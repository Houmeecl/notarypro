import{o as createLucideIcon,r as reactExports,bG as AgoraRTC__default,bO as React,c6 as commonjsGlobal,bf as getDefaultExportFromCjs,u as useToast,j as jsxRuntimeExports,d as Card,v as CardHeader,x as CardTitle,z as CardDescription,e as CardContent,V as CardFooter,a as Button,ax as Alert,ay as CircleAlert,az as AlertTitle,aA as AlertDescription,bm as RefreshCw,bN as LoaderCircle,bh as Camera,p as useLocation,b$ as useRoute,ad as Label,P as Input,B as Badge,bE as Video,au as Phone,T as Tabs,g as TabsList,h as TabsTrigger,i as FileText,bc as Shield,bo as RotateCcw,k as TabsContent,bJ as MicOff,bI as Mic,c7 as CameraOff,c8 as PenLine,aB as CircleCheckBig,bY as UserCheck,aD as Dialog,aE as DialogContent,aF as DialogHeader,aG as DialogTitle,aH as DialogDescription,aI as DialogFooter}from"./index-BPC64rrb.js";import{F as ForcedModeNotification}from"./ForcedModeNotification-DitjzG4k.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode=[["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 18h18",key:"1h113x"}],["path",{d:"M3 6h18",key:"d0wm0j"}]],AlignJustify=createLucideIcon("align-justify",__iconNode);function _objectWithoutPropertiesLoose(r,e){if(r==null)return{};var i={},o=Object.keys(r),s,l;for(l=0;l<o.length;l++)s=o[l],!(e.indexOf(s)>=0)&&(i[s]=r[s]);return i}var AgoraRTCErrorCode;(function(r){r.UNEXPECTED_ERROR="UNEXPECTED_ERROR",r.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",r.TIMEOUT="TIMEOUT",r.INVALID_PARAMS="INVALID_PARAMS",r.NOT_SUPPORTED="NOT_SUPPORTED",r.INVALID_OPERATION="INVALID_OPERATION",r.OPERATION_ABORTED="OPERATION_ABORTED",r.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",r.NETWORK_ERROR="NETWORK_ERROR",r.NETWORK_TIMEOUT="NETWORK_TIMEOUT",r.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",r.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",r.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",r.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",r.ELECTRON_IS_NULL="ELECTRON_IS_NULL",r.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",r.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",r.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",r.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",r.PERMISSION_DENIED="PERMISSION_DENIED",r.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",r.TRACK_IS_DISABLED="TRACK_IS_DISABLED",r.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",r.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",r.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",r.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",r.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",r.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",r.UID_CONFLICT="UID_CONFLICT",r.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",r.INVALID_TRACK="INVALID_TRACK",r.SENDER_NOT_FOUND="SENDER_NOT_FOUND",r.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",r.SET_ANSWER_FAILED="SET_ANSWER_FAILED",r.ICE_FAILED="ICE_FAILED",r.PC_CLOSED="PC_CLOSED",r.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",r.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",r.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",r.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",r.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",r.INVALID_REMOTE_USER="INVALID_REMOTE_USER",r.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",r.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",r.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",r.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",r.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",r.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",r.WS_ABORT="WS_ABORT",r.WS_DISCONNECT="WS_DISCONNECT",r.WS_ERR="WS_ERR",r.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",r.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",r.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",r.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",r.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",r.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",r.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",r.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",r.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",r.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",r.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",r.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",r.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",r.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",r.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",r.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",r.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",r.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE"})(AgoraRTCErrorCode||(AgoraRTCErrorCode={}));var createClient=function(e){var i;function o(){return i||(i=AgoraRTC__default.createClient(e)),i}return function(){return o()}};function createMicrophoneAndCameraTracks(r,e){var i=function(){try{return Promise.resolve(AgoraRTC__default.createMicrophoneAndCameraTracks(r,e)).then(function(l){return o=l,o})}catch(l){return Promise.reject(l)}},o=null;return function(){var l=reactExports.useState(!1),f=l[0],h=l[1],d=reactExports.useState(null),p=d[0],g=d[1],_=reactExports.useRef(o);return reactExports.useEffect(function(){return _.current===null?i().then(function(b){_.current=b,h(!0)},function(b){g(b)}):h(!0),function(){o=null}},[]),{ready:f,tracks:_.current,error:p}}}var AgoraVideoPlayer=function(e){var i=reactExports.useRef(null),o=e.videoTrack,s=e.config,l=_objectWithoutPropertiesLoose(e,["videoTrack","config"]);return reactExports.useLayoutEffect(function(){return i.current!==null&&o.play(i.current,s),function(){o.stop()}},[o]),React.createElement("div",Object.assign({},l,{ref:i}))},agoraRtmSdk$1={exports:{}},agoraRtmSdk=agoraRtmSdk$1.exports,hasRequiredAgoraRtmSdk;function requireAgoraRtmSdk(){return hasRequiredAgoraRtmSdk||(hasRequiredAgoraRtmSdk=1,function(module,exports){var define_process_env_default={};/*
 @preserve
 AgoraRTM Web SDK 1.4.3-203 - commit: v1.4.3-17-g1e27aa38
 Copyright (C) 2018-2021 Agora Lab.
 This file is licensed under the AGORA, INC. SDK LICENSE AGREEMENT
 A copy of this license may be found at https://www.agora.io/en/sdk-license-agreement/
*/(function(r,e){module.exports=e()})(agoraRtmSdk,function(){function be(r,e){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);e&&(o=o.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),i.push.apply(i,o)}return i}function ua(r){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?be(Object(i),!0).forEach(function(o){m(r,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):be(Object(i)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(i,o))})}return r}function X(r){return(X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function sl(r,e,i,o,s,l,f){try{var h=r[l](f),d=h.value}catch(p){return void i(p)}h.done?e(d):Promise.resolve(d).then(o,s)}function J(r){return function(){var e=this,i=arguments;return new Promise(function(o,s){function l(d){sl(h,o,s,l,f,"next",d)}function f(d){sl(h,o,s,l,f,"throw",d)}var h=r.apply(e,i);l(void 0)})}}function W(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function tl(r,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function Ha(r,e,i){return e&&tl(r.prototype,e),i&&tl(r,i),r}function m(r,e,i){return e in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,r}function la(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&df(r,e)}function wd(r){return(wd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(r)}function df(r,e){return(df=Object.setPrototypeOf||function(i,o){return i.__proto__=o,i})(r,e)}function ul(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sh(r,e,i){return(Sh=ul()?Reflect.construct:function(o,s,l){var f=[null];return f.push.apply(f,s),o=new(Function.bind.apply(o,f)),l&&df(o,l.prototype),o}).apply(null,arguments)}function ef(r){var e=typeof Map=="function"?new Map:void 0;return(ef=function(i){function o(){return Sh(i,arguments,wd(this).constructor)}if(i===null||Function.toString.call(i).indexOf("[native code]")===-1)return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(i))return e.get(i);e.set(i,o)}return o.prototype=Object.create(i.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),df(o,i)})(r)}function ff(r,e){if(r==null)return{};if(r==null)var i={};else{i={};var o,s=Object.keys(r);for(o=0;o<s.length;o++){var l=s[o];0<=e.indexOf(l)||(i[l]=r[l])}}if(Object.getOwnPropertySymbols)for(o=Object.getOwnPropertySymbols(r),l=0;l<o.length;l++)s=o[l],0<=e.indexOf(s)||Object.prototype.propertyIsEnumerable.call(r,s)&&(i[s]=r[s]);return i}function n(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ma(r){var e=ul();return function(){var i=wd(r);if(e){var o=wd(this).constructor;i=Reflect.construct(i,arguments,o)}else i=i.apply(this,arguments);return i=!i||typeof i!="object"&&typeof i!="function"?n(this):i}}function Th(r,e,i){return(Th=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(o,s,l){for(;!Object.prototype.hasOwnProperty.call(o,s)&&(o=wd(o))!==null;);if(o)return(s=Object.getOwnPropertyDescriptor(o,s)).get?s.get.call(l):s.value})(r,e,i||r)}function ra(r,e){var i=Array.isArray(r)?r:void 0;if(!i)if((i=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]))==null)i=void 0;else{var o,s=[],l=!0,f=!1;try{for(i=i.call(r);!(l=(o=i.next()).done)&&(s.push(o.value),!e||s.length!==e);l=!0);}catch(d){f=!0;var h=d}finally{try{l||i.return==null||i.return()}finally{if(f)throw h}}i=s}if(!(r=i||vl(r,e)))throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return r}function G(r){var e=Array.isArray(r)?Uh(r):void 0;if(e||(e=typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null?Array.from(r):void 0),!(r=e||vl(r)))throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return r}function vl(r,e){if(r){if(typeof r=="string")return Uh(r,e);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Uh(r,e)}}function Uh(r,e){(e==null||e>r.length)&&(e=r.length);for(var i=0,o=Array(e);i<e;i++)o[i]=r[i];return o}function fa(r,e,i,o,s){var l={};return Object.keys(o).forEach(function(f){l[f]=o[f]}),l.enumerable=!!l.enumerable,l.configurable=!!l.configurable,("value"in l||l.initializer)&&(l.writable=!0),l=i.slice().reverse().reduce(function(f,h){return h(r,e,f)||f},l),s&&l.initializer!==void 0&&(l.value=l.initializer?l.initializer.call(s):void 0,l.initializer=void 0),l.initializer===void 0&&(Object.defineProperty(r,e,l),l=null),l}function $a(r){var e={exports:{}};return r(e,e.exports),e.exports}function wl(r,e){var i,o=3>arguments.length?r:arguments[2];return va(r)===o?r[e]:(i=Fb.f(r,e))?Q(i,"value")?i.value:i.get===void 0?void 0:i.get.call(o):ha(i=Vb(r))?wl(i,e,o):void 0}function rs(r){var e=r.charCodeAt(0)<<24,i=0|ss(~e),o=0,s=0|r.length,l="";if(5>i&&s>=i){for(e=e<<i>>>24+i,o=1;o<i;o=o+1|0)e=e<<6|63&r.charCodeAt(o);65535>=e?l+=xd(e):1114111>=e?l+=xd(55296+((e=e-65536|0)>>10)|0,56320+(1023&e)|0):o=0}for(;o<s;o=o+1|0)l+="ï¿½";return l}function xl(){}function ts(r){var e=0|r.charCodeAt(0);if(55296<=e&&56319>=e){var i=0|r.charCodeAt(1);if(!(i==i&&56320<=i&&57343>=i))return xd(239,191,189);if(65535<(e=(e-55296<<10)+i-56320+65536|0))return xd(240|e>>>18,128|e>>>12&63,128|e>>>6&63,128|63&e)}return 127>=e?r:2047>=e?xd(192|e>>>6,128|63&e):xd(224|e>>>12,128|e>>>6&63,128|63&e)}function yl(){}function ea(){ea.init.call(this)}function ng(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+X(r))}function zl(r,e,i,o){ng(i);var s=r._events;if(s===void 0)s=r._events=Object.create(null),r._eventsCount=0;else{s.newListener!==void 0&&(r.emit("newListener",e,i.listener?i.listener:i),s=r._events);var l=s[e]}return l===void 0?(s[e]=i,++r._eventsCount):(typeof l=="function"?l=s[e]=o?[i,l]:[l,i]:o?l.unshift(i):l.push(i),0<(i=r._maxListeners===void 0?ea.defaultMaxListeners:r._maxListeners)&&l.length>i&&!l.warned&&(l.warned=!0,(i=Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",i.emitter=r,i.type=e,i.count=l.length,console&&console.warn&&console.warn(i))),r}function us(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Al(r,e,i){return r={fired:!1,wrapFn:void 0,target:r,type:e,listener:i},(e=us.bind(r)).listener=i,r.wrapFn=e}function Bl(r,e,i){if((r=r._events)===void 0)return[];if((e=r[e])===void 0)return[];if(typeof e=="function")return i?[e.listener||e]:[e];if(i)for(i=Array(e.length),r=0;r<i.length;++r)i[r]=e[r].listener||e[r];else i=Cl(e,e.length);return i}function Dl(r){var e=this._events;if(e!==void 0){if(typeof(r=e[r])=="function")return 1;if(r!==void 0)return r.length}return 0}function Cl(r,e){for(var i=Array(e),o=0;o<e;++o)i[o]=r[o];return i}function vs(r,e,i){typeof r.on=="function"&&El(r,"error",e,i)}function El(r,e,i,o){if(typeof r.on=="function")o.once?r.once(e,i):r.on(e,i);else{if(typeof r.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+X(r));r.addEventListener(e,function s(l){o.once&&r.removeEventListener(e,s),i(l)})}}function ws(r){return r?G(r):xs(function(){return[]},function(e,i){return e.push(i),e})}function Fl(r,e){var i,o,s,l;return w.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:i=Gl(r)([Hl,Hl,function(h,d){return d}])[2],o=0;case 2:if(!(o<e.length)){f.next=17;break}if(s=e[o],!((l=i(Vh,s))instanceof og)){f.next=11;break}if((l=Wh(l.deref()))===Vh){f.next=10;break}return f.next=10,l;case 10:return f.abrupt("return");case 11:if(l===Vh){f.next=14;break}return f.next=14,l;case 14:o++,f.next=2;break;case 17:case"end":return f.stop()}},ys)}function pg(r,e){return e!=null&&typeof e[Symbol.iterator]=="function"?Fl(pg(r),e):function(i){var o=i[2];return zs(i,function(s,l){return o(s,r(l))})}}function Ac(r){return Object.prototype.toString.call(r).slice(8,-1)}function yd(r){return Ac(r)==="Object"&&r.constructor===Object&&Object.getPrototypeOf(r)===Object.prototype}function Il(r){var e;return(e=Ac(r)==="Boolean"||Ac(r)==="Null"||Ac(r)==="Undefined")||(e=Ac(r)==="Number"&&!isNaN(r)),e||Ac(r)==="String"||Ac(r)==="Symbol"}function zd(r){var e=-1,i=r==null?0:r.length;for(this.clear();++e<i;){var o=r[e];this.set(o[0],o[1])}}function ce(r){var e=-1,i=r==null?0:r.length;for(this.clear();++e<i;){var o=r[e];this.set(o[0],o[1])}}function de(r){var e=-1,i=r==null?0:r.length;for(this.clear();++e<i;){var o=r[e];this.set(o[0],o[1])}}function gf(r){var e=-1,i=r==null?0:r.length;for(this.__data__=new qg;++e<i;)this.add(r[e])}function ee(r){this.size=(this.__data__=new rg(r)).size}function fe(r,e,i,o,s,l){var f,h=1&e,d=2&e,p=4&e;if(i&&(f=s?i(r,o,s,l):i(r)),f!==void 0)return f;if(!lb(r))return r;if(o=Va(r)){if(f=As(r),!h)return Xh(r,f)}else{var g=hf(r),_=g=="[object Function]"||g=="[object GeneratorFunction]";if(jf(r))return Jl(r,h);if(g=="[object Object]"||g=="[object Arguments]"||_&&!s){if(f=d||_?{}:Kl(r),!h)return d?Bs(r,Cs(f,r)):Ds(r,Es(f,r))}else{if(!wa[g])return s?r:{};f=Fs(r,g,h)}}if(l||(l=new ge),s=l.get(r))return s;l.set(r,f),Gs(r)?r.forEach(function(x){f.add(fe(x,e,i,x,r,l))}):Hs(r)&&r.forEach(function(x,A){f.set(A,fe(x,e,i,A,r,l))}),d=p?d?Ll:Yh:d?kf:Ad;var b=o?void 0:d(r);return Is(b||r,function(x,A){b&&(x=r[A=x]),Ml(f,A,fe(x,e,i,A,r,l))}),f}function Zh(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var i=function o(){var s=arguments,l=e?e.apply(this,s):s[0],f=o.cache;return f.has(l)?f.get(l):(s=r.apply(this,s),o.cache=f.set(l,s)||f,s)};return i.cache=new(Zh.Cache||qg),i}function Nl(r){if(typeof r=="string")return r;if(Va(r))return he(r,Nl)+"";if(ie(r))return Ol?Ol.call(r):"";var e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function $h(r,e,i,o,s){var l=-1,f=r.length;for(i||(i=Ks),s||(s=[]);++l<f;){var h=r[l];i(h)?ai(s,h):s[s.length]=h}return s}function je(r,e,i,o,s){if(r===e)e=!0;else if(r==null||e==null||!gc(r)&&!gc(e))e=r!=r&&e!=e;else e:{var l=Va(r),f=Va(e),h=l?"[object Array]":hf(r),d=f?"[object Array]":hf(e),p=(h=h=="[object Arguments]"?"[object Object]":h)=="[object Object]";if(f=(d=d=="[object Arguments]"?"[object Object]":d)=="[object Object]",(d=h==d)&&jf(r)){if(!jf(e)){e=!1;break e}l=!0,p=!1}if(d&&!p)s||(s=new ge),e=l||bi(r)?Pl(r,e,i,o,je,s):Ls(r,e,h,i,o,je,s);else{if(!(1&i)&&(l=p&&Ql.call(r,"__wrapped__"),h=f&&Ql.call(e,"__wrapped__"),l||h)){r=l?r.value():r,e=h?e.value():e,s||(s=new ge),e=je(r,e,i,o,s);break e}if(d)t:if(s||(s=new ge),l=1&i,h=Yh(r),f=h.length,d=Yh(e).length,f==d||l){for(d=f;d--;){var g=h[d];if(!(l?g in e:Ms.call(e,g))){e=!1;break t}}if(p=s.get(r),g=s.get(e),p&&g)e=p==e&&g==r;else{p=!0,s.set(r,e),s.set(e,r);for(var _=l;++d<f;){var b=r[g=h[d]],x=e[g];if(o)var A=l?o(x,b,g,e,r,s):o(b,x,g,r,e,s);if(A===void 0?b!==x&&!je(b,x,i,o,s):!A){p=!1;break}_||(_=g=="constructor")}p&&!_&&(i=r.constructor)!=(o=e.constructor)&&"constructor"in r&&"constructor"in e&&!(typeof i=="function"&&i instanceof i&&typeof o=="function"&&o instanceof o)&&(p=!1),s.delete(r),s.delete(e),e=p}}else e=!1;else e=!1}}return e}function xa(r,e,i){this.low=0|r,this.high=0|e,this.unsigned=!!i}function mb(r){return(r&&r.__isLong__)===!0}function Bd(r,e){var i;if(e){if((e=0<=(r>>>=0)&&256>r)&&(i=Rl[r]))return i;i=ya(r,0>(0|r)?-1:0,!0),e&&(Rl[r]=i)}else{if((e=-128<=(r|=0)&&128>r)&&(i=Sl[r]))return i;i=ya(r,0>r?-1:0,!1),e&&(Sl[r]=i)}return i}function Gb(r,e){if(isNaN(r))return e?Cd:Hb;if(e){if(0>r)return Cd;if(r>=Tl)return Ul}else{if(r<=-9223372036854776e3)return nb;if(r+1>=Vl)return Wl}return 0>r?Gb(-r,e).neg():ya(r%ke|0,r/ke|0,e)}function ya(r,e,i){return new xa(r,e,i)}function ci(r,e,i){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return Hb;if(typeof e=="number"?(i=e,e=!1):e=!!e,2>(i=i||10)||36<i)throw RangeError("radix");var o;if(0<(o=r.indexOf("-")))throw Error("interior hyphen");if(o===0)return ci(r.substring(1),e,i).neg();o=Gb(sg(i,8));for(var s=Hb,l=0;l<r.length;l+=8){var f=Math.min(8,r.length-l),h=parseInt(r.substring(l,l+f),i);8>f?(f=Gb(sg(i,f)),s=s.mul(f).add(Gb(h))):s=(s=s.mul(o)).add(Gb(h))}return s.unsigned=e,s}function Wb(r,e){return typeof r=="number"?Gb(r,e):typeof r=="string"?ci(r,e):ya(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}function O(r,e){function i(){this.constructor=r}di(r,e),r.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}function le(r){return typeof r=="function"}function me(r){setTimeout(function(){throw r},0)}function ei(r){return r!==null&&X(r)==="object"}function Xl(r){return r.reduce(function(e,i){return e.concat(i instanceof lf?i.errors:i)},[])}function fi(r){for(;r;){var e=r.destination,i=r.isStopped;if(r.closed||i)return!1;r=e&&e instanceof ia?e:null}return!0}function Yc(r){return r}function gi(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Yl(r)}function Yl(r){return r.length===0?Yc:r.length===1?r[0]:function(e){return r.reduce(function(i,o){return o(i)},e)}}function Zl(r){if(r||(r=Ib.Promise||Promise),!r)throw Error("no Promise impl found");return r}function $l(){return function(r){return r.lift(new Ns(r))}}function mf(r){return r?Os(r):vb}function Os(r){return new Y(function(e){return r.schedule(function(){return e.complete()})})}function Zc(r){return r&&typeof r.schedule=="function"}function hi(r,e){return new Y(function(i){var o=new Oa,s=0;return o.add(e.schedule(function(){s===r.length?i.complete():(i.next(r[s++]),i.closed||o.add(this.schedule()))})),o})}function nf(r,e){return e?hi(r,e):new Y(am(r))}function bb(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Zc(e=r[r.length-1])?(r.pop(),hi(r,e)):nf(r)}function Z(r,e){return new Y(e?function(i){return e.schedule(Ps,0,{error:r,subscriber:i})}:function(i){return i.error(r)})}function Ps(r){r.subscriber.error(r.error)}function Qs(r,e){return e===void 0&&(e=0),function(i){return i.lift(new Rs(r,e))}}function bm(r){return r in ii&&(delete ii[r],!0)}function hc(){}function ba(r,e){return function(i){if(typeof r!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new Ss(r,e))}}function cm(r,e,i){if(e){if(!Zc(e))return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return cm(r,i).apply(void 0,o).pipe(ba(function(l){return Jb(l)?e.apply(void 0,l):e(l)}))};i=e}return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var l,f=this,h={context:f,subject:l,callbackFunc:r,scheduler:i};return new Y(function(d){if(i)return i.schedule(Ts,0,{args:o,subscriber:d,params:h});if(!l){l=new of;try{r.apply(f,o.concat([function(){for(var p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];l.next(1>=p.length?p[0]:p),l.complete()}]))}catch(p){fi(l)?l.error(p):console.warn(p)}}return l.subscribe(d)})}}function Ts(r){var e=this,i=r.args,o=r.subscriber,s=r.params;r=s.callbackFunc;var l=s.context,f=s.scheduler,h=s.subject;if(!h){h=s.subject=new of,s=function(){for(var d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];e.add(f.schedule(Us,0,{value:1>=d.length?d[0]:d,subject:h}))};try{r.apply(l,i.concat([s]))}catch(d){h.error(d)}}this.add(h.subscribe(o))}function Us(r){var e=r.subject;e.next(r.value),e.complete()}function dm(r,e,i){if(e){if(!Zc(e))return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return dm(r,i).apply(void 0,o).pipe(ba(function(l){return Jb(l)?e.apply(void 0,l):e(l)}))};i=e}return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var l={subject:void 0,args:o,callbackFunc:r,scheduler:i,context:this};return new Y(function(f){var h=l.context,d=l.subject;if(i)return i.schedule(Vs,0,{params:l,subscriber:f,context:h});if(!d){d=l.subject=new of;try{r.apply(h,o.concat([function(){for(var p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];(g=p.shift())?d.error(g):(d.next(1>=p.length?p[0]:p),d.complete())}]))}catch(p){fi(d)?d.error(p):console.warn(p)}}return d.subscribe(f)})}}function Vs(r){var e=this,i=r.params,o=r.subscriber;r=r.context;var s=i.callbackFunc,l=i.args,f=i.scheduler,h=i.subject;if(!h){h=i.subject=new of,i=function(){for(var d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];(p=d.shift())?e.add(f.schedule(em,0,{err:p,subject:h})):e.add(f.schedule(Ws,0,{value:1>=d.length?d[0]:d,subject:h}))};try{s.apply(r,l.concat([i]))}catch(d){this.add(f.schedule(em,0,{err:d,subject:h}))}}this.add(h.subscribe(o))}function Ws(r){var e=r.subject;e.next(r.value),e.complete()}function em(r){r.subject.error(r.err)}function fm(r){return!!r&&typeof r.subscribe!="function"&&typeof r.then=="function"}function ji(r,e,i,o,s){if(s===void 0&&(s=new Xs(r,i,o)),!s.closed)return e instanceof Y?e.subscribe(s):pf(e)(s)}function Ys(r,e){return new Y(function(i){var o=new Oa;return o.add(e.schedule(function(){var s=r[ne]();o.add(s.subscribe({next:function(l){o.add(e.schedule(function(){return i.next(l)}))},error:function(l){o.add(e.schedule(function(){return i.error(l)}))},complete:function(){o.add(e.schedule(function(){return i.complete()}))}}))})),o})}function Zs(r,e){return new Y(function(i){var o=new Oa;return o.add(e.schedule(function(){return r.then(function(s){o.add(e.schedule(function(){i.next(s),o.add(e.schedule(function(){return i.complete()}))}))},function(s){o.add(e.schedule(function(){return i.error(s)}))})})),o})}function $s(r,e){if(!r)throw Error("Iterable cannot be null");return new Y(function(i){var o,s=new Oa;return s.add(function(){o&&typeof o.return=="function"&&o.return()}),s.add(e.schedule(function(){o=r[$c](),s.add(e.schedule(function(){if(!i.closed){try{var l=o.next(),f=l.value,h=l.done}catch(d){return void i.error(d)}h?i.complete():(i.next(f),this.schedule())}}))})),s})}function gm(r,e){if(r!=null){if(r&&typeof r[ne]=="function")return Ys(r,e);if(fm(r))return Zs(r,e);if(hm(r))return hi(r,e);if(r&&typeof r[$c]=="function"||typeof r=="string")return $s(r,e)}throw new TypeError((r!==null&&X(r)||r)+" is not observable")}function Kb(r,e){return e?gm(r,e):r instanceof Y?r:new Y(pf(r))}function ic(r,e){if(!e.closed){if(r instanceof Y)return r.subscribe(e);try{var i=pf(r)(e)}catch(o){e.error(o)}return i}}function cb(r,e,i){return i===void 0&&(i=Number.POSITIVE_INFINITY),typeof e=="function"?function(o){return o.pipe(cb(function(s,l){return Kb(r(s,l)).pipe(ba(function(f,h){return e(s,f,l,h)}))},i))}:(typeof e=="number"&&(i=e),function(o){return o.lift(new at(r,i))})}function tg(r){return r===void 0&&(r=Number.POSITIVE_INFINITY),cb(Yc,r)}function im(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return tg(1)(bb.apply(void 0,r))}function ad(r){return new Y(function(e){try{var i=r()}catch(o){return void e.error(o)}return(i?Kb(i):mf()).subscribe(e)})}function jm(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];if(r.length===1){var i=r[0];if(Jb(i))return ug(i,null);if(ei(i)&&Object.getPrototypeOf(i)===Object.prototype)return ug((r=Object.keys(i)).map(function(s){return i[s]}),r)}if(typeof r[r.length-1]=="function"){var o=r.pop();return ug(r=r.length===1&&Jb(r[0])?r[0]:r,null).pipe(ba(function(s){return o.apply(void 0,s)}))}return ug(r,null)}function ug(r,e){return new Y(function(i){var o=r.length;if(o===0)i.complete();else for(var s=Array(o),l=0,f=0,h=function(p){var g=Kb(r[p]),_=!1;i.add(g.subscribe({next:function(b){_||(_=!0,f++),s[p]=b},error:function(b){return i.error(b)},complete:function(){++l!==o&&_||(f===o&&i.next(e?e.reduce(function(b,x,A){return b[x]=s[A],b},{}):s),i.complete())}}))},d=0;d<o;d++)h(d)})}function gb(r,e,i,o){return le(i)&&(o=i,i=void 0),o?gb(r,e,i).pipe(ba(function(s){return Jb(s)?o.apply(void 0,s):o(s)})):new Y(function(s){km(r,e,function(l){1<arguments.length?s.next(Array.prototype.slice.call(arguments)):s.next(l)},s,i)})}function km(r,e,i,o,s){if(r&&typeof r.addEventListener=="function"&&typeof r.removeEventListener=="function"){r.addEventListener(e,i,s);var l=function(){return r.removeEventListener(e,i,s)}}else if(r&&typeof r.on=="function"&&typeof r.off=="function")r.on(e,i),l=function(){return r.off(e,i)};else if(r&&typeof r.addListener=="function"&&typeof r.removeListener=="function")r.addListener(e,i),l=function(){return r.removeListener(e,i)};else{if(!r||!r.length)throw new TypeError("Invalid event target");for(var f=0,h=r.length;f<h;f++)km(r[f],e,i,o,s)}o.add(l)}function lm(r,e,i){return i?lm(r,e).pipe(ba(function(o){return Jb(o)?i.apply(void 0,o):i(o)})):new Y(function(o){var s=function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];return o.next(f.length===1?f[0]:f)};try{var l=r(s)}catch(f){return void o.error(f)}if(le(e))return function(){return e(s,l)}})}function bt(r){var e=r.subscriber,i=r.condition;if(!e.closed){if(r.needIterate)try{r.state=r.iterate(r.state)}catch(l){return void e.error(l)}else r.needIterate=!0;if(i){var o=void 0;try{o=i(r.state)}catch(l){return void e.error(l)}if(!o)return void e.complete();if(e.closed)return}try{var s=r.resultSelector(r.state)}catch(l){return void e.error(l)}if(!e.closed&&(e.next(s),!e.closed))return this.schedule(r)}}function ki(r){return!Jb(r)&&0<=r-parseFloat(r)+1}function mm(r,e){return r===void 0&&(r=0),e===void 0&&(e=bd),(!ki(r)||0>r)&&(r=0),e&&typeof e.schedule=="function"||(e=bd),new Y(function(i){return i.add(e.schedule(ct,r,{subscriber:i,counter:0,period:r})),i})}function ct(r){var e=r.subscriber,i=r.counter;r=r.period,e.next(i),this.schedule({subscriber:e,counter:i+1,period:r},r)}function Xb(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];e=Number.POSITIVE_INFINITY;var i=null,o=r[r.length-1];return Zc(o)?(i=r.pop(),1<r.length&&typeof r[r.length-1]=="number"&&(e=r.pop())):typeof o=="number"&&(e=r.pop()),i===null&&r.length===1&&r[0]instanceof Y?r[0]:tg(e)(nf(r,i))}function li(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];if(r.length===0)return vb;var i=r[0],o=r.slice(1);return r.length===1&&Jb(i)?li.apply(void 0,i):new Y(function(s){var l=function(){return s.add(li.apply(void 0,o).subscribe(s))};return Kb(i).subscribe({next:function(f){s.next(f)},error:l,complete:l})})}function dt(r){var e=r.keys,i=r.index,o=r.subscriber,s=r.subscription;if(r=r.obj,!o.closed)if(i<e.length){var l=e[i];o.next([l,r[l]]),s.add(this.schedule({keys:e,index:i+1,subscriber:o,subscription:s,obj:r}))}else o.complete()}function et(r,e){function i(){return!i.pred.apply(i.thisArg,arguments)}return i.pred=r,i.thisArg=e,i}function wb(r,e){return function(i){return i.lift(new ft(r,e))}}function Ca(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];if(r.length===1){if(!Jb(r[0]))return r[0];r=r[0]}return nf(r,void 0).lift(new gt)}function ht(r){var e=r.start,i=r.index,o=r.subscriber;i>=r.count?o.complete():(o.next(e),o.closed||(r.index=i+1,r.start=e+1,this.schedule(r)))}function Bc(r,e,i){r===void 0&&(r=0);var o=-1;return ki(e)?o=1>Number(e)?1:Number(e):Zc(e)&&(i=e),Zc(i)||(i=bd),new Y(function(s){var l=ki(r)?r:+r-i.now();return i.schedule(it,l,{index:0,period:o,subscriber:s})})}function it(r){var e=r.index,i=r.period,o=r.subscriber;if(o.next(e),!o.closed){if(i===-1)return o.complete();r.index=e+1,this.schedule(r,i)}}function mi(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return typeof(e=r[r.length-1])=="function"&&r.pop(),nf(r,void 0).lift(new jt(e))}function Ga(r){return function(e){var i=new kt(r);return e=e.lift(i),i.caught=e}}function ni(r,e){return cb(r,e,1)}function nm(r){return r===void 0&&(r=null),function(e){return e.lift(new lt(r))}}function cd(r,e){e===void 0&&(e=bd);var i=r instanceof Date&&!isNaN(+r)?+r-e.now():Math.abs(r);return function(o){return o.lift(new mt(i,e))}}function om(r,e){return function(i){return i.lift(new nt(r,e))}}function Dd(r){return r===void 0&&(r=ot),function(e){return e.lift(new pt(r))}}function ot(){return new vg}function Ka(r){return function(e){return r===0?mf():e.lift(new qt(r))}}function pm(r,e){return e?function(i){return i.pipe(pm(function(o,s){return Kb(r(o,s)).pipe(ba(function(l,f){return e(o,l,s,f)}))}))}:function(i){return i.lift(new rt(r))}}function wg(r){return function(e){return e.lift(new st(r))}}function aa(r,e){var i=2<=arguments.length;return function(o){return o.pipe(r?wb(function(s,l){return r(s,l,o)}):Yc,Ka(1),i?nm(e):Dd(function(){return new vg}))}}function tt(){return function(r){return r.lift(new ut)}}function qm(r){return function(e){return r===0?mf():e.lift(new vt(r))}}function qf(r){return function(e){return e.lift(new wt(r))}}function xg(r,e){var i=!1;return 2<=arguments.length&&(i=!0),function(o){return o.lift(new xt(r,e,i))}}function rm(r,e){return 2<=arguments.length?function(i){return gi(xg(r,e),qm(1),nm(e))(i)}:function(i){return gi(xg(function(o,s,l){return r(o,s,l+1)}),qm(1))(i)}}function yt(r,e){return function(i){var o=typeof r=="function"?r:function(){return r},s=Object.create(i,At);return s.source=i,s.subjectFactory=o,s}}function oe(r){return function(e){return e.lift(new Bt(r,e))}}function Ct(){return new Pa}function pe(){return function(r){return $l()(yt(Ct)(r))}}function sm(r,e,i){var o=r&&X(r)==="object"?r:{bufferSize:r,windowTime:e,refCount:!1,scheduler:i};return function(s){return s.lift(Dt(o))}}function Dt(r){var e,i,o=r.bufferSize,s=o===void 0?Number.POSITIVE_INFINITY:o,l=(o=r.windowTime)===void 0?Number.POSITIVE_INFINITY:o,f=r.refCount,h=r.scheduler,d=0,p=!1,g=!1;return function(_){if(d++,!e||p){p=!1;var b=(e=new qe(s,l,h)).subscribe(this);i=_.subscribe({next:function(x){e.next(x)},error:function(x){p=!0,e.error(x)},complete:function(){g=!0,i=void 0,e.complete()}}),g&&(i=void 0)}else b=e.subscribe(this);this.add(function(){d--,b.unsubscribe(),b=void 0,i&&!g&&f&&d===0&&(i.unsubscribe(),e=i=void 0)})}}function Cc(r,e){return function(i){return i.lift(new Et(r))}}function ob(r){return function(e){return e.lift(new Ft(r))}}function Gt(r,e){return e===void 0&&(e=!1),function(i){return i.lift(new Ht(r,e))}}function ca(r,e,i){return function(o){return o.lift(new It(r,e,i))}}function Jt(r,e,i){return e===void 0&&(e=bd),i===void 0&&(i=Kt),function(o){return o.lift(new Lt(r,e,i.leading,i.trailing))}}function Mt(r){r.subscriber.clearThrottle()}function Nt(r,e,i){return i===void 0&&(i=bd),function(o){var s=r instanceof Date&&!isNaN(+r),l=s?+r-i.now():Math.abs(r);return o.lift(new Ot(l,s,e,i))}}function hb(r,e){return e===void 0&&(e=bd),Nt(r,Z(new pb),e)}function Pt(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return function(i){var o;return typeof r[r.length-1]=="function"&&(o=r.pop()),i.lift(new Qt(r,o))}}function tm(r,e,i,o,s){r!==e&&um(e,function(l,f){if(s||(s=new ge),lb(l)){l=s;var h=oi(r,f),d=oi(e,f),p=l.get(d);if(p)pi(r,f,p);else{var g=(p=o?o(h,d,f+"",r,e,l):void 0)===void 0;if(g){var _=Va(d),b=!_&&jf(d),x=!_&&!b&&bi(d);p=d,_||b||x?Va(h)?p=h:gc(h)&&Ed(h)?p=Xh(h):b?(g=!1,p=Jl(d,!0)):x?(g=!1,p=vm(d,!0)):p=[]:wm(d)||rf(d)?(p=h,rf(h)?p=re(h,kf(h)):lb(h)&&!qi(h)||(p=Kl(d))):g=!1}g&&(l.set(d,p),tm(p,d,i,o,l),l.delete(d)),pi(r,f,p)}}else(h=o?o(oi(r,f),l,f+"",r,e,s):void 0)===void 0&&(h=l),pi(r,f,h)},kf)}function Rt(r){var e=1,i=ri;(1>=arguments.length?0:arguments.length-1)==1?typeof(1>=arguments.length?void 0:arguments[1])=="number"?e=1>=arguments.length?void 0:arguments[1]:i=1>=arguments.length?void 0:arguments[1]:(1>=arguments.length?0:arguments.length-1)==2&&(e=1>=arguments.length?void 0:arguments[1],i=2>=arguments.length?void 0:arguments[2]);var o=e||1;return function(s){return s.pipe(xg(function(l,f){var h=i.now(),d=h-r;if((l=l.filter(function(_){return _.until>d})).length>=o){var p=l[l.length-1],g=l[0].until+r*Math.floor(l.length/o);l.push({delay:p.until<h?g-h:g-p.until,until:g,value:f})}else l.push({delay:0,until:h,value:f});return l},[]),ba(function(l){return l[l.length-1]}),ni(function(l){var f=bb(l.value);return l.delay?f.pipe(cd(l.delay,i)):f}))}}function St(r,e){var i=(e=e===void 0?{protocols:xm,makeWebSocket:ym}:e).protocols,o=i===void 0?xm:i,s=(e=e.makeWebSocket)===void 0?ym:e;return new Y(function(l){var f,h=new Pa,d=s(r,o),p=!1,g=!1,_=function(b){if(f)throw p=!0,b=Error("Web socket message factory function called more than once"),l.error(b),b;return f=b.subscribe(function(x){d.send(x)}),h};return d.onopen=function(){g?(p=!0,d.close()):l.next(_)},d.onmessage=function(b){h.next(b.data)},d.onerror=function(b){p=!0,l.error(Error(b.message))},d.onclose=function(b){p||(p=!0,g?(l.complete(),h.complete()):l.error(Error(b.code===1e3?"Normal closure":b.reason)))},function(){g=!0,f&&f.unsubscribe(),p||(p=!0,d.close())}})}function yg(){this._listeners={}}function zm(r){return typeof Float32Array<"u"?function(){function e(d,p,g){l[0]=d,p[g]=f[0],p[g+1]=f[1],p[g+2]=f[2],p[g+3]=f[3]}function i(d,p,g){l[0]=d,p[g]=f[3],p[g+1]=f[2],p[g+2]=f[1],p[g+3]=f[0]}function o(d,p){return f[0]=d[p],f[1]=d[p+1],f[2]=d[p+2],f[3]=d[p+3],l[0]}function s(d,p){return f[3]=d[p],f[2]=d[p+1],f[1]=d[p+2],f[0]=d[p+3],l[0]}var l=new Float32Array([-0]),f=new Uint8Array(l.buffer),h=f[3]===128;r.writeFloatLE=h?e:i,r.writeFloatBE=h?i:e,r.readFloatLE=h?o:s,r.readFloatBE=h?s:o}():function(){function e(o,s,l,f){var h=0>s?1:0;if(h&&(s=-s),s===0)o(0<1/s?0:2147483648,l,f);else if(isNaN(s))o(2143289344,l,f);else if(34028234663852886e22<s)o((h<<31|2139095040)>>>0,l,f);else if(11754943508222875e-54>s)o((h<<31|Math.round(s/1401298464324817e-60))>>>0,l,f);else{var d=Math.floor(Math.log(s)/Math.LN2);o((h<<31|d+127<<23|8388607&Math.round(s*Math.pow(2,-d)*8388608))>>>0,l,f)}}function i(o,s,l){return l=o(s,l),o=2*(l>>31)+1,s=l>>>23&255,l&=8388607,s===255?l?NaN:1/0*o:s===0?1401298464324817e-60*o*l:o*Math.pow(2,s-150)*(l+8388608)}r.writeFloatLE=e.bind(null,Am),r.writeFloatBE=e.bind(null,Bm),r.readFloatLE=i.bind(null,Cm),r.readFloatBE=i.bind(null,Dm)}(),typeof Float64Array<"u"?function(){function e(d,p,g){l[0]=d,p[g]=f[0],p[g+1]=f[1],p[g+2]=f[2],p[g+3]=f[3],p[g+4]=f[4],p[g+5]=f[5],p[g+6]=f[6],p[g+7]=f[7]}function i(d,p,g){l[0]=d,p[g]=f[7],p[g+1]=f[6],p[g+2]=f[5],p[g+3]=f[4],p[g+4]=f[3],p[g+5]=f[2],p[g+6]=f[1],p[g+7]=f[0]}function o(d,p){return f[0]=d[p],f[1]=d[p+1],f[2]=d[p+2],f[3]=d[p+3],f[4]=d[p+4],f[5]=d[p+5],f[6]=d[p+6],f[7]=d[p+7],l[0]}function s(d,p){return f[7]=d[p],f[6]=d[p+1],f[5]=d[p+2],f[4]=d[p+3],f[3]=d[p+4],f[2]=d[p+5],f[1]=d[p+6],f[0]=d[p+7],l[0]}var l=new Float64Array([-0]),f=new Uint8Array(l.buffer),h=f[7]===128;r.writeDoubleLE=h?e:i,r.writeDoubleBE=h?i:e,r.readDoubleLE=h?o:s,r.readDoubleBE=h?s:o}():function(){function e(o,s,l,f,h,d){var p=0>f?1:0;if(p&&(f=-f),f===0)o(0,h,d+s),o(0<1/f?0:2147483648,h,d+l);else if(isNaN(f))o(0,h,d+s),o(2146959360,h,d+l);else if(17976931348623157e292<f)o(0,h,d+s),o((p<<31|2146435072)>>>0,h,d+l);else if(22250738585072014e-324>f)o((f/=5e-324)>>>0,h,d+s),o((p<<31|f/4294967296)>>>0,h,d+l);else{var g=Math.floor(Math.log(f)/Math.LN2);g===1024&&(g=1023),o(4503599627370496*(f*=Math.pow(2,-g))>>>0,h,d+s),o((p<<31|g+1023<<20|1048576*f&1048575)>>>0,h,d+l)}}function i(o,s,l,f,h){return s=o(f,h+s),f=o(f,h+l),o=2*(f>>31)+1,s=4294967296*(1048575&f)+s,(l=f>>>20&2047)===2047?s?NaN:1/0*o:l===0?5e-324*o*s:o*Math.pow(2,l-1075)*(s+4503599627370496)}r.writeDoubleLE=e.bind(null,Am,0,4),r.writeDoubleBE=e.bind(null,Bm,4,0),r.readDoubleLE=i.bind(null,Cm,0,4),r.readDoubleBE=i.bind(null,Dm,4,0)}(),r}function Am(r,e,i){e[i]=255&r,e[i+1]=r>>>8&255,e[i+2]=r>>>16&255,e[i+3]=r>>>24}function Bm(r,e,i){e[i]=r>>>24,e[i+1]=r>>>16&255,e[i+2]=r>>>8&255,e[i+3]=255&r}function Cm(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function Dm(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}function Wa(r,e){this.lo=r>>>0,this.hi=e>>>0}function sf(r,e,i){this.fn=r,this.len=e,this.next=void 0,this.val=i}function si(){}function Tt(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function ja(){this.len=0,this.tail=this.head=new sf(si,0,0),this.states=null}function ti(r,e,i){e[i]=255&r}function ui(r,e){this.len=r,this.next=void 0,this.val=e}function vi(r,e,i){for(;r.hi;)e[i++]=127&r.lo|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;127<r.lo;)e[i++]=127&r.lo|128,r.lo>>>=7;e[i++]=r.lo}function wi(r,e,i){e[i]=255&r,e[i+1]=r>>>8&255,e[i+2]=r>>>16&255,e[i+3]=r>>>24}function jc(){xi.call(this)}function Ut(r,e,i){40>r.length?V.utf8.write(r,e,i):e.utf8Write?e.utf8Write(r,i):e.write(r,i)}function Yb(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function La(r){this.buf=r,this.pos=0,this.len=r.length}function yi(){var r=new Em(0,0),e=0;if(!(4<this.len-this.pos)){for(;3>e;++e){if(this.pos>=this.len)throw Yb(this);if(r.lo=(r.lo|(127&this.buf[this.pos])<<7*e)>>>0,128>this.buf[this.pos++])return r}return r.lo=(r.lo|(127&this.buf[this.pos++])<<7*e)>>>0,r}for(;4>e;++e)if(r.lo=(r.lo|(127&this.buf[this.pos])<<7*e)>>>0,128>this.buf[this.pos++])return r;if(r.lo=(r.lo|(127&this.buf[this.pos])<<28)>>>0,r.hi=(r.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return r;if(e=0,4<this.len-this.pos){for(;5>e;++e)if(r.hi=(r.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,128>this.buf[this.pos++])return r}else for(;5>e;++e){if(this.pos>=this.len)throw Yb(this);if(r.hi=(r.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,128>this.buf[this.pos++])return r}throw Error("invalid varint encoding")}function zg(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}function Fm(){if(this.pos+8>this.len)throw Yb(this,8);return new Em(zg(this.buf,this.pos+=4),zg(this.buf,this.pos+=4))}function Fd(r){zi.call(this,r)}function tf(r,e,i){if(typeof r!="function")throw TypeError("rpcImpl must be a function");V.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=!!e,this.responseDelimited=!!i}function za(r){return typeof r=="string"&&/^[\s\w!#$%&()+,.:;<=>?@[\]^{|}~-]{1,64}$/.test(r)&&r!=="null"}function Gm(r){try{var e=r.split(".").map(function(o){return Number(o)})}catch{return!1}if(e.length!==4||e[0]===0)return!1;for(r=0;r<e.length;r++){var i=e[r];if(!Number.isInteger(i)||0>i||255<i)return!1}return!0}function Hm(r,e){if(!Array.isArray(e)||e.length===0||32<e.length||e.some(function(i){return i.length===0||32<i.length}))throw new I("arguments is not valid",Ja);if(!za(r))throw new I("ID is invalid",Ja)}function uf(r){var e=r.attributes,i=r.attrSizeMap,o=r.maxAttrsCount,s=r.maxAttrValueSize;if(r=r.maxTotalSize,!yd(e))throw new I("attributes must be an object",Ja);if(Object.keys(e).length>o)throw new ib("Exceed the limit of ".concat(o," attributes"),se);if(Object.keys(e).length===0)throw new I("The attributes is an empty object",Ja);var l=0,f=0;for(e=Object.entries(e);f<e.length;f++){var h=ra(e[f],2),d=h[1];h=new Blob([h[0]]).size;var p=new Blob([d]).size;if(h===0||32<h)throw new I("Invalid attribute key",Ja);if(p>s)throw new ib("Invalid attribute value, over the limit of ".concat(s," bytes"),se);if(typeof d!="string"||d.length===0)throw new I("Invalid attribute value",Ja);l+=h,l+=p}if(l>r)throw new ib("The attributes size overflow",se);if(i!==void 0){if(Object.keys(i).length>o)throw new ib("Exceed the limit of ".concat(o," attributes"),se);for(l=o=0,i=Object.entries(i);l<i.length;l++){if(f=(e=ra(i[l],2))[1],(e=new Blob([e[0]]).size)===0)throw new I("Invalid attribute key",Ja);if(f>s)throw new ib("Invalid attribute value, over the limit of ".concat(s," bytes"),se);o+=e,o+=f}if(o>r)throw new ib("The attributes size overflow",se)}}function Ag(r,e){return Math.floor(Math.random()*(Math.floor(e)-Math.ceil(r)+1))+r}function Bg(){var r=Ag(0,4294967295),e=Ag(1,4294967295);return new U(r,e,!0)}function Xa(r){return r.toString().padEnd(32,"0")}function Im(r,e){return new TypeError("Unexpected ".concat(r,": ").concat(e))}function Jm(r,e){return r=r.split(".").map(function(i){return Number(i)}),e=e.split(".").map(function(i){return Number(i)}),Math.sqrt(1e3*Math.pow(r[0]-e[0],2)+100*Math.pow(r[1]-e[1],2)+10*Math.pow(r[2]-e[2],2)+1*Math.pow(r[3]-e[3],2))}function Km(r){return r.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?r.toNumber():r.toString()}function Ai(r,e){e="".concat(r).concat(e||"");var i=Lm.get(e)||1;return Lm.set(e,i+1),"".concat(r).concat(i)}function Mm(r,e){var i=typeof e=="number"?e:e!==void 0&&typeof e!="string"?e.code:void 0;return e=typeof e!="number"&&typeof e!="string"&&e!==void 0&&e.serverCode!==void 0?e.serverCode:void 0,i="".concat(i!==void 0?" Error Code ".concat(i):"").concat(e!==void 0?", server Code ".concat(e):""),r=typeof r=="string"&&r?Cg(r):Array.isArray(r)&&typeof r[0]=="string"&&r[0]?Cg(Nm.apply(void 0,[r[0]].concat(G(r.slice(1))))):"","".concat(i===""?"":"".concat(i," - ")).concat(r)}function Om(r){return Bi.apply(this,arguments)}function Bi(){return(Bi=J(w.mark(function r(e){return w.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise(function(o){setTimeout(function(){o()},e)}));case 1:case"end":return i.stop()}},r)}))).apply(this,arguments)}function Pm(r){return r instanceof Blob||Object.prototype.toString.call(r)==="[object Blob]"}function Dg(r){var e=255&r,i=r>>8&255,o=r>>16&255;return"".concat(r>>24&255,".").concat(o,".").concat(i,".").concat(e)}function te(r,e,i){return Ci.apply(this,arguments)}function Ci(){return(Ci=J(w.mark(function r(e,i,o){var s,l,f,h,d,p,g,_,b,x,A,k,C,j,P,z,_e,Di,_i,Ei,ga,_c,$,Wt,_t,Vt;return w.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(s=i.body,l=i.headers,f=l===void 0?{}:l,h=i.timeout,d=h===void 0?1e4:h,p=i.signal,g=i.withCredentials,_=g!==void 0&&g,b=(o||{}).useBinaryResponse,x=b!==void 0&&b,(A=new XMLHttpRequest).open("POST",e,!0),A.responseType=x?"arraybuffer":"text",A.withCredentials=_,A.timeout=d,k=s instanceof FormData,C=s instanceof Uint8Array,!(1<(j=Object.keys(f).filter(function(H){return H.toLowerCase()==="content-type"})).length)){B.next=14;break}throw new RangeError("multiple content-type");case 14:j.length===0&&(C?f["Content-Type"]="application/octet-stream":k||(f["Content-Type"]="application/json"));case 15:if("setRequestHeader"in A){B.next=46;break}return A.abort(),B.next=19,fetch(e,{body:k||C?s:JSON.stringify(s),cache:"no-cache",credentials:_?"include":"same-origin",headers:f,method:"POST",mode:"cors",referrer:"no-referrer",signal:p});case 19:if(P=B.sent,!(200<=(z=P.status)&&300>z||z===304)){B.next=31;break}if(!x){B.next=27;break}return B.next=25,P.arrayBuffer();case 25:return _e=B.sent,B.abrupt("return",{status:z,responseData:_e});case 27:return B.next=29,P.text();case 29:return Di=B.sent,B.abrupt("return",{status:z,responseText:Di});case 31:return _i=new da(["Post XHR failure, status %d",z]),B.prev=32,B.next=35,P.text();case 35:throw Ei=B.sent,_i.statusCode=z,_i.message=Ei||"Request failed, status ".concat(z),_i;case 41:throw B.prev=41,B.t0=B.catch(32),_i.statusCode=z,_i.message="Request failed, status ".concat(z),_i;case 46:if(Object.keys(f).length!==0)for(ga=0,_c=Object.entries(f);ga<_c.length;ga++)$=ra(_c[ga],2),Wt=$[0],_t=$[1],A.setRequestHeader(Wt,_t);return p!==void 0&&(Vt=function H(){A.abort(),p.removeEventListener("abort",H)},p.addEventListener("abort",Vt)),k||C?A.send(s):A.send(JSON.stringify(s)),B.abrupt("return",new Promise(function(H,ue){A.onload=function(){var _r=A.status;if(200<=_r&&300>_r||_r===304)H(x?{status:_r,responseData:A.response}:{status:_r,responseText:A.responseText});else{var zt=new da(["Post XHR failure, status %d",_r]);zt.statusCode=_r,zt.message=A.response||"Request failed, status ".concat(A.status),ue(zt)}},A.ontimeout=function(_r){ue(new db(["XHR request timed out after %d ms",d],{originalError:_r}))},A.onerror=function(){var _r=new da(["Post XHR failure, status %d",A.status]);_r.statusCode=A.status,_r.message=A.response||"Request failed, status ".concat(A.status),ue(_r)},A.onabort=function(){try{ue(new DOMException("The request aborted.","AbortError"))}catch{var _r=Error("The request aborted.");_r.name="AbortError",ue(_r)}}}));case 50:case"end":return B.stop()}},r,null,[[32,41]])}))).apply(this,arguments)}function Rm(r){return Hi.apply(this,arguments)}function Hi(){return(Hi=J(w.mark(function r(e){var i;return w.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return(i=new Image).src=e,o.abrupt("return",new Promise(function(s,l){i.onload=function(){s({width:i.width,height:i.height})},i.onerror=l}));case 3:case"end":return o.stop()}},r)}))).apply(this,arguments)}function Xt(r,e){return Ii.apply(this,arguments)}function Ii(){return(Ii=J(w.mark(function r(e,i){var o,s,l,f,h,d,p,g,_,b;return w.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(o=e.thumbnailHeight,s=o===void 0?0:o,l=e.thumbnailWidth,f=l===void 0?0:l,h=e.width,d=h===void 0?0:h,p=e.height,g=p===void 0?0:p,_=e.thumbnail,b=[],typeof s=="number"&&typeof f=="number"&&typeof d=="number"&&typeof g=="number"){x.next=5;break}throw new I("Invalid message params",wf);case 5:return 0>=d&&0>=g&&b.push(Rm(Sm(i)).then(function(A){d=A.width,g=A.height})),0>=f&&0>=s&&_!==void 0&&b.push(Ji(_).then(function(){var A=J(w.mark(function k(C){var j;return w.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,Rm(Sm(C));case 2:j=P.sent,f=j.width,s=j.height;case 5:case"end":return P.stop()}},k)}));return function(k){return A.apply(this,arguments)}}())),x.next=9,Promise.all(b).catch(function(){});case 9:return x.abrupt("return",{width:d,height:g,thumbnailWidth:f,thumbnailHeight:s});case 10:case"end":return x.stop()}},r)}))).apply(this,arguments)}function Tm(r,e){if(!yd(r))throw new I("message object is not a plain object",e);if(r.messageType===void 0)if(r.rawMessage instanceof Uint8Array){if(r.messageType="RAW",r.text!==void 0)throw new I("Raw messages cannot have text property. Use description instead",e)}else{if(typeof r.text!="string")throw new I("messageType is undefined",e);if(r.messageType="TEXT",r.rawMessage!==void 0)throw new I("Text messages cannot have rawMessage property",e)}}function Gg(r){return Ki.apply(this,arguments)}function Ki(){return(Ki=J(w.mark(function r(e){var i,o,s,l,f,h,d,p,g,_,b,x,A,k,C,j,P,z,_e,Di,_i;return w.wrap(function(Ei){for(;;)switch(Ei.prev=Ei.next){case 0:if(i=e.message,o=e.peerId,s=e.toPeer,l=e.session,f=e.errorCodes,h=e.diff,d=e.logger,p=e.options,l!==void 0){Ei.next=3;break}throw new K("The client is not logged in. Cannot do the operation",f.NOT_LOGGED_IN);case 3:if(g=!1,i.messageType!=="TEXT"||!i.text.startsWith("AgoraRTMLegacyEndcallCompatibleMessagePrefix")||!s){Ei.next=11;break}if(_=i.text.split("_"),b=ra(_,3),x=b[0],A=b[1],b[2]!==void 0&&za(A)&&x==="AgoraRTMLegacyEndcallCompatibleMessagePrefix"){Ei.next=10;break}throw new I("Message is not valid",ve);case 10:g=!0;case 11:if(k=Date.now(),C=l.messageSentTimes.length-1,!((j=l.messageSentTimes[C])&&j+3e3<k)){Ei.next=18;break}l.messageSentTimes=[k],Ei.next=29;break;case 18:P=C;case 19:if(!(0<=P)){Ei.next=28;break}if(!(l.messageSentTimes[P]+3e3<k)){Ei.next=23;break}return l.messageSentTimes=l.messageSentTimes.slice(P+1,C+1),Ei.abrupt("break",28);case 23:if(!(180<=C-P+1)){Ei.next=25;break}throw new ib("Message sent failed, exceeded the 180 message in 3 seconds",f.TOO_OFTEN);case 25:P--,Ei.next=19;break;case 28:l.messageSentTimes.push(k);case 29:Ei.t0=i.messageType,Ei.next=Ei.t0==="TEXT"?32:Ei.t0==="RAW"?37:Ei.t0==="FILE"||Ei.t0==="IMAGE"?39:40;break;case 32:if(!g){Ei.next=36;break}return z=i.text.split("_"),_e=ra(z,3),Di=_e[1],_i=_e[2],d.info("[rtm-API] EndCall message send api is called"),Ei.abrupt("return",l.sendInvitationMessage({peerId:o,type:"CallCancel",extra:_i,channelId:Di,callId:"0"}));case 36:return Ei.abrupt("return",l.sendTextMessage(i.text,o,s,p,1e4-h));case 37:return i.description===void 0&&(i.description=""),Ei.abrupt("return",l.sendRawMessage(i.rawMessage,i.description,o,s,p,1e4-h));case 39:return Ei.abrupt("return",l.sendMediaMessage(i.messageType,i,o,s,p,1e4-h));case 40:throw new I("Invalid message type",ve);case 41:case"end":return Ei.stop()}},r)}))).apply(this,arguments)}function Yt(r){var e=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],i=r.replace(/(https?:\/\/)?(www.)?/i,"");return e||(i=i.split(".").slice(r.length-2).join(".")),i.indexOf("/")!==-1?i.split("/")[0]:i}function oa(r){if(typeof r!="string")return"[Sensitive Info]";var e=Math.floor(.7*r.length),i=r.length;return Um(r,e,i,"*".repeat(i-e))}function Vm(r,e,i){function o(s){if(r===void 0)return r;if(Il(s))return s;if(Array.isArray(s))return s.map(o);var l={},f=0;for(s=Hg(s);f<s.length;f++){var h=ra(s[f],2),d=h[0];if(typeof(h=h[1])=="string"&&i.includes(d)){l[d]=typeof h=="string"?oa(h):"[Sensitive Info]";break}e.includes(d)?l[d]="[Hidden Info]":l[d]=h==null?h:i.includes(d)?"[Sensitive Info]":o(h)}return l}return Array.isArray(r)?r.map(o):o(r)}function Wm(r){return Object.getOwnPropertyNames(r).forEach(function(e){X(e=r[e])=="object"&&e!==null&&Wm(e)}),Object.freeze(r)}function pa(r){return new TextDecoder("utf-8").decode(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength))}function Ig(r){return new TextEncoder().encode(r).length}function Xm(){for(var r=0,e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];for(e=0;e<i.length;e++)r+=i[e].length;for(r=new Uint8Array(r),o=e=0;o<i.length;o++){var s=i[o];r.set(s,e),e+=s.length}return r}function we(r,e,i){var o=r.match(/([^?#]+)(\?[^#]*)?(#.*)?/);if(r=o==null?void 0:o[1],o=o==null?void 0:o[2]){var s;for(o=o.substr(1).split("&"),s=0;s<o.length;s++)if(o[s].split("=")[0]==e){o[s]=e+"="+encodeURIComponent(i);break}return s==o.length&&o.push(e+"="+encodeURIComponent(i)),r+"?"+o.join("&")}return r+"?"+e+"="+encodeURIComponent(i)}function Ji(r){return new Promise(function(e,i){var o=new FileReader;o.onloadend=function(){var s=o.result||new ArrayBuffer(0);e(s)},o.onerror=i,o.readAsArrayBuffer(r)})}function Zt(r,e){r=r=[r],typeof(e=e||{})=="string"&&(e={type:e});try{var i=new Blob(r,e)}catch(s){if(s.name!=="TypeError")throw s;i=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder);for(var o=0;o<r.length;o+=1)i.append(r[o]);i=i.getBlob(e.type)}return i}function Um(r,e,i,o){return typeof r!="string"?"[Sensitive Info]":r.substring(0,e)+o+r.substring(i)}function Ym(r){var e=[];return function i(o){if(o===null||X(o)!=="object")return o;if(e.indexOf(o)!==-1)return"[Circular]";if(e.push(o),typeof o.toJSON=="function")try{var s=i(o.toJSON());return e.pop(),s}catch(l){return"[Throws: "+(l?l.message:"?")+"]"}return Array.isArray(o)?(s=o.map(i),e.pop(),s):(s=Object.keys(o).reduce(function(l,f){e:{if($t.call(o,f))try{var h=o[f];break e}catch(d){h="[Throws: "+(d?d.message:"?")+"]";break e}h=o[f]}return l[f]=i(h),l},{}),e.pop(),s)}(r)}function au(r){if(!(100<(r=String(r)).length)&&(r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r))){var e=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*e;case"weeks":case"week":case"w":return 6048e5*e;case"days":case"day":case"d":return 864e5*e;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*e;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*e;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e}}}function Jg(r,e,i,o){return Math.round(r/i)+" "+o+(e>=1.5*i?"s":"")}function bu(r){var e=r.areas,i=r.excludedArea;if(e.length===1&&e[0]===F.GLOBAL&&i===F.CHINA)return xe([F.OVERSEA]);if(e.includes(F.GLOBAL)){if(r=xf(Kg).filter(function(l){return l!==F.GLOBAL&&l!==F.OVERSEA}),i in yf){e=yf[i];var o=[].concat(G(e??[]),[i]);return xe(r.filter(function(l){return!o.includes(l)}))}if(Zm(i)){var s=cu(i);return xe(r.filter(function(l){return l!==i&&l!==s}))}}if(Zm(i)||i in yf)return xe(e);throw new I("Invalid excludedArea area config")}function Ma(r,e,i){i===void 0&&(i=Object.getOwnPropertyDescriptor(r,e));var o=i.value;return i.value=function(){for(var s=this,l=arguments.length,f=Array(l),h=0;h<l;h++)f[h]=arguments[h];this.invokeTracker.apply(this,["%s: ".concat(0<f.length?"%s with args: ".concat(f.map(function(){return"%o"})):"%s"),this.name,e].concat(G(f.map(ye))));try{var d=o.apply(this,f)}catch(g){throw this.logError.apply(this,["".concat(g.code!==void 0?"Error Code ".concat(g.code,": "):"","%s failed").concat(0<f.length?" with args: ".concat(f.map(function(){return"%o"})):""),e].concat(G(f.map(ye)))),g.originalError&&this.logError(g.originalError),this.errorTracker(g),g}var p=Date.now();return J(w.mark(function g(){var _,b;return w.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,d;case 3:_=x.sent,x.next=12;break;case 6:return x.prev=6,x.t0=x.catch(0),s.logError.apply(s,["".concat(x.t0.code!==void 0?"Error Code ".concat(x.t0.code,": "):"","%s failed").concat(0<f.length?" with args: ".concat(f.map(function(){return"%o"})):""),e].concat(G(f.map(ye)))),x.t0.originalError&&s.logError(x.t0.originalError),s.errorTracker(x.t0),x.abrupt("return");case 12:_!==d?_===void 0?s.resultTracker("%s promise resolves after %dms",e,Date.now()-p):s.resultTracker("%s promise resolves after %dms, result is %o",e,Date.now()-p,ye(_)):Ac(_)!=="Object"||yd(_)?s.resultTracker("%s result is %o",e,ye(_)):s.resultTracker("%s result is %s",e,_.name||((b=_.constructor)===null||b===void 0?void 0:b.name));case 13:case"end":return x.stop()}},g,null,[[0,6]])}))(),d},i}function Nb(r,e,i){i===void 0&&(i=Object.getOwnPropertyDescriptor(r,e));var o=i.value;return i.value=function(){for(var s=this,l=arguments.length,f=Array(l),h=0;h<l;h++)f[h]=arguments[h];this.invokeTracker.apply(this,["%s: ".concat(0<f.length?"%s with args: ".concat(f.map(function(){return"%o"})):"%s"),this.name,e].concat(f));try{var d=o.apply(this,f)}catch(g){throw this.logError.apply(this,["".concat(g.code!==void 0?"Error Code ".concat(g.code,": "):"","%s failed").concat(0<f.length?" with args: ".concat(f.map(function(){return"%o"})):""),e].concat(f)),g.originalError&&this.logError(g.originalError),this.errorTracker(g),g}var p=Date.now();return J(w.mark(function g(){var _,b;return w.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,d;case 3:_=x.sent,x.next=12;break;case 6:return x.prev=6,x.t0=x.catch(0),s.logError.apply(s,["".concat(x.t0.code!==void 0?"Error Code ".concat(x.t0.code,": "):"","%s failed").concat(0<f.length?" with args: ".concat(f.map(function(){return"%o"})):""),e].concat(f)),x.t0.originalError&&s.logError(x.t0.originalError),s.errorTracker(x.t0),x.abrupt("return");case 12:_!==d?_===void 0?s.resultTracker("%s promise resolves after %dms",e,Date.now()-p):s.resultTracker("%s promise resolves after %dms, result is %o",e,Date.now()-p,_):Ac(_)!=="Object"||yd(_)?s.resultTracker("%s result is %o",e,_):s.resultTracker("%s result is %s",e,_.name||((b=_.constructor)===null||b===void 0?void 0:b.name));case 13:case"end":return x.stop()}},g,null,[[0,6]])}))(),d},i}function du(r,e){var i="".concat(r,"Uri");if(typeof(i=Li[i])!="number"||i===0)throw new TypeError("Got Unknown URI Name");return e=new(r=$m[r])(e),e=r.encode(e).finish(),new eu({uri:i,data:e})}function an(r,e){return"".concat(r.split(".").join("-"),".edge.").concat(e?"sd-rtn.com":"agora.io")}function eb(r,e,i){return Mi.apply(this,arguments)}function Mi(){return(Mi=J(w.mark(function r(e,i,o){var s,l;return w.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:f.next=2;break;case 2:return s=fu[e].encode(i).finish(),l=function(){var h=J(w.mark(function d(p){var g,_,b,x=arguments;return w.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(!(3<(_=1<x.length&&x[1]!==void 0?x[1]:0))){A.next=3;break}return A.abrupt("return");case 3:return b=we(b=o?"https://".concat((g=M==null?void 0:M.PROXY_NGINX[0])!==null&&g!==void 0?g:"webrtc-cloud-proxy.sd-rtn.com","/rs/?h=").concat(p,"&p=6443&d=events/proto-raw"):"https://".concat(p,":6443/events/proto-raw"),"sentTs",Math.ceil(Date.now()/1e3).toString()),b=we(b,"id",gu[e].toString()),A.next=8,te(b,{body:s,timeout:2e4,headers:{"Content-Type":"application/octet-stream"}}).catch(function(k){return l(p,_+1)});case 8:case"end":return A.stop()}},d)}));return function(d){return h.apply(this,arguments)}}(),f.prev=4,f.next=7,l((M==null?void 0:M.EVENT_REPORT_DOMAIN[0])||"webcollector-rtm.agora.io");case 7:f.next=13;break;case 9:return f.prev=9,f.t0=f.catch(4),f.next=13,l(M&&bn(1<(M==null?void 0:M.EVENT_REPORT_DOMAIN.length)?M==null?void 0:M.EVENT_REPORT_DOMAIN.slice(1):M==null?void 0:M.EVENT_REPORT_DOMAIN)||"rtm.statscollector.sd-rtn.com");case 13:case"end":return f.stop()}},r,null,[[4,9]])}))).apply(this,arguments)}function fb(r){return r===void 0?U.fromNumber(0):U.fromNumber(Date.now()-r)}function hu(r){return btoa(String.fromCharCode.apply({},r.replace(/\r|\n/g,"").replace(/([\dA-Fa-f]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ").map(function(e){return parseInt(e,16)}))).replace(/={1,2}$/,"")}function Lg(r,e){return U.fromValue(r).eq(e)}function Mg(r,e){var i=e===void 0?r.val:e,o=r.isBoolean;e=r.isNumber;var s=r.oneof,l=r.len;if([o,e,s].filter(function(f){return!f}).length!==2)throw new TypeError("invalid field type");if(i!==void 0&&(r=!1,s!==void 0&&(s=Ni(s),iu(s,Lg).length===s.length&&ju(s,function(f){return Lg(i,f)})!==void 0&&(r=!0)),o=o!==void 0&&(i===0||i===1)&&l===1,e=e!==void 0&&i.toString(2).length<=l,!(r||o||e)))throw Error("invalid field value")}function cn(r){return function(){var e=r();if(!e)throw new K("Client is not logged in. Cannot do the operation");return e}}var Ya=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{},Ng=function(r){return r&&r.Math==Math&&r},y=Ng(typeof globalThis=="object"&&globalThis)||Ng(typeof window=="object"&&window)||Ng(typeof self=="object"&&self)||Ng(typeof Ya=="object"&&Ya)||function(){return this}()||Function("return this")(),R=function(r){try{return!!r()}catch{return!0}},ka=!R(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),dn={}.propertyIsEnumerable,en=Object.getOwnPropertyDescriptor,zf=en&&!dn.call({1:2},1)?function(r){return!!(r=en(this,r))&&r.enumerable}:dn,dd=function(r,e){return{enumerable:!(1&r),configurable:!(2&r),writable:!(4&r),value:e}},ku={}.toString,Zb=function(r){return ku.call(r).slice(8,-1)},lu="".split,Af=R(function(){return!Object("z").propertyIsEnumerable(0)})?function(r){return Zb(r)=="String"?lu.call(r,""):Object(r)}:Object,jb=function(r){if(r==null)throw TypeError("Can't call method on "+r);return r},qb=function(r){return Af(jb(r))},ha=function(r){return typeof r=="object"?r!==null:typeof r=="function"},lc=function(r,e){if(!ha(r))return r;var i,o;if(e&&typeof(i=r.toString)=="function"&&!ha(o=i.call(r))||typeof(i=r.valueOf)=="function"&&!ha(o=i.call(r))||!e&&typeof(i=r.toString)=="function"&&!ha(o=i.call(r)))return o;throw TypeError("Can't convert object to primitive value")},Qa=function(r){return Object(jb(r))},mu={}.hasOwnProperty,Q=function(r,e){return mu.call(Qa(r),e)},ze=y.document,Og=ha(ze)&&ha(ze.createElement),fn=!ka&&!R(function(){return Object.defineProperty(Og?ze.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),gn=Object.getOwnPropertyDescriptor,Fb={f:ka?gn:function(r,e){if(r=qb(r),e=lc(e,!0),fn)try{return gn(r,e)}catch{}if(Q(r,e))return dd(!zf.call(r,e),r[e])}},va=function(r){if(!ha(r))throw TypeError(String(r)+" is not an object");return r},hn=Object.defineProperty,Ra={f:ka?hn:function(r,e,i){if(va(r),e=lc(e,!0),va(i),fn)try{return hn(r,e,i)}catch{}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(r[e]=i.value),r}},Na=ka?function(r,e,i){return Ra.f(r,e,dd(1,i))}:function(r,e,i){return r[e]=i,r},Oi=function(r,e){try{Na(y,r,e)}catch{y[r]=e}return e},ed=y["__core-js_shared__"]||Oi("__core-js_shared__",{}),nu=Function.toString;typeof ed.inspectSource!="function"&&(ed.inspectSource=function(r){return nu.call(r)});var Pi=ed.inspectSource,jn=y.WeakMap,ou=typeof jn=="function"&&/native code/.test(Pi(jn)),fd=$a(function(r){(r.exports=function(e,i){return ed[e]||(ed[e]=i!==void 0?i:{})})("versions",[]).push({version:"3.12.1",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})}),pu=0,qu=Math.random(),Ae=function(r){return"Symbol("+String(r===void 0?"":r)+")_"+(++pu+qu).toString(36)},kn=fd("keys"),Pg=function(r){return kn[r]||(kn[r]=Ae(r))},Be={},ru=y.WeakMap;if(ou||ed.state)var Gd=ed.state||(ed.state=new ru),su=Gd.get,ln=Gd.has,tu=Gd.set,Qi=function(r,e){if(ln.call(Gd,r))throw new TypeError("Object already initialized");return e.facade=r,tu.call(Gd,r,e),e},Qg=function(r){return su.call(Gd,r)||{}},Ri=function(r){return ln.call(Gd,r)};else{var Ce=Pg("state");Be[Ce]=!0,Qi=function(r,e){if(Q(r,Ce))throw new TypeError("Object already initialized");return e.facade=r,Na(r,Ce,e),e},Qg=function(r){return Q(r,Ce)?r[Ce]:{}},Ri=function(r){return Q(r,Ce)}}var Za={set:Qi,get:Qg,has:Ri,enforce:function(r){return Ri(r)?Qg(r):Qi(r,{})},getterFor:function(r){return function(e){var i;if(!ha(e)||(i=Qg(e)).type!==r)throw TypeError("Incompatible receiver, "+r+" required");return i}}},Ta=$a(function(r){var e=Za.get,i=Za.enforce,o=String(String).split("String");(r.exports=function(s,l,f,h){var d=!!h&&!!h.unsafe,p=!!h&&!!h.enumerable;if(h=!!h&&!!h.noTargetGet,typeof f=="function"){typeof l!="string"||Q(f,"name")||Na(f,"name",l);var g=i(f);g.source||(g.source=o.join(typeof l=="string"?l:""))}s===y?p?s[l]=f:Oi(l,f):(d?!h&&s[l]&&(p=!0):delete s[l],p?s[l]=f:Na(s,l,f))})(Function.prototype,"toString",function(){return typeof this=="function"&&e(this).source||Pi(this)})}),mn=function(r){return typeof r=="function"?r:void 0},mc=function(r,e){return 2>arguments.length?mn(y[r])||mn(y[r]):y[r]&&y[r][e]||y[r]&&y[r][e]},uu=Math.ceil,vu=Math.floor,$b=function(r){return isNaN(r=+r)?0:(0<r?vu:uu)(r)},wu=Math.min,ta=function(r){return 0<r?wu($b(r),9007199254740991):0},xu=Math.max,yu=Math.min,xb=function(r,e){return 0>(r=$b(r))?xu(r+e,0):yu(r,e)},nn=function(r){return function(e,i,o){e=qb(e);var s=ta(e.length);if(o=xb(o,s),r&&i!=i){for(;s>o;)if((i=e[o++])!=i)return!0}else for(;s>o;o++)if((r||o in e)&&e[o]===i)return r||o||0;return!r&&-1}},on=nn(!0),Si=nn(!1),pn=function(r,e){r=qb(r);var i,o=0,s=[];for(i in r)!Q(Be,i)&&Q(r,i)&&s.push(i);for(;e.length>o;)Q(r,i=e[o++])&&(~Si(s,i)||s.push(i));return s},Rg="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),zu=Rg.concat("length","prototype"),Hd={f:Object.getOwnPropertyNames||function(r){return pn(r,zu)}},Bf={f:Object.getOwnPropertySymbols},qn=mc("Reflect","ownKeys")||function(r){var e=Hd.f(va(r)),i=Bf.f;return i?e.concat(i(r)):e},rn=function(r,e){for(var i=qn(e),o=Ra.f,s=Fb.f,l=0;l<i.length;l++){var f=i[l];Q(r,f)||o(r,f,s(e,f))}},Au=/#|\.prototype\./,nc=function(r,e){return(r=Bu[Cu(r)])==Du||r!=Eu&&(typeof e=="function"?R(e):!!e)},Cu=nc.normalize=function(r){return String(r).replace(Au,".").toLowerCase()},Bu=nc.data={},Eu=nc.NATIVE="N",Du=nc.POLYFILL="P",Fu=Fb.f,N=function(r,e){var i,o,s,l=r.target,f=r.global,h=r.stat;if(o=f?y:h?y[l]||Oi(l,{}):(y[l]||{}).prototype)for(s in e){var d=e[s],p=r.noTargetGet?(i=Fu(o,s))&&i.value:o[s];if(!(i=nc(f?s:l+(h?".":"#")+s,r.forced))&&p!==void 0){if(typeof d==typeof p)continue;rn(d,p)}(r.sham||p&&p.sham)&&Na(d,"sham",!0);try{Ta(o,s,d,r)}catch{}}},yb=function(r){if(typeof r!="function")throw TypeError(String(r)+" is not a function");return r},Id=function(r,e,i){if(yb(r),e===void 0)return r;switch(i){case 0:return function(){return r.call(e)};case 1:return function(o){return r.call(e,o)};case 2:return function(o,s){return r.call(e,o,s)};case 3:return function(o,s,l){return r.call(e,o,s,l)}}return function(){return r.apply(e,arguments)}},gd=Array.isArray||function(r){return Zb(r)=="Array"},De=mc("navigator","userAgent")||"",sn=y.process,tn=sn&&sn.versions,un=tn&&tn.v8;if(un)var hd=un.split("."),Ti=4>hd[0]?1:hd[0]+hd[1];else De&&(hd=De.match(/Edge\/(\d+)/),(!hd||74<=hd[1])&&(hd=De.match(/Chrome\/(\d+)/))&&(Ti=hd[1]));var id=Ti&&+Ti,oc=!!Object.getOwnPropertySymbols&&!R(function(){return!String(Symbol())||!Symbol.sham&&id&&41>id}),vn=oc&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Cf=fd("wks"),Df=y.Symbol,Gu=vn?Df:Df&&Df.withoutSetter||Ae,qa=function(r){return Q(Cf,r)&&(oc||typeof Cf[r]=="string")||(oc&&Q(Df,r)?Cf[r]=Df[r]:Cf[r]=Gu("Symbol."+r)),Cf[r]},Hu=qa("species"),Sg=function(r,e){if(gd(r)){var i=r.constructor;typeof i!="function"||i!==Array&&!gd(i.prototype)?ha(i)&&(i=i[Hu])===null&&(i=void 0):i=void 0}return new(i===void 0?Array:i)(e===0?0:e)},wn=[].push,jd=function(r){var e=r==1,i=r==2,o=r==3,s=r==4,l=r==6,f=r==7,h=r==5||l;return function(d,p,g,_){var b=Qa(d),x=Af(b);p=Id(p,g,3),g=ta(x.length);var A,k=0;for(_=_||Sg,d=e?_(d,g):i||f?_(d,0):void 0;g>k;k++)if((h||k in x)&&(A=p(_=x[k],k,b),r))if(e)d[k]=A;else if(A)switch(r){case 3:return!0;case 5:return _;case 6:return k;case 2:wn.call(d,_)}else switch(r){case 4:return!1;case 7:wn.call(d,_)}return l?-1:o||s?s:d}},Jd=jd(0),xn=jd(1),yn=jd(2),Iu=jd(3),Ju=jd(4),zn=jd(5),An=jd(6),Ku=qa("species"),Ef=function(r){return 51<=id||!R(function(){var e=[];return(e.constructor={})[Ku]=function(){return{foo:1}},e[r](Boolean).foo!==1})},Lu=Ef("filter");N({target:"Array",proto:!0,forced:!Lu},{filter:function(r){return yn(this,r,1<arguments.length?arguments[1]:void 0)}});var Dc=Object.keys||function(r){return pn(r,Rg)},Mu=R(function(){Dc(1)});N({target:"Object",stat:!0,forced:Mu},{keys:function(r){return Dc(Qa(r))}});var Ee=function(r,e){var i=[][r];return!!i&&R(function(){i.call(null,e||function(){throw 1},1)})},Nu=[].join,Ou=Af!=Object,Pu=Ee("join",",");N({target:"Array",proto:!0,forced:Ou||!Pu},{join:function(r){return Nu.call(qb(this),r===void 0?",":r)}});var Qu=Ef("map");N({target:"Array",proto:!0,forced:!Qu},{map:function(r){return xn(this,r,1<arguments.length?arguments[1]:void 0)}});var Ui=function(r){var e=r.return;if(e!==void 0)return va(e.call(r)).value},Fe={},Ru=qa("iterator"),Su=Array.prototype,Vi=function(r){return r!==void 0&&(Fe.Array===r||Su[Ru]===r)},Ge=function(r,e,i){(e=lc(e))in r?Ra.f(r,e,dd(0,i)):r[e]=i},Tu=qa("toStringTag"),Bn={};Bn[Tu]="z";var Wi=String(Bn)==="[object z]",Uu=qa("toStringTag"),Vu=Zb(function(){return arguments}())=="Arguments",Ff=Wi?Zb:function(r){var e;if(r===void 0)var i="Undefined";else{if(r===null)var o="Null";else{e:{var s=r=Object(r);try{o=s[Uu];break e}catch{}o=void 0}o=typeof(i=o)=="string"?i:Vu?Zb(r):(e=Zb(r))=="Object"&&typeof r.callee=="function"?"Arguments":e}i=o}return i},Wu=qa("iterator"),Xi=function(r){if(r!=null)return r[Wu]||r["@@iterator"]||Fe[Ff(r)]},Cn=qa("iterator"),Dn=!1;try{var Xu=0,En={next:function(){return{done:!!Xu++}},return:function(){Dn=!0}};En[Cn]=function(){return this},Array.from(En,function(){throw 2})}catch(r){}var Tg=function(r,e){if(!e&&!Dn)return!1;var i=!1;try{(e={})[Cn]=function(){return{next:function(){return{done:i=!0}}}},r(e)}catch{}return i},Yu=!Tg(function(r){Array.from(r)});N({target:"Array",stat:!0,forced:Yu},{from:function(r){var e,i=Qa(r),o=typeof this=="function"?this:Array,s=arguments.length,l=1<s?arguments[1]:void 0,f=l!==void 0,h=Xi(i),d=0;if(f&&(l=Id(l,2<s?arguments[2]:void 0,2)),h==null||o==Array&&Vi(h)){var p=ta(i.length);for(o=new o(p);p>d;d++)h=f?l(i[d],d):i[d],Ge(o,d,h)}else for(s=(i=h.call(i)).next,o=new o;!(e=s.call(i)).done;d++){if(f){h=i;var g=l;e=[e.value,d];try{p=g(va(e)[0],e[1])}catch(_){throw Ui(h),_}}else p=e.value;Ge(o,d,h=p)}return o.length=d,o}});var Fn=function(r){return function(e,i){e=String(jb(e)),i=$b(i);var o,s=e.length;if(0>i||i>=s)return r?"":void 0;var l=e.charCodeAt(i);return 55296>l||56319<l||i+1===s||56320>(o=e.charCodeAt(i+1))||57343<o?r?e.charAt(i):l:r?e.slice(i,i+2):o-56320+(l-55296<<10)+65536}},Gn=Fn(!0),Hn=!R(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),In=Pg("IE_PROTO"),Zu=Object.prototype,Vb=Hn?Object.getPrototypeOf:function(r){return r=Qa(r),Q(r,In)?r[In]:typeof r.constructor=="function"&&r instanceof r.constructor?r.constructor.prototype:r instanceof Object?Zu:null},Yi=qa("iterator"),Jn=!1,$u=function(){return this},Kd;if([].keys){var Kn=[].keys();if("next"in Kn){var Ln=Vb(Vb(Kn));Ln!==Object.prototype&&(Kd=Ln)}else Jn=!0}(Kd==null||R(function(){var r={};return Kd[Yi].call(r)!==r}))&&(Kd={}),Q(Kd,Yi)||Na(Kd,Yi,$u);var Ug=Kd,Vg=Jn,av=ka?Object.defineProperties:function(r,e){va(r);for(var i,o=Dc(e),s=o.length,l=0;s>l;)Ra.f(r,i=o[l++],e[i]);return r},Zi=mc("document","documentElement"),Mn=Pg("IE_PROTO"),$i=function(){},aj,Wg=function(){try{aj=document.domain&&new ActiveXObject("htmlfile")}catch{}if(aj){var r=aj;r.write("<script><\/script>"),r.close(),r=r.parentWindow.Object}else(r=Og?ze.createElement("iframe"):{}).style.display="none",Zi.appendChild(r),r.src="javascript:",(r=r.contentWindow.document).open(),r.write("<script>document.F=Object<\/script>"),r.close(),r=r.F;for(Wg=r,r=Rg.length;r--;)delete Wg.prototype[Rg[r]];return Wg()};Be[Mn]=!0;var ac=Object.create||function(r,e){if(r!==null){$i.prototype=va(r);var i=new $i;$i.prototype=null,i[Mn]=r}else i=Wg();return e===void 0?i:av(i,e)},bv=Ra.f,Nn=qa("toStringTag"),Ec=function(r,e,i){r&&!Q(r=i?r:r.prototype,Nn)&&bv(r,Nn,{configurable:!0,value:e})},cv=function(){return this},dv=function(r,e,i){return e+=" Iterator",r.prototype=ac(Ug,{next:dd(1,i)}),Ec(r,e,!1),Fe[e]=cv,r},Ua=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,e={};try{var i=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;i.call(e,[]),r=e instanceof Array}catch{}return function(o,s){if(va(o),!ha(s)&&s!==null)throw TypeError("Can't set "+String(s)+" as a prototype");return r?i.call(o,s):o.__proto__=s,o}}():void 0),Gf=qa("iterator"),ev=function(){return this},bj=function(r,e,i,o,s,l,f){dv(i,e,o),o=function(k){if(k===s&&b)return b;if(!Vg&&k in g)return g[k];switch(k){case"keys":case"values":case"entries":return function(){return new i(this,k)}}return function(){return new i(this)}};var h,d=e+" Iterator",p=!1,g=r.prototype,_=g[Gf]||g["@@iterator"]||s&&g[s],b=!Vg&&_||o(s),x=e=="Array"&&g.entries||_;if(x&&(r=Vb(x.call(new r)),Ug!==Object.prototype&&r.next&&(Vb(r)!==Ug&&(Ua?Ua(r,Ug):typeof r[Gf]!="function"&&Na(r,Gf,ev)),Ec(r,d,!0))),s=="values"&&_&&_.name!=="values"&&(p=!0,b=function(){return _.call(this)}),g[Gf]!==b&&Na(g,Gf,b),Fe[e]=b,s){var A={values:o("values"),keys:l?b:o("keys"),entries:o("entries")};if(f)for(h in A)!Vg&&!p&&h in g||Ta(g,h,A[h]);else N({target:e,proto:!0,forced:Vg||p},A)}return A},fv=Za.set,gv=Za.getterFor("String Iterator");bj(String,"String",function(r){fv(this,{type:"String Iterator",string:String(r),index:0})},function(){var r=gv(this),e=r.string,i=r.index;return i>=e.length?{value:void 0,done:!0}:(e=Gn(e,i),r.index+=e.length,{value:e,done:!1})});var cj=qa("unscopables"),dj=Array.prototype;dj[cj]==null&&Ra.f(dj,cj,{configurable:!0,value:ac(null)});var Ld=function(r){dj[cj][r]=!0},On=!0;"find"in[]&&Array(1).find(function(){On=!1}),N({target:"Array",proto:!0,forced:On},{find:function(r){return zn(this,r,1<arguments.length?arguments[1]:void 0)}}),Ld("find");var Pn=function(r){var e=String(jb(this)),i="";if(0>(r=$b(r))||r==1/0)throw RangeError("Wrong number of repetitions");for(;0<r;(r>>>=1)&&(e+=e))1&r&&(i+=e);return i};N({target:"String",proto:!0},{repeat:Pn}),N({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),N({target:"Number",stat:!0},{isNaN:function(r){return r!=r}}),y.Number.isNaN;var hv=Wi?{}.toString:function(){return"[object "+Ff(this)+"]"};Wi||Ta(Object.prototype,"toString",hv,{unsafe:!0});var Fc=y.Promise,Hf=function(r,e,i){for(var o in e)Ta(r,o,e[o],i);return r},Qn=qa("species"),If=function(r){r=mc(r);var e=Ra.f;ka&&r&&!r[Qn]&&e(r,Qn,{configurable:!0,get:function(){return this}})},Gc=function(r,e,i){if(!(r instanceof e))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return r},Jf=function(r,e){this.stopped=r,this.result=e},Xg=function(r,e,i){var o,s=!(!i||!i.AS_ENTRIES),l=!(!i||!i.IS_ITERATOR),f=!(!i||!i.INTERRUPTED),h=Id(e,i&&i.that,1+s+f),d=function(g){return p&&Ui(p),new Jf(!0,g)};if(e=function(g){return s?(va(g),f?h(g[0],g[1],d):h(g[0],g[1])):f?h(g,d):h(g)},l)var p=r;else{if(typeof(l=Xi(r))!="function")throw TypeError("Target is not iterable");if(Vi(l)){for(l=0,i=ta(r.length);i>l;l++)if((o=e(r[l]))&&o instanceof Jf)return o;return new Jf(!1)}p=l.call(r)}for(r=p.next;!(l=r.call(p)).done;){try{o=e(l.value)}catch(g){throw Ui(p),g}if(typeof o=="object"&&o&&o instanceof Jf)return o}return new Jf(!1)},iv=qa("species"),kd=function(r,e){var i;return(r=va(r).constructor)===void 0||(i=va(r)[iv])==null?e:yb(i)},Rn=/(?:iphone|ipod|ipad).*applewebkit/i.test(De),Hc=Zb(y.process)=="process",Yg=y.location,ej=y.setImmediate,Sn=y.clearImmediate,jv=y.process,Tn=y.MessageChannel,fj=y.Dispatch,gj=0,Kf={},hj=function(r){if(Kf.hasOwnProperty(r)){var e=Kf[r];delete Kf[r],e()}},ij=function(r){return function(){hj(r)}},Un=function(r){hj(r.data)},Vn=function(r){y.postMessage(r+"",Yg.protocol+"//"+Yg.host)};if(!ej||!Sn)if(ej=function(r){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return Kf[++gj]=function(){(typeof r=="function"?r:Function(r)).apply(void 0,e)},Lf(gj),gj},Sn=function(r){delete Kf[r]},Hc)var Lf=function(r){jv.nextTick(ij(r))};else if(fj&&fj.now)Lf=function(r){fj.now(ij(r))};else if(Tn&&!Rn){var Wn=new Tn,Xn=Wn.port2;Wn.port1.onmessage=Un,Lf=Id(Xn.postMessage,Xn,1)}else y.addEventListener&&typeof postMessage=="function"&&!y.importScripts&&Yg&&Yg.protocol!=="file:"&&!R(Vn)?(Lf=Vn,y.addEventListener("message",Un,!1)):Lf="onreadystatechange"in(Og?ze.createElement("script"):{})?function(r){Zi.appendChild(Og?ze.createElement("script"):{}).onreadystatechange=function(){Zi.removeChild(this),hj(r)}}:function(r){setTimeout(ij(r),0)};var jj=ej,kv=/web0s(?!.*chrome)/i.test(De),lv=Fb.f,Yn=y.MutationObserver||y.WebKitMutationObserver,Zn=y.document,$n=y.process,Zg=y.Promise,ao=lv(y,"queueMicrotask"),bo=ao&&ao.value,Md,Mf;if(!bo){var ah=function(){var r;for(Hc&&(r=$n.domain)&&r.exit();Md;){var e=Md.fn;Md=Md.next;try{e()}catch(i){throw Md?$g():Mf=void 0,i}}Mf=void 0,r&&r.enter()};if(Rn||Hc||kv||!Yn||!Zn)if(Zg&&Zg.resolve){var kj=Zg.resolve(void 0);kj.constructor=Zg;var mv=kj.then,$g=function(){mv.call(kj,ah)}}else $g=Hc?function(){$n.nextTick(ah)}:function(){jj.call(y,ah)};else{var co=!0,eo=Zn.createTextNode("");new Yn(ah).observe(eo,{characterData:!0}),$g=function(){eo.data=co=!co}}}var fo=bo||function(r){r={fn:r,next:void 0},Mf&&(Mf.next=r),Md||(Md=r,$g()),Mf=r},nv=function(r){var e,i;this.promise=new r(function(o,s){if(e!==void 0||i!==void 0)throw TypeError("Bad Promise constructor");e=o,i=s}),this.resolve=yb(e),this.reject=yb(i)},lj={f:function(r){return new nv(r)}},mj=function(r,e){return va(r),ha(e)&&e.constructor===r?e:((0,(r=lj.f(r)).resolve)(e),r.promise)},ov=function(r,e){var i=y.console;i&&i.error&&(arguments.length===1?i.error(r):i.error(r,e))},nj=function(r){try{return{error:!1,value:r()}}catch(e){return{error:!0,value:e}}},pv=typeof window=="object",qv=qa("species"),go=Za.get,rv=Za.set,sv=Za.getterFor("Promise"),Nd=Fc&&Fc.prototype,zb=Fc,bh=Nd,ho=y.TypeError,oj=y.document,pj=y.process,He=lj.f,tv=He,uv=!!(oj&&oj.createEvent&&y.dispatchEvent),io=typeof PromiseRejectionEvent=="function",jo=!1,Nf=nc("Promise",function(){var r=Pi(zb)!==String(zb);if(!r&&id===66)return!0;if(51<=id&&/native code/.test(zb))return!1;var e=new zb(function(o){o(1)}),i=function(o){o(function(){},function(){})};return(e.constructor={})[qv]=i,!(jo=e.then(function(){})instanceof i)||!r&&pv&&!io}),vv=Nf||!Tg(function(r){zb.all(r).catch(function(){})}),ko=function(r){var e;return!(!ha(r)||typeof(e=r.then)!="function")&&e},qj=function(r,e){if(!r.notified){r.notified=!0;var i=r.reactions;fo(function(){for(var o=r.value,s=r.state==1,l=0;i.length>l;){var f,h=i[l++],d=s?h.ok:h.fail,p=h.resolve,g=h.reject,_=h.domain;try{if(d){if(s||(r.rejection===2&&wv(r),r.rejection=1),d===!0)var b=o;else if(_&&_.enter(),b=d(o),_){_.exit();var x=!0}b===h.promise?g(ho("Promise-chain cycle")):(f=ko(b))?f.call(b,p,g):p(b)}else g(o)}catch(A){_&&!x&&_.exit(),g(A)}}r.reactions=[],r.notified=!1,e&&!r.rejection&&xv(r)})}},lo=function(r,e,i){var o;if(uv){var s=oj.createEvent("Event");s.promise=e,s.reason=i,s.initEvent(r,!1,!0),y.dispatchEvent(s)}else s={promise:e,reason:i};!io&&(o=y["on"+r])?o(s):r==="unhandledrejection"&&ov("Unhandled promise rejection",i)},xv=function(r){jj.call(y,function(){var e=r.facade,i=r.value;if(r.rejection!==1&&!r.parent){var o=nj(function(){Hc?pj.emit("unhandledRejection",i,e):lo("unhandledrejection",e,i)});if(r.rejection=Hc||r.rejection!==1&&!r.parent?2:1,o.error)throw o.value}})},wv=function(r){jj.call(y,function(){var e=r.facade;Hc?pj.emit("rejectionHandled",e):lo("rejectionhandled",e,r.value)})},Ie=function(r,e,i){return function(o){r(e,o,i)}},Je=function(r,e,i){r.done||(r.done=!0,i&&(r=i),r.value=e,r.state=2,qj(r,!0))},rj=function(r,e,i){if(!r.done){r.done=!0,i&&(r=i);try{if(r.facade===e)throw ho("Promise can't be resolved itself");var o=ko(e);o?fo(function(){var s={done:!1};try{o.call(e,Ie(rj,s,r),Ie(Je,s,r))}catch(l){Je(s,l,r)}}):(r.value=e,r.state=1,qj(r,!1))}catch(s){Je({done:!1},s,r)}}};if(Nf){zb=function(r){Gc(this,zb,"Promise"),yb(r),sj.call(this);var e=go(this);try{r(Ie(rj,e),Ie(Je,e))}catch(i){Je(e,i)}},bh=zb.prototype;var sj=function(r){rv(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})};sj.prototype=Hf(bh,{then:function(r,e){var i=sv(this),o=He(kd(this,zb));return o.ok=typeof r!="function"||r,o.fail=typeof e=="function"&&e,o.domain=Hc?pj.domain:void 0,i.parent=!0,i.reactions.push(o),i.state!=0&&qj(i,!1),o.promise},catch:function(r){return this.then(void 0,r)}});var yv=function(){var r=new sj,e=go(r);this.promise=r,this.resolve=Ie(rj,e),this.reject=Ie(Je,e)};if(lj.f=He=function(r){return r===zb||r===zv?new yv(r):tv(r)},typeof Fc=="function"&&Nd!==Object.prototype){var Av=Nd.then;jo||(Ta(Nd,"then",function(r,e){var i=this;return new zb(function(o,s){Av.call(i,o,s)}).then(r,e)},{unsafe:!0}),Ta(Nd,"catch",bh.catch,{unsafe:!0}));try{delete Nd.constructor}catch{}Ua&&Ua(Nd,bh)}}N({global:!0,wrap:!0,forced:Nf},{Promise:zb}),Ec(zb,"Promise",!1),If("Promise");var zv=mc("Promise");N({target:"Promise",stat:!0,forced:Nf},{reject:function(r){var e=He(this);return e.reject.call(void 0,r),e.promise}}),N({target:"Promise",stat:!0,forced:Nf},{resolve:function(r){return mj(this,r)}}),N({target:"Promise",stat:!0,forced:vv},{all:function(r){var e=this,i=He(e),o=i.resolve,s=i.reject,l=nj(function(){var f=yb(e.resolve),h=[],d=0,p=1;Xg(r,function(g){var _=d++,b=!1;h.push(void 0),p++,f.call(e,g).then(function(x){b||(b=!0,h[_]=x,--p||o(h))},s)}),--p||o(h)});return l.error&&s(l.value),i.promise},race:function(r){var e=this,i=He(e),o=i.reject,s=nj(function(){var l=yb(e.resolve);Xg(r,function(f){l.call(e,f).then(i.resolve,o)})});return s.error&&o(s.value),i.promise}});var mo=[].indexOf,no=!!mo&&0>1/[1].indexOf(1,-0),Bv=Ee("indexOf");N({target:"Array",proto:!0,forced:no||!Bv},{indexOf:function(r){return no?mo.apply(this,arguments)||0:Si(this,r,1<arguments.length?arguments[1]:void 0)}});var tj=function(){var r=va(this),e="";return r.global&&(e+="g"),r.ignoreCase&&(e+="i"),r.multiline&&(e+="m"),r.dotAll&&(e+="s"),r.unicode&&(e+="u"),r.sticky&&(e+="y"),e},pc=R(function(){var r=RegExp("a","y");return r.lastIndex=2,r.exec("abcd")!=null}),Cv=R(function(){var r=RegExp("^r","gy");return r.lastIndex=2,r.exec("str")!=null}),ch=RegExp.prototype.exec,Dv=fd("native-string-replace",String.prototype.replace),oo=ch,uj=(c=/a/,a=/b*/g,ch.call(c,"a"),ch.call(a,"a"),c.lastIndex!==0||a.lastIndex!==0),po=pc||Cv,vj=/()??/.exec("")[1]!==void 0,c,a;(uj||vj||po)&&(oo=function(r){var e,i=po&&this.sticky,o=tj.call(this),s=this.source,l=0,f=r;if(i){(o=o.replace("y","")).indexOf("g")===-1&&(o+="g"),f=String(r).slice(this.lastIndex),0<this.lastIndex&&(!this.multiline||this.multiline&&r[this.lastIndex-1]!==`
`)&&(s="(?: "+s+")",f=" "+f,l++);var h=new RegExp("^(?:"+s+")",o)}if(vj&&(h=new RegExp("^"+s+"$(?!\\s)",o)),uj)var d=this.lastIndex;var p=ch.call(i?h:this,f);return i?p?(p.input=p.input.slice(l),p[0]=p[0].slice(l),p.index=this.lastIndex,this.lastIndex+=p[0].length):this.lastIndex=0:uj&&p&&(this.lastIndex=this.global?p.index+p[0].length:d),vj&&p&&1<p.length&&Dv.call(p[0],h,function(){for(e=1;e<arguments.length-2;e++)arguments[e]===void 0&&(p[e]=void 0)}),p});var Of=oo;N({target:"RegExp",proto:!0,forced:/./.exec!==Of},{exec:Of});var Ev=qa("species"),wj=RegExp.prototype,Fv=!R(function(){var r=/./;return r.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(r,"$<a>")!=="7"}),qo="a".replace(/./,"$0")==="$0",ro=qa("replace"),so=!!/./[ro]&&/./[ro]("a","$0")==="",Gv=!R(function(){var r=/(?:)/,e=r.exec;return r.exec=function(){return e.apply(this,arguments)},(r="ab".split(r)).length!==2||r[0]!=="a"||r[1]!=="b"}),dh=function(r,e,i,o){var s=qa(r),l=!R(function(){var p={};return p[s]=function(){return 7},""[r](p)!=7}),f=l&&!R(function(){var p=!1,g=/a/;return r==="split"&&((g={constructor:{}}).constructor[Ev]=function(){return g},g.flags="",g[s]=/./[s]),g.exec=function(){return p=!0,null},g[s](""),!p});if(!l||!f||r==="replace"&&(!Fv||!qo||so)||r==="split"&&!Gv){var h=/./[s],d=(i=i(s,""[r],function(p,g,_,b,x){var A=g.exec;return A===Of||A===wj.exec?l&&!x?{done:!0,value:h.call(g,_,b)}:{done:!0,value:p.call(_,g,b)}:{done:!1}},{REPLACE_KEEPS_$0:qo,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:so}))[1];Ta(String.prototype,r,i[0]),Ta(wj,s,e==2?function(p,g){return d.call(p,this,g)}:function(p){return d.call(p,this)})}o&&Na(wj[s],"sham",!0)},xj=function(r,e,i){return e+(i?Gn(r,e).length:1)},Hv=Math.floor,Iv="".replace,Jv=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Kv=/\$([$&'`]|\d{1,2})/g,Lv=function(r,e,i,o,s,l){var f=i+r.length,h=o.length,d=Kv;return s!==void 0&&(s=Qa(s),d=Jv),Iv.call(l,d,function(p,g){switch(g.charAt(0)){case"$":return"$";case"&":return r;case"`":return e.slice(0,i);case"'":return e.slice(f);case"<":p=s[g.slice(1,-1)];break;default:var _=+g;if(_===0)return p;if(_>h)return(_=Hv(_/10))===0?p:_<=h?o[_-1]===void 0?g.charAt(1):o[_-1]+g.charAt(1):p;p=o[_-1]}return p===void 0?"":p})},Ke=function(r,e){var i=r.exec;if(typeof i=="function"){if(typeof(r=i.call(r,e))!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return r}if(Zb(r)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return Of.call(r,e)},Mv=Math.max,Nv=Math.min,Ov=function(r){return r===void 0?r:String(r)};dh("replace",2,function(r,e,i,o){var s=o.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,l=o.REPLACE_KEEPS_$0,f=s?"$":"$0";return[function(h,d){var p=jb(this),g=h==null?void 0:h[r];return g!==void 0?g.call(h,p,d):e.call(String(p),h,d)},function(h,d){if(!s&&l||typeof d=="string"&&d.indexOf(f)===-1){var p=i(e,h,this,d);if(p.done)return p.value}var g=va(h);h=String(this),(p=typeof d=="function")||(d=String(d));var _=g.global;if(_){var b=g.unicode;g.lastIndex=0}for(var x=[];;){var A=Ke(g,h);if(A===null||(x.push(A),!_))break;String(A[0])===""&&(g.lastIndex=xj(h,ta(g.lastIndex),b))}for(b="",_=g=0;_<x.length;_++){A=x[_];for(var k=String(A[0]),C=Mv(Nv($b(A.index),h.length),0),j=[],P=1;P<A.length;P++)j.push(Ov(A[P]));A=A.groups,p?(j=[k].concat(j,C,h),A!==void 0&&j.push(A),A=String(d.apply(void 0,j))):A=Lv(k,h,C,j,A,d),C>=g&&(b+=h.slice(g,C)+A,g=C+k.length)}return b+h.slice(g)}]});var Pv=Ef("slice"),Qv=qa("species"),Rv=[].slice,Sv=Math.max;N({target:"Array",proto:!0,forced:!Pv},{slice:function(r,e){var i=qb(this),o=ta(i.length);if(r=xb(r,o),e=xb(e===void 0?o:e,o),gd(i)){var s=i.constructor;if(typeof s!="function"||s!==Array&&!gd(s.prototype)?ha(s)&&(s=s[Qv])===null&&(s=void 0):s=void 0,s===Array||s===void 0)return Rv.call(i,r,e)}for(s=new(s===void 0?Array:s)(Sv(e-r,0)),o=0;r<e;r++,o++)r in i&&Ge(s,o,i[r]);return s.length=o,s}});var Tv=Za.set,Uv=Za.getterFor("Array Iterator"),ld=bj(Array,"Array",function(r,e){Tv(this,{type:"Array Iterator",target:qb(r),index:0,kind:e})},function(){var r=Uv(this),e=r.target,i=r.kind,o=r.index++;return!e||o>=e.length?(r.target=void 0,{value:void 0,done:!0}):i=="keys"?{value:o,done:!1}:i=="values"?{value:e[o],done:!1}:{value:[o,e[o]],done:!1}},"values");Fe.Arguments=Fe.Array,Ld("keys"),Ld("values"),Ld("entries");var to=typeof ArrayBuffer<"u"&&typeof DataView<"u",Le=function(r){if(r===void 0)return 0;r=$b(r);var e=ta(r);if(r!==e)throw RangeError("Wrong length or index");return e},Vv=Math.abs,Ic=Math.pow,Wv=Math.floor,Xv=Math.log,Yv=Math.LN2,yj=function(r){var e=Qa(this),i=ta(e.length),o=arguments.length,s=xb(1<o?arguments[1]:void 0,i);for(i=(o=2<o?arguments[2]:void 0)===void 0?i:xb(o,i);i>s;)e[s++]=r;return e},Zv=Hd.f,$v=Ra.f,Me=Za.get,uo=Za.set,bc=y.ArrayBuffer,Ab=bc,cc=y.DataView,eh=cc&&cc.prototype,vo=Object.prototype,fh=y.RangeError,wo=function(r,e,i){var o,s=Array(i),l=(1<<(i=8*i-e-1))-1,f=l>>1,h=e===23?Ic(2,-24)-Ic(2,-77):0,d=0>r||r===0&&0>1/r?1:0,p=0;if((r=Vv(r))!=r||r===1/0){r=r!=r?1:0;var g=l}else g=Wv(Xv(r)/Yv),1>r*(o=Ic(2,-g))&&(g--,o*=2),2<=(r=1<=g+f?r+h/o:r+h*Ic(2,1-f))*o&&(g++,o/=2),g+f>=l?(r=0,g=l):1<=g+f?(r=(r*o-1)*Ic(2,e),g+=f):(r=r*Ic(2,f-1)*Ic(2,e),g=0);for(;8<=e;s[p++]=255&r,r/=256,e-=8);for(g=g<<e|r,i+=e;0<i;s[p++]=255&g,g/=256,i-=8);return s[--p]|=128*d,s},xo=function(r,e){var i=r.length,o=8*i-e-1,s=(1<<o)-1,l=s>>1;o-=7,--i;var f=r[i--],h=127&f;for(f>>=7;0<o;h=256*h+r[i],i--,o-=8);var d=h&(1<<-o)-1;for(h>>=-o,o+=e;0<o;d=256*d+r[i],i--,o-=8);if(h===0)h=1-l;else{if(h===s)return d?NaN:f?-1/0:1/0;d+=Ic(2,e),h-=l}return(f?-1:1)*d*Ic(2,h-e)},yo=function(r){return[255&r]},zo=function(r){return[255&r,r>>8&255]},Ao=function(r){return[255&r,r>>8&255,r>>16&255,r>>24&255]},Bo=function(r){return r[3]<<24|r[2]<<16|r[1]<<8|r[0]},aw=function(r){return wo(r,23,4)},bw=function(r){return wo(r,52,8)},gh=function(r,e){$v(r.prototype,e,{get:function(){return Me(this)[e]}})},md=function(r,e,i,o){i=Le(i);var s=Me(r);if(i+e>s.byteLength)throw fh("Wrong index");return r=Me(s.buffer).bytes,i+=s.byteOffset,e=r.slice(i,i+e),o?e:e.reverse()},nd=function(r,e,i,o,s,l){i=Le(i);var f=Me(r);if(i+e>f.byteLength)throw fh("Wrong index");for(r=Me(f.buffer).bytes,i+=f.byteOffset,o=o(+s),s=0;s<e;s++)r[i+s]=o[l?s:e-s-1]};if(to){if(!R(function(){bc(1)})||!R(function(){new bc(-1)})||R(function(){return new bc,new bc(1.5),new bc(NaN),bc.name!="ArrayBuffer"})){Ab=function(r){return Gc(this,Ab),new bc(Le(r))};for(var cw=Ab.prototype=bc.prototype,Co=Zv(bc),Do=0,zj;Co.length>Do;)(zj=Co[Do++])in Ab||Na(Ab,zj,bc[zj]);cw.constructor=Ab}Ua&&Vb(eh)!==vo&&Ua(eh,vo);var hh=new cc(new Ab(2)),Eo=eh.setInt8;hh.setInt8(0,2147483648),hh.setInt8(1,2147483649),!hh.getInt8(0)&&hh.getInt8(1)||Hf(eh,{setInt8:function(r,e){Eo.call(this,r,e<<24>>24)},setUint8:function(r,e){Eo.call(this,r,e<<24>>24)}},{unsafe:!0})}else Ab=function(r){Gc(this,Ab,"ArrayBuffer"),r=Le(r),uo(this,{bytes:yj.call(Array(r),0),byteLength:r}),ka||(this.byteLength=r)},cc=function(r,e,i){Gc(this,cc,"DataView"),Gc(r,Ab,"DataView");var o=Me(r).byteLength;if(0>(e=$b(e))||e>o)throw fh("Wrong offset");if(e+(i=i===void 0?o-e:ta(i))>o)throw fh("Wrong length");uo(this,{buffer:r,byteLength:i,byteOffset:e}),ka||(this.buffer=r,this.byteLength=i,this.byteOffset=e)},ka&&(gh(Ab,"byteLength"),gh(cc,"buffer"),gh(cc,"byteLength"),gh(cc,"byteOffset")),Hf(cc.prototype,{getInt8:function(r){return md(this,1,r)[0]<<24>>24},getUint8:function(r){return md(this,1,r)[0]},getInt16:function(r){var e=md(this,2,r,1<arguments.length?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(r){var e=md(this,2,r,1<arguments.length?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(r){return Bo(md(this,4,r,1<arguments.length?arguments[1]:void 0))},getUint32:function(r){return Bo(md(this,4,r,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(r){return xo(md(this,4,r,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(r){return xo(md(this,8,r,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(r,e){nd(this,1,r,yo,e)},setUint8:function(r,e){nd(this,1,r,yo,e)},setInt16:function(r,e){nd(this,2,r,zo,e,2<arguments.length?arguments[2]:void 0)},setUint16:function(r,e){nd(this,2,r,zo,e,2<arguments.length?arguments[2]:void 0)},setInt32:function(r,e){nd(this,4,r,Ao,e,2<arguments.length?arguments[2]:void 0)},setUint32:function(r,e){nd(this,4,r,Ao,e,2<arguments.length?arguments[2]:void 0)},setFloat32:function(r,e){nd(this,4,r,aw,e,2<arguments.length?arguments[2]:void 0)},setFloat64:function(r,e){nd(this,8,r,bw,e,2<arguments.length?arguments[2]:void 0)}});Ec(Ab,"ArrayBuffer"),Ec(cc,"DataView");var Pf={ArrayBuffer:Ab,DataView:cc},Aj=Pf.ArrayBuffer,Fo=Pf.DataView,Go=Aj.prototype.slice,dw=R(function(){return!new Aj(2).slice(1,void 0).byteLength});N({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:dw},{slice:function(r,e){if(Go!==void 0&&e===void 0)return Go.call(va(this),r);var i=va(this).byteLength;r=xb(r,i),e=xb(e===void 0?i:e,i),i=new(kd(this,Aj))(ta(e-r));for(var o=new Fo(this),s=new Fo(i),l=0;r<e;)s.setUint8(l++,o.getUint8(r++));return i}});var ew=Ra.f,ih=y.Int8Array,Bj=ih&&ih.prototype,Ho=y.Uint8ClampedArray,Io=Ho&&Ho.prototype,qc=ih&&Vb(ih),dc=Bj&&Vb(Bj),Jo=Object.prototype,Ko=Jo.isPrototypeOf,Lo=qa("toStringTag"),Cj=Ae("TYPED_ARRAY_TAG"),Jc=to&&!!Ua&&Ff(y.opera)!=="Opera",Mo=!1,Bb,rc={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},fw={BigInt64Array:8,BigUint64Array:8},jh=function(r){return!!ha(r)&&(r=Ff(r),Q(rc,r)||Q(fw,r))};for(Bb in rc)y[Bb]||(Jc=!1);if((!Jc||typeof qc!="function"||qc===Function.prototype)&&(qc=function(){throw TypeError("Incorrect invocation")},Jc))for(Bb in rc)y[Bb]&&Ua(y[Bb],qc);if((!Jc||!dc||dc===Jo)&&(dc=qc.prototype,Jc))for(Bb in rc)y[Bb]&&Ua(y[Bb].prototype,dc);if(Jc&&Vb(Io)!==dc&&Ua(Io,dc),ka&&!Q(dc,Lo))for(Bb in Mo=!0,ew(dc,Lo,{get:function(){return ha(this)?this[Cj]:void 0}}),rc)y[Bb]&&Na(y[Bb],Cj,Bb);var Qf=Jc,No=Mo&&Cj,Da=function(r){if(jh(r))return r;throw TypeError("Target is not a typed array")},Ne=function(r){if(Ua){if(Ko.call(qc,r))return r}else for(var e in rc)if(Q(rc,Bb)){var i=y[e];if(i&&(r===i||Ko.call(i,r)))return r}throw TypeError("Target is not a typed array constructor")},Aa=function(r,e,i){if(ka){if(i)for(var o in rc){var s=y[o];if(s&&Q(s.prototype,r))try{delete s.prototype[r]}catch{}}dc[r]&&!i||Ta(dc,r,i?e:Jc&&Bj[r]||e)}},Oo=function(r,e,i){var o,s;if(ka){if(Ua){if(i){for(o in rc)if((s=y[o])&&Q(s,r))try{delete s[r]}catch{}}if(qc[r]&&!i)return;try{return Ta(qc,r,i?e:Jc&&qc[r]||e)}catch{}}for(o in rc)!(s=y[o])||s[r]&&!i||Ta(s,r,e)}},Po=qc,Rf=dc,gw=y.ArrayBuffer,Od=y.Int8Array,Dj=!Qf||!R(function(){Od(1)})||!R(function(){new Od(-1)})||!Tg(function(r){new Od,new Od(null),new Od(1.5),new Od(r)},!0)||R(function(){return new Od(new gw(2),1,void 0).length!==1}),kh=function(r,e){if(0>(r=$b(r)))throw RangeError("The argument can't be less than 0");if(r%e)throw RangeError("Wrong offset");return r},Ej=function(r){var e=Qa(r),i=arguments.length,o=1<i?arguments[1]:void 0,s=o!==void 0,l=Xi(e);if(l!=null&&!Vi(l)){var f=l.call(e),h=f.next;for(e=[];!(l=h.call(f)).done;)e.push(l.value)}for(s&&2<i&&(o=Id(o,arguments[2],2)),l=ta(e.length),f=new(Ne(this))(l),i=0;l>i;i++)f[i]=s?o(e[i],i):e[i];return f},lh=function(r,e,i){var o,s;return Ua&&typeof(o=e.constructor)=="function"&&o!==i&&ha(s=o.prototype)&&s!==i.prototype&&Ua(r,s),r},Sf=$a(function(r){var e=Hd.f,i=Za.get,o=Za.set,s=Ra.f,l=Fb.f,f=Math.round,h=y.RangeError,d=Pf.ArrayBuffer,p=Pf.DataView,g=function(C,j){var P=0,z=j.length;for(C=new(Ne(C))(z);z>P;)C[P]=j[P++];return C},_=function(C,j){s(C,j,{get:function(){return i(this)[j]}})},b=function(C){var j;return C instanceof d||(j=Ff(C))=="ArrayBuffer"||j=="SharedArrayBuffer"},x=function(C,j){return jh(C)&&typeof j!="symbol"&&j in C&&String(+j)==String(j)},A=function(C,j){return x(C,j=lc(j,!0))?dd(2,C[j]):l(C,j)},k=function(C,j,P){return!(x(C,j=lc(j,!0))&&ha(P)&&Q(P,"value"))||Q(P,"get")||Q(P,"set")||P.configurable||Q(P,"writable")&&!P.writable||Q(P,"enumerable")&&!P.enumerable?s(C,j,P):(C[j]=P.value,C)};ka?(Qf||(Fb.f=A,Ra.f=k,_(Rf,"buffer"),_(Rf,"byteOffset"),_(Rf,"byteLength"),_(Rf,"length")),N({target:"Object",stat:!0,forced:!Qf},{getOwnPropertyDescriptor:A,defineProperty:k}),r.exports=function(C,j,P){var z=C.match(/\d+$/)[0]/8,_e=C+(P?"Clamped":"")+"Array",Di="get"+C,_i="set"+C,Ei=y[_e],ga=Ei;C=ga&&ga.prototype;var _c={},$=function(Wt,_t){s(Wt,_t,{get:function(){var Vt=i(this);return Vt.view[Di](_t*z+Vt.byteOffset,!0)},set:function(Vt){var B=i(this);P&&(Vt=0>(Vt=f(Vt))?0:255<Vt?255:255&Vt),B.view[_i](_t*z+B.byteOffset,Vt,!0)},enumerable:!0})};Qf?Dj&&(ga=j(function(Wt,_t,Vt,B){return Gc(Wt,ga,_e),lh(ha(_t)?b(_t)?B!==void 0?new Ei(_t,kh(Vt,z),B):Vt!==void 0?new Ei(_t,kh(Vt,z)):new Ei(_t):jh(_t)?g(ga,_t):Ej.call(ga,_t):new Ei(Le(_t)),Wt,ga)}),Ua&&Ua(ga,Po),Jd(e(Ei),function(Wt){Wt in ga||Na(ga,Wt,Ei[Wt])}),ga.prototype=C):(ga=j(function(Wt,_t,Vt,B){Gc(Wt,ga,_e);var H=0,ue=0;if(ha(_t)){if(!b(_t))return jh(_t)?g(ga,_t):Ej.call(ga,_t);var _r=_t;if(ue=kh(Vt,z),_t=_t.byteLength,B===void 0){if(_t%z||0>(B=_t-ue))throw h("Wrong length")}else if((B=ta(B)*z)+ue>_t)throw h("Wrong length");_t=B/z}else _t=Le(_t),_r=new d(B=_t*z);for(o(Wt,{buffer:_r,byteOffset:ue,byteLength:B,length:_t,view:new p(_r)});H<_t;)$(Wt,H++)}),Ua&&Ua(ga,Po),C=ga.prototype=ac(Rf)),C.constructor!==ga&&Na(C,"constructor",ga),No&&Na(C,No,_e),_c[_e]=ga,N({global:!0,forced:ga!=Ei,sham:!Qf},_c),"BYTES_PER_ELEMENT"in ga||Na(ga,"BYTES_PER_ELEMENT",z),"BYTES_PER_ELEMENT"in C||Na(C,"BYTES_PER_ELEMENT",z),If(_e)}):r.exports=function(){}});Sf("Uint8",function(r){return function(e,i,o){return r(this,e,i,o)}});var hw=Math.min,iw=[].copyWithin||function(r,e){var i=Qa(this),o=ta(i.length),s=xb(r,o),l=xb(e,o),f=2<arguments.length?arguments[2]:void 0;for(o=hw((f===void 0?o:xb(f,o))-l,o-s),f=1,l<s&&s<l+o&&(f=-1,l+=o-1,s+=o-1);0<o--;)l in i?i[s]=i[l]:delete i[s],s+=f,l+=f;return i};Aa("copyWithin",function(r,e){return iw.call(Da(this),r,e,2<arguments.length?arguments[2]:void 0)}),Aa("every",function(r){return Ju(Da(this),r,1<arguments.length?arguments[1]:void 0)}),Aa("fill",function(r){return yj.apply(Da(this),arguments)}),Aa("filter",function(r){var e=yn(Da(this),r,1<arguments.length?arguments[1]:void 0),i=kd(this,this.constructor),o=0,s=e.length;for(i=new(Ne(i))(s);s>o;)i[o]=e[o++];return i}),Aa("find",function(r){return zn(Da(this),r,1<arguments.length?arguments[1]:void 0)}),Aa("findIndex",function(r){return An(Da(this),r,1<arguments.length?arguments[1]:void 0)}),Aa("forEach",function(r){Jd(Da(this),r,1<arguments.length?arguments[1]:void 0)}),Aa("includes",function(r){return on(Da(this),r,1<arguments.length?arguments[1]:void 0)}),Aa("indexOf",function(r){return Si(Da(this),r,1<arguments.length?arguments[1]:void 0)});var Qo=qa("iterator"),Ro=y.Uint8Array,jw=ld.values,kw=ld.keys,lw=ld.entries,Fj=Ro&&Ro.prototype[Qo],So=!!Fj&&(Fj.name=="values"||Fj.name==null),To=function(){return jw.call(Da(this))};Aa("entries",function(){return lw.call(Da(this))}),Aa("keys",function(){return kw.call(Da(this))}),Aa("values",To,!So),Aa(Qo,To,!So);var mw=[].join;Aa("join",function(r){return mw.apply(Da(this),arguments)});var nw=Math.min,Gj=[].lastIndexOf,Uo=!!Gj&&0>1/[1].lastIndexOf(1,-0),ow=Ee("lastIndexOf"),pw=Uo||!ow?function(r){if(Uo)return Gj.apply(this,arguments)||0;var e=qb(this),i=ta(e.length),o=i-1;for(1<arguments.length&&(o=nw(o,$b(arguments[1]))),0>o&&(o=i+o);0<=o;o--)if(o in e&&e[o]===r)return o||0;return-1}:Gj;Aa("lastIndexOf",function(r){return pw.apply(Da(this),arguments)}),Aa("map",function(r){return xn(Da(this),r,1<arguments.length?arguments[1]:void 0,function(e,i){return new(Ne(kd(e,e.constructor)))(i)})});var Vo=function(r){return function(e,i,o,s){yb(i),e=Qa(e);var l=Af(e),f=ta(e.length),h=r?f-1:0,d=r?-1:1;if(2>o)for(;;){if(h in l){s=l[h],h+=d;break}if(h+=d,r?0>h:f<=h)throw TypeError("Reduce of empty array with no initial value")}for(;r?0<=h:f>h;h+=d)h in l&&(s=i(s,l[h],h,e));return s}},Wo=Vo(!1),qw=Vo(!0);Aa("reduce",function(r){return Wo(Da(this),r,arguments.length,1<arguments.length?arguments[1]:void 0)}),Aa("reduceRight",function(r){return qw(Da(this),r,arguments.length,1<arguments.length?arguments[1]:void 0)});var rw=Math.floor;Aa("reverse",function(){for(var r,e=Da(this).length,i=rw(e/2),o=0;o<i;)r=this[o],this[o++]=this[--e],this[e]=r;return this});var sw=R(function(){new Int8Array(1).set({})});Aa("set",function(r){Da(this);var e=kh(1<arguments.length?arguments[1]:void 0,1),i=this.length,o=Qa(r),s=ta(o.length),l=0;if(s+e>i)throw RangeError("Wrong length");for(;l<s;)this[e+l]=o[l++]},sw);var tw=[].slice,uw=R(function(){new Int8Array(1).slice()});Aa("slice",function(r,e){r=tw.call(Da(this),r,e);var i=kd(this,this.constructor);e=0;var o=r.length;for(i=new(Ne(i))(o);o>e;)i[e]=r[e++];return i},uw),Aa("some",function(r){return Iu(Da(this),r,1<arguments.length?arguments[1]:void 0)});var vw=[].sort;Aa("sort",function(r){return vw.call(Da(this),r)}),Aa("subarray",function(r,e){var i=Da(this),o=i.length;return r=xb(r,o),new(kd(i,i.constructor))(i.buffer,i.byteOffset+r*i.BYTES_PER_ELEMENT,ta((e===void 0?o:xb(e,o))-r))});var mh=y.Int8Array,Xo=[].toLocaleString,ww=[].slice,xw=!!mh&&R(function(){Xo.call(new mh(1))}),yw=R(function(){return[1,2].toLocaleString()!=new mh([1,2]).toLocaleString()})||!R(function(){mh.prototype.toLocaleString.call([1,2])});Aa("toLocaleString",function(){return Xo.apply(xw?ww.call(Da(this)):Da(this),arguments)},yw);var Yo=y.Uint8Array,zw=Yo&&Yo.prototype||{},nh=[].toString,Aw=[].join;R(function(){nh.call({})})&&(nh=function(){return Aw.call(this)}),Aa("toString",nh,zw.toString!=nh);var Zo=Pf.ArrayBuffer;N({global:!0,forced:y.ArrayBuffer!==Zo},{ArrayBuffer:Zo}),If("ArrayBuffer");var Bw=Ra.f,Hj=Function.prototype,Cw=Hj.toString,Dw=/^\s*function ([^ (]*)/;!ka||"name"in Hj||Bw(Hj,"name",{configurable:!0,get:function(){try{return Cw.call(this).match(Dw)[1]}catch{return""}}});var $o=RegExp.prototype,ap=$o.toString,Ew=R(function(){return ap.call({source:"a",flags:"b"})!="/a/b"}),Fw=ap.name!="toString";(Ew||Fw)&&Ta(RegExp.prototype,"toString",function(){var r=va(this),e=String(r.source),i=r.flags;return"/"+e+"/"+(r=String(i===void 0&&r instanceof RegExp&&!("flags"in $o)?tj.call(r):i))},{unsafe:!0});var Gw=Ef("splice"),Hw=Math.max,Iw=Math.min;N({target:"Array",proto:!0,forced:!Gw},{splice:function(r,e){var i,o,s=Qa(this),l=ta(s.length),f=xb(r,l),h=arguments.length;if(h===0?h=i=0:h===1?(h=0,i=l-f):(h-=2,i=Iw(Hw($b(e),0),l-f)),9007199254740991<l+h-i)throw TypeError("Maximum allowed length exceeded");var d=Sg(s,i);for(o=0;o<i;o++){var p=f+o;p in s&&Ge(d,o,s[p])}if(d.length=i,h<i){for(o=f;o<l-i;o++){var g=o+h;(p=o+i)in s?s[g]=s[p]:delete s[g]}for(o=l;o>l-i+h;o--)delete s[o-1]}else if(h>i)for(o=l-i;o>f;o--)g=o+h-1,(p=o+i-1)in s?s[g]=s[p]:delete s[g];for(o=0;o<h;o++)s[o+f]=arguments[o+2];return s.length=l-i+h,d}});var Ij={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Jj=qa("iterator"),bp=qa("toStringTag"),Kj=ld.values,oh;for(oh in Ij){var cp=y[oh],Kc=cp&&cp.prototype;if(Kc){if(Kc[Jj]!==Kj)try{Na(Kc,Jj,Kj)}catch{Kc[Jj]=Kj}if(Kc[bp]||Na(Kc,bp,oh),Ij[oh]){for(var Oe in ld)if(Kc[Oe]!==ld[Oe])try{Na(Kc,Oe,ld[Oe])}catch{Kc[Oe]=ld[Oe]}}}}var dp=Object.is||function(r,e){return r===e?r!==0||1/r==1/e:r!=r&&e!=e};dh("search",1,function(r,e,i){return[function(o){var s=jb(this),l=o==null?void 0:o[r];return l!==void 0?l.call(o,s):new RegExp(o)[r](String(s))},function(o){var s=i(e,o,this);if(s.done)return s.value;o=va(o);var l=String(this);return s=o.lastIndex,dp(s,0)||(o.lastIndex=0),l=Ke(o,l),dp(o.lastIndex,s)||(o.lastIndex=s),l===null?-1:l.index}]}),$a(function(r){(function(e,i){r.exports?r.exports=i(e):i(e)})(typeof self<"u"?self:Ya,function(e){function i($){return btoa($).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function o($){return $=($+="===").slice(0,-$.length%4),atob($.replace(/-/g,"+").replace(/_/g,"/"))}function s($){for(var Wt=new Uint8Array($.length),_t=0;_t<$.length;_t++)Wt[_t]=$.charCodeAt(_t);return Wt}function l($){return $ instanceof ArrayBuffer&&($=new Uint8Array($)),String.fromCharCode.apply(String,$)}function f($){var Wt={name:($.name||$||"").toUpperCase().replace("V","v")};switch(Wt.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":$.length&&(Wt.length=$.length);break;case"HMAC":$.hash&&(Wt.hash=f($.hash)),$.length&&(Wt.length=$.length);break;case"RSAES-PKCS1-v1_5":$.publicExponent&&(Wt.publicExponent=new Uint8Array($.publicExponent)),$.modulusLength&&(Wt.modulusLength=$.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":$.hash&&(Wt.hash=f($.hash)),$.publicExponent&&(Wt.publicExponent=new Uint8Array($.publicExponent)),$.modulusLength&&(Wt.modulusLength=$.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return Wt}function h($){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[$.name][($.hash||{}).name||$.length||""]}function d($){($ instanceof ArrayBuffer||$ instanceof Uint8Array)&&($=JSON.parse(decodeURIComponent(escape(l($)))));var Wt={kty:$.kty,alg:$.alg,ext:$.ext||$.extractable};switch(Wt.kty){case"oct":Wt.k=$.k;case"RSA":"n e d p q dp dq qi oth".split(" ").forEach(function(_t){_t in $&&(Wt[_t]=$[_t])});break;default:throw new TypeError("Unsupported key type")}return Wt}function p($){return $=d($),Di&&($.extractable=$.ext,delete $.ext),s(unescape(encodeURIComponent(JSON.stringify($)))).buffer}function g($){var Wt=_($),_t=!1;switch(2<Wt.length&&(_t=!0,Wt.shift()),$={ext:!0},Wt[0][0]){case"1.2.840.113549.1.1.1":var Vt="n e d p q dp dq qi".split(" ");for(Wt=_(Wt[1]),_t&&Wt.shift(),_t=0;_t<Wt.length;_t++)Wt[_t][0]||(Wt[_t]=Wt[_t].subarray(1)),$[Vt[_t]]=i(l(Wt[_t]));$.kty="RSA";break;default:throw new TypeError("Unsupported key type")}return $}function _($,Wt){if($ instanceof ArrayBuffer&&($=new Uint8Array($)),Wt||(Wt={pos:0,end:$.length}),2>Wt.end-Wt.pos||Wt.end>$.length)throw new RangeError("Malformed DER");var _t=$[Wt.pos++],Vt=$[Wt.pos++];if(128<=Vt){if(Vt&=127,Wt.end-Wt.pos<Vt)throw new RangeError("Malformed DER");for(var B=0;Vt--;)B<<=8,B|=$[Wt.pos++];Vt=B}if(Wt.end-Wt.pos<Vt)throw new RangeError("Malformed DER");switch(_t){case 2:_t=$.subarray(Wt.pos,Wt.pos+=Vt);break;case 3:if($[Wt.pos++])throw Error("Unsupported bit string");Vt--;case 4:_t=new Uint8Array($.subarray(Wt.pos,Wt.pos+=Vt)).buffer;break;case 5:_t=null;break;case 6:if(!(($=btoa(l($.subarray(Wt.pos,Wt.pos+=Vt))))in Ei))throw Error("Unsupported OBJECT ID "+$);_t=Ei[$];break;case 48:for(_t=[],Vt=Wt.pos+Vt;Wt.pos<Vt;)_t.push(_($,Wt));break;default:throw Error("Unsupported DER tag 0x"+_t.toString(16))}return _t}function b($,Wt){Wt||(Wt=[]);var _t=Wt.length+2;if(Wt.push(0,0),$ instanceof Uint8Array)for(var Vt=2,B=$.length,H=0;H<B;H++)Wt.push($[H]);else if($ instanceof ArrayBuffer)for(Vt=4,B=$.byteLength,$=new Uint8Array($),H=0;H<B;H++)Wt.push($[H]);else if($===null)Vt=5,B=0;else if(typeof $=="string"&&$ in ga)for(Vt=6,B=($=s(atob(ga[$]))).length,H=0;H<B;H++)Wt.push($[H]);else if($ instanceof Array){for(H=0;H<$.length;H++)b($[H],Wt);Vt=48,B=Wt.length-_t}else{if(!(X($)==="object"&&$.tag===3&&$.value instanceof ArrayBuffer))throw Error("Unsupported DER value "+$);for(Vt=3,B=($=new Uint8Array($.value)).byteLength,Wt.push(0),H=0;H<B;H++)Wt.push($[H]);B++}if(128<=B){for(H=B,B=4,Wt.splice(_t,0,H>>24&255,H>>16&255,H>>8&255,255&H);1<B&&!(H>>24);)H<<=8,B--;4>B&&Wt.splice(_t,4-B),B|=128}return Wt.splice(_t-2,2,Vt,B),Wt}function x($,Wt,_t,Vt){Object.defineProperties(this,{_key:{value:$},type:{value:$.type,enumerable:!0},extractable:{value:_t===void 0?$.extractable:_t,enumerable:!0},algorithm:{value:Wt===void 0?$.algorithm:Wt,enumerable:!0},usages:{value:Vt===void 0?$.usages:Vt,enumerable:!0}})}function A($){return $==="verify"||$==="encrypt"||$==="wrapKey"}function k($){return $==="sign"||$==="decrypt"||$==="unwrapKey"}if(typeof Promise!="function")throw"Promise support required";var C=e.crypto||e.msCrypto;if(C){var j=C.subtle||C.webkitSubtle;if(j){var P=e.Crypto||C.constructor||Object,z=e.SubtleCrypto||j.constructor||Object;e.CryptoKey||e.Key;var _e=-1<e.navigator.userAgent.indexOf("Edge/"),Di=!!e.msCrypto&&!_e,_i=!C.subtle&&!!C.webkitSubtle;if(Di||_i){var Ei={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},ga={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};if(["generateKey","importKey","unwrapKey"].forEach(function($){var Wt=j[$];j[$]=function(_t,Vt,B){var H=[].slice.call(arguments);switch($){case"generateKey":var ue=f(_t),_r=Vt,zt=B;break;case"importKey":ue=f(B),_r=H[3],zt=H[4],_t==="jwk"&&((Vt=d(Vt)).alg||(Vt.alg=h(ue)),Vt.key_ops||(Vt.key_ops=Vt.kty!=="oct"?"d"in Vt?zt.filter(k):zt.filter(A):zt.slice()),H[1]=p(Vt));break;case"unwrapKey":ue=H[4],_r=H[5],zt=H[6],H[2]=B._key}if($==="generateKey"&&ue.name==="HMAC"&&ue.hash)return ue.length=ue.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[ue.hash.name],j.importKey("raw",C.getRandomValues(new Uint8Array(ue.length+7>>3)),ue,_r,zt);if(_i&&$==="generateKey"&&ue.name==="RSASSA-PKCS1-v1_5"&&(!ue.modulusLength||2048<=ue.modulusLength))return(_t=f(_t)).name="RSAES-PKCS1-v1_5",delete _t.hash,j.generateKey(_t,!0,["encrypt","decrypt"]).then(function(_n){return Promise.all([j.exportKey("jwk",_n.publicKey),j.exportKey("jwk",_n.privateKey)])}).then(function(_n){return _n[0].alg=_n[1].alg=h(ue),_n[0].key_ops=zt.filter(A),_n[1].key_ops=zt.filter(k),Promise.all([j.importKey("jwk",_n[0],ue,!0,_n[0].key_ops),j.importKey("jwk",_n[1],ue,_r,_n[1].key_ops)])}).then(function(_n){return{publicKey:_n[0],privateKey:_n[1]}});if((_i||Di&&(ue.hash||{}).name==="SHA-1")&&$==="importKey"&&_t==="jwk"&&ue.name==="HMAC"&&Vt.kty==="oct")return j.importKey("raw",s(o(Vt.k)),B,H[3],H[4]);if(_i&&$==="importKey"&&(_t==="spki"||_t==="pkcs8"))return j.importKey("jwk",g(Vt),B,H[3],H[4]);if(Di&&$==="unwrapKey")return j.decrypt(H[3],B,Vt).then(function(_n){return j.importKey(_t,_n,H[4],H[5],H[6])});try{var Fi=Wt.apply(j,H)}catch(_n){return Promise.reject(_n)}return Di&&(Fi=new Promise(function(_n,Js){Fi.onabort=Fi.onerror=function(Gi){Js(Gi)},Fi.oncomplete=function(Gi){_n(Gi.target.result)}})),Fi=Fi.then(function(_n){return ue.name!=="HMAC"||ue.length||(ue.length=8*_n.algorithm.length),ue.name.search("RSA")==0&&(ue.modulusLength||(ue.modulusLength=(_n.publicKey||_n).algorithm.modulusLength),ue.publicExponent||(ue.publicExponent=(_n.publicKey||_n).algorithm.publicExponent)),_n.publicKey&&_n.privateKey?{publicKey:new x(_n.publicKey,ue,_r,zt.filter(A)),privateKey:new x(_n.privateKey,ue,_r,zt.filter(k))}:new x(_n,ue,_r,zt)})}}),["exportKey","wrapKey"].forEach(function($){var Wt=j[$];j[$]=function(_t,Vt,B){var H=[].slice.call(arguments);switch($){case"exportKey":H[1]=Vt._key;break;case"wrapKey":H[1]=Vt._key,H[2]=B._key}if((_i||Di&&(Vt.algorithm.hash||{}).name==="SHA-1")&&$==="exportKey"&&_t==="jwk"&&Vt.algorithm.name==="HMAC"&&(H[0]="raw"),!_i||$!=="exportKey"||_t!=="spki"&&_t!=="pkcs8"||(H[0]="jwk"),Di&&$==="wrapKey")return j.exportKey(_t,Vt).then(function(_r){return _t==="jwk"&&(_r=s(unescape(encodeURIComponent(JSON.stringify(d(_r)))))),j.encrypt(H[3],B,_r)});try{var ue=Wt.apply(j,H)}catch(_r){return Promise.reject(_r)}return Di&&(ue=new Promise(function(_r,zt){ue.onabort=ue.onerror=function(Fi){zt(Fi)},ue.oncomplete=function(Fi){_r(Fi.target.result)}})),$==="exportKey"&&_t==="jwk"&&(ue=ue.then(function(_r){return(_i||Di&&(Vt.algorithm.hash||{}).name==="SHA-1")&&Vt.algorithm.name==="HMAC"?{kty:"oct",alg:h(Vt.algorithm),key_ops:Vt.usages.slice(),ext:!0,k:i(l(_r))}:((_r=d(_r)).alg||(_r.alg=h(Vt.algorithm)),_r.key_ops||(_r.key_ops=Vt.type==="public"?Vt.usages.filter(A):Vt.type==="private"?Vt.usages.filter(k):Vt.usages.slice()),_r)})),!_i||$!=="exportKey"||_t!=="spki"&&_t!=="pkcs8"||(ue=ue.then(function(_r){var zt=[["",null]],Fi=!1;switch((_r=d(_r)).kty){case"RSA":for(var _n="n e d p q dp dq qi".split(" "),Js=[],Gi=0;Gi<_n.length&&_n[Gi]in _r;Gi++){var _u=Js[Gi]=s(o(_r[_n[Gi]]));128&_u[0]&&(Js[Gi]=new Uint8Array(_u.length+1),Js[Gi].set(_u,1))}2<Js.length&&(Fi=!0,Js.unshift(new Uint8Array([0]))),zt[0][0]="1.2.840.113549.1.1.1";break;default:throw new TypeError("Unsupported key type")}return zt.push(new Uint8Array(b(Js)).buffer),Fi?zt.unshift(new Uint8Array([0])):zt[1]={tag:3,value:zt[1]},new Uint8Array(b(zt)).buffer})),ue}}),["encrypt","decrypt","sign","verify"].forEach(function($){var Wt=j[$];j[$]=function(_t,Vt,B,H){if(Di&&(!B.byteLength||H&&!H.byteLength))throw Error("Empty input is not allowed");var ue=[].slice.call(arguments),_r=f(_t);if(!Di||$!=="sign"&&$!=="verify"||_t!=="RSASSA-PKCS1-v1_5"&&_t!=="HMAC"||(ue[0]={name:_t}),Di&&Vt.algorithm.hash&&(ue[0].hash=ue[0].hash||Vt.algorithm.hash),Di&&$==="decrypt"&&_r.name==="AES-GCM"){var zt=_t.tagLength>>3;ue[2]=(B.buffer||B).slice(0,B.byteLength-zt),_t.tag=(B.buffer||B).slice(B.byteLength-zt)}Di&&_r.name==="AES-GCM"&&ue[0].tagLength===void 0&&(ue[0].tagLength=128),ue[1]=Vt._key;try{var Fi=Wt.apply(j,ue)}catch(_n){return Promise.reject(_n)}return Di&&(Fi=new Promise(function(_n,Js){Fi.onabort=Fi.onerror=function(Gi){Js(Gi)},Fi.oncomplete=function(Gi){if(Gi=Gi.target.result,$==="encrypt"&&Gi instanceof AesGcmEncryptResult){var _u=Gi.ciphertext,vf=Gi.tag;(Gi=new Uint8Array(_u.byteLength+vf.byteLength)).set(new Uint8Array(_u),0),Gi.set(new Uint8Array(vf),_u.byteLength),Gi=Gi.buffer}_n(Gi)}})),Fi}}),Di){var _c=j.digest;j.digest=function($,Wt){if(!Wt.byteLength)throw Error("Empty input is not allowed");try{var _t=_c.call(j,$,Wt)}catch(Vt){return Promise.reject(Vt)}return _t=new Promise(function(Vt,B){_t.onabort=_t.onerror=function(H){B(H)},_t.oncomplete=function(H){Vt(H.target.result)}})},e.crypto=Object.create(C,{getRandomValues:{value:function($){return C.getRandomValues($)}},subtle:{value:j}}),e.CryptoKey=x}_i&&(C.subtle=j,e.Crypto=P,e.SubtleCrypto=z,e.CryptoKey=x)}}}})});var Jw=qa("match"),Lj=function(r){var e;return ha(r)&&((e=r[Jw])!==void 0?!!e:Zb(r)=="RegExp")},Kw=[].push,Lw=Math.min;dh("split",2,function(r,e,i){var o="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||1<".".split(/()()/).length||"".split(/.?/).length?function(s,l){var f=String(jb(this));if((l=l===void 0?4294967295:l>>>0)===0)return[];if(s===void 0)return[f];if(!Lj(s))return e.call(f,s,l);var h,d,p,g=[],_=0;for(s=new RegExp(s.source,(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(s.sticky?"y":"")+"g");(h=Of.call(s,f))&&!((d=s.lastIndex)>_&&(g.push(f.slice(_,h.index)),1<h.length&&h.index<f.length&&Kw.apply(g,h.slice(1)),p=h[0].length,_=d,g.length>=l));)s.lastIndex===h.index&&s.lastIndex++;return _===f.length?(p||!s.test(""))&&g.push(""):g.push(f.slice(_)),g.length>l?g.slice(0,l):g}:"0".split(void 0,0).length?function(s,l){return s===void 0&&l===0?[]:e.call(this,s,l)}:e;return[function(s,l){var f=jb(this),h=s==null?void 0:s[r];return h!==void 0?h.call(s,f,l):o.call(String(f),s,l)},function(s,l){var f=i(o,s,this,l,o!==e);if(f.done)return f.value;var h=va(s);s=String(this);var d=kd(h,RegExp);if(f=h.unicode,h=new d(pc?"^(?:"+h.source+")":h,(h.ignoreCase?"i":"")+(h.multiline?"m":"")+(h.unicode?"u":"")+(pc?"g":"y")),(l=l===void 0?4294967295:l>>>0)===0)return[];if(s.length===0)return Ke(h,s)===null?[s]:[];var p=0,g=0;for(d=[];g<s.length;){h.lastIndex=pc?0:g;var _,b=Ke(h,pc?s.slice(g):s);if(b===null||(_=Lw(ta(h.lastIndex+(pc?g:0)),s.length))===p)g=xj(s,g,f);else{if(d.push(s.slice(p,g)),d.length===l)return d;for(p=1;p<=b.length-1;p++)if(d.push(b[p]),d.length===l)return d;g=p=_}}return d.push(s.slice(p)),d}]},pc),function(r){r.console||(r.console={}),r=r.console;for(var e,i=function(){},o=["memory"],s="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");e=o.pop();)r[e]||(r[e]={});for(;e=s.pop();)r[e]||(r[e]=i)}(typeof window>"u"?Ya:window),N({target:"Object",stat:!0},{setPrototypeOf:Ua});var Mw=R(function(){Vb(1)});N({target:"Object",stat:!0,forced:Mw,sham:!Hn},{getPrototypeOf:function(r){return Vb(Qa(r))}});var ep=[].slice,Mj={},Nw=Function.bind||function(r){var e=yb(this),i=ep.call(arguments,1),o=function(){var s=i.concat(ep.call(arguments));if(this instanceof o){var l=s.length;if(!(l in Mj)){for(var f=[],h=0;h<l;h++)f[h]="a["+h+"]";Mj[l]=Function("C,a","return new C("+f.join(",")+")")}s=Mj[l](e,s)}else s=e.apply(r,s);return s};return ha(e.prototype)&&(o.prototype=e.prototype),o},Nj=mc("Reflect","construct"),fp=R(function(){function r(){}return!(Nj(function(){},[],r)instanceof r)}),gp=!R(function(){Nj(function(){})}),hp=fp||gp;N({target:"Reflect",stat:!0,forced:hp,sham:hp},{construct:function(r,e){yb(r),va(e);var i=3>arguments.length?r:yb(arguments[2]);if(gp&&!fp)return Nj(r,e,i);if(r==i){switch(e.length){case 0:return new r;case 1:return new r(e[0]);case 2:return new r(e[0],e[1]);case 3:return new r(e[0],e[1],e[2]);case 4:return new r(e[0],e[1],e[2],e[3])}return(i=[null]).push.apply(i,e),new(Nw.apply(r,i))}i=i.prototype,i=ac(ha(i)?i:Object.prototype);var o=Function.apply.call(r,i,e);return ha(o)?o:i}}),N({target:"Reflect",stat:!0},{get:wl});var ip=Fb.f,Ow=R(function(){ip(1)});N({target:"Object",stat:!0,forced:!ka||Ow,sham:!ka},{getOwnPropertyDescriptor:function(r,e){return ip(qb(r),e)}});var jp=Hd.f,Pw={}.toString,kp=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Oj=function(r){if(kp&&Pw.call(r)=="[object Window]")try{var e=jp(r)}catch{e=kp.slice()}else e=jp(qb(r));return e},lp={f:qa},Qw=Ra.f,ph=function(r){var e=y.Symbol||(y.Symbol={});Q(e,r)||Qw(e,r,{value:lp.f(r)})},rb=Pg("hidden"),mp=qa("toPrimitive"),Rw=Za.set,np=Za.getterFor("Symbol"),Ob=Object.prototype,sb=y.Symbol,Tf=mc("JSON","stringify"),op=Fb.f,od=Ra.f,pp=Oj,Sw=zf,Lc=fd("symbols"),Uf=fd("op-symbols"),Pj=fd("string-to-symbol-registry"),Qj=fd("symbol-to-string-registry"),Tw=fd("wks"),Rj=y.QObject,Sj=!Rj||!Rj.prototype||!Rj.prototype.findChild,Tj=ka&&R(function(){return ac(od({},"a",{get:function(){return od(this,"a",{value:7}).a}})).a!=7})?function(r,e,i){var o=op(Ob,e);o&&delete Ob[e],od(r,e,i),o&&r!==Ob&&od(Ob,e,o)}:od,Uj=function(r,e){var i=Lc[r]=ac(sb.prototype);return Rw(i,{type:"Symbol",tag:r,description:e}),ka||(i.description=e),i},Vj=vn?function(r){return typeof r=="symbol"}:function(r){return Object(r)instanceof sb},qh=function(r,e,i){return r===Ob&&qh(Uf,e,i),va(r),e=lc(e,!0),va(i),Q(Lc,e)?(i.enumerable?(Q(r,rb)&&r[rb][e]&&(r[rb][e]=!1),i=ac(i,{enumerable:dd(0,!1)})):(Q(r,rb)||od(r,rb,dd(1,{})),r[rb][e]=!0),Tj(r,e,i)):od(r,e,i)},qp=function(r,e){va(r);var i=qb(e);return e=Dc(i).concat(Wj(i)),Jd(e,function(o){ka&&!Xj.call(i,o)||qh(r,o,i[o])}),r},Xj=function(r){r=lc(r,!0);var e=Sw.call(this,r);return!(this===Ob&&Q(Lc,r)&&!Q(Uf,r))&&(!(e||!Q(this,r)||!Q(Lc,r)||Q(this,rb)&&this[rb][r])||e)},rp=function(r,e){if(r=qb(r),e=lc(e,!0),r!==Ob||!Q(Lc,e)||Q(Uf,e)){var i=op(r,e);return!i||!Q(Lc,e)||Q(r,rb)&&r[rb][e]||(i.enumerable=!0),i}},sp=function(r){r=pp(qb(r));var e=[];return Jd(r,function(i){Q(Lc,i)||Q(Be,i)||e.push(i)}),e},Wj=function(r){var e=r===Ob;r=pp(e?Uf:qb(r));var i=[];return Jd(r,function(o){!Q(Lc,o)||e&&!Q(Ob,o)||i.push(Lc[o])}),i};if(oc||(sb=function(){if(this instanceof sb)throw TypeError("Symbol is not a constructor");var r=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,e=Ae(r),i=function(o){this===Ob&&i.call(Uf,o),Q(this,rb)&&Q(this[rb],e)&&(this[rb][e]=!1),Tj(this,e,dd(1,o))};return ka&&Sj&&Tj(Ob,e,{configurable:!0,set:i}),Uj(e,r)},Ta(sb.prototype,"toString",function(){return np(this).tag}),Ta(sb,"withoutSetter",function(r){return Uj(Ae(r),r)}),zf=Xj,Ra.f=qh,Fb.f=rp,Hd.f=Oj=sp,Bf.f=Wj,lp.f=function(r){return Uj(qa(r),r)},ka&&(od(sb.prototype,"description",{configurable:!0,get:function(){return np(this).description}}),Ta(Ob,"propertyIsEnumerable",Xj,{unsafe:!0}))),N({global:!0,wrap:!0,forced:!oc,sham:!oc},{Symbol:sb}),Jd(Dc(Tw),function(r){ph(r)}),N({target:"Symbol",stat:!0,forced:!oc},{for:function(r){if(r=String(r),Q(Pj,r))return Pj[r];var e=sb(r);return Pj[r]=e,Qj[e]=r,e},keyFor:function(r){if(!Vj(r))throw TypeError(r+" is not a symbol");if(Q(Qj,r))return Qj[r]},useSetter:function(){Sj=!0},useSimple:function(){Sj=!1}}),N({target:"Object",stat:!0,forced:!oc,sham:!ka},{create:function(r,e){return e===void 0?ac(r):qp(ac(r),e)},defineProperty:qh,defineProperties:qp,getOwnPropertyDescriptor:rp}),N({target:"Object",stat:!0,forced:!oc},{getOwnPropertyNames:sp,getOwnPropertySymbols:Wj}),N({target:"Object",stat:!0,forced:R(function(){Bf.f(1)})},{getOwnPropertySymbols:function(r){return Bf.f(Qa(r))}}),Tf){var Uw=!oc||R(function(){var r=sb();return Tf([r])!="[null]"||Tf({a:r})!="{}"||Tf(Object(r))!="{}"});N({target:"JSON",stat:!0,forced:Uw},{stringify:function(r,e,i){for(var o,s=[r],l=1;arguments.length>l;)s.push(arguments[l++]);if(o=e,(ha(e)||r!==void 0)&&!Vj(r))return gd(e)||(e=function(f,h){if(typeof o=="function"&&(h=o.call(this,f,h)),!Vj(h))return h}),s[1]=e,Tf.apply(null,s)}})}sb.prototype[mp]||Na(sb.prototype,mp,sb.prototype.valueOf),Ec(sb,"Symbol"),Be[rb]=!0;var Vw=Ra.f,Mc=y.Symbol;if(ka&&typeof Mc=="function"&&(!("description"in Mc.prototype)||Mc().description!==void 0)){var tp={},Vf=function(){var r=1>arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),e=this instanceof Vf?new Mc(r):r===void 0?Mc():Mc(r);return r===""&&(tp[e]=!0),e};rn(Vf,Mc);var Yj=Vf.prototype=Mc.prototype;Yj.constructor=Vf;var Ww=Yj.toString,Xw=String(Mc("test"))=="Symbol(test)",Yw=/^Symbol\((.*)\)[^)]+$/;Vw(Yj,"description",{configurable:!0,get:function(){var r=ha(this)?this.valueOf():this,e=Ww.call(r);return Q(tp,r)?"":(r=Xw?e.slice(7,-1):e.replace(Yw,"$1"))===""?void 0:r}}),N({global:!0,forced:!0},{Symbol:Vf})}ph("toStringTag"),Ec(y.JSON,"JSON",!0),Ec(Math,"Math",!0),function(){function r(b,x){if(!(b instanceof x))throw new TypeError("Cannot call a class as a function")}function e(b,x){for(var A=0;A<x.length;A++){var k=x[A];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(b,k.key,k)}}function i(b,x,A){return x&&e(b.prototype,x),b}function o(b,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(x&&x.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),x&&l(b,x)}function s(b){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(b)}function l(b,x){return(l=Object.setPrototypeOf||function(A,k){return A.__proto__=k,A})(b,x)}function f(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}function h(b){var x=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var A=s(b);if(x){var k=s(this).constructor;A=Reflect.construct(A,arguments,k)}else A=A.apply(this,arguments);return A=!A||X(A)!=="object"&&typeof A!="function"?f(this):A}}function d(b,x,A){return(d=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(k,C,j){for(;!Object.prototype.hasOwnProperty.call(k,C)&&(k=s(k))!==null;);if(k)return(C=Object.getOwnPropertyDescriptor(k,C)).get?C.get.call(j):C.value})(b,x,A||b)}var p=function(){function b(){r(this,b),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return i(b,[{key:"addEventListener",value:function(x,A,k){x in this.listeners||(this.listeners[x]=[]),this.listeners[x].push({callback:A,options:k})}},{key:"removeEventListener",value:function(x,A){if(x in this.listeners){for(var k=0,C=(x=this.listeners[x]).length;k<C;k++)if(x[k].callback===A){x.splice(k,1);break}}}},{key:"dispatchEvent",value:function(x){if(x.type in this.listeners){for(var A=this.listeners[x.type].slice(),k=0,C=A.length;k<C;k++){var j=A[k];try{j.callback.call(this,x)}catch(P){Promise.resolve().then(function(){throw P})}j.options&&j.options.once&&this.removeEventListener(x.type,j.callback)}return!x.defaultPrevented}}}]),b}(),g=function(b){function x(){r(this,x);var k=A.call(this);return k.listeners||p.call(f(k)),Object.defineProperty(f(k),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(f(k),"onabort",{value:null,writable:!0,configurable:!0}),k}o(x,b);var A=h(x);return i(x,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(k){k.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,k)),d(s(x.prototype),"dispatchEvent",this).call(this,k)}}]),x}(p),_=function(){function b(){r(this,b),Object.defineProperty(this,"signal",{value:new g,writable:!0,configurable:!0})}return i(b,[{key:"abort",value:function(){try{var x=new Event("abort")}catch{typeof document<"u"?document.createEvent?(x=document.createEvent("Event")).initEvent("abort",!1,!1):(x=document.createEventObject()).type="abort":x={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(x)}},{key:"toString",value:function(){return"[object AbortController]"}}]),b}();typeof Symbol<"u"&&Symbol.toStringTag&&(_.prototype[Symbol.toStringTag]="AbortController",g.prototype[Symbol.toStringTag]="AbortSignal"),function(b){if(b.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL){console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill");var x=!0}else x=typeof b.Request=="function"&&!b.Request.prototype.hasOwnProperty("signal")||!b.AbortController;x&&(b.AbortController=_,b.AbortSignal=g)}(typeof self<"u"?self:Ya)}();var Zw=Math.floor,$w=Math.log,ax=Math.LOG2E;N({target:"Math",stat:!0},{clz32:function(r){return(r>>>=0)?31-Zw($w(r+.5)*ax):32}});var bx=Math.log,cx=Math.LN2,ss=Math.clz32||function(r){return 31-bx(r>>>0)/cx|0},xd=String.fromCharCode,up={}.toString,Zj=window.Uint8Array,ak=Zj||Array,dx=up.call((window.ArrayBuffer||ak).prototype),bk;xl.prototype.decode=function(r){if(r=r&&r.buffer||r,up.call(r)!==dx)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var e="",i=0,o=0|(r=Zj?new ak(r):r).length;i<o;i=i+32768|0)e+=xd.apply(0,r[Zj?"slice":"subarray"](i,i+32768|0));return e.replace(/[\xc0-\xff][\x80-\xbf]*/g,rs)},window.TextDecoder||(window.TextDecoder=xl),yl.prototype.encode=function(r){for(var e=0|(r=r===void 0?"":(""+r).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,ts)).length,i=new ak(e),o=0;o<e;o=o+1|0)i[o]=r.charCodeAt(o);return i},window.TextEncoder||(window.TextEncoder=yl),function(r){var e,i,o,s,l,f,h,d,p,g,_;(function(b){b.LOGIN="LOGIN",b.LOGIN_SUCCESS="LOGIN_SUCCESS",b.LOGIN_FAILURE="LOGIN_FAILURE",b.LOGIN_TIMEOUT="LOGIN_TIMEOUT",b.INTERRUPTED="INTERRUPTED",b.LOGOUT="LOGOUT",b.BANNED_BY_SERVER="BANNED_BY_SERVER",b.REMOTE_LOGIN="REMOTE_LOGIN"})(e||(e={})),r.ConnectionChangeReason=e,function(b){b.DISCONNECTED="DISCONNECTED",b.CONNECTING="CONNECTING",b.CONNECTED="CONNECTED",b.RECONNECTING="RECONNECTING",b.ABORTED="ABORTED"}(i||(i={})),r.ConnectionState=i,function(b){b.IDLE="IDLE",b.SENT_TO_REMOTE="SENT_TO_REMOTE",b.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",b.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",b.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",b.CANCELED="CANCELED",b.FAILURE="FAILURE"}(o||(o={})),r.LocalInvitationState=o,function(b){b.INVITATION_RECEIVED="INVITATION_RECEIVED",b.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",b.REFUSED="REFUSED",b.ACCEPTED="ACCEPTED",b.CANCELED="CANCELED",b.FAILURE="FAILURE"}(s||(s={})),r.RemoteInvitationState=s,function(b){b.UNKNOWN="UNKNOWN",b.PEER_NO_RESPONSE="PEER_NO_RESPONSE",b.INVITATION_EXPIRE="INVITATION_EXPIRE",b.PEER_OFFLINE="PEER_OFFLINE",b.NOT_LOGGEDIN="NOT_LOGGEDIN"}(l||(l={})),r.LocalInvitationFailureReason=l,function(b){b.UNKNOWN="UNKNOWN",b.PEER_OFFLINE="PEER_OFFLINE",b.ACCEPT_FAILURE="ACCEPT_FAILURE",b.INVITATION_EXPIRE="INVITATION_EXPIRE"}(f||(f={})),r.RemoteInvitationFailureReason=f,function(b){b.ONLINE="ONLINE",b.UNREACHABLE="UNREACHABLE",b.OFFLINE="OFFLINE"}(h||(h={})),r.PeerOnlineState=h,(d||(d={})).ONLINE_STATUS="ONLINE_STATUS",r.PeerSubscriptionOption=d,function(b){b.TEXT="TEXT",b.RAW="RAW",b.IMAGE="IMAGE",b.FILE="FILE"}(p||(p={})),r.MessageType=p,function(b){b.CN="CN",b.NA="NA",b.EU="EU",b.AS="AS",b.JP="JP",b.IN="IN",b.GLOB="GLOB",b.OC="OC",b.SA="SA",b.AF="AF",b.OVS="OVS"}(g||(g={})),r.LegacyAreaCode=g,function(b){b.GLOBAL="GLOBAL",b.INDIA="INDIA",b.JAPAN="JAPAN",b.ASIA="ASIA",b.EUROPE="EUROPE",b.CHINA="CHINA",b.NORTH_AMERICA="NORTH_AMERICA"}(_||(_={})),r.AreaCode=_}(bk||(bk={}));var S=bk;N({target:"Array",proto:!0},{includes:function(r){return on(this,r,1<arguments.length?arguments[1]:void 0)}}),Ld("includes");var ck=function(r){if(Lj(r))throw TypeError("The method doesn't accept regular expressions");return r},ex=qa("match"),dk=function(r){var e=/./;try{"/./"[r](e)}catch{try{return e[ex]=!1,"/./"[r](e)}catch{}}return!1};N({target:"String",proto:!0,forced:!dk("includes")},{includes:function(r){return!!~String(jb(this)).indexOf(ck(r),1<arguments.length?arguments[1]:void 0)}});var Nc={RECONNECTING_AP_INTERVAL:2500,RECONNECTING_AP_NUM:2,DISABLE_MESSAGE_COMPRESSION:!1,LOG_UPLOAD_INTERVAL:3e3,LOG_HANDLER:void 0};ph("iterator"),ph("asyncIterator");var ek=Ee("forEach")?[].forEach:function(r){return Jd(this,r,1<arguments.length?arguments[1]:void 0)},vp;for(vp in Ij){var wp=y[vp],rh=wp&&wp.prototype;if(rh&&rh.forEach!==ek)try{Na(rh,"forEach",ek)}catch{rh.forEach=ek}}var fx=[].reverse,xp=[1,2];N({target:"Array",proto:!0,forced:String(xp)===String(xp.reverse())},{reverse:function(){return gd(this)&&(this.length=this.length),fx.call(this)}});var w=$a(function(r){r=function(e){function i(B,H,ue){return Object.defineProperty(B,H,{value:ue,enumerable:!0,configurable:!0,writable:!0}),B[H]}function o(B,H,ue,_r){return H=Object.create((H&&H.prototype instanceof l?H:l).prototype),_r=new x(_r||[]),H._invoke=function(zt,Fi,_n){var Js=Ei;return function(Gi,_u){if(Js===_c)throw Error("Generator is already running");if(Js===$){if(Gi==="throw")throw _u;return k()}for(_n.method=Gi,_n.arg=_u;;){if((Gi=_n.delegate)&&(Gi=g(Gi,_n))){if(Gi===Wt)continue;return Gi}if(_n.method==="next")_n.sent=_n._sent=_n.arg;else if(_n.method==="throw"){if(Js===Ei)throw Js=$,_n.arg;_n.dispatchException(_n.arg)}else _n.method==="return"&&_n.abrupt("return",_n.arg);if(Js=_c,(Gi=s(zt,Fi,_n)).type==="normal"){if(Js=_n.done?$:ga,Gi.arg===Wt)continue;return{value:Gi.arg,done:_n.done}}Gi.type==="throw"&&(Js=$,_n.method="throw",_n.arg=Gi.arg)}}}(B,ue,_r),H}function s(B,H,ue){try{return{type:"normal",arg:B.call(H,ue)}}catch(_r){return{type:"throw",arg:_r}}}function l(){}function f(){}function h(){}function d(B){["next","throw","return"].forEach(function(H){i(B,H,function(ue){return this._invoke(H,ue)})})}function p(B,H){function ue(zt,Fi,_n,Js){if((zt=s(B[zt],B,Fi)).type!=="throw"){var Gi=zt.arg;return(zt=Gi.value)&&X(zt)==="object"&&P.call(zt,"__await")?H.resolve(zt.__await).then(function(_u){ue("next",_u,_n,Js)},function(_u){ue("throw",_u,_n,Js)}):H.resolve(zt).then(function(_u){Gi.value=_u,_n(Gi)},function(_u){return ue("throw",_u,_n,Js)})}Js(zt.arg)}var _r;this._invoke=function(zt,Fi){function _n(){return new H(function(Js,Gi){ue(zt,Fi,Js,Gi)})}return _r=_r?_r.then(_n,_n):_n()}}function g(B,H){var ue=B.iterator[H.method];if(ue===C){if(H.delegate=null,H.method==="throw"){if(B.iterator.return&&(H.method="return",H.arg=C,g(B,H),H.method==="throw"))return Wt;H.method="throw",H.arg=new TypeError("The iterator does not provide a 'throw' method")}return Wt}return(ue=s(ue,B.iterator,H.arg)).type==="throw"?(H.method="throw",H.arg=ue.arg,H.delegate=null,Wt):(ue=ue.arg)?ue.done?(H[B.resultName]=ue.value,H.next=B.nextLoc,H.method!=="return"&&(H.method="next",H.arg=C),H.delegate=null,Wt):ue:(H.method="throw",H.arg=new TypeError("iterator result is not an object"),H.delegate=null,Wt)}function _(B){var H={tryLoc:B[0]};1 in B&&(H.catchLoc=B[1]),2 in B&&(H.finallyLoc=B[2],H.afterLoc=B[3]),this.tryEntries.push(H)}function b(B){var H=B.completion||{};H.type="normal",delete H.arg,B.completion=H}function x(B){this.tryEntries=[{tryLoc:"root"}],B.forEach(_,this),this.reset(!0)}function A(B){if(B){var H=B[_e];if(H)return H.call(B);if(typeof B.next=="function")return B;if(!isNaN(B.length)){var ue=-1;return(H=function _r(){for(;++ue<B.length;)if(P.call(B,ue))return _r.value=B[ue],_r.done=!1,_r;return _r.value=C,_r.done=!0,_r}).next=H}}return{next:k}}function k(){return{value:C,done:!0}}var C,j=Object.prototype,P=j.hasOwnProperty,z=typeof Symbol=="function"?Symbol:{},_e=z.iterator||"@@iterator",Di=z.asyncIterator||"@@asyncIterator",_i=z.toStringTag||"@@toStringTag";try{i({},"")}catch{i=function(H,ue,_r){return H[ue]=_r}}e.wrap=o;var Ei="suspendedStart",ga="suspendedYield",_c="executing",$="completed",Wt={};i(z={},_e,function(){return this});var _t=Object.getPrototypeOf;(_t=_t&&_t(_t(A([]))))&&_t!==j&&P.call(_t,_e)&&(z=_t);var Vt=h.prototype=l.prototype=Object.create(z);return f.prototype=h,i(Vt,"constructor",h),i(h,"constructor",f),f.displayName=i(h,_i,"GeneratorFunction"),e.isGeneratorFunction=function(B){return!!(B=typeof B=="function"&&B.constructor)&&(B===f||(B.displayName||B.name)==="GeneratorFunction")},e.mark=function(B){return Object.setPrototypeOf?Object.setPrototypeOf(B,h):(B.__proto__=h,i(B,_i,"GeneratorFunction")),B.prototype=Object.create(Vt),B},e.awrap=function(B){return{__await:B}},d(p.prototype),i(p.prototype,Di,function(){return this}),e.AsyncIterator=p,e.async=function(B,H,ue,_r,zt){zt===void 0&&(zt=Promise);var Fi=new p(o(B,H,ue,_r),zt);return e.isGeneratorFunction(H)?Fi:Fi.next().then(function(_n){return _n.done?_n.value:Fi.next()})},d(Vt),i(Vt,_i,"Generator"),i(Vt,_e,function(){return this}),i(Vt,"toString",function(){return"[object Generator]"}),e.keys=function(B){var H,ue=[];for(H in B)ue.push(H);return ue.reverse(),function _r(){for(;ue.length;){var zt=ue.pop();if(zt in B)return _r.value=zt,_r.done=!1,_r}return _r.done=!0,_r}},e.values=A,x.prototype={constructor:x,reset:function(B){if(this.next=this.prev=0,this.sent=this._sent=C,this.done=!1,this.delegate=null,this.method="next",this.arg=C,this.tryEntries.forEach(b),!B)for(var H in this)H.charAt(0)==="t"&&P.call(this,H)&&!isNaN(+H.slice(1))&&(this[H]=C)},stop:function(){this.done=!0;var B=this.tryEntries[0].completion;if(B.type==="throw")throw B.arg;return this.rval},dispatchException:function(B){function H(Gi,_u){return Fi.type="throw",Fi.arg=B,ue.next=Gi,_u&&(ue.method="next",ue.arg=C),!!_u}if(this.done)throw B;for(var ue=this,_r=this.tryEntries.length-1;0<=_r;--_r){var zt=this.tryEntries[_r],Fi=zt.completion;if(zt.tryLoc==="root")return H("end");if(zt.tryLoc<=this.prev){var _n=P.call(zt,"catchLoc"),Js=P.call(zt,"finallyLoc");if(_n&&Js){if(this.prev<zt.catchLoc)return H(zt.catchLoc,!0);if(this.prev<zt.finallyLoc)return H(zt.finallyLoc)}else if(_n){if(this.prev<zt.catchLoc)return H(zt.catchLoc,!0)}else{if(!Js)throw Error("try statement without catch or finally");if(this.prev<zt.finallyLoc)return H(zt.finallyLoc)}}}},abrupt:function(B,H){for(var ue=this.tryEntries.length-1;0<=ue;--ue){var _r=this.tryEntries[ue];if(_r.tryLoc<=this.prev&&P.call(_r,"finallyLoc")&&this.prev<_r.finallyLoc){var zt=_r;break}}return zt&&(B==="break"||B==="continue")&&zt.tryLoc<=H&&H<=zt.finallyLoc&&(zt=null),(ue=zt?zt.completion:{}).type=B,ue.arg=H,zt?(this.method="next",this.next=zt.finallyLoc,Wt):this.complete(ue)},complete:function(B,H){if(B.type==="throw")throw B.arg;return B.type==="break"||B.type==="continue"?this.next=B.arg:B.type==="return"?(this.rval=this.arg=B.arg,this.method="return",this.next="end"):B.type==="normal"&&H&&(this.next=H),Wt},finish:function(B){for(var H=this.tryEntries.length-1;0<=H;--H){var ue=this.tryEntries[H];if(ue.finallyLoc===B)return this.complete(ue.completion,ue.afterLoc),b(ue),Wt}},catch:function(B){for(var H=this.tryEntries.length-1;0<=H;--H){var ue=this.tryEntries[H];if(ue.tryLoc===B){if((B=ue.completion).type==="throw"){var _r=B.arg;b(ue)}return _r}}throw Error("illegal catch attempt")},delegateYield:function(B,H,ue){return this.delegate={iterator:A(B),resultName:H,nextLoc:ue},this.method==="next"&&(this.arg=C),Wt}},e}(r.exports);try{regeneratorRuntime=r}catch{(typeof globalThis>"u"?"undefined":X(globalThis))==="object"?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}),yp=!R(function(){return Object.isExtensible(Object.preventExtensions({}))}),fk=$a(function(r){var e=Ra.f,i=Ae("meta"),o=0,s=Object.isExtensible||function(){return!0},l=function(h){e(h,i,{value:{objectID:"O"+ ++o,weakData:{}}})},f=r.exports={REQUIRED:!1,fastKey:function(h,d){if(!ha(h))return typeof h=="symbol"?h:(typeof h=="string"?"S":"P")+h;if(!Q(h,i)){if(!s(h))return"F";if(!d)return"E";l(h)}return h[i].objectID},getWeakData:function(h,d){if(!Q(h,i)){if(!s(h))return!0;if(!d)return!1;l(h)}return h[i].weakData},onFreeze:function(h){return yp&&f.REQUIRED&&s(h)&&!Q(h,i)&&l(h),h}};Be[i]=!0}),zp=function(r,e,i){var o=r.indexOf("Map")!==-1,s=r.indexOf("Weak")!==-1,l=o?"set":"add",f=y[r],h=f&&f.prototype,d=f,p={},g=function(C){var j=h[C];Ta(h,C,C=="add"?function(P){return j.call(this,P===0?0:P),this}:C=="delete"?function(P){return!(s&&!ha(P))&&j.call(this,P===0?0:P)}:C=="get"?function(P){return s&&!ha(P)?void 0:j.call(this,P===0?0:P)}:C=="has"?function(P){return!(s&&!ha(P))&&j.call(this,P===0?0:P)}:function(P,z){return j.call(this,P===0?0:P,z),this})};if(nc(r,typeof f!="function"||!(s||h.forEach&&!R(function(){new f().entries().next()}))))d=i.getConstructor(e,r,o,l),fk.REQUIRED=!0;else if(nc(r,!0)){var _=new d,b=_[l](s?{}:-0,1)!=_,x=R(function(){_.has(1)}),A=Tg(function(C){new f(C)}),k=!s&&R(function(){for(var C=new f,j=5;j--;)C[l](j,j);return!C.has(-0)});A||((d=e(function(C,j){return Gc(C,d,r),C=lh(new f,C,d),j!=null&&Xg(j,C[l],{that:C,AS_ENTRIES:o}),C})).prototype=h,h.constructor=d),(x||k)&&(g("delete"),g("has"),o&&g("get")),(k||b)&&g(l),s&&h.clear&&delete h.clear}return p[r]=d,N({global:!0,forced:d!=f},p),Ec(d,r),s||i.setStrong(d,r,o),d},gx=Ra.f,Ap=fk.fastKey,Bp=Za.set,gk=Za.getterFor,Cp={getConstructor:function(r,e,i,o){var s=r(function(d,p){Gc(d,s,e),Bp(d,{type:e,index:ac(null),first:void 0,last:void 0,size:0}),ka||(d.size=0),p!=null&&Xg(p,d[o],{that:d,AS_ENTRIES:i})}),l=gk(e),f=function(d,p,g){var _,b=l(d),x=h(d,p);return x?x.value=g:(b.last=x={index:_=Ap(p,!0),key:p,value:g,previous:p=b.last,next:void 0,removed:!1},b.first||(b.first=x),p&&(p.next=x),ka?b.size++:d.size++,_!=="F"&&(b.index[_]=x)),d},h=function(d,p){d=l(d);var g=Ap(p);if(g!=="F")return d.index[g];for(d=d.first;d;d=d.next)if(d.key==p)return d};return Hf(s.prototype,{clear:function(){for(var d=l(this),p=d.index,g=d.first;g;)g.removed=!0,g.previous&&(g.previous=g.previous.next=void 0),delete p[g.index],g=g.next;d.first=d.last=void 0,ka?d.size=0:this.size=0},delete:function(d){var p=l(this);if(d=h(this,d)){var g=d.next,_=d.previous;delete p.index[d.index],d.removed=!0,_&&(_.next=g),g&&(g.previous=_),p.first==d&&(p.first=g),p.last==d&&(p.last=_),ka?p.size--:this.size--}return!!d},forEach:function(d){for(var p,g=l(this),_=Id(d,1<arguments.length?arguments[1]:void 0,3);p=p?p.next:g.first;)for(_(p.value,p.key,this);p&&p.removed;)p=p.previous},has:function(d){return!!h(this,d)}}),Hf(s.prototype,i?{get:function(d){return(d=h(this,d))&&d.value},set:function(d,p){return f(this,d===0?0:d,p)}}:{add:function(d){return f(this,d=d===0?0:d,d)}}),ka&&gx(s.prototype,"size",{get:function(){return l(this).size}}),s},setStrong:function(r,e,i){var o=e+" Iterator",s=gk(e),l=gk(o);bj(r,e,function(f,h){Bp(this,{type:o,target:f,state:s(f),kind:h,last:void 0})},function(){for(var f=l(this),h=f.kind,d=f.last;d&&d.removed;)d=d.previous;return f.target&&(f.last=d=d?d.next:f.state.first)?h=="keys"?{value:d.key,done:!1}:h=="values"?{value:d.value,done:!1}:{value:[d.key,d.value],done:!1}:(f.target=void 0,{value:void 0,done:!0})},i?"entries":"values",!i,!0),If(e)}};zp("Set",function(r){return function(){return r(this,arguments.length?arguments[0]:void 0)}},Cp);var hx=/^[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,ix=/[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,hk=function(r){return function(e){return e=String(jb(e)),1&r&&(e=e.replace(hx,"")),2&r&&(e=e.replace(ix,"")),e}},ik=hk(3),sh=y.parseInt,jx=/^[+-]?0[Xx]/,Dp=sh(`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF08`)!==8||sh(`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF0x16`)!==22?function(r,e){return r=ik(String(r)),sh(r,e>>>0||(jx.test(r)?16:10))}:sh;N({global:!0,forced:parseInt!=Dp},{parseInt:Dp});var kx=Hd.f,lx=Fb.f,mx=Ra.f,pd=y.Number,th=pd.prototype,nx=Zb(ac(th))=="Number",Ep=function(r){var e,i=lc(r,!1);if(typeof i=="string"&&2<i.length){if((r=(i=ik(i)).charCodeAt(0))===43||r===45){if((r=i.charCodeAt(2))===88||r===120)return NaN}else if(r===48){switch(i.charCodeAt(1)){case 66:case 98:r=2;var o=49;break;case 79:case 111:r=8,o=55;break;default:return+i}var s=(i=i.slice(2)).length;for(e=0;e<s;e++){var l=i.charCodeAt(e);if(48>l||l>o)return NaN}return parseInt(i,r)}}return+i};if(nc("Number",!pd(" 0o1")||!pd("0b1")||pd("+0x1"))){for(var Pd=function(r){var e=1>arguments.length?0:r,i=this;return i instanceof Pd&&(nx?R(function(){th.valueOf.call(i)}):Zb(i)!="Number")?lh(new pd(Ep(e)),i,Pd):Ep(e)},Fp=ka?kx(pd):"MAX_VALUE MIN_VALUE NaN NEGATIVE_INFINITY POSITIVE_INFINITY EPSILON isFinite isInteger isNaN isSafeInteger MAX_SAFE_INTEGER MIN_SAFE_INTEGER parseFloat parseInt isInteger fromString range".split(" "),jk=0,uh;Fp.length>jk;jk++)Q(pd,uh=Fp[jk])&&!Q(Pd,uh)&&mx(Pd,uh,lx(pd,uh));Pd.prototype=th,th.constructor=Pd,Ta(y,"Number",Pd)}var Gp=qa("isConcatSpreadable"),ox=51<=id||!R(function(){var r=[];return r[Gp]=!1,r.concat()[0]!==r}),px=Ef("concat");N({target:"Array",proto:!0,forced:!ox||!px},{concat:function(r){var e,i=Qa(this),o=Sg(i,0),s=0,l=-1;for(e=arguments.length;l<e;l++){var f=l===-1?i:arguments[l],h=f;if(ha(h)){var d=h[Gp];h=d!==void 0?!!d:gd(h)}else h=!1;if(h){if(9007199254740991<s+(d=ta(f.length)))throw TypeError("Maximum allowed index exceeded");for(h=0;h<d;h++,s++)h in f&&Ge(o,s,f[h])}else{if(9007199254740991<=s)throw TypeError("Maximum allowed index exceeded");Ge(o,s++,f)}}return o.length=s,o}});var kk=mc("Reflect","apply"),qx=Function.apply,rx=!R(function(){kk(function(){})});N({target:"Reflect",stat:!0,forced:rx},{apply:function(r,e,i){return yb(r),va(i),kk?kk(r,e,i):qx.call(r,e,i)}}),N({target:"Reflect",stat:!0},{ownKeys:qn});var sx=Oj,tx=R(function(){return!Object.getOwnPropertyNames(1)});N({target:"Object",stat:!0,forced:tx},{getOwnPropertyNames:sx});var Pe=(typeof Reflect>"u"?"undefined":X(Reflect))==="object"?Reflect:null,Hp=Pe&&typeof Pe.apply=="function"?Pe.apply:function(r,e,i){return Function.prototype.apply.call(r,e,i)},ux=Pe&&typeof Pe.ownKeys=="function"?Pe.ownKeys:Object.getOwnPropertySymbols?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:function(r){return Object.getOwnPropertyNames(r)},Ip=Number.isNaN||function(r){return r!=r};ea.EventEmitter=ea,ea.prototype._events=void 0,ea.prototype._eventsCount=0,ea.prototype._maxListeners=void 0;var Jp=10;Object.defineProperty(ea,"defaultMaxListeners",{enumerable:!0,get:function(){return Jp},set:function(r){if(typeof r!="number"||0>r||Ip(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Jp=r}}),ea.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ea.prototype.setMaxListeners=function(r){if(typeof r!="number"||0>r||Ip(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this},ea.prototype.getMaxListeners=function(){return this._maxListeners===void 0?ea.defaultMaxListeners:this._maxListeners},ea.prototype.emit=function(r){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);i=r==="error";var o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;throw 0<e.length&&(s=e[0]),s instanceof Error?s:((e=Error("Unhandled error."+(s?" ("+s.message+")":""))).context=s,e)}if((i=o[r])===void 0)return!1;if(typeof i=="function")Hp(i,this,e);else for(o=Cl(i,s=i.length),i=0;i<s;++i)Hp(o[i],this,e);return!0},ea.prototype.addListener=function(r,e){return zl(this,r,e,!1)},ea.prototype.on=ea.prototype.addListener,ea.prototype.prependListener=function(r,e){return zl(this,r,e,!0)},ea.prototype.once=function(r,e){return ng(e),this.on(r,Al(this,r,e)),this},ea.prototype.prependOnceListener=function(r,e){return ng(e),this.prependListener(r,Al(this,r,e)),this},ea.prototype.removeListener=function(r,e){var i;ng(e);var o=this._events;if(o===void 0)return this;var s=o[r];if(s===void 0)return this;if(s===e||s.listener===e)--this._eventsCount==0?this._events=Object.create(null):(delete o[r],o.removeListener&&this.emit("removeListener",r,s.listener||e));else if(typeof s!="function"){var l=-1;for(i=s.length-1;0<=i;i--)if(s[i]===e||s[i].listener===e){var f=s[i].listener;l=i;break}if(0>l)return this;if(l===0)s.shift();else{for(;l+1<s.length;l++)s[l]=s[l+1];s.pop()}s.length===1&&(o[r]=s[0]),o.removeListener!==void 0&&this.emit("removeListener",r,f||e)}return this},ea.prototype.off=ea.prototype.removeListener,ea.prototype.removeAllListeners=function(r){var e=this._events;if(e===void 0)return this;if(e.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):e[r]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete e[r]),this;if(arguments.length===0){var i=Object.keys(e);for(e=0;e<i.length;++e){var o=i[e];o!=="removeListener"&&this.removeAllListeners(o)}return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(i=e[r])=="function")this.removeListener(r,i);else if(i!==void 0)for(e=i.length-1;0<=e;e--)this.removeListener(r,i[e]);return this},ea.prototype.listeners=function(r){return Bl(this,r,!0)},ea.prototype.rawListeners=function(r){return Bl(this,r,!1)},ea.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):Dl.call(r,e)},ea.prototype.listenerCount=Dl,ea.prototype.eventNames=function(){return 0<this._eventsCount?ux(this._events):[]},ea.once=function(r,e){return new Promise(function(i,o){function s(f){r.removeListener(e,l),o(f)}function l(){typeof r.removeListener=="function"&&r.removeListener("error",s),i([].slice.call(arguments))}El(r,e,l,{once:!0}),e!=="error"&&vs(r,s,{once:!0})})};var Qe=Object.assign,Kp=Object.defineProperty,Lp=!Qe||R(function(){if(ka&&Qe({b:1},Qe(Kp({},"a",{enumerable:!0,get:function(){Kp(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var r={},e={},i=Symbol();return r[i]=7,"abcdefghijklmnopqrst".split("").forEach(function(o){e[o]=o}),Qe({},r)[i]!=7||Dc(Qe({},e)).join("")!="abcdefghijklmnopqrst"})?function(r,e){for(var i=Qa(r),o=arguments.length,s=1,l=Bf.f,f=zf;o>s;)for(var h,d=Af(arguments[s++]),p=l?Dc(d).concat(l(d)):Dc(d),g=p.length,_=0;g>_;)h=p[_++],(!ka||f.call(d,h))&&(i[h]=d[h]);return i}:Qe;N({target:"Object",stat:!0,forced:Object.assign!==Lp},{assign:Lp}),zp("Map",function(r){return function(){return r(this,arguments.length?arguments[0]:void 0)}},Cp);var vx=Math.log,wx=Math.LN2;N({target:"Math",stat:!0},{log2:function(r){return vx(r)/wx}});var xx=Ra.f,yx=Hd.f,zx=Za.enforce,Ax=qa("match"),sc=y.RegExp,lk=sc.prototype,Wf=/a/g,mk=/a/g,nk=new sc(Wf)!==Wf;if(ka&&nc("RegExp",!nk||pc||R(function(){return mk[Ax]=!1,sc(Wf)!=Wf||sc(mk)==mk||sc(Wf,"i")!="/a/i"}))){for(var Oc=function(r,e){var i,o=this instanceof Oc,s=Lj(r),l=e===void 0;return!o&&s&&r.constructor===Oc&&l||(nk?s&&!l&&(r=r.source):r instanceof Oc&&(l&&(e=tj.call(r)),r=r.source),pc&&(i=!!e&&-1<e.indexOf("y"))&&(e=e.replace(/y/g,"")),r=lh(nk?new sc(r,e):sc(r,e),o?this:lk,Oc),pc&&i&&(zx(r).sticky=!0)),r},Bx=function(r){r in Oc||xx(Oc,r,{configurable:!0,get:function(){return sc[r]},set:function(e){sc[r]=e}})},Mp=yx(sc),Np=0;Mp.length>Np;)Bx(Mp[Np++]);lk.constructor=Oc,Oc.prototype=lk,Ta(y,"RegExp",Oc)}If("RegExp"),Sf("Float32",function(r){return function(e,i,o){return r(this,e,i,o)}}),Sf("Float64",function(r){return function(e,i,o){return r(this,e,i,o)}}),Sf("Uint32",function(r){return function(e,i,o){return r(this,e,i,o)}}),Sf("Uint16",function(r){return function(e,i,o){return r(this,e,i,o)}});var ok=function(r,e){return r===e?0:r==null?e==null?0:-1:e==null?r==null?0:1:typeof r.compare=="function"?r.compare(e):typeof e.compare=="function"?-e.compare(r):r<e?-1:r>e?1:0},pk=[],Op=pk.sort,Cx=R(function(){pk.sort(void 0)}),Dx=R(function(){pk.sort(null)}),Ex=Ee("sort");N({target:"Array",proto:!0,forced:Cx||!Dx||!Ex},{sort:function(r){return r===void 0?Op.call(Qa(this)):Op.call(Qa(this),yb(r))}});var Pp=Object.getPrototypeOf({}),Xf=function(r,e){var i;return r===e||(r==null?r==e:X(r.equiv)==="function"?r.equiv(e):e==null?r==e:X(e.equiv)==="function"?e.equiv(r):X(r)!=="string"&&X(e)!=="string"&&((i=Object.getPrototypeOf(r))!=null&&i!==Pp||(i=Object.getPrototypeOf(e))!=null&&i!==Pp?X(r)!=="function"&&r.length!==void 0&&X(e)!=="function"&&e.length!==void 0?Gx(r,e):r instanceof Set&&e instanceof Set?Hx(r,e):r instanceof Map&&e instanceof Map?Ix(r,e):r instanceof Date&&e instanceof Date?r.getTime()===e.getTime():r instanceof RegExp&&e instanceof RegExp?r.toString()===e.toString():r!=r&&e!=e:Fx(r,e)))},Gx=function(r,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xf,o=r.length;if(o===e.length)for(;0<=--o&&i(r[o],e[o]););return 0>o},Hx=function(r,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xf;return r.size===e.size&&i(G(r.keys()).sort(),G(e.keys()).sort())},Ix=function(r,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xf;return r.size===e.size&&i(G(r).sort(),G(e).sort())},Fx=function(r,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xf;if(Object.keys(r).length!==Object.keys(e).length)return!1;for(var o in r)if(!e.hasOwnProperty(o)||!i(r[o],e[o]))return!1;return!0},Qp=function(r){var e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:function(i){return i!==void 0?": "+i:""};return function(i){function o(l){return W(this,o),s.call(this,r(l)+e(l))}la(o,i);var s=ma(o);return o}(ef(Error))},Jx=Qp(function(){return"illegal argument(s)"}),vh=function(r){throw new Jx(r)},qk=Qp(function(){return"index out of bounds"}),Rp=1/4294967295,Kx=function(){function r(){W(this,r)}return Ha(r,[{key:"float",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return this.int()*Rp*e}},{key:"norm",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(this.int()*Rp-.5)*e}},{key:"minmax",value:function(e,i){return this.float()*(i-e)+e}}]),r}(),rk=Math.random,Lx=new(function(r){function e(){return W(this,e),i.apply(this,arguments)}la(e,r);var i=ma(e);return Ha(e,[{key:"int",value:function(){return 4294967296*rk()>>>0}},{key:"float",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return rk()*o}},{key:"norm",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(rk()-.5)*o}}]),e}(Kx)),Vh=Symbol(),Hl=function(){},Mx=fk.onFreeze,sk=Object.freeze,Nx=R(function(){sk(1)});N({target:"Object",stat:!0,forced:Nx,sham:!yp},{freeze:function(r){return sk&&ha(r)?sk(Mx(r)):r}});var Ox=Ee("reduce"),Px=!Hc&&79<id&&83>id;N({target:"Array",proto:!0,forced:!Ox||Px},{reduce:function(r){return Wo(this,r,arguments.length,1<arguments.length?arguments[1]:void 0)}});var Gl=function(r){return r!=null&&typeof r.xform=="function"?r.xform():r},og=function(){function r(e){W(this,r),this.value=e}return Ha(r,[{key:"deref",value:function(){return this.value}}]),r}(),Wh=function(r){return r instanceof og?r.deref():r},xs=function(r,e){return[r,function(i){return i},e]},Qx=w.mark(function(r,e){var i,o,s,l,f,h;return w.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:i=Gl(r)(ws()),o=i[1],s=i[2],l=0;case 4:if(!(l<e.length)){d.next=15;break}if(f=e[l],!((h=s([],f))instanceof og)){d.next=10;break}return d.delegateYield(Wh(o(h.deref())),"t0",9);case 9:return d.abrupt("return");case 10:if(!h.length){d.next=12;break}return d.delegateYield(h,"t1",12);case 12:l++,d.next=4;break;case 15:return d.delegateYield(Wh(o([])),"t2",16);case 16:case"end":return d.stop()}},Qx)}),ys=w.mark(Fl),zs=function(r,e){return[r[0],r[1],e]},Sp=!0;"findIndex"in[]&&Array(1).findIndex(function(){Sp=!1}),N({target:"Array",proto:!0,forced:Sp},{findIndex:function(r){return An(this,r,1<arguments.length?arguments[1]:void 0)}}),Ld("findIndex"),N({target:"Array",proto:!0},{fill:yj}),Ld("fill");var Rx=function(){function r(e){W(this,r),this._length=0,e&&this.into(e)}return Ha(r,[{key:"length",get:function(){return this._length}},{key:"copy",value:function(){return new r(this)}},{key:"empty",value:function(){return new r}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var e,i=this.head;i;)e=i.next,delete i.value,delete i.prev,delete i.next,i=e;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(e){var i=this._length;if(i<e._length)return-1;if(i>e._length)return 1;if(i===0)return 0;i=this.head,e=e.head;for(var o=0;i&&o==0;)o=ok(i.value,e.value),i=i.next,e=e.next;return o}},{key:"equiv",value:function(e){if(!(e instanceof r||e!=null&&typeof e!="function"&&e.length!==void 0)||this._length!==e.length)return!1;if(!this._length||this===e)return!0;for(var i=this.head,o=0;o<e.length;o++){if(!Xf(i.value,e[o]))return!1;i=i.next}return!0}},{key:Symbol.iterator,value:w.mark(function e(){var i;return w.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:i=this.head;case 1:if(!i){o.next=7;break}return o.next=4,i.value;case 4:i=i.next,o.next=1;break;case 7:case"end":return o.stop()}},e,this)})},{key:"seq",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;if(!(e>=i||0>e)){e=this.nthCell(e);var o=this.nthCell(i-1);return i=function s(l){return{first:function(){return l.value},next:function(){return l!==o&&l.next?s(l.next):void 0}}},e?i(e):void 0}}},{key:"cycle",value:w.mark(function e(){return w.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.delegateYield(this,"t0",2);case 2:i.next=0;break;case 4:case"end":return i.stop()}},e,this)})},{key:"$reduce",value:function(e,i){for(var o=this.head;o&&!(i instanceof og);)i=e(i,o.value),o=o.next;return i}},{key:"drop",value:function(){var e=this.head;if(e)return(this.head=e.next)?delete this.head.prev:delete this.tail,this._length--,e.value}},{key:"cons",value:function(e){return e={value:e,next:this.head},this.head?this.head.prev=e:this.tail=e,this.head=e,this._length++,this}},{key:"insertBefore",value:function(e,i){return e||vh("cell is undefined"),i={value:i,next:e,prev:e.prev},e.prev?e.prev.next=i:this.head=i,e.prev=i,this._length++,this}},{key:"insertAfter",value:function(e,i){return e||vh("cell is undefined"),i={value:i,next:e.next,prev:e},e.next?e.next.prev=i:this.tail=i,e.next=i,this._length++,this}},{key:"insertBeforeNth",value:function(e,i){if(0>e&&(e+=this._length),0>=e)return this.cons(i);if(0>e||e>=this._length)throw new qk(e);return this.insertBefore(this.nthCellUnsafe(e),i)}},{key:"insertAfterNth",value:function(e,i){if(0>e&&(e+=this._length),e>=this._length-1)return this.push(i);if(0>e||e>=this._length)throw new qk(e);return this.insertAfter(this.nthCellUnsafe(e),i)}},{key:"insertSorted",value:function(e,i){i=i||ok;for(var o=this.head;o;){if(0>=i(e,o.value))return this.insertBefore(o,e);o=o.next}return this.push(e)}},{key:"find",value:function(e){for(var i=this.head;i;){if(i.value===e)return i;i=i.next}}},{key:"findWith",value:function(e){for(var i=this.head;i;){if(e(i.value))return i;i=i.next}}},{key:"concat",value:function(){for(var e=this.copy(),i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];for(i=0;i<o.length;i++)e.into(o[i]);return e}},{key:"into",value:function(e){for(var i=0;i<e.length;i++)this.push(e[i])}},{key:"slice",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;e=0>e?e+this._length:e,i=0>i?i+this._length:i,(0>e||0>i)&&vh("invalid indices: ${from} / ${to}");for(var o=new r,s=this.nthCell(e);s&&++e<=i;)o.push(s.value),s=s.next;return o}},{key:"splice",value:function(e){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,o=2<arguments.length?arguments[2]:void 0;if(typeof e=="number"){if(0>e&&(e+=this._length),0>e||e>=this._length)throw new qk(e);var s=this.nthCellUnsafe(e)}else s=e;var l=new r;if(0<i)for(;s&&0<i--;)this.remove(s),l.push(s.value),s=s.next;else s&&(s=s.next);if(o)if(s)for(i=0;i<o.length;i++)this.insertBefore(s,o[i]);else for(s=0;s<o.length;s++)this.push(o[s]);return l}},{key:"remove",value:function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,this._length--,this}},{key:"swap",value:function(e,i){if(e!==i){var o=e.value;e.value=i.value,i.value=o}return this}},{key:"push",value:function(e){return this.tail?(e={value:e,prev:this.tail},this.tail=this.tail.next=e,this._length++,this):this.cons(e)}},{key:"pop",value:function(){var e=this.tail;if(e)return(this.tail=e.prev)?delete this.tail.next:delete this.head,this._length--,e.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(e){return this.head?(this.head.value=e,this):this.cons(e)}},{key:"setTail",value:function(e){return this.tail?(this.tail.value=e,this):this.push(e)}},{key:"setNth",value:function(e,i){var o=this.nthCell(e);return!o&&vh("index out of bounds: ".concat(e)),o.value=i,this}},{key:"nth",value:function(e,i){return(e=this.nthCell(e))?e.value:i}},{key:"nthCell",value:function(e){if(0>e&&(e+=this._length),!(0>e||e>=this._length))return this.nthCellUnsafe(e)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var e=this.peek();return this.pop(),this.cons(e)}}},{key:"map",value:function(e){for(var i=new r,o=this.head;o;)i.push(e(o.value)),o=o.next;return i}},{key:"filter",value:function(e){for(var i=new r,o=this.head;o;)e(o.value)&&i.push(o.value),o=o.next;return i}},{key:"reduce",value:function(e,i){for(var o=this.head;o;)i=e(i,o.value),o=o.next;return i}},{key:"shuffle",value:function(e){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:Lx;if(2>this._length)return this;for(e=e??Math.ceil(1.5*Math.log2(this._length));0<e;e--)for(var o=this.head;o;){var s=o.next;.5>i.float()?this.asHead(o):this.asTail(o),o=s}return this}},{key:"sort",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:ok;if(!this._length)return this;for(var i=1;;){var o=this.head;this.tail=this.head=void 0;for(var s=0;o;){s++;for(var l=o,f=0,h=0;h<i&&(f++,l=l.next);h++);for(h=i;0<f||0<h&&l;){if(f===0){var d=l;l=l.next,h--}else l&&h!==0?0>=e(o.value,l.value)?(d=o,o=o.next,f--):(d=l,l=l.next,h--):(d=o,o=o.next,f--);this.tail?this.tail.next=d:this.head=d,d.prev=this.tail,this.tail=d}o=l}if(this.tail.next=void 0,1>=s)return this;i*=2}}},{key:"reverse",value:function(){for(var e=this.head,i=this.tail,o=(this._length>>>1)+(1&this._length);e&&i&&0<o;){var s=e.value;e.value=i.value,i.value=s,e=e.next,i=i.prev,o--}return this}},{key:"asHead",value:function(e){return e===this.head||(this.remove(e),this.head.prev=e,e.next=this.head,e.prev=void 0,this.head=e,this._length++),this}},{key:"asTail",value:function(e){return e===this.tail||(this.remove(e),this.tail.next=e,e.prev=this.tail,e.next=void 0,this.tail=e,this._length++),this}},{key:"toString",value:function(){for(var e=[],i=this.head;i;)e.push(String(i.value)),i=i.next;return e.join(", ")}},{key:"toJSON",value:function(){return G(this)}},{key:"nthCellUnsafe",value:function(e){if(e<=this._length>>1)var i=this.head,o="next";else i=this.tail,o="prev",e=this._length-e-1;for(;0<e--&&i;)i=i[o];return i}}]),r}(),tc=function(){function r(e,i){W(this,r),i=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},i),this.map=i.map(),this.items=new Rx,this._size=0,this.opts=i,e&&this.into(e)}return Ha(r,[{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return pg(function(e){return[e.k,e]},this.items)}},{key:"keys",value:function(){return pg(function(e){return e.k},this.items)}},{key:"values",value:function(){return pg(function(e){return e.v},this.items)}},{key:"copy",value:function(){var e=this.empty();e.items=this.items.copy();for(var i=e.items.head;i;)e.map.set(i.value.k,i),i=i.next;return e}},{key:"empty",value:function(){return new r(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var e=this.opts.release;if(e){for(var i;i=this.items.drop();)e(i.k,i.v);return!0}return this.items.release()}},{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e,i){return(e=this.map.get(e))?this.resetEntry(e):i}},{key:"set",value:function(e,i){var o=this.opts.ksize(e)+this.opts.vsize(i),s=this.map.get(e);return this._size+=Math.max(0,o-(s?s.value.s:0)),this.ensureSize()&&this.doSetEntry(s,e,i,o),i}},{key:"into",value:function(e){for(var i=0;i<e.length;i++){var o=e[i];this.set(o[0],o[1])}return this}},{key:"getSet",value:function(e,i){var o=this,s=this.map.get(e);return s?Promise.resolve(this.resetEntry(s)):i().then(function(l){return o.set(e,l)})}},{key:"delete",value:function(e){return!!(e=this.map.get(e))&&(this.removeEntry(e),!0)}},{key:"resetEntry",value:function(e){return this.items.asTail(e),e.value.v}},{key:"ensureSize",value:function(){for(var e=this.opts.release,i=this.opts.maxsize,o=this.opts.maxlen;this._size>i||this.length>=o;){var s=this.items.drop();if(!s)return!1;this.map.delete(s.k),e&&e(s.k,s.v),this._size-=s.s}return!0}},{key:"removeEntry",value:function(e){var i=e.value;this.map.delete(i.k),this.items.remove(e),this.opts.release&&this.opts.release(i.k,i.v),this._size-=i.s}},{key:"doSetEntry",value:function(e,i,o,s){e?(e.value.v=o,e.value.s=s,this.items.asTail(e)):(this.items.push({k:i,v:o,s}),this.map.set(i,this.items.tail))}}]),r}(),Sx=function(r){function e(o,s){return W(this,e),s=Object.assign({ttl:36e5},s),i.call(this,o,s)}la(e,r);var i=ma(e);return Ha(e,[{key:"empty",value:function(){return new e(null,this.opts)}},{key:"has",value:function(o){return this.get(o)!==void 0}},{key:"get",value:function(o,s){if(o=this.map.get(o)){if(o.value.t>=Date.now())return this.resetEntry(o);this.removeEntry(o)}return s}},{key:"set",value:function(o,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,f=this.opts.ksize(o)+this.opts.vsize(s),h=this.map.get(o);return this._size+=Math.max(0,f-(h?h.value.s:0)),this.ensureSize()&&(l=Date.now()+l,h?(h.value.v=s,h.value.s=f,h.value.t=l,this.items.asTail(h)):(this.items.push({k:o,v:s,s:f,t:l}),this.map.set(o,this.items.tail))),s}},{key:"getSet",value:function(o,s){var l=this,f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,h=this.get(o);return h?Promise.resolve(h):s().then(function(d){return l.set(o,d,f)})}},{key:"prune",value:function(){for(var o=Date.now(),s=this.items.head;s;)s.value.t<o&&this.removeEntry(s),s=s.next}},{key:"ensureSize",value:function(){for(var o=this.opts.maxsize,s=this.opts.maxlen,l=Date.now(),f=this.items.head;f&&(this._size>o||this.length>=s);)f.value.t<l&&this.removeEntry(f),f=f.next;return Th(wd(e.prototype),"ensureSize",this).call(this)}}]),e}(tc),Tp=X(Ya)=="object"&&Ya&&Ya.Object===Object&&Ya,Tx=(typeof self>"u"?"undefined":X(self))=="object"&&self&&self.Object===Object&&self,Cb=Tp||Tx||Function("return this")(),Pb=Cb.Symbol,Up=Object.prototype,Ux=Up.hasOwnProperty,Vx=Up.toString,Yf=Pb?Pb.toStringTag:void 0,Wx=Object.prototype.toString,Vp=Pb?Pb.toStringTag:void 0,Qd=function(r){if(r==null)r=r===void 0?"[object Undefined]":"[object Null]";else if(Vp&&Vp in Object(r)){var e=Ux.call(r,Yf),i=r[Yf];try{r[Yf]=void 0;var o=!0}catch{}var s=Vx.call(r);o&&(e?r[Yf]=i:delete r[Yf]),r=s}else r=Wx.call(r);return r},lb=function(r){var e=X(r);return r!=null&&(e=="object"||e=="function")},qi=function(r){return!!lb(r)&&((r=Qd(r))=="[object Function]"||r=="[object GeneratorFunction]"||r=="[object AsyncFunction]"||r=="[object Proxy]")},tk=Cb["__core-js_shared__"],Wp=function(){var r=/[^.]+$/.exec(tk&&tk.keys&&tk.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Xx=Function.prototype.toString,Rd=function(r){if(r!=null){try{return Xx.call(r)}catch{}return r+""}return""},Yx=/^\[object .+?Constructor\]$/,Zx=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sd=function(r,e){return r=r==null?void 0:r[e],!lb(r)||Wp&&Wp in r||!(qi(r)?Zx:Yx).test(Rd(r))?void 0:r},Zf=Sd(Object,"create"),$x=Object.prototype.hasOwnProperty,ay=Object.prototype.hasOwnProperty;zd.prototype.clear=function(){this.__data__=Zf?Zf(null):{},this.size=0},zd.prototype.delete=function(r){return r=this.has(r)&&delete this.__data__[r],this.size-=r?1:0,r},zd.prototype.get=function(r){var e=this.__data__;return Zf?(r=e[r])==="__lodash_hash_undefined__"?void 0:r:$x.call(e,r)?e[r]:void 0},zd.prototype.has=function(r){var e=this.__data__;return Zf?e[r]!==void 0:ay.call(e,r)},zd.prototype.set=function(r,e){var i=this.__data__;return this.size+=this.has(r)?0:1,i[r]=Zf&&e===void 0?"__lodash_hash_undefined__":e,this};var $f=function(r,e){return r===e||r!=r&&e!=e},wh=function(r,e){for(var i=r.length;i--;)if($f(r[i][0],e))return i;return-1},by=Array.prototype.splice;ce.prototype.clear=function(){this.__data__=[],this.size=0},ce.prototype.delete=function(r){var e=this.__data__;return!(0>(r=wh(e,r)))&&(r==e.length-1?e.pop():by.call(e,r,1),--this.size,!0)},ce.prototype.get=function(r){var e=this.__data__;return 0>(r=wh(e,r))?void 0:e[r][1]},ce.prototype.has=function(r){return-1<wh(this.__data__,r)},ce.prototype.set=function(r,e){var i=this.__data__,o=wh(i,r);return 0>o?(++this.size,i.push([r,e])):i[o][1]=e,this};var rg=ce,ag=Sd(Cb,"Map"),xh=function(r,e){r=r.__data__;var i=X(e);return(i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null)?r[typeof e=="string"?"string":"hash"]:r.map};de.prototype.clear=function(){this.size=0,this.__data__={hash:new zd,map:new(ag||rg),string:new zd}},de.prototype.delete=function(r){return r=xh(this,r).delete(r),this.size-=r?1:0,r},de.prototype.get=function(r){return xh(this,r).get(r)},de.prototype.has=function(r){return xh(this,r).has(r)},de.prototype.set=function(r,e){var i=xh(this,r),o=i.size;return i.set(r,e),this.size+=i.size==o?0:1,this};var qg=de;gf.prototype.add=gf.prototype.push=function(r){return this.__data__.set(r,"__lodash_hash_undefined__"),this},gf.prototype.has=function(r){return this.__data__.has(r)};var Xp=function(r,e,i,o){var s=r.length;for(i+=-1;++i<s;)if(e(r[i],i,r))return i;return-1},cy=function(r){return r!=r},dy=function(r,e){var i;if(i=!(r==null||!r.length)){if(e==e)e:{i=-1;for(var o=r.length;++i<o;)if(r[i]===e){r=i;break e}r=-1}else r=Xp(r,cy,0);i=-1<r}return i},ey=function(r,e,i){for(var o=-1,s=r==null?0:r.length;++o<s;)if(i(e,r[o]))return!0;return!1},fy=function(r,e){return r.has(e)},Re=Sd(Cb,"Set"),gy=function(){},uk=function(r){var e=-1,i=Array(r.size);return r.forEach(function(o){i[++e]=o}),i},hy=1/0,iy=Re&&1/uk(new Re([,-0]))[1]==hy?function(r){return new Re(r)}:gy,vk=function(r,e,i){var o=-1,s=dy,l=r.length,f=!0,h=[],d=h;if(i)f=!1,s=ey;else if(200<=l){if(s=iy(r))return uk(s);f=!1,s=fy,d=new gf}else d=h;e:for(;++o<l;){var p=r[o],g=p;if(p=i||p!==0?p:0,f&&g==g){for(var _=d.length;_--;)if(d[_]===g)continue e;h.push(p)}else s(d,g,i)||(d!==h&&d.push(g),h.push(p))}return h},Yp=function(r){for(var e=-1,i=r==null?0:r.length,o={};++e<i;){var s=r[e];o[s[0]]=s[1]}return o},he=function(r,e){for(var i=-1,o=r==null?0:r.length,s=Array(o);++i<o;)s[i]=e(r[i],i,r);return s};ee.prototype.clear=function(){this.__data__=new rg,this.size=0},ee.prototype.delete=function(r){var e=this.__data__;return r=e.delete(r),this.size=e.size,r},ee.prototype.get=function(r){return this.__data__.get(r)},ee.prototype.has=function(r){return this.__data__.has(r)},ee.prototype.set=function(r,e){var i=this.__data__;if(i instanceof rg){var o=i.__data__;if(!ag||199>o.length)return o.push([r,e]),this.size=++i.size,this;i=this.__data__=new qg(o)}return i.set(r,e),this.size=i.size,this};var ge=ee,Is=function(r,e){for(var i=-1,o=r==null?0:r.length;++i<o&&e(r[i],i,r)!==!1;);return r},yh=function(){try{var r=Sd(Object,"defineProperty");return r({},"",{}),r}catch{}}(),bg=function(r,e,i){e=="__proto__"&&yh?yh(r,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[e]=i},jy=Object.prototype.hasOwnProperty,Ml=function(r,e,i){var o=r[e];jy.call(r,e)&&$f(o,i)&&(i!==void 0||e in r)||bg(r,e,i)},re=function(r,e,i,o){var s=!i;i||(i={});for(var l=-1,f=e.length;++l<f;){var h=e[l],d=void 0;d===void 0&&(d=r[h]),s?bg(i,h,d):Ml(i,h,d)}return i},gc=function(r){return r!=null&&X(r)=="object"},Zp=function(r){return gc(r)&&Qd(r)=="[object Arguments]"},$p=Object.prototype,ky=$p.hasOwnProperty,ly=$p.propertyIsEnumerable,rf=Zp(function(){return arguments}())?Zp:function(r){return gc(r)&&ky.call(r,"callee")&&!ly.call(r,"callee")},Va=Array.isArray,my=function(){return!1},jf=$a(function(r,e){var i=(e=e&&!e.nodeType&&e)&&r&&!r.nodeType&&r;e=i&&i.exports===e?Cb.Buffer:void 0,r.exports=(e?e.isBuffer:void 0)||my}),ny=/^(?:0|[1-9]\d*)$/,wk=function(r,e){var i=X(r);return!!(e=e??9007199254740991)&&(i=="number"||i!="symbol"&&ny.test(r))&&-1<r&&r%1==0&&r<e},xk=function(r){return typeof r=="number"&&-1<r&&r%1==0&&9007199254740991>=r},Ea={};Ea["[object Float32Array]"]=Ea["[object Float64Array]"]=Ea["[object Int8Array]"]=Ea["[object Int16Array]"]=Ea["[object Int32Array]"]=Ea["[object Uint8Array]"]=Ea["[object Uint8ClampedArray]"]=Ea["[object Uint16Array]"]=Ea["[object Uint32Array]"]=!0,Ea["[object Arguments]"]=Ea["[object Array]"]=Ea["[object ArrayBuffer]"]=Ea["[object Boolean]"]=Ea["[object DataView]"]=Ea["[object Date]"]=Ea["[object Error]"]=Ea["[object Function]"]=Ea["[object Map]"]=Ea["[object Number]"]=Ea["[object Object]"]=Ea["[object RegExp]"]=Ea["[object Set]"]=Ea["[object String]"]=Ea["[object WeakMap]"]=!1;var oy=function(r){return gc(r)&&xk(r.length)&&!!Ea[Qd(r)]},zh=function(r){return function(e){return r(e)}},Se=$a(function(r,e){var i=e&&!e.nodeType&&e;i=(e=i&&r&&!r.nodeType&&r)&&e.exports===i&&Tp.process;e:{try{var o=e&&e.require&&e.require("util").types;if(o){var s=o;break e}s=i&&i.binding&&i.binding("util");break e}catch{}s=void 0}r.exports=s}),aq=Se&&Se.isTypedArray,bi=aq?zh(aq):oy,py=Object.prototype.hasOwnProperty,bq=function(r,e){var i=Va(r),o=!i&&rf(r),s=!i&&!o&&jf(r),l=!i&&!o&&!s&&bi(r);if(i=i||o||s||l){o=r.length;for(var f=String,h=-1,d=Array(o);++h<o;)d[h]=f(h);o=d}else o=[];for(var p in f=o.length,r)!e&&!py.call(r,p)||i&&(p=="length"||s&&(p=="offset"||p=="parent")||l&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||wk(p,f))||o.push(p);return o},qy=Object.prototype,yk=function(r){var e=r&&r.constructor;return r===(typeof e=="function"&&e.prototype||qy)},cq=function(r,e){return function(i){return r(e(i))}},ry=cq(Object.keys,Object),sy=Object.prototype.hasOwnProperty,Ed=function(r){return r!=null&&xk(r.length)&&!qi(r)},Ad=function(r){if(Ed(r))r=bq(r);else if(yk(r)){var e,i=[];for(e in Object(r))sy.call(r,e)&&e!="constructor"&&i.push(e);r=i}else r=ry(r);return r},Es=function(r,e){return r&&re(e,Ad(e),r)},ty=Object.prototype.hasOwnProperty,kf=function(r){if(Ed(r))r=bq(r,!0);else if(lb(r)){var e=yk(r),i=[];for(o in r)(o!="constructor"||!e&&ty.call(r,o))&&i.push(o);r=i}else{var o=[];if(r!=null)for(e in Object(r))o.push(e);r=o}return r},Cs=function(r,e){return r&&re(e,kf(e),r)},Jl=$a(function(r,e){var i=(e=e&&!e.nodeType&&e)&&r&&!r.nodeType&&r,o=(e=i&&i.exports===e?Cb.Buffer:void 0)?e.allocUnsafe:void 0;r.exports=function(s,l){return l?s.slice():(l=s.length,l=o?o(l):new s.constructor(l),s.copy(l),l)}}),Xh=function(r,e){var i=-1,o=r.length;for(e||(e=Array(o));++i<o;)e[i]=r[i];return e},uy=function(r,e){for(var i=-1,o=r==null?0:r.length,s=0,l=[];++i<o;){var f=r[i];e(f,i,r)&&(l[s++]=f)}return l},dq=function(){return[]},vy=Object.prototype.propertyIsEnumerable,eq=Object.getOwnPropertySymbols,zk=eq?function(r){return r==null?[]:(r=Object(r),uy(eq(r),function(e){return vy.call(r,e)}))}:dq,Ds=function(r,e){return re(r,zk(r),e)},ai=function(r,e){for(var i=-1,o=e.length,s=r.length;++i<o;)r[s+i]=e[i];return r},Ak=cq(Object.getPrototypeOf,Object),fq=Object.getOwnPropertySymbols?function(r){for(var e=[];r;)ai(e,zk(r)),r=Ak(r);return e}:dq,Bs=function(r,e){return re(r,fq(r),e)},gq=function(r,e,i){return e=e(r),Va(r)?e:ai(e,i(r))},Yh=function(r){return gq(r,Ad,zk)},Ll=function(r){return gq(r,kf,fq)},Bk=Sd(Cb,"DataView"),Ck=Sd(Cb,"Promise"),Dk=Sd(Cb,"WeakMap"),wy=Rd(Bk),xy=Rd(ag),yy=Rd(Ck),zy=Rd(Re),Ay=Rd(Dk),Td=Qd;(Bk&&Td(new Bk(new ArrayBuffer(1)))!="[object DataView]"||ag&&Td(new ag)!="[object Map]"||Ck&&Td(Ck.resolve())!="[object Promise]"||Re&&Td(new Re)!="[object Set]"||Dk&&Td(new Dk)!="[object WeakMap]")&&(Td=function(r){var e=Qd(r);if(r=(r=e=="[object Object]"?r.constructor:void 0)?Rd(r):"")switch(r){case wy:return"[object DataView]";case xy:return"[object Map]";case yy:return"[object Promise]";case zy:return"[object Set]";case Ay:return"[object WeakMap]"}return e});var hf=Td,By=Object.prototype.hasOwnProperty,As=function(r){var e=r.length,i=new r.constructor(e);return e&&typeof r[0]=="string"&&By.call(r,"index")&&(i.index=r.index,i.input=r.input),i},Ah=Cb.Uint8Array,Ek=function(r){var e=new r.constructor(r.byteLength);return new Ah(e).set(new Ah(r)),e},Cy=/\w*$/,hq=Pb?Pb.prototype:void 0,iq=hq?hq.valueOf:void 0,vm=function(r,e){return e=e?Ek(r.buffer):r.buffer,new r.constructor(e,r.byteOffset,r.length)},Fs=function(r,e,i){var o=r.constructor;switch(e){case"[object ArrayBuffer]":return Ek(r);case"[object Boolean]":case"[object Date]":return new o(+r);case"[object DataView]":return e=i?Ek(r.buffer):r.buffer,new r.constructor(e,r.byteOffset,r.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return vm(r,i);case"[object Map]":return new o;case"[object Number]":case"[object String]":return new o(r);case"[object RegExp]":return(e=new r.constructor(r.source,Cy.exec(r))).lastIndex=r.lastIndex,e;case"[object Set]":return new o;case"[object Symbol]":return iq?Object(iq.call(r)):{}}},jq=Object.create,Dy=function(){function r(){}return function(e){return lb(e)?jq?jq(e):(r.prototype=e,e=new r,r.prototype=void 0,e):{}}}(),Kl=function(r){return typeof r.constructor!="function"||yk(r)?{}:Dy(Ak(r))},Ey=function(r){return gc(r)&&hf(r)=="[object Map]"},kq=Se&&Se.isMap,Hs=kq?zh(kq):Ey,Fy=function(r){return gc(r)&&hf(r)=="[object Set]"},lq=Se&&Se.isSet,Gs=lq?zh(lq):Fy,wa={};wa["[object Arguments]"]=wa["[object Array]"]=wa["[object ArrayBuffer]"]=wa["[object DataView]"]=wa["[object Boolean]"]=wa["[object Date]"]=wa["[object Float32Array]"]=wa["[object Float64Array]"]=wa["[object Int8Array]"]=wa["[object Int16Array]"]=wa["[object Int32Array]"]=wa["[object Map]"]=wa["[object Number]"]=wa["[object Object]"]=wa["[object RegExp]"]=wa["[object Set]"]=wa["[object String]"]=wa["[object Symbol]"]=wa["[object Uint8Array]"]=wa["[object Uint8ClampedArray]"]=wa["[object Uint16Array]"]=wa["[object Uint32Array]"]=!0,wa["[object Error]"]=wa["[object Function]"]=wa["[object WeakMap]"]=!1;var ie=function(r){return X(r)=="symbol"||gc(r)&&Qd(r)=="[object Symbol]"},Gy=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Hy=/^\w*$/,Fk=function(r,e){if(Va(r))return!1;var i=X(r);return!(i!="number"&&i!="symbol"&&i!="boolean"&&r!=null&&!ie(r))||Hy.test(r)||!Gy.test(r)||e!=null&&r in Object(e)};Zh.Cache=qg;var Iy=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Jy=/\\(\\)?/g,Ky=function(r){var e=(r=Zh(r,function(i){return e.size===500&&e.clear(),i})).cache;return r}(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(Iy,function(i,o,s,l){e.push(s?l.replace(Jy,"$1"):o||i)}),e}),mq=Pb?Pb.prototype:void 0,Ol=mq?mq.toString:void 0,Bh=function(r,e){return Va(r)?r:Fk(r,e)?[r]:Ky(r==null?"":Nl(r))},cg=function(r){if(typeof r=="string"||ie(r))return r;var e=r+"";return e=="0"&&1/r==-1/0?"-0":e},Ch=function(r,e){for(var i=0,o=(e=Bh(e,r)).length;r!=null&&i<o;)r=r[cg(e[i++])];return i&&i==o?r:void 0},My=function(r,e){if(!(2>(e=Bh(e,r)).length)){var i=e,o=0,s=-1,l=-1,f=i.length;for(0>o&&(o=-o>f?0:f+o),0>(s=s>f?f:s)&&(s+=f),f=o>s?0:s-o>>>0,o>>>=0,s=Array(f);++l<f;)s[l]=i[l+o];r=Ch(r,s)}return(i=r==null)||(i=e==null?0:e.length,i=delete r[cg(i?e[i-1]:void 0)]),i},nq=Function.prototype.toString,Ny=Object.prototype.hasOwnProperty,Oy=nq.call(Object),wm=function(r){return!(!gc(r)||Qd(r)!="[object Object]")&&((r=Ak(r))===null||typeof(r=Ny.call(r,"constructor")&&r.constructor)=="function"&&r instanceof r&&nq.call(r)==Oy)},Py=function(r){return wm(r)?void 0:r},oq=Pb?Pb.isConcatSpreadable:void 0,Ks=function(r){return Va(r)||rf(r)||!!(oq&&r&&r[oq])},Qy=function(r){return r!=null&&r.length?$h(r):[]},Ry=function(r,e,i){switch(i.length){case 0:return r.call(e);case 1:return r.call(e,i[0]);case 2:return r.call(e,i[0],i[1]);case 3:return r.call(e,i[0],i[1],i[2])}return r.apply(e,i)},pq=Math.max,qq=function(r,e,i){return e=pq(e===void 0?r.length-1:e,0),function(){for(var o=arguments,s=-1,l=pq(o.length-e,0),f=Array(l);++s<l;)f[s]=o[e+s];for(s=-1,l=Array(e+1);++s<e;)l[s]=o[s];return l[e]=i(f),Ry(r,this,l)}},Sy=function(r){return function(){return r}},Dh=function(r){return r},Ty=Date.now,rq=function(r){var e=0,i=0;return function(){var o=Ty(),s=16-(o-i);if(i=o,0<s){if(800<=++e)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}(yh?function(r,e){return yh(r,"toString",{configurable:!0,enumerable:!1,value:Sy(e),writable:!0})}:Dh),Gk=function(r){return rq(qq(r,void 0,Qy),r+"")}(function(r,e){var i={};if(r==null)return i;var o=!1;e=he(e,function(l){return l=Bh(l,r),o||(o=1<l.length),l}),re(r,Ll(r),i),o&&(i=fe(i,7,Py));for(var s=e.length;s--;)My(i,e[s]);return i}),Uy=function(r,e,i,o){for(var s=-1,l=r==null?0:r.length;++s<l;){var f=r[s];e(o,f,i(f),r)}return o},um=function(r,e,i){for(var o=-1,s=Object(r),l=(i=i(r)).length;l--;){var f=i[++o];if(e(s[f],f,s)===!1)break}return r},sq=function(r,e){return r&&um(r,e,Ad)},Hk=function(r,e){return function(i,o){if(i==null)return i;if(!Ed(i))return r(i,o);for(var s=i.length,l=-1,f=Object(i);++l<s&&o(f[l],l,f)!==!1;);return i}}(sq),Vy=function(r,e,i,o){return Hk(r,function(s,l,f){e(o,s,i(s),f)}),o},tq=function(r,e){for(var i=-1,o=r==null?0:r.length;++i<o;)if(e(r[i],i,r))return!0;return!1},Pl=function(r,e,i,o,s,l){var f=1&i,h=r.length,d=e.length;if(h!=d&&!(f&&d>h))return!1;d=l.get(r);var p=l.get(e);if(d&&p)return d==e&&p==r;d=-1,p=!0;var g=2&i?new gf:void 0;for(l.set(r,e),l.set(e,r);++d<h;){var _=r[d],b=e[d];if(o)var x=f?o(b,_,d,e,r,l):o(_,b,d,r,e,l);if(x!==void 0){if(x)continue;p=!1;break}if(g){if(!tq(e,function(A,k){if(!g.has(k)&&(_===A||s(_,A,i,o,l)))return g.push(k)})){p=!1;break}}else if(_!==b&&!s(_,b,i,o,l)){p=!1;break}}return l.delete(r),l.delete(e),p},Wy=function(r){var e=-1,i=Array(r.size);return r.forEach(function(o,s){i[++e]=[s,o]}),i},uq=Pb?Pb.prototype:void 0,Ik=uq?uq.valueOf:void 0,Ls=function(r,e,i,o,s,l,f){switch(i){case"[object DataView]":if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)break;r=r.buffer,e=e.buffer;case"[object ArrayBuffer]":if(r.byteLength!=e.byteLength||!l(new Ah(r),new Ah(e)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return $f(+r,+e);case"[object Error]":return r.name==e.name&&r.message==e.message;case"[object RegExp]":case"[object String]":return r==e+"";case"[object Map]":var h=Wy;case"[object Set]":if(h||(h=uk),r.size!=e.size&&!(1&o))break;return(i=f.get(r))?i==e:(o|=2,f.set(r,e),e=Pl(h(r),h(e),o,s,l,f),f.delete(r),e);case"[object Symbol]":if(Ik)return Ik.call(r)==Ik.call(e)}return!1},Ms=Object.prototype.hasOwnProperty,Ql=Object.prototype.hasOwnProperty,Xy=function(r,e,i,o){var s=i.length,l=s;if(r==null)return!l;for(r=Object(r);s--;){var f=i[s];if(f[2]?f[1]!==r[f[0]]:!(f[0]in r))return!1}for(;++s<l;){var h=(f=i[s])[0],d=r[h],p=f[1];if(f[2]){if(d===void 0&&!(h in r))return!1}else{var g;if(f=new ge,g===void 0?!je(p,d,3,o,f):!g)return!1}}return!0},Yy=function(r){for(var e=Ad(r),i=e.length;i--;){var o=e[i],s=r[o];e[i]=[o,s,s==s&&!lb(s)]}return e},vq=function(r,e){return function(i){return i!=null&&i[r]===e&&(e!==void 0||r in Object(i))}},Zy=function(r){var e=Yy(r);return e.length==1&&e[0][2]?vq(e[0][0],e[0][1]):function(i){return i===r||Xy(i,r,e)}},$y=function(r,e){return Fk(r)&&e==e&&!lb(e)?vq(cg(r),e):function(i){var o=i==null?void 0:Ch(i,r);if((o=o===void 0?void 0:o)===void 0&&o===e){if(o=i!=null){for(var s=-1,l=(o=Bh(o=r,i)).length,f=!1;++s<l;){var h=cg(o[s]);if(!(f=i!=null&&i!=null&&h in Object(i)))break;i=i[h]}f||++s!=l?o=f:o=!!(l=i==null?0:i.length)&&xk(l)&&wk(h,l)&&(Va(i)||rf(i))}h=o}else h=je(e,o,3);return h}},az=function(r){return function(e){return e==null?void 0:e[r]}},bz=function(r){return function(e){return Ch(e,r)}},Te=function(r){return typeof r=="function"?r:r==null?Dh:X(r)=="object"?Va(r)?$y(r[0],r[1]):Zy(r):Fk(r)?az(cg(r)):bz(r)},Jk=function(r,e){return function(i,o){var s={};return(Va(i)?Uy:Vy)(i,r,Te(o),s)}}(function(r,e,i){bg(r,i,e)}),uc=function(r,e){var i={};return e=Te(e),sq(r,function(o,s,l){bg(i,s,e(o,s,l))}),i};N({target:"String",proto:!0,forced:R(function(){var r="".sub('"');return r!==r.toLowerCase()||3<r.split('"').length})},{sub:function(){return"<sub>"+String(jb(this))+"</sub>"}});var U=xa,Qb=null;try{Qb=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}xa.prototype.__isLong__,Object.defineProperty(xa.prototype,"__isLong__",{value:!0}),xa.isLong=mb;var Sl={},Rl={};xa.fromInt=Bd,xa.fromNumber=Gb,xa.fromBits=ya;var sg=Math.pow;xa.fromString=ci,xa.fromValue=Wb;var ke=4294967296,Tl=ke*ke,Vl=Tl/2,wq=Bd(16777216),Hb=Bd(0);xa.ZERO=Hb;var Cd=Bd(0,!0);xa.UZERO=Cd;var Ue=Bd(1);xa.ONE=Ue;var xq=Bd(1,!0);xa.UONE=xq;var Kk=Bd(-1);xa.NEG_ONE=Kk;var Wl=ya(-1,2147483647,!1);xa.MAX_VALUE=Wl;var Ul=ya(-1,-1,!0);xa.MAX_UNSIGNED_VALUE=Ul;var nb=ya(0,-2147483648,!1);xa.MIN_VALUE=nb;var D=xa.prototype;D.toInt=function(){return this.unsigned?this.low>>>0:this.low},D.toNumber=function(){return this.unsigned?(this.high>>>0)*ke+(this.low>>>0):this.high*ke+(this.low>>>0)},D.toString=function(r){if(2>(r=r||10)||36<r)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(nb)){var e=Gb(r),i=this.div(e);return e=i.mul(e).sub(this),i.toString(r)+e.toInt().toString(r)}return"-"+this.neg().toString(r)}i=Gb(sg(r,6),this.unsigned),e=this;for(var o="";;){var s=e.div(i),l=(e.sub(s.mul(i)).toInt()>>>0).toString(r);if((e=s).isZero())return l+o;for(;6>l.length;)l="0"+l;o=""+l+o}},D.getHighBits=function(){return this.high},D.getHighBitsUnsigned=function(){return this.high>>>0},D.getLowBits=function(){return this.low},D.getLowBitsUnsigned=function(){return this.low>>>0},D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(nb)?64:this.neg().getNumBitsAbs();for(var r=this.high!=0?this.high:this.low,e=31;0<e&&(r&1<<e)==0;e--);return this.high!=0?e+33:e+1},D.isZero=function(){return this.high===0&&this.low===0},D.eqz=D.isZero,D.isNegative=function(){return!this.unsigned&&0>this.high},D.isPositive=function(){return this.unsigned||0<=this.high},D.isOdd=function(){return(1&this.low)==1},D.isEven=function(){return(1&this.low)==0},D.equals=function(r){return mb(r)||(r=Wb(r)),(this.unsigned===r.unsigned||this.high>>>31!=1||r.high>>>31!=1)&&this.high===r.high&&this.low===r.low},D.eq=D.equals,D.notEquals=function(r){return!this.eq(r)},D.neq=D.notEquals,D.ne=D.notEquals,D.lessThan=function(r){return 0>this.comp(r)},D.lt=D.lessThan,D.lessThanOrEqual=function(r){return 0>=this.comp(r)},D.lte=D.lessThanOrEqual,D.le=D.lessThanOrEqual,D.greaterThan=function(r){return 0<this.comp(r)},D.gt=D.greaterThan,D.greaterThanOrEqual=function(r){return 0<=this.comp(r)},D.gte=D.greaterThanOrEqual,D.ge=D.greaterThanOrEqual,D.compare=function(r){if(mb(r)||(r=Wb(r)),this.eq(r))return 0;var e=this.isNegative(),i=r.isNegative();return e&&!i?-1:!e&&i?1:this.unsigned?r.high>>>0>this.high>>>0||r.high===this.high&&r.low>>>0>this.low>>>0?-1:1:this.sub(r).isNegative()?-1:1},D.comp=D.compare,D.negate=function(){return!this.unsigned&&this.eq(nb)?nb:this.not().add(Ue)},D.neg=D.negate,D.add=function(r){mb(r)||(r=Wb(r));var e=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=r.high>>>16,l=65535&r.high,f=r.low>>>16;return o=(f=((r=(65535&this.low)+(65535&r.low))>>>16)+(o+f))>>>16,ya((65535&f)<<16|65535&r,(e=((o+=i+l)>>>16)+(e+s)&65535)<<16|65535&o,this.unsigned)},D.subtract=function(r){return mb(r)||(r=Wb(r)),this.add(r.neg())},D.sub=D.subtract,D.multiply=function(r){if(this.isZero())return Hb;if(mb(r)||(r=Wb(r)),Qb){var e=Qb.mul(this.low,this.high,r.low,r.high);return ya(e,Qb.get_high(),this.unsigned)}if(r.isZero())return Hb;if(this.eq(nb))return r.isOdd()?nb:Hb;if(r.eq(nb))return this.isOdd()?nb:Hb;if(this.isNegative())return r.isNegative()?this.neg().mul(r.neg()):this.neg().mul(r).neg();if(r.isNegative())return this.mul(r.neg()).neg();if(this.lt(wq)&&r.lt(wq))return Gb(this.toNumber()*r.toNumber(),this.unsigned);e=this.high>>>16;var i=65535&this.high,o=this.low>>>16,s=65535&this.low,l=r.high>>>16,f=65535&r.high,h=r.low>>>16,d=s*(r=65535&r.low),p=(d>>>16)+o*r,g=p>>>16;g+=(p=(65535&p)+s*h)>>>16;var _=(g+=i*r)>>>16;return ya((65535&p)<<16|65535&d,(_=(_+=(g=(65535&g)+o*h)>>>16)+((g=(65535&g)+s*f)>>>16)+(e*r+i*h+o*f+s*l)&65535)<<16|65535&g,this.unsigned)},D.mul=D.multiply,D.divide=function(r){if(mb(r)||(r=Wb(r)),r.isZero())throw Error("division by zero");if(Qb)return this.unsigned||this.high!==-2147483648||r.low!==-1||r.high!==-1?ya(r=(this.unsigned?Qb.div_u:Qb.div_s)(this.low,this.high,r.low,r.high),Qb.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Cd:Hb;if(this.unsigned){if(r.unsigned||(r=r.toUnsigned()),r.gt(this))return Cd;if(r.gt(this.shru(1)))return xq;var e=Cd}else{if(this.eq(nb)){if(r.eq(Ue)||r.eq(Kk))return nb;if(r.eq(nb))return Ue;var i=this.shr(1).div(r).shl(1);if(i.eq(Hb))return r.isNegative()?Ue:Kk;var o=this.sub(r.mul(i));return i.add(o.div(r))}if(r.eq(nb))return this.unsigned?Cd:Hb;if(this.isNegative())return r.isNegative()?this.neg().div(r.neg()):this.neg().div(r).neg();if(r.isNegative())return this.div(r.neg()).neg();e=Hb}for(o=this;o.gte(r);){i=Math.max(1,Math.floor(o.toNumber()/r.toNumber()));var s=Math.ceil(Math.log(i)/Math.LN2);s=48>=s?1:sg(2,s-48);for(var l=Gb(i),f=l.mul(r);f.isNegative()||f.gt(o);)f=(l=Gb(i-=s,this.unsigned)).mul(r);l.isZero()&&(l=Ue),e=e.add(l),o=o.sub(f)}return e},D.div=D.divide,D.modulo=function(r){return mb(r)||(r=Wb(r)),Qb?ya(r=(this.unsigned?Qb.rem_u:Qb.rem_s)(this.low,this.high,r.low,r.high),Qb.get_high(),this.unsigned):this.sub(this.div(r).mul(r))},D.mod=D.modulo,D.rem=D.modulo,D.not=function(){return ya(~this.low,~this.high,this.unsigned)},D.and=function(r){return mb(r)||(r=Wb(r)),ya(this.low&r.low,this.high&r.high,this.unsigned)},D.or=function(r){return mb(r)||(r=Wb(r)),ya(this.low|r.low,this.high|r.high,this.unsigned)},D.xor=function(r){return mb(r)||(r=Wb(r)),ya(this.low^r.low,this.high^r.high,this.unsigned)},D.shiftLeft=function(r){return mb(r)&&(r=r.toInt()),(r&=63)==0?this:32>r?ya(this.low<<r,this.high<<r|this.low>>>32-r,this.unsigned):ya(0,this.low<<r-32,this.unsigned)},D.shl=D.shiftLeft,D.shiftRight=function(r){return mb(r)&&(r=r.toInt()),(r&=63)==0?this:32>r?ya(this.low>>>r|this.high<<32-r,this.high>>r,this.unsigned):ya(this.high>>r-32,0<=this.high?0:-1,this.unsigned)},D.shr=D.shiftRight,D.shiftRightUnsigned=function(r){if(mb(r)&&(r=r.toInt()),(r&=63)===0)return this;var e=this.high;return 32>r?ya(this.low>>>r|e<<32-r,e>>>r,this.unsigned):ya(r===32?e:e>>>r-32,0,this.unsigned)},D.shru=D.shiftRightUnsigned,D.shr_u=D.shiftRightUnsigned,D.toSigned=function(){return this.unsigned?ya(this.low,this.high,!1):this},D.toUnsigned=function(){return this.unsigned?this:ya(this.low,this.high,!0)},D.toBytes=function(r){return r?this.toBytesLE():this.toBytesBE()},D.toBytesLE=function(){var r=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&r,r>>>8&255,r>>>16&255,r>>>24]},D.toBytesBE=function(){var r=this.high,e=this.low;return[r>>>24,r>>>16&255,r>>>8&255,255&r,e>>>24,e>>>16&255,e>>>8&255,255&e]},xa.fromBytes=function(r,e,i){return i?xa.fromBytesLE(r,e):xa.fromBytesBE(r,e)},xa.fromBytesLE=function(r,e){return new xa(r[0]|r[1]<<8|r[2]<<16|r[3]<<24,r[4]|r[5]<<8|r[6]<<16|r[7]<<24,e)},xa.fromBytesBE=function(r,e){return new xa(r[4]<<24|r[5]<<16|r[6]<<8|r[7],r[0]<<24|r[1]<<16|r[2]<<8|r[3],e)};var di=function(r,e){return(di=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])})(r,e)},Lk=!1,Ib={Promise:void 0,set useDeprecatedSynchronousErrorHandling(r){r?console.warn(`DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: 
`+Error().stack):Lk&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),Lk=r},get useDeprecatedSynchronousErrorHandling(){return Lk}},Eh={closed:!0,next:function(r){},error:function(r){if(Ib.useDeprecatedSynchronousErrorHandling)throw r;me(r)},complete:function(){}},Jb=Array.isArray||function(r){return r&&typeof r.length=="number"},lf=function(){function r(e){return Error.call(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(i,o){return o+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e,this}return r.prototype=Object.create(Error.prototype),r}(),Oa=function(){function r(e){this.closed=!1,this._subscriptions=this._parentOrParents=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return r.prototype.unsubscribe=function(){if(!this.closed){var e=this._parentOrParents,i=this._ctorUnsubscribe,o=this._unsubscribe,s=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,e instanceof r)e.remove(this);else if(e!==null)for(var l=0;l<e.length;++l)e[l].remove(this);if(le(o)){i&&(this._unsubscribe=void 0);try{o.call(this)}catch(h){var f=h instanceof lf?Xl(h.errors):[h]}}if(Jb(s)){for(l=-1,e=s.length;++l<e;)if(ei(i=s[l]))try{i.unsubscribe()}catch(h){f=f||[],h instanceof lf?f=f.concat(Xl(h.errors)):f.push(h)}}if(f)throw new lf(f)}},r.prototype.add=function(e){var i=e;if(!e)return r.EMPTY;switch(X(e)){case"function":i=new r(e);case"object":if(i===this||i.closed||typeof i.unsubscribe!="function")return i;if(this.closed)return i.unsubscribe(),i;i instanceof r||(e=i,(i=new r)._subscriptions=[e]);break;default:throw Error("unrecognized teardown "+e+" added to Subscription.")}if((e=i._parentOrParents)===null)i._parentOrParents=this;else if(e instanceof r){if(e===this)return i;i._parentOrParents=[e,this]}else{if(e.indexOf(this)!==-1)return i;e.push(this)}return(e=this._subscriptions)===null?this._subscriptions=[i]:e.push(i),i},r.prototype.remove=function(e){var i=this._subscriptions;i&&(e=i.indexOf(e))!==-1&&i.splice(e,1)},r.EMPTY=function(e){return e.closed=!0,e}(new r),r}(),Fh=typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),ia=function(r){function e(i,o,s){var l=r.call(this)||this;switch(l.syncErrorValue=null,l.syncErrorThrown=!1,l.syncErrorThrowable=!1,l.isStopped=!1,arguments.length){case 0:l.destination=Eh;break;case 1:if(!i){l.destination=Eh;break}if(X(i)==="object"){i instanceof e?(l.syncErrorThrowable=i.syncErrorThrowable,l.destination=i,i.add(l)):(l.syncErrorThrowable=!0,l.destination=new yq(l,i));break}default:l.syncErrorThrowable=!0,l.destination=new yq(l,i,o,s)}return l}return O(e,r),e.prototype[Fh]=function(){return this},e.create=function(i,o,s){return(i=new e(i,o,s)).syncErrorThrowable=!1,i},e.prototype.next=function(i){this.isStopped||this._next(i)},e.prototype.error=function(i){this.isStopped||(this.isStopped=!0,this._error(i))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this))},e.prototype._next=function(i){this.destination.next(i)},e.prototype._error=function(i){this.destination.error(i),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var i=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=i,this},e}(Oa),yq=function(r){function e(i,o,s,l){var f=r.call(this)||this;if(f._parentSubscriber=i,i=f,le(o))var h=o;else o&&(h=o.next,s=o.error,l=o.complete,o!==Eh&&(le((i=Object.create(o)).unsubscribe)&&f.add(i.unsubscribe.bind(i)),i.unsubscribe=f.unsubscribe.bind(f)));return f._context=i,f._next=h,f._error=s,f._complete=l,f}return O(e,r),e.prototype.next=function(i){if(!this.isStopped&&this._next){var o=this._parentSubscriber;Ib.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable?this.__tryOrSetError(o,this._next,i)&&this.unsubscribe():this.__tryOrUnsub(this._next,i)}},e.prototype.error=function(i){if(!this.isStopped){var o=this._parentSubscriber,s=Ib.useDeprecatedSynchronousErrorHandling;if(this._error)s&&o.syncErrorThrowable?this.__tryOrSetError(o,this._error,i):this.__tryOrUnsub(this._error,i),this.unsubscribe();else if(o.syncErrorThrowable)s?(o.syncErrorValue=i,o.syncErrorThrown=!0):me(i),this.unsubscribe();else{if(this.unsubscribe(),s)throw i;me(i)}}},e.prototype.complete=function(){var i=this;if(!this.isStopped){var o=this._parentSubscriber;if(this._complete){var s=function(){return i._complete.call(i._context)};Ib.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable?this.__tryOrSetError(o,s):this.__tryOrUnsub(s)}this.unsubscribe()}},e.prototype.__tryOrUnsub=function(i,o){try{i.call(this._context,o)}catch(s){if(this.unsubscribe(),Ib.useDeprecatedSynchronousErrorHandling)throw s;me(s)}},e.prototype.__tryOrSetError=function(i,o,s){if(!Ib.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{o.call(this._context,s)}catch(l){return Ib.useDeprecatedSynchronousErrorHandling?(i.syncErrorValue=l,i.syncErrorThrown=!0):me(l),!0}return!1},e.prototype._unsubscribe=function(){var i=this._parentSubscriber;this._parentSubscriber=this._context=null,i.unsubscribe()},e}(ia),ne=typeof Symbol=="function"&&Symbol.observable||"@@observable",Y=function(){function r(e){this._isScalar=!1,e&&(this._subscribe=e)}return r.prototype.lift=function(e){var i=new r;return i.source=this,i.operator=e,i},r.prototype.subscribe=function(e,i,o){var s=this.operator;e:{if(e){if(e instanceof ia)break e;if(e[Fh]){e=e[Fh]();break e}}e=e||i||o?new ia(e,i,o):new ia(Eh)}if(s?e.add(s.call(e,this.source)):e.add(this.source||Ib.useDeprecatedSynchronousErrorHandling&&!e.syncErrorThrowable?this._subscribe(e):this._trySubscribe(e)),Ib.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable&&(e.syncErrorThrowable=!1,e.syncErrorThrown))throw e.syncErrorValue;return e},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(i){Ib.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=i),fi(e)?e.error(i):console.warn(i)}},r.prototype.forEach=function(e,i){var o=this;return new(i=Zl(i))(function(s,l){var f=o.subscribe(function(h){try{e(h)}catch(d){l(d),f&&f.unsubscribe()}},l,s)})},r.prototype._subscribe=function(e){var i=this.source;return i&&i.subscribe(e)},r.prototype[ne]=function(){return this},r.prototype.pipe=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return e.length===0?this:Yl(e)(this)},r.prototype.toPromise=function(e){var i=this;return new(e=Zl(e))(function(o,s){var l;i.subscribe(function(f){return l=f},function(f){return s(f)},function(){return o(l)})})},r.create=function(e){return new r(e)},r}(),qd=function(){function r(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return r.prototype=Object.create(Error.prototype),r}(),zq=function(r){function e(i,o){var s=r.call(this)||this;return s.subject=i,s.subscriber=o,s.closed=!1,s}return O(e,r),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var i=this.subject,o=i.observers;this.subject=null,!o||o.length===0||i.isStopped||i.closed||(i=o.indexOf(this.subscriber))!==-1&&o.splice(i,1)}},e}(Oa),Aq=function(r){function e(i){var o=r.call(this,i)||this;return o.destination=i,o}return O(e,r),e}(ia),Pa=function(r){function e(){var i=r.call(this)||this;return i.observers=[],i.closed=!1,i.isStopped=!1,i.hasError=!1,i.thrownError=null,i}return O(e,r),e.prototype[Fh]=function(){return new Aq(this)},e.prototype.lift=function(i){var o=new Bq(this,this);return o.operator=i,o},e.prototype.next=function(i){if(this.closed)throw new qd;if(!this.isStopped){var o=this.observers,s=o.length;o=o.slice();for(var l=0;l<s;l++)o[l].next(i)}},e.prototype.error=function(i){if(this.closed)throw new qd;this.hasError=!0,this.thrownError=i,this.isStopped=!0;var o=this.observers,s=o.length;o=o.slice();for(var l=0;l<s;l++)o[l].error(i);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new qd;this.isStopped=!0;var i=this.observers,o=i.length;i=i.slice();for(var s=0;s<o;s++)i[s].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},e.prototype._trySubscribe=function(i){if(this.closed)throw new qd;return r.prototype._trySubscribe.call(this,i)},e.prototype._subscribe=function(i){if(this.closed)throw new qd;return this.hasError?(i.error(this.thrownError),Oa.EMPTY):this.isStopped?(i.complete(),Oa.EMPTY):(this.observers.push(i),new zq(this,i))},e.prototype.asObservable=function(){var i=new Y;return i.source=this,i},e.create=function(i,o){return new Bq(i,o)},e}(Y),Bq=function(r){function e(i,o){var s=r.call(this)||this;return s.destination=i,s.source=o,s}return O(e,r),e.prototype.next=function(i){var o=this.destination;o&&o.next&&o.next(i)},e.prototype.error=function(i){var o=this.destination;o&&o.error&&this.destination.error(i)},e.prototype.complete=function(){var i=this.destination;i&&i.complete&&this.destination.complete()},e.prototype._subscribe=function(i){return this.source?this.source.subscribe(i):Oa.EMPTY},e}(Pa),Ns=function(){function r(e){this.connectable=e}return r.prototype.call=function(e,i){var o=this.connectable;return o._refCount++,e=new cz(e,o),i=i.subscribe(e),e.closed||(e.connection=o.connect()),i},r}(),cz=function(r){function e(i,o){return(i=r.call(this,i)||this).connectable=o,i}return O(e,r),e.prototype._unsubscribe=function(){var i=this.connectable;if(i){this.connectable=null;var o=i._refCount;0>=o?this.connection=null:(i._refCount=o-1,1<o?this.connection=null:(o=this.connection,i=i._connection,this.connection=null,!i||o&&i!==o||i.unsubscribe()))}else this.connection=null},e}(ia),Cq=function(r){function e(i,o){var s=r.call(this)||this;return s.source=i,s.subjectFactory=o,s._refCount=0,s._isComplete=!1,s}return O(e,r),e.prototype._subscribe=function(i){return this.getSubject().subscribe(i)},e.prototype.getSubject=function(){var i=this._subject;return i&&!i.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var i=this._connection;return i||(this._isComplete=!1,(i=this._connection=new Oa).add(this.source.subscribe(new dz(this.getSubject(),this))),i.closed&&(this._connection=null,i=Oa.EMPTY)),i},e.prototype.refCount=function(){return $l()(this)},e}(Y),At=function(){var r=Cq.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:r._subscribe},_isComplete:{value:r._isComplete,writable:!0},getSubject:{value:r.getSubject},connect:{value:r.connect},refCount:{value:r.refCount}}}(),dz=function(r){function e(i,o){return(i=r.call(this,i)||this).connectable=o,i}return O(e,r),e.prototype._error=function(i){this._unsubscribe(),r.prototype._error.call(this,i)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),r.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var i=this.connectable;if(i){this.connectable=null;var o=i._connection;i._refCount=0,i._subject=null,i._connection=null,o&&o.unsubscribe()}},e}(Aq);(function(r){function e(i,o){return(i=r.call(this,i)||this).connectable=o,i}O(e,r),e.prototype._unsubscribe=function(){var i=this.connectable;if(i){this.connectable=null;var o=i._refCount;0>=o?this.connection=null:(i._refCount=o-1,1<o?this.connection=null:(o=this.connection,i=i._connection,this.connection=null,!i||o&&i!==o||i.unsubscribe()))}else this.connection=null}})(ia),function(r){function e(i,o,s,l,f){return(i=r.call(this,i)||this).keySelector=o,i.elementSelector=s,i.durationSelector=l,i.subjectSelector=f,i.groups=null,i.attemptedToUnsubscribe=!1,i.count=0,i}O(e,r),e.prototype._next=function(i){try{var o=this.keySelector(i)}catch(s){return void this.error(s)}this._group(i,o)},e.prototype._group=function(i,o){var s=this.groups;s||(s=this.groups=new Map);var l=s.get(o);if(this.elementSelector)try{var f=this.elementSelector(i)}catch(h){this.error(h)}else f=i;if(!l&&(l=this.subjectSelector?this.subjectSelector():new Pa,s.set(o,l),i=new Mk(o,l,this),this.destination.next(i),this.durationSelector)){i=void 0;try{i=this.durationSelector(new Mk(o,l))}catch(h){return void this.error(h)}this.add(i.subscribe(new ez(o,l,this)))}l.closed||l.next(f)},e.prototype._error=function(i){var o=this.groups;o&&(o.forEach(function(s,l){s.error(i)}),o.clear()),this.destination.error(i)},e.prototype._complete=function(){var i=this.groups;i&&(i.forEach(function(o,s){o.complete()}),i.clear()),this.destination.complete()},e.prototype.removeGroup=function(i){this.groups.delete(i)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&r.prototype.unsubscribe.call(this))}}(ia);var ez=function(r){function e(i,o,s){var l=r.call(this,o)||this;return l.key=i,l.group=o,l.parent=s,l}return O(e,r),e.prototype._next=function(i){this.complete()},e.prototype._unsubscribe=function(){var i=this.parent,o=this.key;this.key=this.parent=null,i&&i.removeGroup(o)},e}(ia),Mk=function(r){function e(i,o,s){var l=r.call(this)||this;return l.key=i,l.groupSubject=o,l.refCountSubscription=s,l}return O(e,r),e.prototype._subscribe=function(i){var o=new Oa,s=this.refCountSubscription,l=this.groupSubject;return s&&!s.closed&&o.add(new fz(s)),o.add(l.subscribe(i)),o},e}(Y),fz=function(r){function e(i){var o=r.call(this)||this;return o.parent=i,i.count++,o}return O(e,r),e.prototype.unsubscribe=function(){var i=this.parent;i.closed||this.closed||(r.prototype.unsubscribe.call(this),--i.count,i.count===0&&i.attemptedToUnsubscribe&&i.unsubscribe())},e}(Oa),gz=function(r){function e(i){var o=r.call(this)||this;return o._value=i,o}return O(e,r),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(i){var o=r.prototype._subscribe.call(this,i);return o&&!o.closed&&i.next(this._value),o},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new qd;return this._value},e.prototype.next=function(i){r.prototype.next.call(this,this._value=i)},e}(Pa),dg=function(r){function e(i,o){var s=r.call(this,i,o)||this;return s.scheduler=i,s.work=o,s.pending=!1,s}return O(e,r),e.prototype.schedule=function(i,o){if(o===void 0&&(o=0),this.closed)return this;this.state=i,i=this.id;var s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,o)),this.pending=!0,this.delay=o,this.id=this.id||this.requestAsyncId(s,this.id,o),this},e.prototype.requestAsyncId=function(i,o,s){return s===void 0&&(s=0),setInterval(i.flush.bind(i,this),s)},e.prototype.recycleAsyncId=function(i,o,s){if(s===void 0&&(s=0),s!==null&&this.delay===s&&this.pending===!1)return o;clearInterval(o)},e.prototype.execute=function(i,o){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(i=this._execute(i,o))?i:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},e.prototype._execute=function(i,o){o=!1;var s=void 0;try{this.work(i)}catch(l){o=!0,s=!!l&&l||Error(l)}if(o)return this.unsubscribe(),s},e.prototype._unsubscribe=function(){var i=this.id,o=this.scheduler,s=o.actions,l=s.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,l!==-1&&s.splice(l,1),i!=null&&(this.id=this.recycleAsyncId(o,i,null)),this.delay=null},e}(function(r){function e(i,o){return r.call(this)||this}return O(e,r),e.prototype.schedule=function(i,o){return this},e}(Oa)),hz=function(r){function e(i,o){var s=r.call(this,i,o)||this;return s.scheduler=i,s.work=o,s}return O(e,r),e.prototype.schedule=function(i,o){return o===void 0&&(o=0),0<o?r.prototype.schedule.call(this,i,o):(this.delay=o,this.state=i,this.scheduler.flush(this),this)},e.prototype.execute=function(i,o){return 0<o||this.closed?r.prototype.execute.call(this,i,o):this._execute(i,o)},e.prototype.requestAsyncId=function(i,o,s){return s===void 0&&(s=0),s!==null&&0<s||s===null&&0<this.delay?r.prototype.requestAsyncId.call(this,i,o,s):i.flush(this)},e}(dg),Nk=function(){function r(e,i){i===void 0&&(i=r.now),this.SchedulerAction=e,this.now=i}return r.prototype.schedule=function(e,i,o){return i===void 0&&(i=0),new this.SchedulerAction(this,e).schedule(o,i)},r.now=function(){return Date.now()},r}(),eg=function(r){function e(i,o){o===void 0&&(o=Nk.now);var s=r.call(this,i,function(){return e.delegate&&e.delegate!==s?e.delegate.now():o()})||this;return s.actions=[],s.active=!1,s.scheduled=void 0,s}return O(e,r),e.prototype.schedule=function(i,o,s){return o===void 0&&(o=0),e.delegate&&e.delegate!==this?e.delegate.schedule(i,o,s):r.prototype.schedule.call(this,i,o,s)},e.prototype.flush=function(i){var o=this.actions;if(this.active)o.push(i);else{var s;this.active=!0;do if(s=i.execute(i.state,i.delay))break;while(i=o.shift());if(this.active=!1,s){for(;i=o.shift();)i.unsubscribe();throw s}}},e}(Nk),fg=new(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return O(e,r),e}(eg))(hz),vb=new Y(function(r){return r.complete()}),am=function(r){return function(e){for(var i=0,o=r.length;i<o&&!e.closed;i++)e.next(r[i]);e.complete()}},Ok;(function(r){r.NEXT="N",r.ERROR="E",r.COMPLETE="C"})(Ok||(Ok={}));var Ve=function(){function r(e,i,o){this.kind=e,this.value=i,this.error=o,this.hasValue=e==="N"}return r.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},r.prototype.do=function(e,i,o){switch(this.kind){case"N":return e&&e(this.value);case"E":return i&&i(this.error);case"C":return o&&o()}},r.prototype.accept=function(e,i,o){return e&&typeof e.next=="function"?this.observe(e):this.do(e,i,o)},r.prototype.toObservable=function(){switch(this.kind){case"N":return bb(this.value);case"E":return Z(this.error);case"C":return mf()}throw Error("unexpected notification kind value")},r.createNext=function(e){return e!==void 0?new r("N",e):r.undefinedValueNotification},r.createError=function(e){return new r("E",void 0,e)},r.createComplete=function(){return r.completeNotification},r.completeNotification=new r("C"),r.undefinedValueNotification=new r("N",void 0),r}(),Rs=function(){function r(e,i){i===void 0&&(i=0),this.scheduler=e,this.delay=i}return r.prototype.call=function(e,i){return i.subscribe(new Dq(e,this.scheduler,this.delay))},r}(),Dq=function(r){function e(i,o,s){return s===void 0&&(s=0),(i=r.call(this,i)||this).scheduler=o,i.delay=s,i}return O(e,r),e.dispatch=function(i){i.notification.observe(i.destination),this.unsubscribe()},e.prototype.scheduleMessage=function(i){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new iz(i,this.destination)))},e.prototype._next=function(i){this.scheduleMessage(Ve.createNext(i))},e.prototype._error=function(i){this.scheduleMessage(Ve.createError(i)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(Ve.createComplete()),this.unsubscribe()},e}(ia),iz=function(r,e){this.notification=r,this.destination=e},qe=function(r){function e(i,o,s){i===void 0&&(i=Number.POSITIVE_INFINITY),o===void 0&&(o=Number.POSITIVE_INFINITY);var l=r.call(this)||this;return l.scheduler=s,l._events=[],l._infiniteTimeWindow=!1,l._bufferSize=1>i?1:i,l._windowTime=1>o?1:o,o===Number.POSITIVE_INFINITY?(l._infiniteTimeWindow=!0,l.next=l.nextInfiniteTimeWindow):l.next=l.nextTimeWindow,l}return O(e,r),e.prototype.nextInfiniteTimeWindow=function(i){if(!this.isStopped){var o=this._events;o.push(i),o.length>this._bufferSize&&o.shift()}r.prototype.next.call(this,i)},e.prototype.nextTimeWindow=function(i){this.isStopped||(this._events.push(new jz(this._getNow(),i)),this._trimBufferThenGetEvents()),r.prototype.next.call(this,i)},e.prototype._subscribe=function(i){var o=this._infiniteTimeWindow,s=o?this._events:this._trimBufferThenGetEvents(),l=this.scheduler,f=s.length;if(this.closed)throw new qd;if(this.isStopped||this.hasError)var h=Oa.EMPTY;else this.observers.push(i),h=new zq(this,i);if(l&&i.add(i=new Dq(i,l)),o)for(o=0;o<f&&!i.closed;o++)i.next(s[o]);else for(o=0;o<f&&!i.closed;o++)i.next(s[o].value);return this.hasError?i.error(this.thrownError):this.isStopped&&i.complete(),h},e.prototype._getNow=function(){return(this.scheduler||fg).now()},e.prototype._trimBufferThenGetEvents=function(){for(var i=this._getNow(),o=this._bufferSize,s=this._windowTime,l=this._events,f=l.length,h=0;h<f&&!(i-l[h].time<s);)h++;return f>o&&(h=Math.max(h,f-o)),0<h&&l.splice(0,h),l},e}(Pa),jz=function(r,e){this.time=r,this.value=e},of=function(r){function e(){var i=r!==null&&r.apply(this,arguments)||this;return i.value=null,i.hasNext=!1,i.hasCompleted=!1,i}return O(e,r),e.prototype._subscribe=function(i){return this.hasError?(i.error(this.thrownError),Oa.EMPTY):this.hasCompleted&&this.hasNext?(i.next(this.value),i.complete(),Oa.EMPTY):r.prototype._subscribe.call(this,i)},e.prototype.next=function(i){this.hasCompleted||(this.value=i,this.hasNext=!0)},e.prototype.error=function(i){this.hasCompleted||r.prototype.error.call(this,i)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&r.prototype.next.call(this,this.value),r.prototype.complete.call(this)},e}(Pa),kz=1,lz=Promise.resolve(),ii={},Eq={setImmediate:function(r){var e=kz++;return ii[e]=!0,lz.then(function(){return bm(e)&&r()}),e},clearImmediate:function(r){bm(r)}},mz=function(r){function e(i,o){var s=r.call(this,i,o)||this;return s.scheduler=i,s.work=o,s}return O(e,r),e.prototype.requestAsyncId=function(i,o,s){return s===void 0&&(s=0),s!==null&&0<s?r.prototype.requestAsyncId.call(this,i,o,s):(i.actions.push(this),i.scheduled||(i.scheduled=Eq.setImmediate(i.flush.bind(i,null))))},e.prototype.recycleAsyncId=function(i,o,s){if(s===void 0&&(s=0),s!==null&&0<s||s===null&&0<this.delay)return r.prototype.recycleAsyncId.call(this,i,o,s);i.actions.length===0&&(Eq.clearImmediate(o),i.scheduled=void 0)},e}(dg),ri=new(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return O(e,r),e.prototype.flush=function(i){this.active=!0,this.scheduled=void 0;var o,s=this.actions,l=-1,f=s.length;i=i||s.shift();do if(o=i.execute(i.state,i.delay))break;while(++l<f&&(i=s.shift()));if(this.active=!1,o){for(;++l<f&&(i=s.shift());)i.unsubscribe();throw o}},e}(eg))(mz),nz=ri,Pk=new eg(dg),bd=Pk,oz=function(r){function e(i,o){var s=r.call(this,i,o)||this;return s.scheduler=i,s.work=o,s}return O(e,r),e.prototype.requestAsyncId=function(i,o,s){return s===void 0&&(s=0),s!==null&&0<s?r.prototype.requestAsyncId.call(this,i,o,s):(i.actions.push(this),i.scheduled||(i.scheduled=requestAnimationFrame(function(){return i.flush(null)})))},e.prototype.recycleAsyncId=function(i,o,s){if(s===void 0&&(s=0),s!==null&&0<s||s===null&&0<this.delay)return r.prototype.recycleAsyncId.call(this,i,o,s);i.actions.length===0&&(cancelAnimationFrame(o),i.scheduled=void 0)},e}(dg),Fq=new(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return O(e,r),e.prototype.flush=function(i){this.active=!0,this.scheduled=void 0;var o,s=this.actions,l=-1,f=s.length;i=i||s.shift();do if(o=i.execute(i.state,i.delay))break;while(++l<f&&(i=s.shift()));if(this.active=!1,o){for(;++l<f&&(i=s.shift());)i.unsubscribe();throw o}},e}(eg))(oz),pz=function(r){function e(i,o){i===void 0&&(i=Gq),o===void 0&&(o=Number.POSITIVE_INFINITY);var s=r.call(this,i,function(){return s.frame})||this;return s.maxFrames=o,s.frame=0,s.index=-1,s}return O(e,r),e.prototype.flush=function(){for(var i,o,s=this.actions,l=this.maxFrames;(o=s[0])&&o.delay<=l&&(s.shift(),this.frame=o.delay,!(i=o.execute(o.state,o.delay))););if(i){for(;o=s.shift();)o.unsubscribe();throw i}},e.frameTimeFactor=10,e}(eg),Gq=function(r){function e(i,o,s){s===void 0&&(s=i.index+=1);var l=r.call(this,i,o)||this;return l.scheduler=i,l.work=o,l.index=s,l.active=!0,l.index=i.index=s,l}return O(e,r),e.prototype.schedule=function(i,o){if(o===void 0&&(o=0),!this.id)return r.prototype.schedule.call(this,i,o);this.active=!1;var s=new e(this.scheduler,this.work);return this.add(s),s.schedule(i,o)},e.prototype.requestAsyncId=function(i,o,s){return s===void 0&&(s=0),this.delay=i.frame+s,(i=i.actions).push(this),i.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(i,o,s){},e.prototype._execute=function(i,o){if(this.active===!0)return r.prototype._execute.call(this,i,o)},e.sortActions=function(i,o){return i.delay===o.delay?i.index===o.index?0:i.index>o.index?1:-1:i.delay>o.delay?1:-1},e}(dg),Qk=function(){function r(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return r.prototype=Object.create(Error.prototype),r}(),vg=function(){function r(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return r.prototype=Object.create(Error.prototype),r}(),pb=function(){function r(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return r.prototype=Object.create(Error.prototype),r}(),Ss=function(){function r(e,i){this.project=e,this.thisArg=i}return r.prototype.call=function(e,i){return i.subscribe(new qz(e,this.project,this.thisArg))},r}(),qz=function(r){function e(i,o,s){return(i=r.call(this,i)||this).project=o,i.count=0,i.thisArg=s||i,i}return O(e,r),e.prototype._next=function(i){try{var o=this.project.call(this.thisArg,i,this.count++)}catch(s){return void this.destination.error(s)}this.destination.next(o)},e}(ia),Rk=function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return O(e,r),e.prototype.notifyNext=function(i,o,s,l,f){this.destination.next(o)},e.prototype.notifyError=function(i,o){this.destination.error(i)},e.prototype.notifyComplete=function(i){this.destination.complete()},e}(ia),Xs=function(r){function e(i,o,s){var l=r.call(this)||this;return l.parent=i,l.outerValue=o,l.outerIndex=s,l.index=0,l}return O(e,r),e.prototype._next=function(i){this.parent.notifyNext(this.outerValue,i,this.outerIndex,this.index++,this)},e.prototype._error=function(i){this.parent.notifyError(i,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(ia),rz=function(r){return function(e){return r.then(function(i){e.closed||(e.next(i),e.complete())},function(i){return e.error(i)}).then(null,me),e}},$c=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator",sz=function(r){return function(e){for(var i=r[$c]();;){var o=void 0;try{o=i.next()}catch(s){return e.error(s),e}if(o.done){e.complete();break}if(e.next(o.value),e.closed)break}return typeof i.return=="function"&&e.add(function(){i.return&&i.return()}),e}},tz=function(r){return function(e){var i=r[ne]();if(typeof i.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return i.subscribe(e)}},hm=function(r){return r&&typeof r.length=="number"&&typeof r!="function"},pf=function(r){if(r&&typeof r[ne]=="function")return tz(r);if(hm(r))return am(r);if(fm(r))return rz(r);if(r&&typeof r[$c]=="function")return sz(r);throw r=ei(r)?"an invalid object":"'"+r+"'",new TypeError("You provided "+r+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},Hq={},vz=function(){function r(e){this.resultSelector=e}return r.prototype.call=function(e,i){return i.subscribe(new uz(e,this.resultSelector))},r}(),uz=function(r){function e(i,o){return(i=r.call(this,i)||this).resultSelector=o,i.active=0,i.values=[],i.observables=[],i}return O(e,r),e.prototype._next=function(i){this.values.push(Hq),this.observables.push(i)},e.prototype._complete=function(){var i=this.observables,o=i.length;if(o===0)this.destination.complete();else{this.toRespond=this.active=o;for(var s=0;s<o;s++)this.add(ji(this,i[s],void 0,s))}},e.prototype.notifyComplete=function(i){--this.active==0&&this.destination.complete()},e.prototype.notifyNext=function(i,o,s){var l=(i=this.values)[s];l=this.toRespond?l===Hq?--this.toRespond:this.toRespond:0,i[s]=o,l===0&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))},e.prototype._tryResultSelector=function(i){try{var o=this.resultSelector.apply(this,i)}catch(s){return void this.destination.error(s)}this.destination.next(o)},e}(Rk),vc=function(r){function e(i){var o=r.call(this)||this;return o.parent=i,o}return O(e,r),e.prototype._next=function(i){this.parent.notifyNext(i)},e.prototype._error=function(i){this.parent.notifyError(i),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(ia);(function(r){function e(i,o,s){var l=r.call(this)||this;return l.parent=i,l.outerValue=o,l.outerIndex=s,l}O(e,r),e.prototype._next=function(i){this.parent.notifyNext(this.outerValue,i,this.outerIndex,this)},e.prototype._error=function(i){this.parent.notifyError(i),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}})(ia);var wc=function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return O(e,r),e.prototype.notifyNext=function(i){this.destination.next(i)},e.prototype.notifyError=function(i){this.destination.error(i)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(ia);(function(r){function e(){return r!==null&&r.apply(this,arguments)||this}O(e,r),e.prototype.notifyNext=function(i,o,s,l){this.destination.next(o)},e.prototype.notifyError=function(i){this.destination.error(i)},e.prototype.notifyComplete=function(i){this.destination.complete()}})(ia);var at=function(){function r(e,i){i===void 0&&(i=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=i}return r.prototype.call=function(e,i){return i.subscribe(new wz(e,this.project,this.concurrent))},r}(),wz=function(r){function e(i,o,s){return s===void 0&&(s=Number.POSITIVE_INFINITY),(i=r.call(this,i)||this).project=o,i.concurrent=s,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return O(e,r),e.prototype._next=function(i){this.active<this.concurrent?this._tryNext(i):this.buffer.push(i)},e.prototype._tryNext=function(i){var o=this.index++;try{var s=this.project(i,o)}catch(l){return void this.destination.error(l)}this.active++,this._innerSub(s)},e.prototype._innerSub=function(i){var o=new vc(this),s=this.destination;s.add(o),(i=ic(i,o))!==o&&s.add(i)},e.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(i){this.destination.next(i)},e.prototype.notifyComplete=function(){var i=this.buffer;this.active--,0<i.length?this._next(i.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},e}(wc),Sk=y.parseFloat,Iq=1/Sk(`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF-0`)!=-1/0?function(r){r=ik(String(r));var e=Sk(r);return e===0&&r.charAt(0)=="-"?-0:e}:Sk;N({global:!0,forced:parseFloat!=Iq},{parseFloat:Iq});var Tk=new Y(hc),ft=function(){function r(e,i){this.predicate=e,this.thisArg=i}return r.prototype.call=function(e,i){return i.subscribe(new xz(e,this.predicate,this.thisArg))},r}(),xz=function(r){function e(i,o,s){return(i=r.call(this,i)||this).predicate=o,i.thisArg=s,i.count=0,i}return O(e,r),e.prototype._next=function(i){try{var o=this.predicate.call(this.thisArg,i,this.count++)}catch(s){return void this.destination.error(s)}o&&this.destination.next(i)},e}(ia),gt=function(){function r(){}return r.prototype.call=function(e,i){return i.subscribe(new yz(e))},r}(),yz=function(r){function e(i){return(i=r.call(this,i)||this).hasFirst=!1,i.observables=[],i.subscriptions=[],i}return O(e,r),e.prototype._next=function(i){this.observables.push(i)},e.prototype._complete=function(){var i=this.observables,o=i.length;if(o===0)this.destination.complete();else{for(var s=0;s<o&&!this.hasFirst;s++){var l=ji(this,i[s],void 0,s);this.subscriptions&&this.subscriptions.push(l),this.add(l)}this.observables=null}},e.prototype.notifyNext=function(i,o,s){if(!this.hasFirst){for(this.hasFirst=!0,i=0;i<this.subscriptions.length;i++)if(i!==s){var l=this.subscriptions[i];l.unsubscribe(),this.remove(l)}this.subscriptions=null}this.destination.next(o)},e}(Rk),jt=function(){function r(e){this.resultSelector=e}return r.prototype.call=function(e,i){return i.subscribe(new zz(e,this.resultSelector))},r}(),zz=function(r){function e(i,o,s){return(i=r.call(this,i)||this).resultSelector=o,i.iterators=[],i.active=0,i.resultSelector=typeof o=="function"?o:void 0,i}return O(e,r),e.prototype._next=function(i){var o=this.iterators;Jb(i)?o.push(new Az(i)):typeof i[$c]=="function"?o.push(new Bz(i[$c]())):o.push(new Cz(this.destination,this,i))},e.prototype._complete=function(){var i=this.iterators,o=i.length;if(this.unsubscribe(),o===0)this.destination.complete();else{this.active=o;for(var s=0;s<o;s++){var l=i[s];l.stillUnsubscribed?this.destination.add(l.subscribe()):this.active--}}},e.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},e.prototype.checkIterators=function(){for(var i=this.iterators,o=i.length,s=this.destination,l=0;l<o;l++){var f=i[l];if(typeof f.hasValue=="function"&&!f.hasValue())return}var h=!1,d=[];for(l=0;l<o;l++){var p=(f=i[l]).next();if(f.hasCompleted()&&(h=!0),p.done)return void s.complete();d.push(p.value)}this.resultSelector?this._tryresultSelector(d):s.next(d),h&&s.complete()},e.prototype._tryresultSelector=function(i){try{var o=this.resultSelector.apply(this,i)}catch(s){return void this.destination.error(s)}this.destination.next(o)},e}(ia),Bz=function(){function r(e){this.iterator=e,this.nextResult=e.next()}return r.prototype.hasValue=function(){return!0},r.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},r.prototype.hasCompleted=function(){var e=this.nextResult;return!(!e||!e.done)},r}(),Az=function(){function r(e){this.array=e,this.length=this.index=0,this.length=e.length}return r.prototype[$c]=function(){return this},r.prototype.next=function(e){e=this.index++;var i=this.array;return e<this.length?{value:i[e],done:!1}:{value:null,done:!0}},r.prototype.hasValue=function(){return this.array.length>this.index},r.prototype.hasCompleted=function(){return this.array.length===this.index},r}(),Cz=function(r){function e(i,o,s){return(i=r.call(this,i)||this).parent=o,i.observable=s,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return O(e,r),e.prototype[$c]=function(){return this},e.prototype.next=function(){var i=this.buffer;return i.length===0&&this.isComplete?{value:null,done:!0}:{value:i.shift(),done:!1}},e.prototype.hasValue=function(){return 0<this.buffer.length},e.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},e.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(i){this.buffer.push(i),this.parent.checkIterators()},e.prototype.subscribe=function(){return ic(this.observable,new vc(this))},e}(wc),Dz=Object.freeze({__proto__:null,Observable:Y,ConnectableObservable:Cq,GroupedObservable:Mk,observable:ne,Subject:Pa,BehaviorSubject:gz,ReplaySubject:qe,AsyncSubject:of,asap:nz,asapScheduler:ri,async:bd,asyncScheduler:Pk,queue:fg,queueScheduler:fg,animationFrame:Fq,animationFrameScheduler:Fq,VirtualTimeScheduler:pz,VirtualAction:Gq,Scheduler:Nk,Subscription:Oa,Subscriber:ia,Notification:Ve,get NotificationKind(){return Ok},pipe:gi,noop:hc,identity:Yc,isObservable:function(r){return!!r&&(r instanceof Y||typeof r.lift=="function"&&typeof r.subscribe=="function")},ArgumentOutOfRangeError:Qk,EmptyError:vg,ObjectUnsubscribedError:qd,UnsubscriptionError:lf,TimeoutError:pb,bindCallback:cm,bindNodeCallback:dm,combineLatest:function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var i=e=void 0;return Zc(r[r.length-1])&&(i=r.pop()),typeof r[r.length-1]=="function"&&(e=r.pop()),r.length===1&&Jb(r[0])&&(r=r[0]),nf(r,i).lift(new vz(e))},concat:im,defer:ad,empty:mf,forkJoin:jm,from:Kb,fromEvent:gb,fromEventPattern:lm,generate:function(r,e,i,o,s){if(arguments.length==1){var l=r.initialState;e=r.condition,i=r.iterate;var f=r.resultSelector||Yc;s=r.scheduler}else o===void 0||Zc(o)?(l=r,f=Yc,s=o):(l=r,f=o);return new Y(function(h){var d=l;if(s)return s.schedule(bt,0,{subscriber:h,iterate:i,condition:e,resultSelector:f,state:d});for(;;){if(e){var p=void 0;try{p=e(d)}catch(g){h.error(g);break}if(!p){h.complete();break}}p=void 0;try{p=f(d)}catch(g){h.error(g);break}if(h.next(p),h.closed)break;try{d=i(d)}catch(g){h.error(g);break}}})},iif:function(r,e,i){return e===void 0&&(e=vb),i===void 0&&(i=vb),ad(function(){return r()?e:i})},interval:mm,merge:Xb,never:function(){return Tk},of:bb,onErrorResumeNext:li,pairs:function(r,e){return new Y(e?function(i){var o=Object.keys(r),s=new Oa;return s.add(e.schedule(dt,0,{keys:o,index:0,subscriber:i,subscription:s,obj:r})),s}:function(i){for(var o=Object.keys(r),s=0;s<o.length&&!i.closed;s++){var l=o[s];r.hasOwnProperty(l)&&i.next([l,r[l]])}i.complete()})},partition:function(r,e,i){return[wb(e,i)(new Y(pf(r))),wb(et(e,i))(new Y(pf(r)))]},race:Ca,range:function(r,e,i){return r===void 0&&(r=0),new Y(function(o){e===void 0&&(e=r,r=0);var s=0,l=r;if(i)return i.schedule(ht,0,{index:s,count:e,start:r,subscriber:o});for(;;){if(s++>=e){o.complete();break}if(o.next(l++),o.closed)break}})},throwError:Z,timer:Bc,using:function(r,e){return new Y(function(i){try{var o=r()}catch(f){return void i.error(f)}try{var s=e(o)}catch(f){return void i.error(f)}var l=(s?Kb(s):vb).subscribe(i);return function(){l.unsubscribe(),o&&o.unsubscribe()}})},zip:mi,scheduled:gm,EMPTY:vb,NEVER:Tk,config:Ib}),kt=function(){function r(e){this.selector=e}return r.prototype.call=function(e,i){return i.subscribe(new Ez(e,this.selector,this.caught))},r}(),Ez=function(r){function e(i,o,s){return(i=r.call(this,i)||this).selector=o,i.caught=s,i}return O(e,r),e.prototype.error=function(i){if(!this.isStopped){var o=void 0;try{o=this.selector(i,this.caught)}catch(s){return void r.prototype.error.call(this,s)}this._unsubscribeAndRecycle(),i=new vc(this),this.add(i),(o=ic(o,i))!==i&&this.add(o)}},e}(wc),lt=function(){function r(e){this.defaultValue=e}return r.prototype.call=function(e,i){return i.subscribe(new Fz(e,this.defaultValue))},r}(),Fz=function(r){function e(i,o){return(i=r.call(this,i)||this).defaultValue=o,i.isEmpty=!0,i}return O(e,r),e.prototype._next=function(i){this.isEmpty=!1,this.destination.next(i)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(ia),mt=function(){function r(e,i){this.delay=e,this.scheduler=i}return r.prototype.call=function(e,i){return i.subscribe(new Gz(e,this.delay,this.scheduler))},r}(),Gz=function(r){function e(i,o,s){return(i=r.call(this,i)||this).delay=o,i.scheduler=s,i.queue=[],i.active=!1,i.errored=!1,i}return O(e,r),e.dispatch=function(i){for(var o=i.source,s=o.queue,l=i.scheduler,f=i.destination;0<s.length&&0>=s[0].time-l.now();)s.shift().notification.observe(f);0<s.length?(o=Math.max(0,s[0].time-l.now()),this.schedule(i,o)):(this.unsubscribe(),o.active=!1)},e.prototype._schedule=function(i){this.active=!0,this.destination.add(i.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:i}))},e.prototype.scheduleNotification=function(i){if(this.errored!==!0){var o=this.scheduler;i=new Hz(o.now()+this.delay,i),this.queue.push(i),this.active===!1&&this._schedule(o)}},e.prototype._next=function(i){this.scheduleNotification(Ve.createNext(i))},e.prototype._error=function(i){this.errored=!0,this.queue=[],this.destination.error(i),this.unsubscribe()},e.prototype._complete=function(){this.scheduleNotification(Ve.createComplete()),this.unsubscribe()},e}(ia),Hz=function(r,e){this.time=r,this.notification=e},nt=function(){function r(e,i){this.keySelector=e,this.flushes=i}return r.prototype.call=function(e,i){return i.subscribe(new Iz(e,this.keySelector,this.flushes))},r}(),Iz=function(r){function e(i,o,s){return(i=r.call(this,i)||this).keySelector=o,i.values=new Set,s&&i.add(ic(s,new vc(i))),i}return O(e,r),e.prototype.notifyNext=function(){this.values.clear()},e.prototype.notifyError=function(i){this._error(i)},e.prototype._next=function(i){this.keySelector?this._useKeySelector(i):this._finalizeNext(i,i)},e.prototype._useKeySelector=function(i){var o=this.destination;try{var s=this.keySelector(i)}catch(l){return void o.error(l)}this._finalizeNext(s,i)},e.prototype._finalizeNext=function(i,o){var s=this.values;s.has(i)||(s.add(i),this.destination.next(o))},e}(wc),pt=function(){function r(e){this.errorFactory=e}return r.prototype.call=function(e,i){return i.subscribe(new Jz(e,this.errorFactory))},r}(),Jz=function(r){function e(i,o){return(i=r.call(this,i)||this).errorFactory=o,i.hasValue=!1,i}return O(e,r),e.prototype._next=function(i){this.hasValue=!0,this.destination.next(i)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var i=void 0;try{i=this.errorFactory()}catch(o){i=o}this.destination.error(i)},e}(ia),qt=function(){function r(e){if(this.total=e,0>this.total)throw new Qk}return r.prototype.call=function(e,i){return i.subscribe(new Kz(e,this.total))},r}(),Kz=function(r){function e(i,o){return(i=r.call(this,i)||this).total=o,i.count=0,i}return O(e,r),e.prototype._next=function(i){var o=this.total,s=++this.count;s<=o&&(this.destination.next(i),s===o&&(this.destination.complete(),this.unsubscribe()))},e}(ia),rt=function(){function r(e){this.project=e}return r.prototype.call=function(e,i){return i.subscribe(new Lz(e,this.project))},r}(),Lz=function(r){function e(i,o){return(i=r.call(this,i)||this).project=o,i.hasSubscription=!1,i.hasCompleted=!1,i.index=0,i}return O(e,r),e.prototype._next=function(i){this.hasSubscription||this.tryNext(i)},e.prototype.tryNext=function(i){var o=this.index++;try{var s=this.project(i,o)}catch(l){return void this.destination.error(l)}this.hasSubscription=!0,this._innerSub(s)},e.prototype._innerSub=function(i){var o=new vc(this),s=this.destination;s.add(o),(i=ic(i,o))!==o&&s.add(i)},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(i){this.destination.next(i)},e.prototype.notifyError=function(i){this.destination.error(i)},e.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(wc),st=function(){function r(e){this.callback=e}return r.prototype.call=function(e,i){return i.subscribe(new Mz(e,this.callback))},r}(),Mz=function(r){function e(i,o){return(i=r.call(this,i)||this).add(new Oa(o)),i}return O(e,r),e}(ia),ut=function(){function r(){}return r.prototype.call=function(e,i){return i.subscribe(new Nz(e))},r}(),Nz=function(r){function e(){return r!==null&&r.apply(this,arguments)||this}return O(e,r),e.prototype._next=function(i){},e}(ia),vt=function(){function r(e){if(this.total=e,0>this.total)throw new Qk}return r.prototype.call=function(e,i){return i.subscribe(new Oz(e,this.total))},r}(),Oz=function(r){function e(i,o){return(i=r.call(this,i)||this).total=o,i.ring=[],i.count=0,i}return O(e,r),e.prototype._next=function(i){var o=this.ring,s=this.total,l=this.count++;o.length<s?o.push(i):o[l%s]=i},e.prototype._complete=function(){var i=this.destination,o=this.count;if(0<o)for(var s=this.count>=this.total?this.total:this.count,l=this.ring,f=0;f<s;f++){var h=o++%s;i.next(l[h])}i.complete()},e}(ia),wt=function(){function r(e){this.value=e}return r.prototype.call=function(e,i){return i.subscribe(new Pz(e,this.value))},r}(),Pz=function(r){function e(i,o){return(i=r.call(this,i)||this).value=o,i}return O(e,r),e.prototype._next=function(i){this.destination.next(this.value)},e}(ia),xt=function(){function r(e,i,o){o===void 0&&(o=!1),this.accumulator=e,this.seed=i,this.hasSeed=o}return r.prototype.call=function(e,i){return i.subscribe(new Qz(e,this.accumulator,this.seed,this.hasSeed))},r}(),Qz=function(r){function e(i,o,s,l){return(i=r.call(this,i)||this).accumulator=o,i._seed=s,i.hasSeed=l,i.index=0,i}return O(e,r),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(i){this.hasSeed=!0,this._seed=i},enumerable:!0,configurable:!0}),e.prototype._next=function(i){if(this.hasSeed)return this._tryNext(i);this.seed=i,this.destination.next(i)},e.prototype._tryNext=function(i){var o=this.index++;try{var s=this.accumulator(this.seed,i,o)}catch(l){this.destination.error(l)}this.seed=s,this.destination.next(s)},e}(ia),Bt=function(){function r(e,i){this.notifier=e,this.source=i}return r.prototype.call=function(e,i){return i.subscribe(new Rz(e,this.notifier,this.source))},r}(),Rz=function(r){function e(i,o,s){return(i=r.call(this,i)||this).notifier=o,i.source=s,i}return O(e,r),e.prototype.error=function(i){if(!this.isStopped){var o=this.errors,s=this.retries,l=this.retriesSubscription;if(s)this.retriesSubscription=this.errors=void 0;else{o=new Pa;try{s=(0,this.notifier)(o)}catch(f){return r.prototype.error.call(this,f)}l=ic(s,new vc(this))}this._unsubscribeAndRecycle(),this.errors=o,this.retries=s,this.retriesSubscription=l,o.next(i)}},e.prototype._unsubscribe=function(){var i=this.errors,o=this.retriesSubscription;i&&(i.unsubscribe(),this.errors=void 0),o&&(o.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype.notifyNext=function(){var i=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=i,this.source.subscribe(this)},e}(wc),Et=function(){function r(e){this.project=e}return r.prototype.call=function(e,i){return i.subscribe(new Sz(e,this.project))},r}(),Sz=function(r){function e(i,o){return(i=r.call(this,i)||this).project=o,i.index=0,i}return O(e,r),e.prototype._next=function(i){var o=this.index++;try{var s=this.project(i,o)}catch(l){return void this.destination.error(l)}this._innerSub(s)},e.prototype._innerSub=function(i){var o=this.innerSubscription;o&&o.unsubscribe(),o=new vc(this);var s=this.destination;s.add(o),this.innerSubscription=ic(i,o),this.innerSubscription!==o&&s.add(this.innerSubscription)},e.prototype._complete=function(){var i=this.innerSubscription;i&&!i.closed||r.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&r.prototype._complete.call(this)},e.prototype.notifyNext=function(i){this.destination.next(i)},e}(wc),Ft=function(){function r(e){this.notifier=e}return r.prototype.call=function(e,i){e=new Tz(e);var o=ic(this.notifier,new vc(e));return o&&!e.seenValue?(e.add(o),i.subscribe(e)):e},r}(),Tz=function(r){function e(i){return(i=r.call(this,i)||this).seenValue=!1,i}return O(e,r),e.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(wc),Ht=function(){function r(e,i){this.predicate=e,this.inclusive=i}return r.prototype.call=function(e,i){return i.subscribe(new Uz(e,this.predicate,this.inclusive))},r}(),Uz=function(r){function e(i,o,s){return(i=r.call(this,i)||this).predicate=o,i.inclusive=s,i.index=0,i}return O(e,r),e.prototype._next=function(i){var o=this.destination;try{var s=this.predicate(i,this.index++)}catch(l){return void o.error(l)}this.nextOrComplete(i,s)},e.prototype.nextOrComplete=function(i,o){var s=this.destination;o?s.next(i):(this.inclusive&&s.next(i),s.complete())},e}(ia),It=function(){function r(e,i,o){this.nextOrObserver=e,this.error=i,this.complete=o}return r.prototype.call=function(e,i){return i.subscribe(new Vz(e,this.nextOrObserver,this.error,this.complete))},r}(),Vz=function(r){function e(i,o,s,l){return(i=r.call(this,i)||this)._tapNext=hc,i._tapError=hc,i._tapComplete=hc,i._tapError=s||hc,i._tapComplete=l||hc,le(o)?(i._context=i,i._tapNext=o):o&&(i._context=o,i._tapNext=o.next||hc,i._tapError=o.error||hc,i._tapComplete=o.complete||hc),i}return O(e,r),e.prototype._next=function(i){try{this._tapNext.call(this._context,i)}catch(o){return void this.destination.error(o)}this.destination.next(i)},e.prototype._error=function(i){try{this._tapError.call(this._context,i)}catch(o){return void this.destination.error(o)}this.destination.error(i)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(i){return void this.destination.error(i)}return this.destination.complete()},e}(ia),Kt={leading:!0,trailing:!1};(function(r){function e(i,o,s,l){var f=r.call(this,i)||this;return f.destination=i,f.durationSelector=o,f._leading=s,f._trailing=l,f._hasValue=!1,f}O(e,r),e.prototype._next=function(i){this._hasValue=!0,this._sendValue=i,this._throttled||(this._leading?this.send():this.throttle(i))},e.prototype.send=function(){var i=this._sendValue;this._hasValue&&(this.destination.next(i),this.throttle(i)),this._hasValue=!1,this._sendValue=void 0},e.prototype.throttle=function(i){(i=this.tryDurationSelector(i))&&this.add(this._throttled=ic(i,new vc(this)))},e.prototype.tryDurationSelector=function(i){try{return this.durationSelector(i)}catch(o){return this.destination.error(o),null}},e.prototype.throttlingDone=function(){var i=this._throttled,o=this._trailing;i&&i.unsubscribe(),this._throttled=void 0,o&&this.send()},e.prototype.notifyNext=function(){this.throttlingDone()},e.prototype.notifyComplete=function(){this.throttlingDone()}})(wc);for(var Lt=function(){function r(e,i,o,s){this.duration=e,this.scheduler=i,this.leading=o,this.trailing=s}return r.prototype.call=function(e,i){return i.subscribe(new Wz(e,this.duration,this.scheduler,this.leading,this.trailing))},r}(),Wz=function(r){function e(i,o,s,l,f){return(i=r.call(this,i)||this).duration=o,i.scheduler=s,i.leading=l,i.trailing=f,i._hasTrailingValue=!1,i._trailingValue=null,i}return O(e,r),e.prototype._next=function(i){this.throttled?this.trailing&&(this._trailingValue=i,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Mt,this.duration,{subscriber:this})),this.leading?this.destination.next(i):this.trailing&&(this._trailingValue=i,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},e.prototype.clearThrottle=function(){var i=this.throttled;i&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),i.unsubscribe(),this.remove(i),this.throttled=null)},e}(ia),Ot=function(){function r(e,i,o,s){this.waitFor=e,this.absoluteTimeout=i,this.withObservable=o,this.scheduler=s}return r.prototype.call=function(e,i){return i.subscribe(new Xz(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},r}(),Xz=function(r){function e(i,o,s,l,f){return(i=r.call(this,i)||this).absoluteTimeout=o,i.waitFor=s,i.withObservable=l,i.scheduler=f,i.scheduleTimeout(),i}return O(e,r),e.dispatchTimeout=function(i){var o=i.withObservable;i._unsubscribeAndRecycle(),i.add(ic(o,new vc(i)))},e.prototype.scheduleTimeout=function(){var i=this.action;i?this.action=i.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(i){this.absoluteTimeout||this.scheduleTimeout(),r.prototype._next.call(this,i)},e.prototype._unsubscribe=function(){this.action=void 0,this.withObservable=this.scheduler=null},e}(wc),Qt=function(){function r(e,i){this.observables=e,this.project=i}return r.prototype.call=function(e,i){return i.subscribe(new Yz(e,this.observables,this.project))},r}(),Yz=function(r){function e(i,o,s){(i=r.call(this,i)||this).observables=o,i.project=s,i.toRespond=[],s=o.length,i.values=Array(s);for(var l=0;l<s;l++)i.toRespond.push(l);for(l=0;l<s;l++)i.add(ji(i,o[l],void 0,l));return i}return O(e,r),e.prototype.notifyNext=function(i,o,s){this.values[s]=o,0<(i=this.toRespond).length&&(s=i.indexOf(s))!==-1&&i.splice(s,1)},e.prototype.notifyComplete=function(){},e.prototype._next=function(i){this.toRespond.length===0&&(i=[i].concat(this.values),this.project?this._tryProject(i):this.destination.next(i))},e.prototype._tryProject=function(i){try{var o=this.project.apply(this,i)}catch(s){return void this.destination.error(s)}this.destination.next(o)},e}(Rk),Jq=$a(function(r){var e=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(e){var i=new Uint8Array(16);r.exports=function(){return e(i),i}}else{var o=Array(16);r.exports=function(){for(var s,l=0;16>l;l++)(3&l)==0&&(s=4294967296*Math.random()),o[l]=s>>>((3&l)<<3)&255;return o}}}),ab=[],Gh=0;256>Gh;++Gh)ab[Gh]=(Gh+256).toString(16).substr(1);var Kq=function(r,e){return e=e||0,[ab[r[e++]],ab[r[e++]],ab[r[e++]],ab[r[e++]],"-",ab[r[e++]],ab[r[e++]],"-",ab[r[e++]],ab[r[e++]],"-",ab[r[e++]],ab[r[e++]],"-",ab[r[e++]],ab[r[e++]],ab[r[e++]],ab[r[e++]],ab[r[e++]],ab[r[e++]]].join("")},Ud=function(r,e,i){if(i=e&&i||0,typeof r=="string"&&(e=r==="binary"?Array(16):null,r=null),(r=(r=r||{}).random||(r.rng||Jq)())[6]=15&r[6]|64,r[8]=63&r[8]|128,e)for(var o=0;16>o;++o)e[i+o]=r[o];return e||Kq(r)},gg=Ud(),Uk=!1,Pc,rd,Vk,Wk,sd,Vd,ec,We,Rb,Xk,Qc,Wd,Rc,Sc,Tc,Xe,Uc,Vc;(function(r){r[r.ATTRIBUTE_OPERATION_ERR_FAILURE=2]="ATTRIBUTE_OPERATION_ERR_FAILURE",r[r.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]="ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT",r[r.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]="ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW",r[r.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]="ATTRIBUTE_OPERATION_ERR_TOO_OFTEN",r[r.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]="ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND",r[r.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]="ATTRIBUTE_OPERATION_ERR_TIMEOUT",r[r.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN"})(Pc||(Pc={})),function(r){r[r.CHANNEL_MESSAGE_ERR_FAILURE=1]="CHANNEL_MESSAGE_ERR_FAILURE",r[r.CHANNEL_MESSAGE_ERR_TIMEOUT=2]="CHANNEL_MESSAGE_ERR_TIMEOUT",r[r.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]="CHANNEL_MESSAGE_ERR_TOO_OFTEN",r[r.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]="CHANNEL_MESSAGE_ERR_INVALID_MESSAGE",r[r.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]="CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL",r[r.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(rd||(rd={})),function(r){r[r.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]="CREATE_CHANNEL_ERR_INVALID_ARGUMENT"}(Vk||(Vk={})),function(r){r[r.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]="CREATE_INSTANCE_ERR_INVALID_ARGUMENT"}(Wk||(Wk={})),function(r){r[r.GET_MEMBERS_ERR_FAILURE=1]="GET_MEMBERS_ERR_FAILURE",r[r.GET_MEMBERS_ERR_REJECTED=2]="GET_MEMBERS_ERR_REJECTED",r[r.GET_MEMBERS_ERR_TIMEOUT=3]="GET_MEMBERS_ERR_TIMEOUT",r[r.GET_MEMBERS_ERR_TOO_OFTEN=4]="GET_MEMBERS_ERR_TOO_OFTEN",r[r.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]="GET_MEMBERS_ERR_NOT_IN_CHANNEL",r[r.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=102]="GET_MEMBERS_ERR_USER_NOT_LOGGED_IN"}(sd||(sd={})),function(r){r[r.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]="INVITATION_API_CALL_ERR_INVALID_ARGUMENT",r[r.INVITATION_API_CALL_ERR_NOT_STARTED=2]="INVITATION_API_CALL_ERR_NOT_STARTED",r[r.INVITATION_API_CALL_ERR_ALREADY_END=3]="INVITATION_API_CALL_ERR_ALREADY_END",r[r.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]="INVITATION_API_CALL_ERR_ALREADY_ACCEPT",r[r.INVITATION_API_CALL_ERR_ALREADY_SENT=5]="INVITATION_API_CALL_ERR_ALREADY_SENT"}(Vd||(Vd={})),function(r){r[r.JOIN_CHANNEL_ERR_FAILURE=1]="JOIN_CHANNEL_ERR_FAILURE",r[r.JOIN_CHANNEL_ERR_REJECTED=2]="JOIN_CHANNEL_ERR_REJECTED",r[r.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]="JOIN_CHANNEL_ERR_INVALID_ARGUMENT",r[r.JOIN_CHANNEL_TIMEOUT=4]="JOIN_CHANNEL_TIMEOUT",r[r.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]="JOIN_CHANNEL_ERR_EXCEED_LIMIT",r[r.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]="JOIN_CHANNEL_ERR_ALREADY_JOINED",r[r.JOIN_CHANNEL_ERR_TOO_OFTEN=7]="JOIN_CHANNEL_ERR_TOO_OFTEN",r[r.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]="JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN",r[r.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN",r[r.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=201]="JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE",r[r.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=202]="JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID"}(ec||(ec={})),function(r){r[r.LEAVE_CHANNEL_ERR_FAILURE=1]="LEAVE_CHANNEL_ERR_FAILURE",r[r.LEAVE_CHANNEL_ERR_REJECTED=2]="LEAVE_CHANNEL_ERR_REJECTED",r[r.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]="LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL",r[r.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN"}(We||(We={})),function(r){r[r.LOGIN_ERR_UNKNOWN=1]="LOGIN_ERR_UNKNOWN",r[r.LOGIN_ERR_REJECTED=2]="LOGIN_ERR_REJECTED",r[r.LOGIN_ERR_INVALID_ARGUMENT=3]="LOGIN_ERR_INVALID_ARGUMENT",r[r.LOGIN_ERR_INVALID_APP_ID=4]="LOGIN_ERR_INVALID_APP_ID",r[r.LOGIN_ERR_INVALID_TOKEN=5]="LOGIN_ERR_INVALID_TOKEN",r[r.LOGIN_ERR_TOKEN_EXPIRED=6]="LOGIN_ERR_TOKEN_EXPIRED",r[r.LOGIN_ERR_NOT_AUTHORIZED=7]="LOGIN_ERR_NOT_AUTHORIZED",r[r.LOGIN_ERR_ALREADY_LOGIN=8]="LOGIN_ERR_ALREADY_LOGIN",r[r.LOGIN_ERR_TIMEOUT=9]="LOGIN_ERR_TIMEOUT",r[r.LOGIN_ERR_TOO_OFTEN=10]="LOGIN_ERR_TOO_OFTEN",r[r.LOGIN_ERR_ABORTED_BY_LOGOUT=201]="LOGIN_ERR_ABORTED_BY_LOGOUT"}(Rb||(Rb={})),function(r){r[r.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]="LOGOUT_ERR_USER_NOT_LOGGED_IN"}(Xk||(Xk={})),function(r){r[r.PEER_MESSAGE_ERR_FAILURE=1]="PEER_MESSAGE_ERR_FAILURE",r[r.PEER_MESSAGE_ERR_TIMEOUT=2]="PEER_MESSAGE_ERR_TIMEOUT",r[r.PEER_MESSAGE_ERR_TOO_OFTEN=5]="PEER_MESSAGE_ERR_TOO_OFTEN",r[r.PEER_MESSAGE_ERR_INVALID_USERID=6]="PEER_MESSAGE_ERR_INVALID_USERID",r[r.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]="PEER_MESSAGE_ERR_INVALID_MESSAGE",r[r.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE=8]="PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE",r[r.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(Qc||(Qc={})),function(r){r[r.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=2]="QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT",r[r.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=3]="QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED",r[r.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=4]="QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT",r[r.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=5]="QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN",r[r.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN"}(Wd||(Wd={})),function(r){r[r.RENEW_TOKEN_ERR_FAILURE=1]="RENEW_TOKEN_ERR_FAILURE",r[r.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]="RENEW_TOKEN_ERR_INVALID_ARGUMENT",r[r.RENEW_TOKEN_ERR_REJECTED=3]="RENEW_TOKEN_ERR_REJECTED",r[r.RENEW_TOKEN_ERR_TOO_OFTEN=4]="RENEW_TOKEN_ERR_TOO_OFTEN",r[r.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]="RENEW_TOKEN_ERR_TOKEN_EXPIRED",r[r.RENEW_TOKEN_ERR_INVALID_TOKEN=6]="RENEW_TOKEN_ERR_INVALID_TOKEN",r[r.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]="RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN",r[r.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]="RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT"}(Rc||(Rc={})),function(r){r[r.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]="GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE",r[r.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]="GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT",r[r.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]="GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN",r[r.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]="GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT",r[r.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]="GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT",r[r.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]="GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED",r[r.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]="GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN"}(Sc||(Sc={})),function(r){r[r.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]="PEER_SUBSCRIPTION_STATUS_ERR_FAILURE",r[r.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]="PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT",r[r.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]="PEER_SUBSCRIPTION_STATUS_ERR_REJECTED",r[r.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]="PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT",r[r.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]="PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN",r[r.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]="PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW",r[r.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]="PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN"}(Tc||(Tc={})),function(r){r[r.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE",r[r.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT",r[r.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN",r[r.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN"}(Xe||(Xe={})),function(r){r[r.UPLOAD_MEDIA_ERR_FAILURE=1]="UPLOAD_MEDIA_ERR_FAILURE",r[r.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="UPLOAD_MEDIA_ERR_INVALID_ARGUMENT",r[r.UPLOAD_MEDIA_ERR_TIMEOUT=3]="UPLOAD_MEDIA_ERR_TIMEOUT",r[r.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW=4]="UPLOAD_MEDIA_ERR_SIZE_OVERFLOW",r[r.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",r[r.UPLOAD_MEDIA_ERR_INTERRUPTED=6]="UPLOAD_MEDIA_ERR_INTERRUPTED",r[r.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="UPLOAD_MEDIA_ERR_NOT_LOGGED_IN"}(Uc||(Uc={})),function(r){r[r.DOWNLOAD_MEDIA_ERR_FAILURE=1]="DOWNLOAD_MEDIA_ERR_FAILURE",r[r.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT",r[r.DOWNLOAD_MEDIA_ERR_TIMEOUT=3]="DOWNLOAD_MEDIA_ERR_TIMEOUT",r[r.DOWNLOAD_MEDIA_ERR_NOT_EXIST=4]="DOWNLOAD_MEDIA_ERR_NOT_EXIST",r[r.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",r[r.DOWNLOAD_MEDIA_ERR_INTERRUPTED=6]="DOWNLOAD_MEDIA_ERR_INTERRUPTED",r[r.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN"}(Vc||(Vc={}));var Sb=Pc.ATTRIBUTE_OPERATION_ERR_FAILURE,Ja=Pc.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,se=Pc.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW;Pc.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN;var Lq=Pc.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND,Tb=Pc.ATTRIBUTE_OPERATION_ERR_TIMEOUT,Ub=Pc.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,hg=rd.CHANNEL_MESSAGE_ERR_FAILURE,Yk=rd.CHANNEL_MESSAGE_ERR_TIMEOUT,Mq=rd.CHANNEL_MESSAGE_ERR_TOO_OFTEN,Hh=rd.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE;rd.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL;var ig=rd.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,Zz=Vk.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,Nq=Wk.CREATE_INSTANCE_ERR_INVALID_ARGUMENT;Sc.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE;var Oq=Sc.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT;Sc.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN;var Pq=Sc.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT,$z=Sc.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT;Sc.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED;var aA=Sc.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,bA=sd.GET_MEMBERS_ERR_FAILURE,cA=sd.GET_MEMBERS_ERR_REJECTED;sd.GET_MEMBERS_ERR_TIMEOUT,sd.GET_MEMBERS_ERR_TOO_OFTEN;var dA=sd.GET_MEMBERS_ERR_NOT_IN_CHANNEL,eA=sd.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,xc=Vd.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,fA=Vd.INVITATION_API_CALL_ERR_NOT_STARTED,Ih=Vd.INVITATION_API_CALL_ERR_ALREADY_END,Qq=Vd.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,gA=Vd.INVITATION_API_CALL_ERR_ALREADY_SENT,Rq=ec.JOIN_CHANNEL_ERR_FAILURE;ec.JOIN_CHANNEL_ERR_REJECTED;var hA=ec.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,Sq=ec.JOIN_CHANNEL_TIMEOUT,Tq=ec.JOIN_CHANNEL_ERR_EXCEED_LIMIT,Uq=ec.JOIN_CHANNEL_ERR_ALREADY_JOINED;ec.JOIN_CHANNEL_ERR_TOO_OFTEN;var Vq=ec.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,Wq=ec.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,Xq=We.LEAVE_CHANNEL_ERR_FAILURE,Yq=We.LEAVE_CHANNEL_ERR_REJECTED,iA=We.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,jA=We.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,Zq=Rb.LOGIN_ERR_UNKNOWN,jg=Rb.LOGIN_ERR_REJECTED,Jh=Rb.LOGIN_ERR_INVALID_ARGUMENT,$q=Rb.LOGIN_ERR_INVALID_APP_ID,ar=Rb.LOGIN_ERR_INVALID_TOKEN,Kh=Rb.LOGIN_ERR_TOKEN_EXPIRED;Rb.LOGIN_ERR_NOT_AUTHORIZED;var kA=Rb.LOGIN_ERR_ALREADY_LOGIN,lA=Rb.LOGIN_ERR_TIMEOUT,mA=Rb.LOGIN_ERR_TOO_OFTEN,br=Xk.LOGOUT_ERR_USER_NOT_LOGGED_IN,cr=Qc.PEER_MESSAGE_ERR_FAILURE,Zk=Qc.PEER_MESSAGE_ERR_TIMEOUT,dr=Qc.PEER_MESSAGE_ERR_TOO_OFTEN,$k=Qc.PEER_MESSAGE_ERR_INVALID_USERID,ve=Qc.PEER_MESSAGE_ERR_INVALID_MESSAGE,al=Qc.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,nA=Qc.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE,er=Wd.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT;Wd.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED;var oA=Wd.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT;Wd.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN;var pA=Wd.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,qA=Rc.RENEW_TOKEN_ERR_FAILURE,rA=Rc.RENEW_TOKEN_ERR_INVALID_ARGUMENT;Rc.RENEW_TOKEN_ERR_REJECTED,Rc.RENEW_TOKEN_ERR_TOO_OFTEN;var sA=Rc.RENEW_TOKEN_ERR_TOKEN_EXPIRED,tA=Rc.RENEW_TOKEN_ERR_INVALID_TOKEN,uA=Rc.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,fr=Tc.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE,kg=Tc.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT;Tc.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED;var vA=Tc.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT;Tc.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN;var gr=Tc.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,bl=Tc.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN;Xe.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE,Xe.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT,Xe.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN,Xe.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN;var lg=Uc.UPLOAD_MEDIA_ERR_FAILURE,wf=Uc.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT,Lh=Uc.UPLOAD_MEDIA_ERR_TIMEOUT,wA=Uc.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW,xA=Uc.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,hr=Uc.UPLOAD_MEDIA_ERR_INTERRUPTED,yA=Uc.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN,mg=Vc.DOWNLOAD_MEDIA_ERR_FAILURE,cl=Vc.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT,zA=Vc.DOWNLOAD_MEDIA_ERR_TIMEOUT,AA=Vc.DOWNLOAD_MEDIA_ERR_NOT_EXIST,BA=Vc.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,ir=Vc.DOWNLOAD_MEDIA_ERR_INTERRUPTED,CA=Vc.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN,DA=function(r,e){var i;return Hk(r,function(o,s,l){return!(i=e(o,s,l))}),!!i},Mh=function(r,e,i){if(!lb(i))return!1;var o=X(e);return!!(o=="number"?Ed(i)&&wk(e,i.length):o=="string"&&e in i)&&$f(i[e],r)},dl=function(r,e,i){var o=Va(r)?tq:DA;return o(r,Te(e))},EA=function(r,e){var i=-1,o=Ed(r)?Array(r.length):[];return Hk(r,function(s,l,f){o[++i]=e(s,l,f)}),o},FA=function(r,e){var i=r.length;for(r.sort(e);i--;)r[i]=r[i].value;return r},GA=function(r,e,i){e=e.length?he(e,function(s){return Va(s)?function(l){return Ch(l,s.length===1?s[0]:s)}:s}):[Dh];var o=-1;return e=he(e,zh(Te)),r=EA(r,function(s,l,f){return{criteria:he(e,function(h){return h(s)}),index:++o,value:s}}),FA(r,function(s,l){e:{for(var f=-1,h=s.criteria,d=l.criteria,p=h.length,g=i.length;++f<p;){t:{var _=h[f],b=d[f];if(_!==b){var x=_!==void 0,A=_===null,k=_==_,C=ie(_),j=b!==void 0,P=b===null,z=b==b,_e=ie(b);if(!P&&!_e&&!C&&_>b||C&&j&&z&&!P&&!_e||A&&j&&z||!x&&z||!k){_=1;break t}if(!A&&!C&&!_e&&_<b||_e&&x&&k&&!A&&!C||P&&x&&k||!j&&k||!z){_=-1;break t}}_=0}if(_){s=f>=g?_:_*(i[f]=="desc"?-1:1);break e}}s=s.index-l.index}return s})},jr=function(r,e){return rq(qq(r,e,Dh),r+"")},kr=jr(function(r,e){if(r==null)return[];var i=e.length;return 1<i&&Mh(r,e[0],e[1])?e=[]:2<i&&Mh(e[0],e[1],e[2])&&(e=[e[0]]),GA(r,$h(e),[])}),lr=function(r){if(r.__esModule)return r;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(r).forEach(function(i){var o=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:function(){return r[i]}})}),e}(Dz),mr=$a(function(r,e){Object.defineProperty(e,"__esModule",{value:!0});var i=[],o=function(s,l){return new WebSocket(s,l)};e.normalClosureMessage="Normal closure",e.default=function(s,l){var f=(l=l===void 0?{protocols:i,makeWebSocket:o}:l).protocols,h=f===void 0?i:f,d=(l=l.makeWebSocket)===void 0?o:l;return new lr.Observable(function(p){var g,_=new lr.Subject,b=d(s,h),x=!1,A=!1,k=function(C){if(g)throw x=!0,C=Error("Web socket message factory function called more than once"),p.error(C),C;return g=C.subscribe(function(j){b.send(j)}),_};return b.onopen=function(){A?(x=!0,b.close()):p.next(k)},b.onmessage=function(C){_.next(C.data)},b.onerror=function(C){x=!0,p.error(Error(C.message))},b.onclose=function(C){x||(x=!0,A?(p.complete(),_.complete()):p.error(Error(C.code===1e3?e.normalClosureMessage:C.reason)))},function(){A=!0,g&&g.unsubscribe(),x||(x=!0,b.close())}})}});(function(r){r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")&&r.default})(mr);var pi=function(r,e,i){(i===void 0||$f(r[e],i))&&(i!==void 0||e in r)||bg(r,e,i)},oi=function(r,e){if((e!=="constructor"||typeof r[e]!="function")&&e!="__proto__")return r[e]},HA=function(r){return jr(function(e,i){var o=-1,s=i.length,l=1<s?i[s-1]:void 0,f=2<s?i[2]:void 0;for(l=3<r.length&&typeof l=="function"?(s--,l):void 0,f&&Mh(i[0],i[1],f)&&(l=3>s?void 0:l,s=1),e=Object(e);++o<s;)(f=i[o])&&r(e,f,o,l);return e})}(function(r,e,i,o){tm(r,e,i,o)}),IA=Math.floor,JA=Math.random,nr=function(r,e){return r+IA(JA()*(e-r+1))},or=function(r){var e=r.length;return e?r[nr(0,e-1)]:void 0},KA=function(r,e){return he(e,function(i){return r[i]})},Ni=function(r){return r==null?[]:KA(r,Ad(r))},LA=function(r){return or(Ni(r))},bn=function(r){return(Va(r)?or:LA)(r)},xm=[],ym=function(r,e){return new WebSocket(r,e)},MA=Math.floor;N({target:"Number",stat:!0},{isInteger:function(r){return!ha(r)&&isFinite(r)&&MA(r)===r}}),Oo("from",Ej,Dj);var NA=function(r,e){for(var i=Array(arguments.length-1),o=0,s=2,l=!0;s<arguments.length;)i[o++]=arguments[s++];return new Promise(function(f,h){i[o]=function(d){if(l)if(l=!1,d)h(d);else{for(var p=Array(arguments.length-1),g=0;g<p.length;)p[g++]=arguments[g];f.apply(null,p)}};try{r.apply(e||null,i)}catch(d){l&&(l=!1,h(d))}})},OA=$a(function(r,e){e.length=function(s){var l=s.length;if(!l)return 0;for(var f=0;1<--l%4&&s.charAt(l)==="=";)++f;return Math.ceil(3*s.length)/4-f};var i=Array(64),o=Array(123);for(r=0;64>r;)o[i[r]=26>r?r+65:52>r?r+71:62>r?r-4:r-59|43]=r++;e.encode=function(s,l,f){for(var h,d=null,p=[],g=0,_=0;l<f;){var b=s[l++];switch(_){case 0:p[g++]=i[b>>2],h=(3&b)<<4,_=1;break;case 1:p[g++]=i[h|b>>4],h=(15&b)<<2,_=2;break;case 2:p[g++]=i[h|b>>6],p[g++]=i[63&b],_=0}8191<g&&((d||(d=[])).push(String.fromCharCode.apply(String,p)),g=0)}return _&&(p[g++]=i[h],p[g++]=61,_===1&&(p[g++]=61)),d?(g&&d.push(String.fromCharCode.apply(String,p.slice(0,g))),d.join("")):String.fromCharCode.apply(String,p.slice(0,g))},e.decode=function(s,l,f){for(var h,d=f,p=0,g=0;g<s.length;){var _=s.charCodeAt(g++);if(_===61&&1<p)break;if((_=o[_])===void 0)throw Error("invalid encoding");switch(p){case 0:h=_,p=1;break;case 1:l[f++]=h<<2|(48&_)>>4,h=_,p=2;break;case 2:l[f++]=(15&h)<<4|(60&_)>>2,h=_,p=3;break;case 3:l[f++]=(3&h)<<6|_,p=0}}if(p===1)throw Error("invalid encoding");return f-d},e.test=function(s){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(s)}});yg.prototype.on=function(r,e,i){return(this._listeners[r]||(this._listeners[r]=[])).push({fn:e,ctx:i||this}),this},yg.prototype.off=function(r,e){if(r===void 0)this._listeners={};else if(e===void 0)this._listeners[r]=[];else{r=this._listeners[r];for(var i=0;i<r.length;)r[i].fn===e?r.splice(i,1):++i}return this},yg.prototype.emit=function(r){var e=this._listeners[r];if(e){for(var i=[],o=1;o<arguments.length;)i.push(arguments[o++]);for(o=0;o<e.length;)e[o].fn.apply(e[o++].ctx,i)}return this};var PA=zm(zm),QA=function(c){try{var a=eval("quire".replace(/^/,"re"))(c);if(a&&(a.length||Object.keys(a).length))return a}catch(r){}return null},RA=$a(function(r,e){e.length=function(i){for(var o,s=0,l=0;l<i.length;++l)128>(o=i.charCodeAt(l))?s+=1:2048>o?s+=2:(64512&o)==55296&&(64512&i.charCodeAt(l+1))==56320?(++l,s+=4):s+=3;return s},e.read=function(i,o,s){if(1>s-o)return"";for(var l,f=null,h=[],d=0;o<s;)128>(l=i[o++])?h[d++]=l:191<l&&224>l?h[d++]=(31&l)<<6|63&i[o++]:239<l&&365>l?(l=((7&l)<<18|(63&i[o++])<<12|(63&i[o++])<<6|63&i[o++])-65536,h[d++]=55296+(l>>10),h[d++]=56320+(1023&l)):h[d++]=(15&l)<<12|(63&i[o++])<<6|63&i[o++],8191<d&&((f||(f=[])).push(String.fromCharCode.apply(String,h)),d=0);return f?(d&&f.push(String.fromCharCode.apply(String,h.slice(0,d))),f.join("")):String.fromCharCode.apply(String,h.slice(0,d))},e.write=function(i,o,s){for(var l,f,h=s,d=0;d<i.length;++d)128>(l=i.charCodeAt(d))?o[s++]=l:(2048>l?o[s++]=l>>6|192:((64512&l)==55296&&(64512&(f=i.charCodeAt(d+1)))==56320?(l=65536+((1023&l)<<10)+(1023&f),++d,o[s++]=l>>18|240,o[s++]=l>>12&63|128):o[s++]=l>>12|224,o[s++]=l>>6&63|128),o[s++]=63&l|128);return s-h}}),SA=function(r,e,i){var o=i||8192,s=o>>>1,l=null,f=o;return function(h){return 1>h||h>s?r(h):(f+h>o&&(l=r(o),f=0),h=e.call(l,f,f+=h),7&f&&(f=1+(7|f)),h)}},Xd=Wa.zero=new Wa(0,0);Xd.toNumber=function(){return 0},Xd.zzEncode=Xd.zzDecode=function(){return this},Xd.length=function(){return 1};var TA=Wa.zeroHash="\0\0\0\0\0\0\0\0";Wa.fromNumber=function(r){if(r===0)return Xd;var e=0>r;e&&(r=-r);var i=r>>>0;return r=(r-i)/4294967296>>>0,e&&(r=~r>>>0,i=~i>>>0,4294967295<++i&&(i=0,4294967295<++r&&(r=0))),new Wa(i,r)},Wa.from=function(r){if(typeof r=="number")return Wa.fromNumber(r);if(V.isString(r)){if(!V.Long)return Wa.fromNumber(parseInt(r,10));r=V.Long.fromString(r)}return r.low||r.high?new Wa(r.low>>>0,r.high>>>0):Xd},Wa.prototype.toNumber=function(r){if(!r&&this.hi>>>31){r=1+~this.lo>>>0;var e=~this.hi>>>0;return r||(e=e+1>>>0),-(r+4294967296*e)}return this.lo+4294967296*this.hi},Wa.prototype.toLong=function(r){return V.Long?new V.Long(0|this.lo,0|this.hi,!!r):{low:0|this.lo,high:0|this.hi,unsigned:!!r}};var td=String.prototype.charCodeAt;Wa.fromHash=function(r){return r===TA?Xd:new Wa((td.call(r,0)|td.call(r,1)<<8|td.call(r,2)<<16|td.call(r,3)<<24)>>>0,(td.call(r,4)|td.call(r,5)<<8|td.call(r,6)<<16|td.call(r,7)<<24)>>>0)},Wa.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},Wa.prototype.zzEncode=function(){var r=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^r)>>>0,this.lo=(this.lo<<1^r)>>>0,this},Wa.prototype.zzDecode=function(){var r=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^r)>>>0,this.hi=(this.hi>>>1^r)>>>0,this},Wa.prototype.length=function(){var r=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?e===0?16384>r?128>r?1:2:2097152>r?3:4:16384>e?128>e?5:6:2097152>e?7:8:128>i?9:10};var V=$a(function(r,e){function i(s,l,f){for(var h=Object.keys(l),d=0;d<h.length;++d)s[h[d]]!==void 0&&f||(s[h[d]]=l[h[d]]);return s}function o(s){function l(f,h){if(!(this instanceof l))return new l(f,h);Object.defineProperty(this,"message",{get:function(){return f}}),Error.captureStackTrace?Error.captureStackTrace(this,l):Object.defineProperty(this,"stack",{value:Error().stack||""}),h&&i(this,h)}return(l.prototype=Object.create(Error.prototype)).constructor=l,Object.defineProperty(l.prototype,"name",{get:function(){return s}}),l.prototype.toString=function(){return this.name+": "+this.message},l}e.asPromise=NA,e.base64=OA,e.EventEmitter=yg,e.float=PA,e.inquire=QA,e.utf8=RA,e.pool=SA,e.LongBits=Wa,e.isNode=!!(Ya!==void 0&&Ya&&Ya.process&&Ya.process.versions&&Ya.process.versions.node),e.global=e.isNode&&Ya||typeof window<"u"&&window||typeof self<"u"&&self||Ya,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(s){return typeof s=="number"&&isFinite(s)&&Math.floor(s)===s},e.isString=function(s){return typeof s=="string"||s instanceof String},e.isObject=function(s){return s&&X(s)==="object"},e.isset=e.isSet=function(s,l){var f=s[l];return!(f==null||!s.hasOwnProperty(l))&&(X(f)!=="object"||0<(Array.isArray(f)?f.length:Object.keys(f).length))},e.Buffer=function(){try{var s=e.inquire("buffer").Buffer;return s.prototype.utf8Write?s:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(s){return typeof s=="number"?e.Buffer?e._Buffer_allocUnsafe(s):new e.Array(s):e.Buffer?e._Buffer_from(s):typeof Uint8Array>"u"?s:new Uint8Array(s)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(s){return s?e.LongBits.from(s).toHash():e.LongBits.zeroHash},e.longFromHash=function(s,l){return s=e.LongBits.fromHash(s),e.Long?e.Long.fromBits(s.lo,s.hi,l):s.toNumber(!!l)},e.merge=i,e.lcFirst=function(s){return s.charAt(0).toLowerCase()+s.substring(1)},e.newError=o,e.ProtocolError=o("ProtocolError"),e.oneOfGetter=function(s){for(var l={},f=0;f<s.length;++f)l[s[f]]=1;return function(){for(var h=Object.keys(this),d=h.length-1;-1<d;--d)if(l[h[d]]===1&&this[h[d]]!==void 0&&this[h[d]]!==null)return h[d]}},e.oneOfSetter=function(s){return function(l){for(var f=0;f<s.length;++f)s[f]!==l&&delete this[s[f]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var s=e.Buffer;s?(e._Buffer_from=s.from!==Uint8Array.from&&s.from||function(l,f){return new s(l,f)},e._Buffer_allocUnsafe=s.allocUnsafe||function(l){return new s(l)}):e._Buffer_from=e._Buffer_allocUnsafe=null}}),xi=ja,el,Nh=V.LongBits,pr=V.base64,qr=V.utf8,rr=function(){return V.Buffer?function(){return(ja.create=function(){return new el})()}:function(){return new ja}};ja.create=rr(),ja.alloc=function(r){return new V.Array(r)},V.Array!==Array&&(ja.alloc=V.pool(ja.alloc,V.Array.prototype.subarray)),ja.prototype._push=function(r,e,i){return this.tail=this.tail.next=new sf(r,e,i),this.len+=e,this},ui.prototype=Object.create(sf.prototype),ui.prototype.fn=function(r,e,i){for(;127<r;)e[i++]=127&r|128,r>>>=7;e[i]=r},ja.prototype.uint32=function(r){return this.len+=(this.tail=this.tail.next=new ui(128>(r>>>=0)?1:16384>r?2:2097152>r?3:268435456>r?4:5,r)).len,this},ja.prototype.int32=function(r){return 0>r?this._push(vi,10,Nh.fromNumber(r)):this.uint32(r)},ja.prototype.sint32=function(r){return this.uint32((r<<1^r>>31)>>>0)},ja.prototype.uint64=function(r){return r=Nh.from(r),this._push(vi,r.length(),r)},ja.prototype.int64=ja.prototype.uint64,ja.prototype.sint64=function(r){return r=Nh.from(r).zzEncode(),this._push(vi,r.length(),r)},ja.prototype.bool=function(r){return this._push(ti,1,r?1:0)},ja.prototype.fixed32=function(r){return this._push(wi,4,r>>>0)},ja.prototype.sfixed32=ja.prototype.fixed32,ja.prototype.fixed64=function(r){return r=Nh.from(r),this._push(wi,4,r.lo)._push(wi,4,r.hi)},ja.prototype.sfixed64=ja.prototype.fixed64,ja.prototype.float=function(r){return this._push(V.float.writeFloatLE,4,r)},ja.prototype.double=function(r){return this._push(V.float.writeDoubleLE,8,r)};var UA=V.Array.prototype.set?function(r,e,i){e.set(r,i)}:function(r,e,i){for(var o=0;o<r.length;++o)e[i+o]=r[o]};ja.prototype.bytes=function(r){var e=r.length>>>0;if(!e)return this._push(ti,1,0);if(V.isString(r)){var i=ja.alloc(e=pr.length(r));pr.decode(r,i,0),r=i}return this.uint32(e)._push(UA,e,r)},ja.prototype.string=function(r){var e=qr.length(r);return e?this.uint32(e)._push(qr.write,e,r):this._push(ti,1,0)},ja.prototype.fork=function(){return this.states=new Tt(this),this.head=this.tail=new sf(si,0,0),this.len=0,this},ja.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new sf(si,0,0),this.len=0),this},ja.prototype.ldelim=function(){var r=this.head,e=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=r.next,this.tail=e,this.len+=i),this},ja.prototype.finish=function(){for(var r=this.head.next,e=this.constructor.alloc(this.len),i=0;r;)r.fn(r.val,e,i),i+=r.len,r=r.next;return e},ja._configure=function(r){el=r,ja.create=rr(),el._configure()},(jc.prototype=Object.create(xi.prototype)).constructor=jc,jc._configure=function(){jc.alloc=V._Buffer_allocUnsafe,jc.writeBytesBuffer=V.Buffer&&V.Buffer.prototype instanceof Uint8Array&&V.Buffer.prototype.set.name==="set"?function(r,e,i){e.set(r,i)}:function(r,e,i){if(r.copy)r.copy(e,i,0,r.length);else for(var o=0;o<r.length;)e[i++]=r[o++]}},jc.prototype.bytes=function(r){V.isString(r)&&(r=V._Buffer_from(r,"base64"));var e=r.length>>>0;return this.uint32(e),e&&this._push(jc.writeBytesBuffer,e,r),this},jc.prototype.string=function(r){var e=V.Buffer.byteLength(r);return this.uint32(e),e&&this._push(Ut,e,r),this},jc._configure();var zi=La,fl,Em=V.LongBits,VA=V.utf8,sr=typeof Uint8Array<"u"?function(r){if(r instanceof Uint8Array||Array.isArray(r))return new La(r);throw Error("illegal buffer")}:function(r){if(Array.isArray(r))return new La(r);throw Error("illegal buffer")},tr=function(){return V.Buffer?function(r){return(La.create=function(e){return V.Buffer.isBuffer(e)?new fl(e):sr(e)})(r)}:sr};La.create=tr(),La.prototype._slice=V.Array.prototype.subarray||V.Array.prototype.slice,La.prototype.uint32=function(){var r=4294967295;return function(){if(r=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++]||(r=(r|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])||(r=(r|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])||(r=(r|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])||(r=(r|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++]))return r;if((this.pos+=5)>this.len)throw this.pos=this.len,Yb(this,10);return r}}(),La.prototype.int32=function(){return 0|this.uint32()},La.prototype.sint32=function(){var r=this.uint32();return r>>>1^-(1&r)|0},La.prototype.bool=function(){return this.uint32()!==0},La.prototype.fixed32=function(){if(this.pos+4>this.len)throw Yb(this,4);return zg(this.buf,this.pos+=4)},La.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Yb(this,4);return 0|zg(this.buf,this.pos+=4)},La.prototype.float=function(){if(this.pos+4>this.len)throw Yb(this,4);var r=V.float.readFloatLE(this.buf,this.pos);return this.pos+=4,r},La.prototype.double=function(){if(this.pos+8>this.len)throw Yb(this,4);var r=V.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,r},La.prototype.bytes=function(){var r=this.uint32(),e=this.pos,i=this.pos+r;if(i>this.len)throw Yb(this,r);return this.pos+=r,Array.isArray(this.buf)?this.buf.slice(e,i):e===i?new this.buf.constructor(0):this._slice.call(this.buf,e,i)},La.prototype.string=function(){var r=this.bytes();return VA.read(r,0,r.length)},La.prototype.skip=function(r){if(typeof r=="number"){if(this.pos+r>this.len)throw Yb(this,r);this.pos+=r}else do if(this.pos>=this.len)throw Yb(this);while(128&this.buf[this.pos++]);return this},La.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=7&this.uint32())!=4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this},La._configure=function(r){fl=r,La.create=tr(),fl._configure();var e=V.Long?"toLong":"toNumber";V.merge(La.prototype,{int64:function(){return yi.call(this)[e](!1)},uint64:function(){return yi.call(this)[e](!0)},sint64:function(){return yi.call(this).zzDecode()[e](!1)},fixed64:function(){return Fm.call(this)[e](!0)},sfixed64:function(){return Fm.call(this)[e](!1)}})},(Fd.prototype=Object.create(zi.prototype)).constructor=Fd,Fd._configure=function(){V.Buffer&&(Fd.prototype._slice=V.Buffer.prototype.slice)},Fd.prototype.string=function(){var r=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+r,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+r,this.len))},Fd._configure(),(tf.prototype=Object.create(V.EventEmitter.prototype)).constructor=tf,tf.prototype.rpcCall=function r(e,i,o,s,l){if(!s)throw TypeError("request must be specified");var f=this;if(!l)return V.asPromise(r,f,e,i,o,s);if(f.rpcImpl)try{return f.rpcImpl(e,i[f.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(h,d){if(h)return f.emit("error",h,e),l(h);if(d!==null){if(!(d instanceof o))try{d=o[f.responseDelimited?"decodeDelimited":"decode"](d)}catch(p){return f.emit("error",p,e),l(p)}return f.emit("data",d,e),l(null,d)}f.end(!0)})}catch(h){f.emit("error",h,e),setTimeout(function(){l(h)},0)}else setTimeout(function(){l(Error("already ended"))},0)},tf.prototype.end=function(r){return this.rpcImpl&&(r||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var WA=$a(function(r,e){e.Service=tf}),XA={},fc=$a(function(r,e){function i(){o.util._configure(),o.Writer._configure(o.BufferWriter),o.Reader._configure(o.BufferReader)}var o=e;o.build="minimal",o.Writer=xi,o.BufferWriter=jc,o.Reader=zi,o.BufferReader=Fd,o.util=V,o.rpc=WA,o.roots=XA,o.configure=i,i()});fc.util.Long=U,fc.configure();var u=fc.Reader,L=fc.Writer,q=fc.util,t=fc.roots.default||(fc.roots.default={}),YA=t.URI=function(){var r={},e=Object.create(r);return e[r[0]="Unknown"]=0,e[r[1]="PingUri"]=1,e[r[2]="PongUri"]=2,e[r[11]="UserJoinUri"]=11,e[r[12]="UserRespUri"]=12,e[r[21]="UserQuitUri"]=21,e[r[22]="UserDropUri"]=22,e[r[31]="GroupEnterUri"]=31,e[r[32]="GroupLeaveUri"]=32,e[r[33]="GroupReplyUri"]=33,e[r[36]="GroupEnterNoticeUri"]=36,e[r[37]="GroupLeaveNoticeUri"]=37,e[r[38]="GroupEventNoticeUri"]=38,e[r[39]="GroupCountNoticeUri"]=39,e[r[41]="UserStatusListUri"]=41,e[r[42]="UserStatusResultUri"]=42,e[r[51]="GroupStatusListUri"]=51,e[r[52]="GroupStatusResultUri"]=52,e[r[55]="GroupAllUsersListUri"]=55,e[r[56]="GroupAllUsersResultUri"]=56,e[r[100]="MessageUri"]=100,e[r[101]="AckUri"]=101,e[r[115]="FileUploadIndexGetUri"]=115,e[r[116]="FileUploadIndexRetUri"]=116,e[r[117]="FileUploadIndexSetUri"]=117,e[r[118]="FileUploadIndexFinUri"]=118,e[r[119]="FileUploadIndexErrUri"]=119,e[r[125]="FileDownloadIndexGetUri"]=125,e[r[126]="FileDownloadIndexRetUri"]=126,e[r[127]="FileDownloadIndexErrUri"]=127,e[r[201]="UserJoinNoticeUri"]=201,e[r[202]="UserQuitNoticeUri"]=202,e[r[203]="UserWaitNoticeUri"]=203,e[r[301]="UserAttributeGetUri"]=301,e[r[302]="UserAttributeRetUri"]=302,e[r[303]="UserAttributeSetUri"]=303,e[r[304]="UserAttributeModUri"]=304,e[r[305]="UserAttributeDelUri"]=305,e[r[307]="UserAttributeRspUri"]=307,e[r[308]="UserAttributeErrUri"]=308,e[r[311]="UserAttributeKeysGetUri"]=311,e[r[312]="UserAttributeKeysRetUri"]=312,e[r[351]="GroupAttributeGetUri"]=351,e[r[352]="GroupAttributeRetUri"]=352,e[r[353]="GroupAttributeSetUri"]=353,e[r[354]="GroupAttributeModUri"]=354,e[r[355]="GroupAttributeDelUri"]=355,e[r[356]="GroupAttributeAltUri"]=356,e[r[357]="GroupAttributeRspUri"]=357,e[r[358]="GroupAttributeErrUri"]=358,e[r[361]="GroupAttributeKeysGetUri"]=361,e[r[362]="GroupAttributeKeysRetUri"]=362,e[r[401]="SubscribeUserStatusUri"]=401,e[r[402]="UnsubscribeUserStatusUri"]=402,e[r[499]="SubscribeResponseUri"]=499,e}(),Oh=t.Wrapper=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.uri=0,r.prototype.data=q.newBuffer([]),r.encode=function(e,i){return i||(i=L.create()),e.uri!=null&&Object.hasOwnProperty.call(e,"uri")&&i.uint32(8).int32(e.uri),e.data!=null&&Object.hasOwnProperty.call(e,"data")&&i.uint32(18).bytes(e.data),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.Wrapper;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.uri=e.int32();break;case 2:o.data=e.bytes();break;default:e.skipType(7&s)}}return o},r}(),ZA=t.Ping=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.ms!=null&&Object.hasOwnProperty.call(e,"ms")&&i.uint32(16).uint64(e.ms),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.Ping;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.ms=e.uint64();break;default:e.skipType(7&s)}}return o},r}(),$A=t.Pong=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.ms!=null&&Object.hasOwnProperty.call(e,"ms")&&i.uint32(16).uint64(e.ms),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.Pong;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.ms=e.uint64();break;default:e.skipType(7&s)}}return o},r}(),aB=t.UserJoin=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.opt=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.account="",r.prototype.ticket="",r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.opt!=null&&Object.hasOwnProperty.call(e,"opt")&&i.uint32(16).uint64(e.opt),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(24).uint64(e.instance),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(34).string(e.account),e.ticket!=null&&Object.hasOwnProperty.call(e,"ticket")&&i.uint32(42).string(e.ticket),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserJoin;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.opt=e.uint64();break;case 3:o.instance=e.uint64();break;case 4:o.account=e.string();break;case 5:o.ticket=e.string();break;default:e.skipType(7&s)}}return o},r}(),bB=t.UserResp=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.account="",r.prototype.code=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(18).string(e.account),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&i.uint32(24).uint32(e.code),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserResp;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.account=e.string();break;case 3:o.code=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),cB=t.UserQuit=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.encode=function(e,i){return i||(i=L.create()),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserQuit;e.pos<i;){var s=e.uint32();e.skipType(7&s)}return o},r}(),dB=t.UserDrop=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.code=0,r.encode=function(e,i){return i||(i=L.create()),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&i.uint32(8).uint32(e.code),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserDrop;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.code=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),eB=t.GroupEnter=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.account="",r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(18).string(e.account),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupEnter;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.account=e.string();break;default:e.skipType(7&s)}}return o},r}(),fB=t.GroupLeave=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.account="",r.encode=function(e,i){return i||(i=L.create()),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(10).string(e.account),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupLeave;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.account=e.string();break;default:e.skipType(7&s)}}return o},r}(),gB=t.GroupReply=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.account="",r.prototype.code=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(18).string(e.account),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&i.uint32(24).uint32(e.code),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupReply;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.account=e.string();break;case 3:o.code=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),ur=t.GroupLeaveNotice=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.user="",r.prototype.group="",r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.size=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&i.uint32(18).string(e.user),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(26).string(e.group),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(32).uint64(e.instance),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&i.uint32(40).uint32(e.size),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupLeaveNotice;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.user=e.string();break;case 3:o.group=e.string();break;case 4:o.instance=e.uint64();break;case 5:o.size=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),vr=t.GroupEnterNotice=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.user="",r.prototype.group="",r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.size=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&i.uint32(18).string(e.user),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(26).string(e.group),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(32).uint64(e.instance),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&i.uint32(40).uint32(e.size),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupEnterNotice;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.user=e.string();break;case 3:o.group=e.string();break;case 4:o.instance=e.uint64();break;case 5:o.size=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),wr=t.Message=function(){function r(e){if(this.MiscMap={},e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.dialogue=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.sequence=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.options=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.src="",r.prototype.dst="",r.prototype.payload=q.newBuffer([]),r.prototype.MiscMap=q.emptyObject,r.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,r.encode=function(e,i){if(i||(i=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(8).uint64(e.instance),e.dialogue!=null&&Object.hasOwnProperty.call(e,"dialogue")&&i.uint32(16).uint64(e.dialogue),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&i.uint32(24).uint64(e.sequence),e.options!=null&&Object.hasOwnProperty.call(e,"options")&&i.uint32(32).uint64(e.options),e.src!=null&&Object.hasOwnProperty.call(e,"src")&&i.uint32(42).string(e.src),e.dst!=null&&Object.hasOwnProperty.call(e,"dst")&&i.uint32(50).string(e.dst),e.payload!=null&&Object.hasOwnProperty.call(e,"payload")&&i.uint32(58).bytes(e.payload),e.MiscMap!=null&&Object.hasOwnProperty.call(e,"MiscMap"))for(var o=Object.keys(e.MiscMap),s=0;s<o.length;++s)i.uint32(66).fork().uint32(10).string(o[s]).uint32(18).bytes(e.MiscMap[o[s]]).ldelim();return e.ms!=null&&Object.hasOwnProperty.call(e,"ms")&&i.uint32(72).uint64(e.ms),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o,s,l=new t.Message;e.pos<i;)switch(o=e.uint32(),o>>>3){case 1:l.instance=e.uint64();break;case 2:l.dialogue=e.uint64();break;case 3:l.sequence=e.uint64();break;case 4:l.options=e.uint64();break;case 5:l.src=e.string();break;case 6:l.dst=e.string();break;case 7:l.payload=e.bytes();break;case 8:l.MiscMap===q.emptyObject&&(l.MiscMap={});var f=e.uint32()+e.pos;for(o="",s=[];e.pos<f;){var h=e.uint32();switch(h>>>3){case 1:o=e.string();break;case 2:s=e.bytes();break;default:e.skipType(7&h)}}l.MiscMap[o]=s;break;case 9:l.ms=e.uint64();break;default:e.skipType(7&o)}return l},r}(),xr=t.Ack=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.dialogue=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.sequence=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.code=0,r.encode=function(e,i){return i||(i=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(8).uint64(e.instance),e.dialogue!=null&&Object.hasOwnProperty.call(e,"dialogue")&&i.uint32(16).uint64(e.dialogue),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&i.uint32(24).uint64(e.sequence),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&i.uint32(32).uint32(e.code),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.Ack;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.instance=e.uint64();break;case 2:o.dialogue=e.uint64();break;case 3:o.sequence=e.uint64();break;case 4:o.code=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),hB=t.FileUploadIndexGet=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.hash=q.newBuffer([]),r.prototype.size=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.hash!=null&&Object.hasOwnProperty.call(e,"hash")&&i.uint32(18).bytes(e.hash),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&i.uint32(24).uint32(e.size),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.FileUploadIndexGet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.hash=e.bytes();break;case 3:o.size=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),iB=t.FileUploadIndexRet=function(){function r(e){if(this.servers=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.unit=0,r.prototype.servers=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&i.uint32(16).uint32(e.unit),e.servers!=null&&e.servers.length){i.uint32(26).fork();for(var o=0;o<e.servers.length;++o)i.uint32(e.servers[o]);i.ldelim()}return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.FileUploadIndexRet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.unit=e.uint32();break;case 3:if(o.servers&&o.servers.length||(o.servers=[]),(7&s)==2)for(s=e.uint32()+e.pos;e.pos<s;)o.servers.push(e.uint32());else o.servers.push(e.uint32());break;default:e.skipType(7&s)}}return o},r}(),jB=t.FileUploadIndexSet=function(){function r(e){if(this.servers=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.hash=q.newBuffer([]),r.prototype.unit=0,r.prototype.servers=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.hash!=null&&Object.hasOwnProperty.call(e,"hash")&&i.uint32(18).bytes(e.hash),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&i.uint32(24).uint32(e.unit),e.servers!=null&&e.servers.length){i.uint32(34).fork();for(var o=0;o<e.servers.length;++o)i.uint32(e.servers[o]);i.ldelim()}return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.FileUploadIndexSet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.hash=e.bytes();break;case 3:o.unit=e.uint32();break;case 4:if(o.servers&&o.servers.length||(o.servers=[]),(7&s)==2)for(s=e.uint32()+e.pos;e.pos<s;)o.servers.push(e.uint32());else o.servers.push(e.uint32());break;default:e.skipType(7&s)}}return o},r}(),kB=t.FileUploadIndexFin=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.zone=0,r.prototype.unit=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.zone!=null&&Object.hasOwnProperty.call(e,"zone")&&i.uint32(16).uint32(e.zone),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&i.uint32(24).uint32(e.unit),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.FileUploadIndexFin;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.zone=e.uint32();break;case 3:o.unit=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),lB=t.FileUploadIndexErr=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.code=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&i.uint32(16).uint32(e.code),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.FileUploadIndexErr;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.code=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),mB=t.FileDownloadIndexGet=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.zone=0,r.prototype.hash=q.newBuffer([]),r.prototype.size=0,r.prototype.unit=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.zone!=null&&Object.hasOwnProperty.call(e,"zone")&&i.uint32(16).uint32(e.zone),e.hash!=null&&Object.hasOwnProperty.call(e,"hash")&&i.uint32(26).bytes(e.hash),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&i.uint32(32).uint32(e.size),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&i.uint32(40).uint32(e.unit),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.FileDownloadIndexGet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.zone=e.uint32();break;case 3:o.hash=e.bytes();break;case 4:o.size=e.uint32();break;case 5:o.unit=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),nB=t.FileDownloadIndexRet=function(){function r(e){if(this.servers=[],this.backups=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.unit=0,r.prototype.zone=0,r.prototype.servers=q.emptyArray,r.prototype.backups=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&i.uint32(16).uint32(e.unit),e.zone!=null&&Object.hasOwnProperty.call(e,"zone")&&i.uint32(24).uint32(e.zone),e.servers!=null&&e.servers.length){i.uint32(34).fork();for(var o=0;o<e.servers.length;++o)i.uint32(e.servers[o]);i.ldelim()}if(e.backups!=null&&e.backups.length){for(i.uint32(42).fork(),o=0;o<e.backups.length;++o)i.uint32(e.backups[o]);i.ldelim()}return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.FileDownloadIndexRet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.unit=e.uint32();break;case 3:o.zone=e.uint32();break;case 4:if(o.servers&&o.servers.length||(o.servers=[]),(7&s)==2)for(s=e.uint32()+e.pos;e.pos<s;)o.servers.push(e.uint32());else o.servers.push(e.uint32());break;case 5:if(o.backups&&o.backups.length||(o.backups=[]),(7&s)==2)for(s=e.uint32()+e.pos;e.pos<s;)o.backups.push(e.uint32());else o.backups.push(e.uint32());break;default:e.skipType(7&s)}}return o},r}(),oB=t.FileDownloadIndexErr=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.code=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&i.uint32(16).uint32(e.code),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.FileDownloadIndexErr;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.code=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),pB=t.GroupAllUsersList=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.group="",r.prototype.pageSize=0,r.prototype.pageNumber=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(18).string(e.group),e.pageSize!=null&&Object.hasOwnProperty.call(e,"pageSize")&&i.uint32(24).uint32(e.pageSize),e.pageNumber!=null&&Object.hasOwnProperty.call(e,"pageNumber")&&i.uint32(32).uint32(e.pageNumber),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAllUsersList;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.group=e.string();break;case 3:o.pageSize=e.uint32();break;case 4:o.pageNumber=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),qB=t.GroupAllUsersResult=function(){function r(e){if(this.memberInfos=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.group="",r.prototype.totalSize=0,r.prototype.pageSize=0,r.prototype.pageNumber=0,r.prototype.memberInfos=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(18).string(e.group),e.totalSize!=null&&Object.hasOwnProperty.call(e,"totalSize")&&i.uint32(24).uint32(e.totalSize),e.pageSize!=null&&Object.hasOwnProperty.call(e,"pageSize")&&i.uint32(32).uint32(e.pageSize),e.pageNumber!=null&&Object.hasOwnProperty.call(e,"pageNumber")&&i.uint32(40).uint32(e.pageNumber),e.memberInfos!=null&&e.memberInfos.length)for(var o=0;o<e.memberInfos.length;++o)t.GroupAllUsersResult.MemberInfo.encode(e.memberInfos[o],i.uint32(50).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAllUsersResult;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.group=e.string();break;case 3:o.totalSize=e.uint32();break;case 4:o.pageSize=e.uint32();break;case 5:o.pageNumber=e.uint32();break;case 6:o.memberInfos&&o.memberInfos.length||(o.memberInfos=[]),o.memberInfos.push(t.GroupAllUsersResult.MemberInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.MemberInfo=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(i,o){return o||(o=L.create()),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&o.uint32(10).string(i.account),i.ts!=null&&Object.hasOwnProperty.call(i,"ts")&&o.uint32(16).uint32(i.ts),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.GroupAllUsersResult.MemberInfo;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.account=i.string();break;case 2:s.ts=i.uint32();break;default:i.skipType(7&l)}}return s},e}(),r}(),rB=t.UserStatusList=function(){function r(e){if(this.users=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.users=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.users!=null&&e.users.length)for(var o=0;o<e.users.length;++o)i.uint32(18).string(e.users[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserStatusList;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.users&&o.users.length||(o.users=[]),o.users.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),sB=t.UserStatusResult=function(){function r(e){if(this.userInfos=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.userInfos=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.userInfos!=null&&e.userInfos.length)for(var o=0;o<e.userInfos.length;++o)t.UserStatusResult.UserStatusInfo.encode(e.userInfos[o],i.uint32(18).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserStatusResult;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.userInfos&&o.userInfos.length||(o.userInfos=[]),o.userInfos.push(t.UserStatusResult.UserStatusInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.UserStatusInfo=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(i,o){return o||(o=L.create()),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&o.uint32(10).string(i.account),i.ts!=null&&Object.hasOwnProperty.call(i,"ts")&&o.uint32(16).uint32(i.ts),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.UserStatusResult.UserStatusInfo;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.account=i.string();break;case 2:s.ts=i.uint32();break;default:i.skipType(7&l)}}return s},e}(),r}(),tB=t.UserAttributeGet=function(){function r(e){if(this.attributes=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.account="",r.prototype.attributes=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(18).string(e.account),e.attributes!=null&&e.attributes.length)for(var o=0;o<e.attributes.length;++o)i.uint32(26).string(e.attributes[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserAttributeGet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.account=e.string();break;case 3:o.attributes&&o.attributes.length||(o.attributes=[]),o.attributes.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),uB=t.UserAttributeRet=function(){function r(e){if(this.attributeInfos=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.attributeInfos=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.attributeInfos!=null&&e.attributeInfos.length)for(var o=0;o<e.attributeInfos.length;++o)t.UserAttributeRet.AttributeInfo.encode(e.attributeInfos[o],i.uint32(18).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserAttributeRet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.attributeInfos&&o.attributeInfos.length||(o.attributeInfos=[]),o.attributeInfos.push(t.UserAttributeRet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.AttributeInfo=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.key="",e.prototype.value="",e.encode=function(i,o){return o||(o=L.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&o.uint32(10).string(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&o.uint32(18).string(i.value),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.UserAttributeRet.AttributeInfo;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.key=i.string();break;case 2:s.value=i.string();break;default:i.skipType(7&l)}}return s},e}(),r}(),vB=t.UserAttributeSet=function(){function r(e){if(this.attributeInfos=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.account="",r.prototype.attributeInfos=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(18).string(e.account),e.attributeInfos!=null&&e.attributeInfos.length)for(var o=0;o<e.attributeInfos.length;++o)t.UserAttributeSet.AttributeInfo.encode(e.attributeInfos[o],i.uint32(26).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserAttributeSet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.account=e.string();break;case 3:o.attributeInfos&&o.attributeInfos.length||(o.attributeInfos=[]),o.attributeInfos.push(t.UserAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.AttributeInfo=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.key="",e.prototype.value="",e.encode=function(i,o){return o||(o=L.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&o.uint32(10).string(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&o.uint32(18).string(i.value),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.UserAttributeSet.AttributeInfo;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.key=i.string();break;case 2:s.value=i.string();break;default:i.skipType(7&l)}}return s},e}(),r}(),wB=t.UserAttributeMod=function(){function r(e){if(this.attributeInfos=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.account="",r.prototype.attributeInfos=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(18).string(e.account),e.attributeInfos!=null&&e.attributeInfos.length)for(var o=0;o<e.attributeInfos.length;++o)t.UserAttributeMod.AttributeInfo.encode(e.attributeInfos[o],i.uint32(26).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserAttributeMod;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.account=e.string();break;case 3:o.attributeInfos&&o.attributeInfos.length||(o.attributeInfos=[]),o.attributeInfos.push(t.UserAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.AttributeInfo=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.key="",e.prototype.value="",e.encode=function(i,o){return o||(o=L.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&o.uint32(10).string(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&o.uint32(18).string(i.value),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.UserAttributeMod.AttributeInfo;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.key=i.string();break;case 2:s.value=i.string();break;default:i.skipType(7&l)}}return s},e}(),r}(),xB=t.UserAttributeDel=function(){function r(e){if(this.attributes=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.account="",r.prototype.attributes=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(18).string(e.account),e.attributes!=null&&e.attributes.length)for(var o=0;o<e.attributes.length;++o)i.uint32(26).string(e.attributes[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserAttributeDel;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.account=e.string();break;case 3:o.attributes&&o.attributes.length||(o.attributes=[]),o.attributes.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),yB=t.UserAttributeErr=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.code=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&i.uint32(16).uint32(e.code),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserAttributeErr;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.code=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),zB=t.UserAttributeKeysGet=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.account="",r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&i.uint32(18).string(e.account),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserAttributeKeysGet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.account=e.string();break;default:e.skipType(7&s)}}return o},r}(),AB=t.UserAttributeKeysRet=function(){function r(e){if(this.keys=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.keys=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.keys!=null&&e.keys.length)for(var o=0;o<e.keys.length;++o)i.uint32(18).string(e.keys[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserAttributeKeysRet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.keys&&o.keys.length||(o.keys=[]),o.keys.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),BB=t.UserAttributeRsp=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserAttributeRsp;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;default:e.skipType(7&s)}}return o},r}(),CB=t.GroupStatusList=function(){function r(e){if(this.groups=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.groups=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.groups!=null&&e.groups.length)for(var o=0;o<e.groups.length;++o)i.uint32(18).string(e.groups[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupStatusList;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.groups&&o.groups.length||(o.groups=[]),o.groups.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),DB=t.GroupStatusResult=function(){function r(e){if(this.groupInfos=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.groupInfos=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.groupInfos!=null&&e.groupInfos.length)for(var o=0;o<e.groupInfos.length;++o)t.GroupStatusResult.GroupInfo.encode(e.groupInfos[o],i.uint32(18).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupStatusResult;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.groupInfos&&o.groupInfos.length||(o.groupInfos=[]),o.groupInfos.push(t.GroupStatusResult.GroupInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.GroupInfo=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.group="",e.prototype.memberCount=0,e.encode=function(i,o){return o||(o=L.create()),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&o.uint32(10).string(i.group),i.memberCount!=null&&Object.hasOwnProperty.call(i,"memberCount")&&o.uint32(16).uint32(i.memberCount),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.GroupStatusResult.GroupInfo;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.group=i.string();break;case 2:s.memberCount=i.uint32();break;default:i.skipType(7&l)}}return s},e}(),r}(),EB=t.GroupCountNotice=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.group="",r.prototype.size=0,r.encode=function(e,i){return i||(i=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(16).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(26).string(e.group),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&i.uint32(32).uint32(e.size),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupCountNotice;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.instance=e.uint64();break;case 2:o.seq=e.uint64();break;case 3:o.group=e.string();break;case 4:o.size=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),FB=t.GroupAttributeGet=function(){function r(e){if(this.attributes=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.group="",r.prototype.attributes=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(18).string(e.group),e.attributes!=null&&e.attributes.length)for(var o=0;o<e.attributes.length;++o)i.uint32(26).string(e.attributes[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeGet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.group=e.string();break;case 3:o.attributes&&o.attributes.length||(o.attributes=[]),o.attributes.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),GB=t.GroupAttributeRet=function(){function r(e){if(this.attributeMaps=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.attributeMaps=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.attributeMaps!=null&&e.attributeMaps.length)for(var o=0;o<e.attributeMaps.length;++o)t.GroupAttributeRet.AttributeMap.encode(e.attributeMaps[o],i.uint32(18).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeRet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.attributeMaps&&o.attributeMaps.length||(o.attributeMaps=[]),o.attributeMaps.push(t.GroupAttributeRet.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.AttributeMap=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(i,o){return o||(o=L.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&o.uint32(10).string(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&o.uint32(18).string(i.value),i.origin!=null&&Object.hasOwnProperty.call(i,"origin")&&o.uint32(26).string(i.origin),i.ms!=null&&Object.hasOwnProperty.call(i,"ms")&&o.uint32(32).uint64(i.ms),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.GroupAttributeRet.AttributeMap;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.key=i.string();break;case 2:s.value=i.string();break;case 3:s.origin=i.string();break;case 4:s.ms=i.uint64();break;default:i.skipType(7&l)}}return s},e}(),r}(),HB=t.GroupAttributeSet=function(){function r(e){if(this.attributeInfos=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.group="",r.prototype.broadcast=!1,r.prototype.attributeInfos=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(18).string(e.group),e.broadcast!=null&&Object.hasOwnProperty.call(e,"broadcast")&&i.uint32(24).bool(e.broadcast),e.attributeInfos!=null&&e.attributeInfos.length)for(var o=0;o<e.attributeInfos.length;++o)t.GroupAttributeSet.AttributeInfo.encode(e.attributeInfos[o],i.uint32(34).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeSet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.group=e.string();break;case 3:o.broadcast=e.bool();break;case 4:o.attributeInfos&&o.attributeInfos.length||(o.attributeInfos=[]),o.attributeInfos.push(t.GroupAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.AttributeInfo=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.key="",e.prototype.value="",e.encode=function(i,o){return o||(o=L.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&o.uint32(10).string(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&o.uint32(18).string(i.value),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.GroupAttributeSet.AttributeInfo;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.key=i.string();break;case 2:s.value=i.string();break;default:i.skipType(7&l)}}return s},e}(),r}(),IB=t.GroupAttributeMod=function(){function r(e){if(this.attributeInfos=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.group="",r.prototype.broadcast=!1,r.prototype.attributeInfos=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(18).string(e.group),e.broadcast!=null&&Object.hasOwnProperty.call(e,"broadcast")&&i.uint32(24).bool(e.broadcast),e.attributeInfos!=null&&e.attributeInfos.length)for(var o=0;o<e.attributeInfos.length;++o)t.GroupAttributeMod.AttributeInfo.encode(e.attributeInfos[o],i.uint32(34).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeMod;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.group=e.string();break;case 3:o.broadcast=e.bool();break;case 4:o.attributeInfos&&o.attributeInfos.length||(o.attributeInfos=[]),o.attributeInfos.push(t.GroupAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.AttributeInfo=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.key="",e.prototype.value="",e.encode=function(i,o){return o||(o=L.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&o.uint32(10).string(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&o.uint32(18).string(i.value),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.GroupAttributeMod.AttributeInfo;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.key=i.string();break;case 2:s.value=i.string();break;default:i.skipType(7&l)}}return s},e}(),r}(),JB=t.GroupAttributeDel=function(){function r(e){if(this.attributes=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.group="",r.prototype.broadcast=!1,r.prototype.attributes=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(18).string(e.group),e.broadcast!=null&&Object.hasOwnProperty.call(e,"broadcast")&&i.uint32(24).bool(e.broadcast),e.attributes!=null&&e.attributes.length)for(var o=0;o<e.attributes.length;++o)i.uint32(34).string(e.attributes[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeDel;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.group=e.string();break;case 3:o.broadcast=e.bool();break;case 4:o.attributes&&o.attributes.length||(o.attributes=[]),o.attributes.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),KB=t.GroupAttributeAlt=function(){function r(e){if(this.attributeMaps=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.group="",r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.attributeMaps=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(18).string(e.group),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(24).uint64(e.instance),e.attributeMaps!=null&&e.attributeMaps.length)for(var o=0;o<e.attributeMaps.length;++o)t.GroupAttributeAlt.AttributeMap.encode(e.attributeMaps[o],i.uint32(34).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeAlt;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.group=e.string();break;case 3:o.instance=e.uint64();break;case 4:o.attributeMaps&&o.attributeMaps.length||(o.attributeMaps=[]),o.attributeMaps.push(t.GroupAttributeAlt.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.AttributeMap=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(i,o){return o||(o=L.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&o.uint32(10).string(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&o.uint32(18).string(i.value),i.origin!=null&&Object.hasOwnProperty.call(i,"origin")&&o.uint32(26).string(i.origin),i.ms!=null&&Object.hasOwnProperty.call(i,"ms")&&o.uint32(32).uint64(i.ms),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.GroupAttributeAlt.AttributeMap;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.key=i.string();break;case 2:s.value=i.string();break;case 3:s.origin=i.string();break;case 4:s.ms=i.uint64();break;default:i.skipType(7&l)}}return s},e}(),r}(),LB=t.GroupAttributeRsp=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeRsp;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;default:e.skipType(7&s)}}return o},r}(),MB=t.GroupAttributeErr=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.code=0,r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&i.uint32(16).uint32(e.code),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeErr;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.code=e.uint32();break;default:e.skipType(7&s)}}return o},r}(),NB=t.GroupAttributeKeysGet=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.group="",r.encode=function(e,i){return i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&i.uint32(18).string(e.group),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeKeysGet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.group=e.string();break;default:e.skipType(7&s)}}return o},r}(),OB=t.GroupAttributeKeysRet=function(){function r(e){if(this.keys=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.keys=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.keys!=null&&e.keys.length)for(var o=0;o<e.keys.length;++o)i.uint32(18).string(e.keys[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.GroupAttributeKeysRet;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.keys&&o.keys.length||(o.keys=[]),o.keys.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),PB=t.SubscribeUserStatus=function(){function r(e){if(this.users=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.users=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.users!=null&&e.users.length)for(var o=0;o<e.users.length;++o)i.uint32(18).string(e.users[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.SubscribeUserStatus;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.users&&o.users.length||(o.users=[]),o.users.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),QB=t.UnsubscribeUserStatus=function(){function r(e){if(this.users=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.users=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.users!=null&&e.users.length)for(var o=0;o<e.users.length;++o)i.uint32(18).string(e.users[o]);return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UnsubscribeUserStatus;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.users&&o.users.length||(o.users=[]),o.users.push(e.string());break;default:e.skipType(7&s)}}return o},r}(),RB=t.UserJoinNotice=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.user="",r.encode=function(e,i){return i||(i=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(16).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&i.uint32(26).string(e.user),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserJoinNotice;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.instance=e.uint64();break;case 2:o.seq=e.uint64();break;case 3:o.user=e.string();break;default:e.skipType(7&s)}}return o},r}(),SB=t.UserQuitNotice=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.user="",r.encode=function(e,i){return i||(i=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(16).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&i.uint32(26).string(e.user),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserQuitNotice;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.instance=e.uint64();break;case 2:o.seq=e.uint64();break;case 3:o.user=e.string();break;default:e.skipType(7&s)}}return o},r}(),TB=t.UserWaitNotice=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.user="",r.encode=function(e,i){return i||(i=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&i.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(16).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&i.uint32(26).string(e.user),i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.UserWaitNotice;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.instance=e.uint64();break;case 2:o.seq=e.uint64();break;case 3:o.user=e.string();break;default:e.skipType(7&s)}}return o},r}(),UB=t.SubscribeResponse=function(){function r(e){if(this.errors=[],e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,r.prototype.errors=q.emptyArray,r.encode=function(e,i){if(i||(i=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&i.uint32(8).uint64(e.seq),e.errors!=null&&e.errors.length)for(var o=0;o<e.errors.length;++o)t.SubscribeResponse.SubscribeErrorsType.encode(e.errors[o],i.uint32(18).fork()).ldelim();return i},r.decode=function(e,i){e instanceof u||(e=u.create(e)),i=i===void 0?e.len:e.pos+i;for(var o=new t.SubscribeResponse;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.seq=e.uint64();break;case 2:o.errors&&o.errors.length||(o.errors=[]),o.errors.push(t.SubscribeResponse.SubscribeErrorsType.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return o},r.SubscribeErrorsType=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.account="",e.prototype.code=0,e.encode=function(i,o){return o||(o=L.create()),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&o.uint32(10).string(i.account),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&o.uint32(16).uint32(i.code),o},e.decode=function(i,o){i instanceof u||(i=u.create(i)),o=o===void 0?i.len:i.pos+o;for(var s=new t.SubscribeResponse.SubscribeErrorsType;i.pos<o;){var l=i.uint32();switch(l>>>3){case 1:s.account=i.string();break;case 2:s.code=i.uint32();break;default:i.skipType(7&l)}}return s},e}(),r}(),VB=Object.freeze({__proto__:null,URI:YA,Wrapper:Oh,Ping:ZA,Pong:$A,UserJoin:aB,UserResp:bB,UserQuit:cB,UserDrop:dB,GroupEnter:eB,GroupLeave:fB,GroupReply:gB,GroupLeaveNotice:ur,GroupEnterNotice:vr,Message:wr,Ack:xr,FileUploadIndexGet:hB,FileUploadIndexRet:iB,FileUploadIndexSet:jB,FileUploadIndexFin:kB,FileUploadIndexErr:lB,FileDownloadIndexGet:mB,FileDownloadIndexRet:nB,FileDownloadIndexErr:oB,GroupAllUsersList:pB,GroupAllUsersResult:qB,UserStatusList:rB,UserStatusResult:sB,UserAttributeGet:tB,UserAttributeRet:uB,UserAttributeSet:vB,UserAttributeMod:wB,UserAttributeDel:xB,UserAttributeErr:yB,UserAttributeKeysGet:zB,UserAttributeKeysRet:AB,UserAttributeRsp:BB,GroupStatusList:CB,GroupStatusResult:DB,GroupCountNotice:EB,GroupAttributeGet:FB,GroupAttributeRet:GB,GroupAttributeSet:HB,GroupAttributeMod:IB,GroupAttributeDel:JB,GroupAttributeAlt:KB,GroupAttributeRsp:LB,GroupAttributeErr:MB,GroupAttributeKeysGet:NB,GroupAttributeKeysRet:OB,SubscribeUserStatus:PB,UnsubscribeUserStatus:QB,UserJoinNotice:RB,UserQuitNotice:SB,UserWaitNotice:TB,SubscribeResponse:UB,default:t}),WB=Math.ceil,yr=function(r){return function(e,i,o){var s=(e=String(jb(e))).length;return o=o===void 0?" ":String(o),(i=ta(i))<=s||o==""?e:(i-=s,(s=Pn.call(o,WB(i/o.length))).length>i&&(s=s.slice(0,i)),r?e+s:s+e)}},XB=yr(!1),YB=yr(!0),zr=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(De);N({target:"String",proto:!0,forced:zr},{padEnd:function(r){return YB(this,r,1<arguments.length?arguments[1]:void 0)}});var ZB=zf,Ar=function(r){return function(e){e=qb(e);for(var i,o=Dc(e),s=o.length,l=0,f=[];s>l;)i=o[l++],ka&&!ZB.call(e,i)||f.push(r?[i,e[i]]:e[i]);return f}},$B=Ar(!0),aC=Ar(!1);N({target:"Object",stat:!0},{entries:function(r){return $B(r)}});var bC=Fb.f,Br="".endsWith,cC=Math.min,Cr=dk("endsWith"),dC=!Cr&&!!function(){var r=bC(String.prototype,"endsWith");return r&&!r.writable}();N({target:"String",proto:!0,forced:!dC&&!Cr},{endsWith:function(r){var e=String(jb(this));ck(r);var i=1<arguments.length?arguments[1]:void 0,o=ta(e.length);return i=i===void 0?o:cC(ta(i),o),o=String(r),Br?Br.call(e,o,i):e.slice(i-o.length,i)===o}}),dh("match",1,function(r,e,i){return[function(o){var s=jb(this),l=o==null?void 0:o[r];return l!==void 0?l.call(o,s):new RegExp(o)[r](String(s))},function(o){var s=i(e,o,this);if(s.done)return s.value;if(o=va(o),s=String(this),!o.global)return Ke(o,s);var l=o.unicode;o.lastIndex=0;for(var f,h=[],d=0;(f=Ke(o,s))!==null;)f=String(f[0]),h[d]=f,f===""&&(o.lastIndex=xj(s,ta(o.lastIndex),l)),d++;return d===0?null:h}]});var eC=Fb.f,Dr="".startsWith,fC=Math.min,Er=dk("startsWith"),gC=!Er&&!!function(){var r=eC(String.prototype,"startsWith");return r&&!r.writable}();N({target:"String",proto:!0,forced:!gC&&!Er},{startsWith:function(r){var e=String(jb(this));ck(r);var i=ta(fC(1<arguments.length?arguments[1]:void 0,e.length)),o=String(r);return Dr?Dr.call(e,o,i):e.slice(i,i+o.length)===o}});var Nm=function(r){var e=/(%?)(%([jds]))/g,i=Array.prototype.slice.call(arguments,1);return i.length&&(r=r.replace(e,function(o,s,l,f){switch(l=i.shift(),f){case"s":l=""+l;break;case"d":l=Number(l);break;case"j":l=JSON.stringify(l)}return s?(i.unshift(l),o):l})),i.length&&(r+=" "+i.join(" ")),""+(r=r.replace(/%{2,2}/g,"%"))},hC=/\s/,iC=function(r){for(var e=r.length;e--&&hC.test(r.charAt(e)););return e},jC=/^\s+/,Fr=NaN,kC=/^[-+]0x[0-9a-f]+$/i,lC=/^0b[01]+$/i,mC=/^0o[0-7]+$/i,nC=parseInt,gl=function(r){if(typeof r=="number")return r;if(ie(r))return Fr;if(lb(r)&&(r=typeof r.valueOf=="function"?r.valueOf():r,r=lb(r)?r+"":r),typeof r!="string")return r===0?r:+r;r=r&&r.slice(0,iC(r)+1).replace(jC,"");var e=lC.test(r);return e||mC.test(r)?nC(r.slice(2),e?2:8):kC.test(r)?Fr:+r},oC=Math.max,pC=Math.min,qC=function(r,e,i){function o(P){var z=d,_e=p;return d=p=void 0,x=P,g=r.apply(_e,z)}function s(P){var z=P-b;return P-=x,b===void 0||z>=e||0>z||k&&P>=j}function l(){var P=Cb.Date.now();if(s(P))return f(P);var z=setTimeout,_e=P-x;P=e-(P-b),_e=k?pC(P,j-_e):P,_=z(l,_e)}function f(P){return _=void 0,C&&d?o(P):(d=p=void 0,g)}function h(){var P=Cb.Date.now(),z=s(P);if(d=arguments,p=this,b=P,z){if(_===void 0)return x=P=b,_=setTimeout(l,e),A?o(P):g;if(k)return clearTimeout(_),_=setTimeout(l,e),o(b)}return _===void 0&&(_=setTimeout(l,e)),g}var d,p,g,_,b,x=0,A=!1,k=!1,C=!0;if(typeof r!="function")throw new TypeError("Expected a function");if(e=gl(e)||0,lb(i)){A=!!i.leading;var j=(k="maxWait"in i)?oC(gl(i.maxWait)||0,e):j;C="trailing"in i?!!i.trailing:C}return h.cancel=function(){_!==void 0&&clearTimeout(_),x=0,d=b=p=_=void 0},h.flush=function(){return _===void 0?g:f(Cb.Date.now())},h},yc=function(r){function e(o,s){return W(this,e),m(n(o=i.call(this,Mm(o,s))),"originalError",void 0),m(n(o),"code",void 0),m(n(o),"serverCode",void 0),typeof s=="number"?o.code=s:typeof s=="string"?o.name=s:s!==void 0&&(s.originalError&&(o.originalError=s.originalError),s.code!==void 0&&(o.code=s.code),s.serverCode!==void 0&&(o.serverCode=s.serverCode)),o}la(e,r);var i=ma(e);return e}(ef(Error)),Ia=function(r){function e(o,s){return W(this,e),m(n(o=i.call(this,Mm(o,s))),"name","RtmInternalError"),m(n(o),"code",void 0),o.code=s,o}la(e,r);var i=ma(e);return e}(ef(Error)),Ph=function(){return function(r){function e(o){W(this,e);var s=Object.keys(o);return i.call(this,o[s[0]],s[0])}la(e,r);var i=ma(e);return e}(Ia)},Fa=Ph(),db=function(r){function e(){W(this,e);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return m(n(o=i.call.apply(i,[this].concat(s))),"name","RtmTimeoutError"),o}la(e,r);var i=ma(e);return e}(yc),I=function(r){function e(){W(this,e);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return m(n(o=i.call.apply(i,[this].concat(s))),"name","RtmInvalidArgumentError"),o}la(e,r);var i=ma(e);return e}(yc),K=function(r){function e(){W(this,e);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return m(n(o=i.call.apply(i,[this].concat(s))),"name","RtmInvalidStatusError"),o}la(e,r);var i=ma(e);return e}(yc),hl=function(r){function e(){W(this,e);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return m(n(o=i.call.apply(i,[this].concat(s))),"name","RtmInterruptedError"),o}la(e,r);var i=ma(e);return e}(yc),ib=function(r){function e(){W(this,e);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return m(n(o=i.call.apply(i,[this].concat(s))),"name","RtmLimitExceededError"),o}la(e,r);var i=ma(e);return e}(yc),rC=function(r){function e(){W(this,e);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return m(n(o=i.call.apply(i,[this].concat(s))),"name","RtmInvokeTooOftenError"),o}la(e,r);var i=ma(e);return e}(yc),da=function(r){function e(){W(this,e);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return m(n(o=i.call.apply(i,[this].concat(s))),"name","RtmUnavailableError"),m(n(o),"serverCode",void 0),m(n(o),"statusCode",void 0),o}la(e,r);var i=ma(e);return e}(yc),Ye=function(r){function e(){W(this,e);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return m(n(o=i.call.apply(i,[this].concat(s))),"name","RtmUnauthenticatedError"),m(n(o),"serverCode",void 0),o}la(e,r);var i=ma(e);return e}(yc),Wc=function(r){function e(){W(this,e);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return m(n(o=i.call.apply(i,[this].concat(s))),"name","RtmUnknownError"),o}la(e,r);var i=ma(e);return e}(yc),Sa=function(r){return r instanceof db||r instanceof pb},sa=function(r){return r instanceof yc},Yd=function(r,e,i){return['Executing "%s.%s" timed out after %ds',r,e,i/1e3]},Lm=new Map,sC=function(){var r=new Date;return"".concat(r.toISOString().split("T")[1].replace(/\..+/,""),".").concat(r.getMilliseconds())},xf=Object.keys,Hg=Object.entries.bind(Object),Cg=function(r){return typeof r=="string"?r.endsWith(".")?r:"".concat(r,"."):r},Sm=function(r){for(var e="",i=(r=new Uint8Array(r)).byteLength,o=-1;++o<i;)e+=String.fromCharCode(r[o]);return e=btoa(e),"data:;base64,".concat(e)},tC=R(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1});N({target:"Date",proto:!0,forced:tC},{toJSON:function(r){r=Qa(this);var e=lc(r);return typeof e!="number"||isFinite(e)?r.toISOString():null}}),N({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var $t=Object.prototype.hasOwnProperty,Gr=function(r,e,i){return JSON.stringify(Ym(r),e,i)};Gr.ensureProperties=Ym;var uC=function(r,e){e=e||{};var i=X(r);if(i==="string"&&0<r.length)return au(r);if(i==="number"&&isFinite(r))return e.long?r=864e5<=(e=Math.abs(r))?Jg(r,e,864e5,"day"):36e5<=e?Jg(r,e,36e5,"hour"):6e4<=e?Jg(r,e,6e4,"minute"):1e3<=e?Jg(r,e,1e3,"second"):r+" ms":r=864e5<=(e=Math.abs(r))?Math.round(r/864e5)+"d":36e5<=e?Math.round(r/36e5)+"h":6e4<=e?Math.round(r/6e4)+"m":1e3<=e?Math.round(r/1e3)+"s":r+"ms",r;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))},vC=function(r){function e(s){function l(){for(var d=arguments.length,p=Array(d),g=0;g<d;g++)p[g]=arguments[g];if(l.enabled){d=Number(new Date),l.diff=d-(f||d),l.prev=f,f=l.curr=d,p[0]=e.coerce(p[0]),typeof p[0]!="string"&&p.unshift("%O");var _=0;p[0]=p[0].replace(/%([a-zA-Z%])/g,function(b,x){return b==="%%"?"%":(_++,typeof(x=e.formatters[x])=="function"&&(b=x.call(l,p[_]),p.splice(_,1),_--),b)}),e.formatArgs.call(l,p),(l.log||e.log).apply(l,p)}}var f,h=null;return l.namespace=s,l.useColors=e.useColors(),l.color=e.selectColor(s),l.extend=i,l.destroy=e.destroy,Object.defineProperty(l,"enabled",{enumerable:!0,configurable:!1,get:function(){return h===null?e.enabled(s):h},set:function(d){h=d}}),typeof e.init=="function"&&e.init(l),l}function i(s,l){return(s=e(this.namespace+(l===void 0?":":l)+s)).log=this.log,s}function o(s){return s.toString().substring(2,s.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(s){return s instanceof Error?s.stack||s.message:s},e.disable=function(){var s=[].concat(G(e.names.map(o)),G(e.skips.map(o).map(function(l){return"-"+l}))).join(",");return e.enable(""),s},e.enable=function(s){e.save(s),e.names=[],e.skips=[];var l,f=(typeof s=="string"?s:"").split(/[\s,]+/),h=f.length;for(l=0;l<h;l++)f[l]&&((s=f[l].replace(/\*/g,".*?"))[0]==="-"?e.skips.push(new RegExp("^"+s.substr(1)+"$")):e.names.push(new RegExp("^"+s+"$")))},e.enabled=function(s){if(s[s.length-1]==="*")return!0;var l,f=0;for(l=e.skips.length;f<l;f++)if(e.skips[f].test(s))return!1;for(f=0,l=e.names.length;f<l;f++)if(e.names[f].test(s))return!0;return!1},e.humanize=uC,e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(r).forEach(function(s){e[s]=r[s]}),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(s){for(var l=0,f=0;f<s.length;f++)l=(l<<5)-l+s.charCodeAt(f),l|=0;return e.colors[Math.abs(l)%e.colors.length]},e.enable(e.load()),e},Hr=$a(function(r,e){e.formatArgs=function(o){if(o[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+o[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),this.useColors){var s="color: "+this.color;o.splice(1,0,s,"color: inherit");var l=0,f=0;o[0].replace(/%[a-zA-Z%]/g,function(h){h!=="%%"&&(l++,h==="%c"&&(f=l))}),o.splice(f,0,s)}},e.save=function(o){try{o?e.storage.setItem("debug",o):e.storage.removeItem("debug")}catch{}},e.load=function(){try{var o=e.storage.getItem("debug")}catch{}return!o&&typeof process<"u"&&"env"in process&&(o=define_process_env_default.DEBUG),o},e.useColors=function(){return!(typeof window>"u"||!window.process||window.process.type!=="renderer"&&!window.process.__nwjs)||(typeof navigator>"u"||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};e:{try{var i=localStorage;break e}catch{}i=void 0}e.storage=i,e.destroy=function(){var o=!1;return function(){o||(o=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),e.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" "),e.log=console.debug||console.log||function(){},r.exports=vC(e),r.exports.formatters.j=function(o){try{return JSON.stringify(o)}catch(s){return"[UnexpectedJSONParseError]: "+s.message}}}),Ir=Hr("RTM:DEBUG"),Ze;Ir.enabled=!1,function(r){r[r.Uploading=0]="Uploading",r[r.Free=1]="Free"}(Ze||(Ze={}));var wC=function(){function r(e){W(this,r),m(this,"uploadRequest",void 0),m(this,"uploadState",void 0),m(this,"uploadResendCount",void 0),m(this,"LogCache",void 0),m(this,"LogsToPost",void 0),m(this,"processId",void 0),m(this,"sdkVersion",void 0),m(this,"logId",void 0),m(this,"rtmConfig",void 0),this.processId=e.processId,this.sdkVersion=e.sdkVersion,this.rtmConfig=e.rtmConfig,this.uploadRequest=e.uploadRequest,this.uploadState=Ze.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return Ha(r,[{key:"upload",value:function(e){this.LogCache.push(e),this.uploadState===Ze.Free&&(this.LogsToPost=40>this.LogCache.length?this.LogCache.splice(0,this.LogCache.length):this.LogCache.splice(0,40),this.postLog(this.LogsToPost))}},{key:"postLog",value:function(e){var i=this;this.uploadState=Ze.Uploading,setTimeout(J(w.mark(function o(){var s,l,f;return w.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return s={sdk_version:i.sdkVersion,process_id:i.processId,payload:JSON.stringify(e)},h.prev=1,h.next=4,i.uploadRequest(s,(l=i.rtmConfig.enableCloudProxy)!==null&&l!==void 0&&l);case 4:if(!Uk){h.next=6;break}throw Error("RTM is busy");case 6:h.next=13;break;case 8:return h.prev=8,h.t0=h.catch(1),f=2>i.uploadResendCount++?2e3:1e4,setTimeout(function(){return i.postLog(i.LogsToPost)},f),h.abrupt("return");case 13:if(Ir('The logs uploaded for "process-'.concat(gg,'"')),i.LogCache.length!==0){h.next=17;break}return i.uploadState=Ze.Free,h.abrupt("return");case 17:i.uploadResendCount=0,i.LogsToPost=40>i.LogCache.length?i.LogCache.splice(0,i.LogCache.length):i.LogCache.splice(0,40),i.postLog(i.LogsToPost);case 20:case"end":return h.stop()}},o,null,[[1,8]])})),Zd.getParameter("LOG_UPLOAD_INTERVAL"))}}]),r}(),Jr=function(r,e,i,o,s,l,f,h){var d=0;for(f=!!f&&Id(f,h,3);d<o;){if(d in i){if(h=f?f(i[d],d,e):i[d],0<l&&gd(h))s=Jr(r,e,h,ta(h.length),s,l-1)-1;else{if(9007199254740991<=s)throw TypeError("Exceed the acceptable array length");r[s]=h}s++}d++}return s},xC=Jr;N({target:"Array",proto:!0},{flat:function(){var r=arguments.length?arguments[0]:void 0,e=Qa(this),i=ta(e.length),o=Sg(e,0);return o.length=xC(o,e,e,i,0,r===void 0?1:$b(r)),o}}),N({target:"Object",stat:!0},{values:function(r){return aC(r)}});var yC=["CODE"],Db,ud,F;(function(r){r.CHINA="CN",r.ASIA="AS",r.NORTH_AMERICA="NA",r.EUROPE="EU",r.JAPAN="JP",r.INDIA="IN",r.OCEANIA="OC",r.SOUTH_AMERICA="SA",r.AFRICA="AF",r.OVERSEA="OVERSEA",r.GLOBAL="GLOBAL"})(F||(F={}));var zC={CN:F.CHINA,NA:F.NORTH_AMERICA,EU:F.EUROPE,AS:F.ASIA,JP:F.JAPAN,IN:F.INDIA,GLOB:F.GLOBAL,AF:F.AFRICA,OC:F.OVERSEA,OVS:F.OVERSEA,SA:F.SOUTH_AMERICA},Kg=Wm((Db={},m(Db,F.ASIA,{CODE:F.ASIA,AP_DOMAINS:["ap-web-1-asia.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-asia.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_AP:["proxy-ap-web-asia.agora.io"],PROXY_NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.NORTH_AMERICA,{CODE:F.NORTH_AMERICA,AP_DOMAINS:["ap-web-1-north-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-north-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_AP:["proxy-ap-web-america.agora.io"],PROXY_NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.EUROPE,{CODE:F.EUROPE,AP_DOMAINS:["ap-web-1-europe.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-europe.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_AP:["proxy-ap-web-europe.agora.io"],PROXY_NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.JAPAN,{CODE:F.JAPAN,AP_DOMAINS:["ap-web-1-japan.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-japan.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_AP:["proxy-ap-web-japan.agora.io"],PROXY_NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.INDIA,{CODE:F.INDIA,AP_DOMAINS:["ap-web-1-india.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-india.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_AP:["proxy-ap-web-india.agora.io"],PROXY_NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.OVERSEA,{CODE:F.OVERSEA,AP_DOMAINS:["ap-web-1-oversea.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_AP:["proxy-ap-web-oversea.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.agora.io"]}),m(Db,F.GLOBAL,{CODE:F.GLOBAL,AP_DOMAINS:["ap-web-1.agora.io","ap-web-2.agora.io"],AP_BACKUP_DOMAINS:["ap-web-3.agora.io","ap-web-4.agora.io"],EVENT_REPORT_DOMAIN:["webcollector-rtm.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["webcollector-1.agora.io"],LOG_UPLOAD_SERVER:["logservice-rtm.agora.io"],PROXY_AP:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.OCEANIA,{CODE:F.OCEANIA,AP_DOMAINS:["ap-web-1-oceania.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oceania.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_AP:["proxy-ap-web-oceania.agora.io"],PROXY_NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.SOUTH_AMERICA,{CODE:F.SOUTH_AMERICA,AP_DOMAINS:["ap-web-1-south-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-south-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_AP:["proxy-ap-web-south-america.agora.io"],PROXY_NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.AFRICA,{CODE:F.AFRICA,AP_DOMAINS:["ap-web-1-africa.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-africa.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_AP:["proxy-ap-web-africa.agora.io"],PROXY_NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.CHINA,{CODE:F.CHINA,AP_DOMAINS:["webrtc2-2.ap.sd-rtn.com"],AP_BACKUP_DOMAINS:["webrtc2-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_AP:["proxy-ap-web.agoraio.cn"],PROXY_NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),Db)),yf=(ud={},m(ud,F.ASIA,[F.CHINA,F.JAPAN,F.INDIA]),m(ud,F.EUROPE,[]),m(ud,F.NORTH_AMERICA,[]),m(ud,F.SOUTH_AMERICA,[]),m(ud,F.OCEANIA,[]),m(ud,F.AFRICA,[]),ud),Kr=[F.OVERSEA,F.GLOBAL,F.CHINA,F.NORTH_AMERICA,F.EUROPE,F.ASIA,F.JAPAN,F.INDIA,F.OCEANIA,F.SOUTH_AMERICA,F.AFRICA],Zm=function(r){return Object.values(yf).flat().includes(r)},cu=function(r){var e;return(e=Hg(yf).find(function(i){return(i=ra(i,2))[0],i[1].includes(r)}))===null||e===void 0?void 0:e[0]},AC=function(r){return r.sort(function(e,i){return Kr.indexOf(e)-Kr.indexOf(i)})},xe=function(r){var e=new Set;if((r=AC(r).slice(0,3).map(function(i){var o=Kg[i];if(o===void 0)throw new Ia("invalid area key");return i=o.CODE,o=ff(o,yC),e.add(i),o})).length===0)throw new Ia("areas cannot be empty");return ua({CODES:e},r.reduce(function(i,o){for(var s=0,l=Hg(i);s<l.length;s++){var f=ra(l[s],2),h=f[0];f=f[1],i[h]=Array.from(new Set([].concat(G(o[h]),G(f))))}return i}))},M,Lr=function(){var r=J(w.mark(function e(i,o){var s,l,f,h,d,p=arguments;return w.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(2<(l=2<p.length&&p[2]!==void 0?p[2]:0))){g.next=3;break}return g.abrupt("return");case 3:return f={withCredentials:!0,body:i,timeout:2e4},h=0<l?(M==null?void 0:M.LOG_UPLOAD_SERVER[0])||"rtm.logservice.sd-rtn.com":(M==null?void 0:M.LOG_UPLOAD_SERVER[0])||"logservice-rtm.agora.io",d=o?"https://".concat((s=M==null?void 0:M.PROXY_NGINX[0])!==null&&s!==void 0?s:"webrtc-cloud-proxy.sd-rtn.com","/ls/?h=").concat(h,"&p=443&d=upload/v1"):"https://".concat(h,"/upload/v1"),g.next=8,te(d,f).catch(function(_){return Lr(i,o,l+1)});case 8:case"end":return g.stop()}},e)}));return function(e,i){return r.apply(this,arguments)}}(),Mr=new wC({processId:"process-".concat(gg),sdkVersion:"Agora_RTM_SDK_for_Web_".concat("v1.4.3-17-g1e27aa38"),uploadRequest:Lr,rtmConfig:{}}),il="text payload rawMessage thumbnail attributeInfos keys value extra".split(" "),Nr="account ticket uid detail token account fileName cname user group key origin users src dst lastUpdateUserId channel cert wan_ip".split(" "),Or="serverReceivedTs isOfflineMessage enableHistoricalMessaging enableOfflineMessaging hasPeerReceived messageType enableNotificationToChannelMembers lastUpdateTs".split(" "),BC="ChannelMessage MemberLeft MessageFromPeer LocalInvitationRefused LocalInvitationAccepted RemoteInvitationCanceled PeersOnlineStatusChanged AttributesUpdated MemberJoined".split(" "),ye=function(r){if(typeof r=="string")return oa(r);if(Array.isArray(r)&&r.every(function(l){return typeof l=="string"}))return r.map(function(l){return oa(l)});if(!Il(r)){for(var e={},i=0;i<Or.length;i++){var o=Or[i];o in r&&(e[o]=r[o])}if(0<Object.keys(e).length)return e;if(5>Object.keys(r).length){for(i=0,r=Object.entries(r);i<r.length;i++){var s=ra(r[i],2);o=s[0],s=s[1],il.includes(o)?e[o]="[Hidden Info]":e[oa(o)]=typeof s=="string"?oa(s):"[Sensitive Info]"}return e}return"[Sensitive Info]"}return r},Pr=function(r){return X(r)==="object"?yd(r)?Vm(fe(r,5),il,Nr):r.constructor&&r.constructor.name:r},Qr=function(r,e){return r instanceof Error?r.message:typeof r!="string"?JSON.stringify(Vm(fe(r,5),il,Nr)):(e=e.map(function(i){return i instanceof Error?i.message:X(i)==="object"?Gr(Array.isArray(i)?i.map(Pr):Pr(i)):i}),Nm.apply(void 0,[r.replace(/%[%Oo]/g,function(i){return i==="%%"?"%":i==="%o"||i==="%O"?"%s":i})].concat(G(e))))},CC=1,Rr=function(r,e,i){var o=Hr(r);return o.enabled=!0,o.log=i,o.useColors=!1,function(s){for(var l=arguments.length,f=Array(1<l?l-1:0),h=1;h<l;h++)f[h-1]=arguments[h];if(e.enableLogUpload){l=Cg(s);var d=Qr(l,f);Mr.upload({log_item_id:"".concat(CC++),log_level:r,payload_str:"[".concat(sC(),"] ").concat(r," - ").concat(256<d.length?d.slice(0,256):d)})}switch(l=function(p){var g=d||Qr(Cg(s),f),_=Nc.LOG_HANDLER;typeof _=="function"&&_({level:p,message:g}),o(g)},r){case"RTM:INFO":e.logFilter.info&&l("log");break;case"RTM:WARN":e.logFilter.warn&&l("warning");break;case"RTM:ERROR":e.logFilter.error&&l("error");break;case"RTM:TRACK":e.logFilter.track&&l("log");break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":e.logFilter.debug&&l("debug");break;case"RTM:DEBUG":e.logFilter.debug&&l("debug")}}},jl,Sr=function(r){return function(e){var i=jl===1||r===void 0?"":"Ins#".concat(r," ");return"".concat(i).concat(e)}},kl=function(r,e,i){var o=Sr(jl);return Rr("RTM:".concat(e),i,function(s){return r(o(s))})},tb=function(){return function(r){function e(o,s){var l=2<arguments.length&&arguments[2]!==void 0&&arguments[2];W(this,e);var f=i.call(this);if(m(n(f),"logError",void 0),m(n(f),"invokeTracker",void 0),m(n(f),"resultTracker",void 0),m(n(f),"errorTracker",void 0),m(n(f),"eventTracker",void 0),m(n(f),"info",void 0),m(n(f),"warn",void 0),m(n(f),"log",void 0),m(n(f),"genLogger",void 0),m(n(f),"loggerId",void 0),m(n(f),"logger",void 0),m(n(f),"name",void 0),f.logger=o,f.name=s,f.loggerId=o.loggerId,f.info=o.info,f.warn=o.warn,f.logError=o.logError,f.genLogger=o.genLogger,f.log=o.genLogger("RTM:DEBUG","<".concat(s,"> ")),f.invokeTracker=o.genTracker("Invoke"),f.eventTracker=o.genTracker("Event"),f.resultTracker=o.genTracker("Result"),f.errorTracker=o.genTracker("Error"),l){var h=f.emit.bind(n(f));f.emit=function(){for(var d=arguments.length,p=Array(d),g=0;g<d;g++)p[g]=arguments[g];d=p[0],g=p.slice(1);var _=BC.includes(d);f.eventTracker.apply(f,["%s: ".concat(0<g.length?"%s emitted with args: ".concat(g.map(function(){return"%o"})):"%s emitted"),s,d].concat(G(_?g.map(ye):g)));try{h.apply(void 0,p)}catch(b){f.logError("Caught in the callback function of the event %s",d,b)}}}return f}la(e,r);var i=ma(e);return e}(ea)},DC=function(r){return kl(console.log.bind(console),"INFO",r)},EC=function(r){return kl(console.warn.bind(console),"WARN",r)},FC=function(r){return kl(console.error.bind(console),"ERROR",r)},Tr=function(r,e){return function(i){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"",s=Sr(r),l=console.debug.bind(console),f=Rr(i,e,function(h){return l(s(h))});return function(h){for(var d=arguments.length,p=Array(1<d?d-1:0),g=1;g<d;g++)p[g-1]=arguments[g];return f.apply(void 0,[o+h].concat(p))}}},GC=function(r,e){return function(i){return Tr(r,e)("RTM:TRACK","[".concat(i,"] "))}},Li=t.URI,eu=Oh,HC=ff(VB,["Wrapper"]),$m=Gk(HC,"URI"),Ur=function(r,e){var i=-1,o=r.length,s=o-1;for(e=e===void 0?o:e;++i<e;){var l=r[o=nr(i,s)];r[o]=r[i],r[i]=l}return r.length=e,r},IC=function(r){return Ur(Xh(r))},JC=function(r){return Ur(Ni(r))},$e=function(r){return(Va(r)?IC:JC)(r)},af={0:9591,1:9593},$d=function(r){return"https://".concat(r,"/api/v1")},KC=bb.apply(void 0,G($e(["web-1.ap.sd-rtn.com","web-2.ap.sd-rtn.com"].map($d)))),LC=bb.apply(void 0,G($e(["ap-web-1.agora.io","ap-web-2.agora.io"].map($d)))),MC=bb.apply(void 0,G($e(["web-3.ap.sd-rtn.com","web-4.ap.sd-rtn.com"].map($d)))),NC=bb.apply(void 0,G($e(["ap-web-3.agora.io","ap-web-4.agora.io"].map($d)))),ll=Ph(),ml=function(r){function e(o,s,l,f,h,d){W(this,e);var p=i.call(this,h,Ai("Socket-",h.loggerId));if(m(n(p),"isActiveClose",!1),m(n(p),"loggedIn",!1),m(n(p),"useNewDomain",void 0),m(n(p),"receivedPacket",new Pa),m(n(p),"open$",void 0),m(n(p),"input$",new Pa),m(n(p),"userJoin$",new Pa),m(n(p),"attemptsSinceLastError",0),m(n(p),"message$",new Pa),m(n(p),"socket$",void 0),m(n(p),"toClose",new Pa),m(n(p),"toReconnect",new Pa),m(n(p),"sendLogger",void 0),m(n(p),"receiveLogger",void 0),m(n(p),"ip",void 0),m(n(p),"env",void 0),m(n(p),"ticket",void 0),m(n(p),"context",void 0),m(n(p),"getDomain",function(){return an(p.ip,p.useNewDomain)}),m(n(p),"socketReconnector",function(b){var x=function(A){return p.attemptsSinceLastError+=1,p.warn("The %s of Env %d reconnecting %s",p.name,p.env,A.message),Bc(3e3)};return b.pipe(Ga(function(A){return p.log("socket connection closed"),p.loggedIn=!1,2<=p.attemptsSinceLastError?(p.warn("socket connection failure"),p.emit("connectionFailure"),p.close(),Z(A)):p.isActiveClose?vb:(p.emit("reconnect"),p.useNewDomain=!p.useNewDomain,Z(A))}),oe(function(A){return A.pipe(Cc(x))}))}),p.ip=o,p.env=s,p.ticket=l,p.context=f,p.useNewDomain=d??.5<=Math.random(),p.sendLogger=p.genLogger("RTM:MSG:SEND"),p.receiveLogger=p.genLogger("RTM:MSG:RECV"),s!==0&&s!==1)throw new ll({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});if(!Gm(o))throw new ll({IP_NOT_VALID:"The ip from ap is not valid"});var g=af[s];p.log("Opening websocket address %s for the Env %d",p.ip,p.env);var _=Xb(p.input$,p.userJoin$.pipe(Rt(2)),p.message$).pipe(ba(function(b){return Oh.encode(b).finish()}));return o=Xb(St("",{protocols:[],makeWebSocket:function(){if(p.context.config.enableCloudProxy){if(p.context.cloudProxyServers.length===0)throw p.logError("No cloud proxy server to connect"),new da;var b="wss://".concat(an(bn(p.context.cloudProxyServers),!1),"/");b=we(b,"sid",p.context.sid),b=we(b,"remote_port",g.toString()),b=we(b,"remote_ip",p.ip),b=we(b,"token",p.context.key),b=new WebSocket(b)}else b=new WebSocket("wss://".concat(p.getDomain(),":").concat(g));return b.binaryType="arraybuffer",b}}),p.toReconnect),p.socket$=Ca(o,Tk.pipe(hb(15e3),Ga(function(b){return Sa(b)&&p.warn("socket open timed out"),Z(b)}))).pipe(ba(function(b){if(b instanceof Error)throw p.warn("Env_%d: Force reconnect the socket",p.env),b;return b(_).pipe(ba(function(x){return Oh.decode(new Uint8Array(x))}))}),p.socketReconnector),p.open$=p.socket$.pipe(ca(function(b){p.log("Websocket opened",p.name),b.subscribe(function(x){var A=x.data;x=Li[x.uri].slice(0,-3),A=$m[x].decode(A);var k=HA({},Gk(A,"toJSON"),function(z,_e){return _e instanceof U?Km(_e):_e}),C=!1;if((A instanceof vr||A instanceof ur)&&A.instance.lessThanOrEqual(4294967295)&&(C=!0),A instanceof wr||A instanceof xr){var j=A.instance,P=A.sequence;(A.dialogue.lessThanOrEqual(4294967295)||j.lessThanOrEqual(4294967295)||P.lessThan(1))&&(C=!0)}C?p.warn("Env_%d: Illegal %s, abandoned %o",p.env,x,k):(x!=="Pong"&&p.receiveLogger("Env_%d: %s %o",p.env,x,k),p.receivedPacket.next([x,A]))},function(){})}),qf(void 0),ob(p.toClose),pe()),p}la(e,r);var i=ma(e);return Ha(e,[{key:"address",get:function(){return"".concat(this.ip,":").concat(af[this.env])}},{key:"sendPacket",value:function(o,s){if(o!=="Ping"){var l=uc(s,function(f){return f instanceof U?Km(f):f});this.sendLogger("Env_%d: %s %o",this.env,o,l)}s=du(o,s),o==="UserJoin"?this.userJoin$.next(s):o==="Message"?this.message$.next(s):this.input$.next(s)}},{key:"close",value:function(){this.isActiveClose=!0,this.loggedIn=!1,this.toClose.next()}},{key:"fromReceived",value:function(o){var s=this;return this.receivedPacket.pipe(ca(function(l){var f=ra(l,2);l=f[0],f=f[1],l==="UserResp"&&(s.attemptsSinceLastError=0,s.loggedIn=!0),l==="UserDrop"&&s.emit("socketUserDrop",f)}),wb(function(l){return ra(l,1)[0]===o}),ba(function(l){return ra(l,2)[1]}))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new ll({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),e}(tb());N({target:"String",proto:!0,forced:zr},{padStart:function(r){return XB(this,r,1<arguments.length?arguments[1]:void 0)}});var OC=function(r){var e=xf(Kg);r=Yt(r);for(var i=0;i<e.length;i++){var o=Kg[e[i]];if(o!=null&&o.AP_DOMAINS.includes(r)||o!=null&&o.AP_BACKUP_DOMAINS.includes(r)||o!=null&&o.PROXY_AP.includes(r))return[o.CODE]}return[F.CHINA,F.GLOBAL]},PC={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token",FORBIDDEN_REGION:"Forbidden to access the request in this area",CANNOT_MEET_AREA_DEMAND:"Cannot allocate to meet the requirements of the given area limit"},Vr={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY",18:"FORBIDDEN_REGION",19:"CANNOT_MEET_AREA_DEMAND"},QC=[100,101,102],Qh=/web-(\d)/,Wr=function(r){function e(o,s){var l=2<arguments.length&&arguments[2]!==void 0&&arguments[2];W(this,e);var f=i.call(this,s,"AccessPoint");return m(n(f),"handleUniLbsError",function(h,d){var p=h;if(4<h.toString().length){var g=h.toString().padStart(8,"0"),_=parseInt(g.slice(0,4),10);if(g=parseInt(g.slice(4,8),10),_===201)p=g;else if(_===101&&!QC.includes(g))return Z(Error("service is currently unavailable"))}if(_=p.toString(),!Object.keys(Vr).includes(_))return(h=new da(["Login is rejected by the server. The response code is %d",h],jg)).serverCode=p,Z(h);switch(_=Vr[_],p=PC[_],_){case"INVALID_APP_ID":case"APP_ID_NO_ACTIVATED":return(d=new Ye(p,$q)).serverCode=h,Z(d);case"INVALID_USER_ID":return(d=new Ye(p,Jh)).serverCode=h,Z(d);case"TOKEN_EXPIRED":case"TOKEN_TIMEOUT":return(d=new Ye(p,Kh)).serverCode=h,Z(d);case"NO_AUTHORIZED":case"INVALID_TOKEN_UID":case"DYNAMIC_KEY_NOT_ENABLED":case"DYNAMIC_ENABLED_BUT_STATIC_KEY":return(d=new Ye(p,ar)).serverCode=h,Z(d);case"CANNOT_MEET_AREA_DEMAND":return(d=OC(d)).forEach(function(b){return f.failedAreas.add(b)}),f.failedAreas.size===(M===void 0?2:M.CODES.size)?((d=new I(p,jg)).serverCode=h,Z(d)):Z(Error("ap ".concat(d.join(", ")," cannot meet requirement")));case"FORBIDDEN_REGION":return(d=new da(p,jg)).serverCode=h,Z(d);default:return Z(Im("ApResErrType",_))}}),m(n(f),"getApEdgeInfo$",void 0),m(n(f),"getApEdgeInfoEndFirst$",void 0),m(n(f),"apFinish$",new Pa),m(n(f),"retryCount",0),m(n(f),"failedAreas",new Set),m(n(f),"usedUrl",[]),m(n(f),"newDomainUsed",!1),m(n(f),"backupNewDomainUsed",!1),m(n(f),"genUrl",function(){return M===void 0?mi.apply(void 0,G($e([KC,LC]))).pipe(ni(function(h){return bb.apply(void 0,G(h))})):bb.apply(void 0,G(M.AP_DOMAINS.slice(0,3).map($d)))}),m(n(f),"genBackupUrl",function(){return M===void 0?mi.apply(void 0,G($e([MC,NC]))).pipe(ni(function(h){return bb.apply(void 0,G(h))})):bb.apply(void 0,G(M.AP_BACKUP_DOMAINS.slice(0,3).map($d)))}),m(n(f),"getApUrl$",function(h){var d,p;return f.genUrl().pipe(wb(function(g){return(!f.newDomainUsed||!g.includes("sd-rtn.com"))&&(g.includes("sd-rtn.com")&&(f.newDomainUsed=!0),!dl(f.usedUrl,function(_){var b;return _===((b=g.match(Qh))===null||b===void 0?void 0:b[1])}))}),ca(function(g){var _;M===void 0&&typeof(g=(_=g.match(Qh))===null||_===void 0?void 0:_[1])=="string"&&f.usedUrl.push(g)}),Ka(h?Math.max(Nc.RECONNECTING_AP_NUM,(d=M==null?void 0:M.CODES.size)!==null&&d!==void 0?d:0):(p=M==null?void 0:M.CODES.size)!==null&&p!==void 0?p:2),Dd(function(){return e.runOutOfUrlSymbol}),Ga(function(g,_){return f.newDomainUsed=!1,g===e.runOutOfUrlSymbol?(f.usedUrl=[],_):Z(g)}))}),m(n(f),"getBackupApUrl$",function(h){var d,p;return f.genBackupUrl().pipe(wb(function(g){return(!f.backupNewDomainUsed||!g.includes("sd-rtn.com"))&&(g.includes("sd-rtn.com")&&(f.backupNewDomainUsed=!0),!dl(f.usedUrl,function(_){var b;return _===((b=g.match(Qh))===null||b===void 0?void 0:b[1])}))}),ca(function(g){var _;M===void 0&&typeof(g=(_=g.match(Qh))===null||_===void 0?void 0:_[1])=="string"&&f.usedUrl.push(g)}),Ka(h?Math.max(Nc.RECONNECTING_AP_NUM,(d=M==null?void 0:M.CODES.size)!==null&&d!==void 0?d:0):(p=M==null?void 0:M.CODES.size)!==null&&p!==void 0?p:2),Dd(function(){return e.runOutOfUrlSymbol}),Ga(function(g,_){return f.backupNewDomainUsed=!1,g===e.runOutOfUrlSymbol?(f.usedUrl=[],_):Z(g)}))}),m(n(f),"getProxyApUrl$",function(h){var d,p;return bb.apply(void 0,G(((M==null?void 0:M.PROXY_AP.slice(0,3))||["ap-proxy-1.agora.io","ap-proxy-2.agora.io"]).map($d))).pipe(Ka(h?Math.max(Nc.RECONNECTING_AP_NUM,(d=M==null?void 0:M.CODES.size)!==null&&d!==void 0?d:0):(p=M==null?void 0:M.CODES.size)!==null&&p!==void 0?p:2))}),m(n(f),"context",void 0),m(n(f),"fetchCloudProxy",function(h,d){var p=Ai("AP-",f.loggerId);f.log("The AccessPoint requests %s(%s)",h,p);var g=new AbortController;return f.apFinish$.pipe(Ka(1)).subscribe(function(){return g.abort()}),ad(J(w.mark(function _(){var b;return w.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return b=Ag(0,Number.MAX_SAFE_INTEGER),f.log("%s request opid: %d",p,b),x.abrupt("return",te(h,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"90","Content-Type":"application/json"},body:{sid:f.context.sid,opid:b,appid:f.context.appId,client_ts:Math.ceil(Date.now()/1e3),request_bodies:[{uri:22,buffer:{service_ids:[7,16],key:d??f.context.key,cname:f.context.uid,uid:0,detail:ua({},M===void 0?{11:[F.CHINA,F.GLOBAL].join()}:{11:Array.from(M.CODES).map(function(A){return A===F.OVERSEA?"".concat(F.ASIA,",").concat(F.EUROPE,",").concat(F.AFRICA,",").concat(F.NORTH_AMERICA,",").concat(F.SOUTH_AMERICA,",").concat(F.OCEANIA):A}).join(",")})}}]},signal:g.signal}));case 3:case"end":return x.stop()}},_)}))).pipe(Ga(function(_){return _.name!=="AbortError"&&(f.logError(_),f.warn("The AP server %s request failure",h,_)),vb}),cb(function(){var _=J(w.mark(function b(x){var A,k,C,j,P,z,_e,Di,_i,Ei,ga,_c,$,Wt,_t,Vt,B,H,ue;return w.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(A=x.responseText,k=JSON.parse(A),f.log("The %s response is %o",p,k),((C=k.response_body)===void 0||C.length===0||C.some(function(zt){var Fi;return((Fi=zt.buffer)===null||Fi===void 0?void 0:Fi.code)===void 0||zt.uri!==23}))&&Z(new da("cloud proxy response_body not valid",jg)),(j=C.filter(function(zt){return zt.buffer.code!==0})).length===0){_r.next=14;break}if((P=j.find(function(zt){return zt.buffer.flag===128}))===void 0){_r.next=12;break}return _r.abrupt("return",f.handleUniLbsError(P.buffer.code,h));case 12:return f.logError("cloud proxy error response"),_r.abrupt("return",f.handleUniLbsError(j[0].buffer.code,h));case 14:for(z=[],_e=0;_e<C.length;_e++)if(((Ei=C[_e])==null||(Di=Ei.buffer)===null||Di===void 0?void 0:Di.flag)===262144)(ga=Ei.buffer)===null||ga===void 0||(_c=ga.edges_services)===null||_c===void 0||($=_c.forEach)===null||$===void 0||$.call(_c,function(zt){Gm(zt=zt.ip)&&f.context.cloudProxyServers.indexOf(zt)===-1&&(f.log("got cloud proxy server: %s",zt),f.context.cloudProxyServers.push(zt))});else if((Ei==null||(_i=Ei.buffer)===null||_i===void 0?void 0:_i.flag)===128){for(B=function(zt,Fi){var _n=Fi[zt];z.some(function(Js){return Js.ip===_n.ip})||z.push({ip:_n.ip,ticket:Ei.buffer.cert})},H=0,ue=Ei.buffer.edges_services;H<ue.length;H++)B(H,ue);f.context.rtmArea=(Wt=(_t=Ei.buffer)===null||_t===void 0||(Vt=_t.detail)===null||Vt===void 0?void 0:Vt[9])!==null&&Wt!==void 0?Wt:""}return _r.abrupt("return",bb.apply(void 0,G(z).concat([fg])));case 19:case"end":return _r.stop()}},b)}));return function(b){return _.apply(this,arguments)}}()),Ga(function(_){return sa(_)?Z(_):vb}),tg(),wb(function(_){return _!==void 0&&typeof _.ip=="string"&&typeof _.ticket=="string"}))}),m(n(f),"fetchAp",function(h,d){var p=Ai("AP-",f.loggerId);f.log("The AccessPoint requests %s(%s)",h,p);var g=new AbortController;return f.apFinish$.pipe(Ka(1)).subscribe(function(){return g.abort()}),ad(J(w.mark(function _(){var b;return w.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return b=Ag(0,Number.MAX_SAFE_INTEGER),f.log("%s request opid: %d",p,b),x.abrupt("return",te(h,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"69","Content-Type":"application/json"},body:{flag:128,opid:b,key:d||f.context.key,cname:f.context.uid,detail:ua({},M===void 0?{11:[F.CHINA,F.GLOBAL].join()}:{11:Array.from(M.CODES).map(function(A){return A===F.OVERSEA?"".concat(F.ASIA,",").concat(F.EUROPE,",").concat(F.AFRICA,",").concat(F.NORTH_AMERICA,",").concat(F.SOUTH_AMERICA,",").concat(F.OCEANIA):A}).join(",")}),uid:0,sid:f.context.sid},signal:g.signal}));case 3:case"end":return x.stop()}},_)}))).pipe(Ga(function(_){return _.name!=="AbortError"&&(f.logError(_),f.warn("The AP server %s request failure",h,_)),vb}),cb(function(){var _=J(w.mark(function b(x){var A,k,C,j,P,z,_e;return w.wrap(function(Di){for(;;)switch(Di.prev=Di.next){case 0:if(A=x.responseText,k=JSON.parse(A),f.log("The %s response is %o",p,k),j=(C=k).code,P=C.addresses,z=C.detail,j===0){Di.next=6;break}return Di.abrupt("return",f.handleUniLbsError(j,h));case 6:if((_e=P).length!==0){Di.next=11;break}return Di.abrupt("return",Z(Error("No available edge address to connect")));case 11:return f.context.rtmArea=z==null?void 0:z[9],Di.abrupt("return",bb.apply(void 0,G(_e).concat([fg])));case 13:case"end":return Di.stop()}},b)}));return function(b){return _.apply(this,arguments)}}()),tg(),Ga(function(_){return sa(_)?Z(_):vb}),wb(function(_){return _!==void 0&&typeof _.ip=="string"&&typeof _.ticket=="string"}))}),f.context=o,f.getApEdgeInfoEndFirst$=function(){var h=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return Bc(0,h||l?Nc.RECONNECTING_AP_INTERVAL:2e3).pipe(Ka(1),ca(function(){f.retryCount+=1}),cb(function(){return f.context.config.enableCloudProxy?f.getProxyApUrl$(h||l):(4<=f.retryCount&&(f.retryCount=0),3>=f.retryCount?f.getApUrl$(h||l):f.getBackupApUrl$(h||l))}),cb(function(d){return f.context.config.enableCloudProxy?f.fetchCloudProxy(d):f.fetchAp(d)}),Ga(function(d){return d instanceof pb&&f.warn("AP request timeout"),Z(d)}),om(function(d){return d.ip}),ob(f.apFinish$))},f.getApEdgeInfo$=function(h){return Bc(0,h||l?Nc.RECONNECTING_AP_INTERVAL:2e3).pipe(Ka(8),ca(function(){f.retryCount+=1}),cb(function(){return f.context.config.enableCloudProxy?f.getProxyApUrl$(h||l):3>=f.retryCount?f.getApUrl$(h||l):f.getBackupApUrl$(h||l)}),cb(function(d){return(f.context.config.enableCloudProxy?f.fetchCloudProxy(d):f.fetchAp(d)).pipe()}),Ga(function(d){return d instanceof pb&&f.warn("AP request timeout"),Z(d)}),om(function(d){return d.ip}),ob(f.apFinish$))},f}la(e,r);var i=ma(e);return Ha(e,[{key:"clearUp",value:function(){this.failedAreas.clear(),this.retryCount=0}}]),e}(tb());m(Wr,"runOutOfUrlSymbol",Symbol("AP urls are used up"));var Xr=Ph(),Yr=function(r){function e(o,s,l){W(this,e);var f=i.call(this,s,"Connection");m(n(f),"apClient",void 0),m(n(f),"lastOpenSockets",[new qe(1),new qe(1)]),m(n(f),"curOpenSockets",[void 0,void 0]),m(n(f),"ipIterator",0),m(n(f),"firstEnv",.5<=Math.random()?1:0),m(n(f),"firstSocketOpener",void 0),m(n(f),"secondSocketOpener",void 0),m(n(f),"firstOpenKeeperSubject",new Pa),m(n(f),"secondOpenKeeperSubject",new Pa),m(n(f),"edgeInfoReplayed",void 0),m(n(f),"firstEnvOpenSocket",void 0),m(n(f),"firstOpenKeeperSub",void 0),m(n(f),"secondOpenKeeperSub",void 0),m(n(f),"context",void 0),m(n(f),"logger",void 0),f.context=o,f.logger=s,f.apClient=new Wr(f.context,s),f.apClient.apFinish$.subscribe(function(){f.log("Ap client fetch finished")});var h,d=[];return f.edgeInfoReplayed=f.apClient.getApEdgeInfo$(l).pipe(oe(function(p){return p.pipe(ca(function(g){if(sa(g))throw g}),cd(l?Zd.getParameter("RECONNECTING_AP_INTERVAL"):900),ob(Bc(2e4)))}),wb(function(p){return!dl(d,p)}),Dd(function(){return new Xr({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),ca(function(p){d.push(p),f.log("An edge info got %o",p)}),ca({error:function(p){f.emit("connectionInitFailure",p)}}),wg(function(){f.apClient.clearUp()}),sm()),f.firstEnvOpenSocket=f.edgeInfoReplayed.pipe(cb(function(p){if(p===void 0)return Z(Error("Invalid edge info"));var g=new ml(p.ip,f.firstEnv,p.ticket,f.context,s,h);return f.firstEnv=f.firstEnv===1?0:1,g.on("connectionFailure",function(){return f.onSocketConnectionFailure(g)}),h=!g.useNewDomain,g.open$.pipe(qf(g))}),ca(function(p){f.log("The websocket of ENV_%d opened to %s:%d",p.env,p.ip,af[p.env]),f.curOpenSockets[p.env]=p,f.lastOpenSockets[p.env].next(p),f.firstEnv=p.env,f.openSecondSocket(p.env,p.ip,p.useNewDomain)}),Ka(1),pe()),f.firstSocketOpener=f.firstEnvOpenSocket.pipe(cb(function(p){return p.open$.pipe(ca(function(){f.log("The websocket of first ENV_%d re-opened to %s:%d",p.env,p.ip,af[p.env]),f.curOpenSockets[p.env]=p,f.lastOpenSockets[p.env].next(p)}))})),o=f.firstOpenKeeperSubject.pipe(Cc(Yc)),f.firstOpenKeeperSub=o.subscribe({error:f.logError}),f}la(e,r);var i=ma(e);return Ha(e,[{key:"initConnection",value:function(){this.firstOpenKeeperSubject.next(this.firstSocketOpener)}},{key:"closeSocket",value:function(o,s){if(![0,1].includes(o))throw new Fa({INVALID_ENV:"The env argument is not 0 or 1"});var l=o===this.firstEnv?this.firstOpenKeeperSub:this.secondOpenKeeperSub;this.firstOpenKeeperSub=void 0;var f=this.curOpenSockets[o];this.curOpenSockets[o]=void 0,f&&(f.isActiveClose=!0,setTimeout(function(){f.close()},s)),l!==void 0&&setTimeout(function(){l==null||l.unsubscribe()},s)}},{key:"waitClosing",value:function(o){var s=this;return o.isActiveClose=!0,o.open$.pipe(tt(),Ga(function(l){return l.message===mr.normalClosureMessage?vb:Z(l)}),hb(5e3),Ga(function(l){return l instanceof pb?(s.warn("Force closing the ENV_%d connection",o.env),vb):Z(l)}))}},{key:"onSocketConnectionFailure",value:function(o){var s=[0,1].filter(function(l){return l!==o.env})[0];(s=this.curOpenSockets[s])&&s.loggedIn?this.reopenSocketWithApRequest(o.env):this.emit("socketsFailure")}},{key:"openSecondSocket",value:function(o,s,l){var f=this,h=o===1?0:1;this.secondSocketOpener=this.edgeInfoReplayed.pipe(rm(function(d,p){return[].concat(G(d),[p])},[]),ba(function(d){return kr(d,function(p){return Jm(s,p.ip)}).slice(-1)[0]}),Ka(1),cb(function(d){if(d===void 0)return Z(Error("Invalid edge info"));var p=new ml(d.ip,h,d.ticket,f.context,f.logger,l);return p.on("connectionFailure",function(){return f.onSocketConnectionFailure(p)}),p.open$.pipe(ca(function(){f.lastOpenSockets[h].next(p),f.curOpenSockets[h]=p}))}),pe()),this.secondOpenKeeperSub=this.secondOpenKeeperSubject.pipe(Cc(Yc)).subscribe({error:this.logError}),this.secondOpenKeeperSubject.next(this.secondSocketOpener)}},{key:"reopenSocketWithApRequest",value:function(o){var s=this,l=[0,1].filter(function(d){return d!==o})[0];if((l=this.curOpenSockets[l])!==void 0){var f,h=l.ip;l=this.apClient.getApEdgeInfoEndFirst$(!0).pipe(Dd(function(){return new Xr({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),oe(function(d){return d.pipe(ca(function(p){if(p.code===Kh)s.emit("tokenExpired"),s.apClient.apFinish$.next(void 0);else if(sa(p))throw p}),cd(Zd.getParameter("RECONNECTING_AP_INTERVAL")),ob(Bc(15e3)))}),ca(function(d){s.log("An edge info got %o",d)}),wg(function(){s.apClient.clearUp()})).pipe(rm(function(d,p){return[].concat(G(d),[p])},[]),ba(function(d){return(d=kr(d,function(p){return Jm(h,p.ip)})).length-1>=s.ipIterator?d.slice(-s.ipIterator++-1)[0]:(s.ipIterator=0,d.slice(-1)[0])}),Dd(),cb(function(d){if(d===void 0)return Z(Error("Invalid edge info"));var p=new ml(d.ip,o,d.ticket,s.context,s.logger,f);return p.on("connectionFailure",function(){return s.onSocketConnectionFailure(p)}),f=!p.useNewDomain,p.open$.pipe(qf(p))}),ca(function(d){s.log("The websocket of ENV_%d re-opened to %s:%d using ap",d.env,d.ip,af[d.env]),s.curOpenSockets[o]=d,s.lastOpenSockets[o].next(d)}),cb(function(d){return d.open$.pipe(ca(function(){s.log("The websocket of ENV_%d re-opened to %s:%d",d.env,d.ip,af[d.env]),s.curOpenSockets[o]=d,s.lastOpenSockets[o].next(d)}))}),pe()),o===this.firstEnv?this.firstOpenKeeperSubject.next(l):this.secondOpenKeeperSubject.next(l)}}}]),e}(tb()),Xc=fc.Writer,na=fc.util,zc=fc.roots.default||(fc.roots.default={}),RC=zc.Session=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.sid="",r.prototype.userId="",r.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.appId="",r.prototype.ver="",r.prototype.buildno=0,r.prototype.installId="",r.prototype.os=0,r.prototype.did="",r.prototype.index=null,r.prototype.token="",r.prototype.version=0,r.prototype.subVersion=0,r.encode=function(e,i){return i||(i=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&i.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&i.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&i.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&i.uint32(32).int64(e.elapse),e.appId!=null&&Object.hasOwnProperty.call(e,"appId")&&i.uint32(42).string(e.appId),e.ver!=null&&Object.hasOwnProperty.call(e,"ver")&&i.uint32(50).string(e.ver),e.buildno!=null&&Object.hasOwnProperty.call(e,"buildno")&&i.uint32(56).int32(e.buildno),e.installId!=null&&Object.hasOwnProperty.call(e,"installId")&&i.uint32(66).string(e.installId),e.os!=null&&Object.hasOwnProperty.call(e,"os")&&i.uint32(128).int32(e.os),e.did!=null&&Object.hasOwnProperty.call(e,"did")&&i.uint32(138).string(e.did),e.index!=null&&Object.hasOwnProperty.call(e,"index")&&zc.Session.CommonIndex.encode(e.index,i.uint32(162).fork()).ldelim(),e.token!=null&&Object.hasOwnProperty.call(e,"token")&&i.uint32(170).string(e.token),e.version!=null&&Object.hasOwnProperty.call(e,"version")&&i.uint32(176).int32(e.version),e.subVersion!=null&&Object.hasOwnProperty.call(e,"subVersion")&&i.uint32(184).int32(e.subVersion),i},r.CommonIndex=function(){function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.index1="",e.prototype.index2="",e.prototype.index3="",e.encode=function(i,o){return o||(o=Xc.create()),i.index1!=null&&Object.hasOwnProperty.call(i,"index1")&&o.uint32(10).string(i.index1),i.index2!=null&&Object.hasOwnProperty.call(i,"index2")&&o.uint32(18).string(i.index2),i.index3!=null&&Object.hasOwnProperty.call(i,"index3")&&o.uint32(26).string(i.index3),o},e}(),r}(),SC=zc.Link=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.sid="",r.prototype.userId="",r.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.ec=0,r.prototype.sc=0,r.prototype.destServerIp="",r.prototype.ackedServerIp="",r.prototype.responseTime=0,r.encode=function(e,i){return i||(i=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&i.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&i.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&i.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&i.uint32(32).int64(e.elapse),e.ec!=null&&Object.hasOwnProperty.call(e,"ec")&&i.uint32(40).int32(e.ec),e.sc!=null&&Object.hasOwnProperty.call(e,"sc")&&i.uint32(48).int32(e.sc),e.destServerIp!=null&&Object.hasOwnProperty.call(e,"destServerIp")&&i.uint32(58).string(e.destServerIp),e.ackedServerIp!=null&&Object.hasOwnProperty.call(e,"ackedServerIp")&&i.uint32(66).string(e.ackedServerIp),e.responseTime!=null&&Object.hasOwnProperty.call(e,"responseTime")&&i.uint32(72).int32(e.responseTime),i},r}(),TC=zc.Logout=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.sid="",r.prototype.userId="",r.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,r.encode=function(e,i){return i||(i=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&i.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&i.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&i.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&i.uint32(32).int64(e.elapse),i},r}(),UC=zc.KickedOff=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.sid="",r.prototype.userId="",r.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.linkId=0,r.prototype.code=0,r.prototype.server="",r.prototype.serverCode=0,r.encode=function(e,i){return i||(i=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&i.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&i.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&i.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&i.uint32(32).int64(e.elapse),e.linkId!=null&&Object.hasOwnProperty.call(e,"linkId")&&i.uint32(48).int32(e.linkId),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&i.uint32(56).int32(e.code),e.server!=null&&Object.hasOwnProperty.call(e,"server")&&i.uint32(66).string(e.server),e.serverCode!=null&&Object.hasOwnProperty.call(e,"serverCode")&&i.uint32(72).int32(e.serverCode),i},r}(),VC=zc.ChnJoin=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.sid="",r.prototype.userId="",r.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.cname="",r.prototype.errCode=0,r.encode=function(e,i){return i||(i=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&i.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&i.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&i.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&i.uint32(32).int64(e.elapse),e.cname!=null&&Object.hasOwnProperty.call(e,"cname")&&i.uint32(50).string(e.cname),e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&i.uint32(56).int32(e.errCode),i},r}(),WC=zc.ChnJoinRes=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.sid="",r.prototype.userId="",r.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.cname="",r.prototype.errCode=0,r.prototype.serverErrCode=0,r.encode=function(e,i){return i||(i=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&i.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&i.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&i.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&i.uint32(32).int64(e.elapse),e.cname!=null&&Object.hasOwnProperty.call(e,"cname")&&i.uint32(50).string(e.cname),e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&i.uint32(56).int32(e.errCode),e.serverErrCode!=null&&Object.hasOwnProperty.call(e,"serverErrCode")&&i.uint32(64).int32(e.serverErrCode),i},r}(),XC=zc.ChnLeave=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.sid="",r.prototype.userId="",r.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.cname="",r.prototype.errCode=0,r.encode=function(e,i){return i||(i=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&i.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&i.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&i.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&i.uint32(32).int64(e.elapse),e.cname!=null&&Object.hasOwnProperty.call(e,"cname")&&i.uint32(50).string(e.cname),e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&i.uint32(56).int32(e.errCode),i},r}(),YC=zc.ConnectionStateChange=function(){function r(e){if(e)for(var i=Object.keys(e),o=0;o<i.length;++o)e[i[o]]!=null&&(this[i[o]]=e[i[o]])}return r.prototype.sid="",r.prototype.userId="",r.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,r.prototype.oldState=0,r.prototype.newState=0,r.prototype.reason=0,r.prototype.reconnId=0,r.encode=function(e,i){return i||(i=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&i.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&i.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&i.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&i.uint32(32).int64(e.elapse),e.oldState!=null&&Object.hasOwnProperty.call(e,"oldState")&&i.uint32(40).int32(e.oldState),e.newState!=null&&Object.hasOwnProperty.call(e,"newState")&&i.uint32(48).int32(e.newState),e.reason!=null&&Object.hasOwnProperty.call(e,"reason")&&i.uint32(56).int32(e.reason),e.reconnId!=null&&Object.hasOwnProperty.call(e,"reconnId")&&i.uint32(64).int32(e.reconnId),i},r}(),fu=Object.freeze({__proto__:null,Session:RC,Link:SC,Logout:TC,KickedOff:UC,ChnJoin:VC,ChnJoinRes:WC,ChnLeave:XC,ConnectionStateChange:YC,default:zc}),gu=Object.freeze({__proto__:null,Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,default:{Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191}}),ZC=function(r){function e(o,s,l){return W(this,e),m(n(l=i.call(this,l,"Context")),"_token",void 0),m(n(l),"config",void 0),m(n(l),"_uid",void 0),m(n(l),"_sid",void 0),m(n(l),"_area","CN"),m(n(l),"appId",void 0),m(n(l),"enableCloudProxy",!1),m(n(l),"cloudProxyServers",[]),l.appId=o,l.config=s,l}la(e,r);var i=ma(e);return Ha(e,[{key:"token",set:function(o){this._token=typeof o=="string"&&o?o:void 0}},{key:"uid",get:function(){if(typeof this._uid=="string"&&this._uid)return this._uid;throw new Ia("Cannot get illegal uid")},set:function(o){if(this.log("The user ID is set to %s",oa(o)),!za(o))throw new Ia;this._uid=o}},{key:"key",get:function(){if(typeof this._token=="string"&&this._token)return this._token;if(typeof this.appId=="string"&&this.appId)return this.appId;throw new Ia("Cannot get illegal key")}},{key:"sid",get:function(){if(typeof this._sid=="string"&&this._sid)return this._sid;throw new Ia("Cannot get illegal sid")},set:function(o){if(this.log("sid is set to %s",o),typeof o!="string"||!o)throw new Ia;this._sid=o}},{key:"rtmArea",get:function(){if(typeof this._area=="string"&&this._area)return this._area;throw new Ia("Cannot get illegal area")},set:function(o){this.log("area is set to %s",o),typeof o=="string"&&o?this._area=o:this.warn("set area failed")}}]),e}(tb()),$C=!!Fc&&R(function(){Fc.prototype.finally.call({then:function(){}},function(){})});if(N({target:"Promise",proto:!0,real:!0,forced:$C},{finally:function(r){var e=kd(this,mc("Promise")),i=typeof r=="function";return this.then(i?function(o){return mj(e,r()).then(function(){return o})}:r,i?function(o){return mj(e,r()).then(function(){throw o})}:r)}}),typeof Fc=="function"){var Zr=mc("Promise").prototype.finally;Fc.prototype.finally!==Zr&&Ta(Fc.prototype,"finally",Zr,{unsafe:!0})}var aD=function(){var r=J(w.mark(function e(i){return w.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.t0=Uint8Array,o.next=3,crypto.subtle.digest("SHA-256",i);case 3:return o.t1=o.sent,o.abrupt("return",new o.t0(o.t1));case 5:case"end":return o.stop()}},e)}));return function(e){return r.apply(this,arguments)}}(),$r=function(r){return Array.from(r).map(function(e){return e.toString(16).padStart(2,"0")}).join("")},bD=function(r){if(typeof r!="string")throw new TypeError("Expected input to be a string");if(r.length%2!=0)throw new RangeError("Expected string to be an even number of characters");for(var e=new Uint8Array(r.length/2),i=0;i<r.length;i+=2)e[i/2]=parseInt(r.substring(i,i+2),16);return e},as=function(r){return btoa(String.fromCharCode.apply(String,G(r))).replace(/={1,2}$/,"")},bs=function(){var r=J(w.mark(function e(i){var o;return w.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,crypto.subtle.digest("SHA-1",i);case 3:o=s.sent,s.next=9;break;case 6:s.prev=6,s.t0=s.catch(0),o=sha1.arrayBuffer(i);case 9:return s.abrupt("return",as(new Uint8Array(o)));case 10:case"end":return s.stop()}},e,null,[[0,6]])}));return function(e){return r.apply(this,arguments)}}(),cs=function(r,e,i,o){o[e]=!0,i.has(r)?i.get(r).add(e):i.set(r,new Set([e]))},cD=function(r){switch(r){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip";default:return"application/octet-stream"}},ds=function(r){function e(o,s,l,f){W(this,e);var h=i.call(this,l,"ChunkDownloadManager");if(m(n(h),"abortController",new AbortController),m(n(h),"downloadedSize",0),m(n(h),"successCount",0),m(n(h),"timer",void 0),m(n(h),"chunks",[]),m(n(h),"retUnit",void 0),m(n(h),"singleThread",!1),m(n(h),"initialized",!1),m(n(h),"ee",void 0),m(n(h),"chunkCount",void 0),m(n(h),"aborted",!1),m(n(h),"serverToIndices",new Map),m(n(h),"backupToIndices",new Map),m(n(h),"indexToBackupServers",[]),m(n(h),"busyBackupServers",new Map),m(n(h),"downloadingChunks",new Set),m(n(h),"metaInfo",void 0),m(n(h),"transHandler",void 0),h.metaInfo=o,h.transHandler=s,h.ee=f===void 0?new ea:f,l=o.size,o=o.unit,l===0)throw new Ia("size cannot be 0");return s.cancelSignal!==void 0&&s.cancelSignal.addEventListener("abort",function(){h.abortController.abort()},{once:!0}),h.abortController.signal.addEventListener("abort",function(){h.aborted=!0},{once:!0}),h.chunkCount=Math.ceil(l/(32768*o)),h}la(e,r);var i=ma(e);return Ha(e,[{key:"setInfoByResponse",value:function(o){var s=this,l=o.serverList,f=o.backupList;if(o=o.unit,l.length<this.chunkCount&&f.length<this.chunkCount)throw new Ia("servers is not enough");this.updateProgress(0),this.initialized=!0;var h=Array(this.chunkCount).fill(!1);if(l.forEach(function(d,p){return d.forEach(function(g){return cs(g,p,s.serverToIndices,h)})}),f.forEach(function(d,p){return d.forEach(function(g){return cs(g,p,s.backupToIndices,h)})}),h.some(function(){return!1}))throw new da("Not enough servers to download",mg);this.indexToBackupServers=f.map(function(d){return new Set(d)}),this.retUnit=o}},{key:"downloadChunks",value:function(){this.aborted?this.warn("downloadChunks after abort, ignored"):this.serverToIndices.size===1&&Array.from(this.serverToIndices.keys())[0]===0?this.serversDownload(this.backupToIndices):1<=this.serverToIndices.size?this.serversDownload(this.serverToIndices,!0):this.ee.emit("error",new da("not enough servers to download",mg))}},{key:"updateProgress",value:function(o){var s=this,l=this.downloadedSize+o;this.downloadedSize>this.metaInfo.size?(this.warn("Invalid download size, overflowed"),this.ee.emit("error",new Wc("Invalid download size",mg))):(this.downloadedSize=l,this.timer!==void 0&&o!==0&&(clearTimeout(this.timer),this.timer=void 0),this.timer===void 0&&this.successCount!==this.chunkCount&&(this.timer=setTimeout(function(){s.ee.emit("timedOut"),s.abortController.abort()},12e4)),this.initialized&&o===0||this.transHandler.onOperationProgress===void 0||this.transHandler.onOperationProgress({totalSize:this.metaInfo.size,currentSize:this.downloadedSize}))}},{key:"getPayload",value:function(){for(var o=0,s=0,l=this.chunks;s<l.length;s++)o+=l[s].byteLength;if(o!==this.metaInfo.size)throw new Ia("invalid chunks total size");o=new Uint8Array(o),l=s=0;for(var f=this.chunks;l<f.length;l++){var h=f[l];o.set(new Uint8Array(h),s),s+=h.byteLength}return s=Array.from(o.subarray(0,4)).map(function(d){return d.toString(16)}).join("").toUpperCase(),Zt(o.buffer,cD(s))}},{key:"getDownloadUrl",value:function(o){var s=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat(Dg(o).split(".").join("-"),".edge.").concat(s,":9601/api/v1/chuck/download")}},{key:"serversDownload",value:function(){var o=J(w.mark(function s(l){var f,h=this,d=arguments;return w.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return f=1<d.length&&d[1]!==void 0&&d[1],p.next=3,Promise.all(Array.from(l.entries()).map(function(g){return g=ra(g,2),h.postDownloadRequest(g[0],Array.from(g[1]),f).catch(function(_){_.statusCode===404?(h.ee.emit("notExist"),h.abortController.abort()):_.name!=="AbortError"&&(Sa(_)?h.singleThread?(h.abortController.abort(),h.ee.emit("timedOut")):(h.warn("%d download timed out after %d, retrying use single thread",_.index,h.singleThread?6e4:3e4),h.abortController.abort(),h.singleThread=!0,h.ee.emit("multiTimeOut")):(h.ee.emit("error",_),h.abortController.abort()))})}));case 3:case"end":return p.stop()}},s)}));return function(s){return o.apply(this,arguments)}}()},{key:"postDownloadRequest",value:function(){var o=J(w.mark(function s(l,f,h){var d,p,g,_,b,x,A,k,C,j=this;return w.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(C=function(){return(C=J(w.mark(function z(_e){var Di,_i,Ei,ga,_c,$,Wt,_t,Vt;return w.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(B.prev=0,_e!==void 0||l!==0){B.next=5;break}throw new Ia("Invalid serverIp");case 5:Di=_e===void 0?A.getDownloadUrl(l):_e;case 6:return A.downloadingChunks.add(d),B.next=9,x(Di);case 9:return _i=B.sent,Ei=_i.responseData,A.downloadingChunks.delete(d),B.abrupt("return",Ei);case 15:if(B.prev=15,B.t0=B.catch(0),A.downloadingChunks.delete(d),f.unshift(d),A.metaInfo.useNewDomain=!1,B.t0.name!=="AbortError"){B.next=22;break}throw B.t0;case 22:if(!Sa(B.t0)){B.next=25;break}throw B.t0.index=d,B.t0;case 25:if(ga=_,_+=1,!(2>ga)){B.next=30;break}return B.t0 instanceof Ia||A.warn("%o, %d download failed, retrying",B.t0,d),B.abrupt("return",k());case 30:if(B.t0.statusCode!==504){B.next=34;break}throw(_c=new db("download server timed out",{originalError:B.t0,serverCode:504})).index=d,_c;case 34:if(!h||ga!==2||b[0]===0){B.next=45;break}return B.t0 instanceof Ia||A.warn("%d download failed, using backup: %d, %o",d,b[0],B.t0),B.next=38,A.busyBackupServers.get(b[0]);case 38:return $=k(A.getDownloadUrl(b[0])),A.busyBackupServers.set(b[0],$),B.next=42,$;case 42:return Wt=B.sent,A.busyBackupServers.delete(b[0]),B.abrupt("return",Wt);case 45:if(!(h&&2<ga&&b[1]!==void 0&&b[1]!==0)){B.next=56;break}return A.warn("%d download failed, using backup 1: %d",d,b[1]),B.next=49,A.busyBackupServers.get(b[1]);case 49:return _t=k(A.getDownloadUrl(b[1])),A.busyBackupServers.set(b[1],_t),B.next=53,_t;case 53:return Vt=B.sent,A.busyBackupServers.delete(b[1]),B.abrupt("return",Vt);case 56:throw B.t0.index=d,B.t0;case 58:case"end":return B.stop()}},z,null,[[0,15]])}))).apply(this,arguments)},k=function(z){return C.apply(this,arguments)},!this.aborted){P.next=4;break}throw new Ia("download already aborted");case 4:if((d=f.shift())!==void 0){P.next=8;break}return this.log("%s download finished",l),P.abrupt("return");case 8:if(!(this.singleThread&&0<this.downloadingChunks.size)){P.next=10;break}return P.abrupt("return");case 10:if(!this.downloadingChunks.has(d)){P.next=13;break}return this.log("%s already downloading, return",d),P.abrupt("return");case 13:if(this.chunks[d]===void 0){P.next=19;break}return this.successCount===this.chunkCount&&(this.log("chunks all download"),this.ee.emit("finished")),this.log("%s already downloaded, do next",d),P.next=18,this.postDownloadRequest(l,f,h);case 18:return P.abrupt("return");case 19:return p=new FormData,g={hash:hu(this.metaInfo.hashHexStr),unit:this.retUnit===void 0?this.metaInfo.unit:this.retUnit,instance:this.metaInfo.instance,loginOpt:this.metaInfo.loginOpt,ticket:this.metaInfo.ticket,index:d},p.append("parameter",JSON.stringify(g)),_=0,b=Array.from(this.indexToBackupServers[d]),x=function(z){return te(z,{body:p,signal:j.abortController.signal,timeout:j.singleThread?12e4:3e4},{useBinaryResponse:!0})},A=this,P.next=28,k().then(function(z){return j.chunks[d]!==void 0?j.log("chunk %d download duplicated",d):(j.chunks[d]=z,j.log("chunk %d downloaded",d),j.successCount+=1,j.updateProgress(j.chunks[d].byteLength)),j.successCount===j.chunkCount&&(j.log("chunks all download"),j.ee.emit("finished")),j.singleThread?(j.downloadChunks(),Promise.resolve()):j.postDownloadRequest(l,f,h)});case 28:case"end":return P.stop()}},s,this)}));return function(s,l,f){return o.apply(this,arguments)}}()}]),e}(tb()),es=function(r){function e(o,s,l,f){W(this,e);var h=i.call(this,l,"ChunkUploadManager");if(m(n(h),"chunkCount",0),m(n(h),"chunks",[]),m(n(h),"uploadedChunks",[]),m(n(h),"totalFailures",0),m(n(h),"timer",void 0),m(n(h),"initState","uninitialized"),m(n(h),"ee",void 0),m(n(h),"unit",0),m(n(h),"uploadedSize",0),m(n(h),"singleThread",!1),m(n(h),"abortController",new AbortController),m(n(h),"servers",[]),m(n(h),"aborted",!1),m(n(h),"metaInfo",void 0),m(n(h),"transHandler",void 0),h.metaInfo=o,h.transHandler=s,h.ee=f===void 0?new ea:f,o.file.length===0)throw new I("file not found or is empty",wf);return s.cancelSignal!==void 0&&s.cancelSignal.addEventListener("abort",function(){h.abortController.abort()},{once:!0}),h.abortController.signal.addEventListener("abort",function(){h.aborted=!0},{once:!0}),h}la(e,r);var i=ma(e);return Ha(e,[{key:"initChunks",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g,_=this;return w.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.initState!=="initialized"&&this.initState!=="initializing"){b.next=2;break}throw new Ia("cannot re-initialize");case 2:for(this.initState="initializing",this.unit=l,f=this.sliceFile(l,this.metaInfo.file),this.chunkCount=f.length,h=[],d=function(x,A){var k=(x=ra(A[x],2))[0],C=x[1];x=bs(C).then(function(j){_.chunks[k]={payload:C,sha1:j,uploadedTo:void 0,index:k,processed:!1}}),h.push(x)},p=0,g=Array.from(f.entries());p<g.length;p++)d(p,g);return b.next=11,Promise.all(h);case 11:this.updateProgress(0),this.initState="initialized",this.log("upload chunks initialized");case 14:case"end":return b.stop()}},s,this)}));return function(s){return o.apply(this,arguments)}}()},{key:"uploadToServers",value:function(){var o=this;if(!this.aborted){for(var s=this.chunks.filter(function(h){return!h.processed}),l=function(h){var d=s[h],p=o.servers.filter(function(_){return!_.isUploading}).sort(function(_,b){return _.successCount-b.successCount}).sort(function(_,b){return _.failureCount-b.failureCount})[0];if(p===void 0||1<p.failureCount)return o.log("Upload server not available, waiting"),o.ee.emit("serverUsedUp"),Om(1e3).then(function(){o.totalFailures>2*o.chunkCount&&o.ee.emit("error"),o.totalFailures+=1,p!==void 0&&(p.failureCount=0),o.uploadToServers()}).catch(function(){}),"break";d.processed=!0,p.isUploading=!0,o.log("uploading chunk %d to server %s",d.index,Dg(p.ip));var g=o.getUploadUrl(p.ip);return J(w.mark(function _(){var b;return w.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,o.postChunk(d.payload,g,d.index);case 3:b=o.chunks.findIndex(function(A){return A===d}),d.uploadedTo=p.ip,o.chunks.splice(b,1),o.uploadedChunks.push(d),p.successCount+=1,p.isUploading=!1,o.updateProgress(d.payload.byteLength),o.log("upload chunk %d successfully",d.index),x.next=31;break;case 13:if(x.prev=13,x.t0=x.catch(0),p.isUploading=!1,d.processed=!1,x.t0.statusCode!==504&&!Sa(x.t0)){x.next=27;break}if(o.singleThread){x.next=24;break}return o.warn("%d upload timed out after %d, retrying use single thread",d.index,o.singleThread?12e4:3e4),o.abortController.abort(),o.singleThread=!0,o.ee.emit("multiTimeOut"),x.abrupt("return");case 24:return o.ee.emit("timedOut"),o.abortController.abort(),x.abrupt("return");case 27:return o.metaInfo.useNewDomain=!1,p.failureCount+=1,x.next=31,Om(1e3);case 31:o.uploadedChunks.length===o.chunkCount?(o.log("chunks uploaded"),o.ee.emit("finished")):(o.singleThread||o.chunks.filter(function(A){return!A.processed}).length===1)&&o.uploadToServers();case 32:case"end":return x.stop()}},_,null,[[0,13]])}))(),o.singleThread?"break":void 0},f=0;f<s.length&&l(f)!=="break";f++);s.length===0&&this.uploadedChunks.length!==this.chunkCount&&this.log("%d chunks left uploading",this.chunkCount-this.uploadedChunks.length)}}},{key:"getUploadServerIPs",value:function(){var o=!0,s=[],l=G(this.uploadedChunks).sort(function(d,p){return d.index-p.index}),f=0;for(l=Array.from(l.values());f<l.length;f++){var h=l[f].uploadedTo;if(h===void 0){o=!1;break}s.push(h)}if(!o)throw new Ia("some chunks not uploaded, cannot get upload server ips");return s}},{key:"addServers",value:function(o){var s=this;o.forEach(function(l){var f=s.servers.findIndex(function(h){return h.ip===l});f!==-1?s.servers[f].failureCount=0:(s.log("server %s added",Dg(l)),s.servers.push({successCount:0,isUploading:!1,ip:l,failureCount:0}))})}},{key:"updateProgress",value:function(o){var s=this,l=o!==void 0?this.uploadedSize+o:this.metaInfo.file.length;l>this.metaInfo.file.length?(this.warn("Invalid upload size, overflowed"),this.ee.emit("error",new Wc("Invalid upload size",lg))):(this.uploadedSize=l,this.timer!==void 0&&o!==0&&(clearTimeout(this.timer),this.timer=void 0),this.timer===void 0&&o!==void 0&&this.uploadedChunks.length!==this.chunkCount&&(this.timer=setTimeout(function(){s.ee.emit("timedOut"),s.abortController.abort()},12e4)),this.initState==="initialized"&&o===0||this.transHandler.onOperationProgress===void 0||this.transHandler.onOperationProgress({totalSize:this.metaInfo.file.length,currentSize:this.uploadedSize}))}},{key:"sliceFile",value:function(o,s){var l=0,f=[],h=s.length;for(o*=32768;l<h;)f.push(s.slice(l,l+o)),l+=o;return this.log("chunks split into %d",f.length),f}},{key:"postChunk",value:function(){var o=J(w.mark(function s(l,f,h){var d,p,g,_,b,x,A,k;return w.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(!this.aborted){C.next=2;break}throw new Ia("upload already aborted");case 2:if(this.unit!==void 0){C.next=4;break}throw new Ia("unit is undefined");case 4:return d=this.metaInfo,p=d.ticket,g=d.instance,_=d.loginOpt,b=d.hashStr,C.t0=h,C.t1=b,C.next=9,bs(l);case 9:return C.t2=C.sent,C.t3=this.unit,C.t4=p,C.t5=g,C.t6=_,x={index:C.t0,hash:C.t1,sha1:C.t2,unit:C.t3,ticket:C.t4,instance:C.t5,loginOpt:C.t6},(A=new FormData).append("parameter",JSON.stringify(x)),A.append("payload",new Blob([l])),C.next=20,te(f,{headers:{Accept:"application/json"},body:A,timeout:this.singleThread?12e4:3e4,signal:this.abortController.signal});case 20:if(k=C.sent,k.status===201){C.next=24;break}throw new da("uploading chunk ".concat(h," failed"));case 24:case"end":return C.stop()}},s,this)}));return function(s,l,f){return o.apply(this,arguments)}}()},{key:"getUploadUrl",value:function(o){var s=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat(Dg(o).split(".").join("-"),".edge.").concat(s,":9601/api/v1/chuck/upload")}}]),e}(tb()),fs=function(r){function e(o){W(this,e);var s=i.call(this,o,"MediaTaskManager");return m(n(s),"isProcessing",!1),m(n(s),"authInfo",void 0),m(n(s),"taskFinishers",{}),m(n(s),"mediaTasks",new Map),m(n(s),"ongoingTask",void 0),s.on("connectionStateChanged",function(l){if(l===S.ConnectionState.ABORTED||l===S.ConnectionState.DISCONNECTED){s.ongoingTask!==void 0&&s.cancelTask(s.ongoingTask),l=0;for(var f=Array.from(s.mediaTasks.entries());l<f.length;l++){var h=ra(f[l],2)[1];s.cancelTask(h)}s.mediaTasks.clear(),s.taskFinishers={}}else l===S.ConnectionState.RECONNECTING?s.ongoingTask!==void 0&&s.ongoingTask.manager.abortController.abort():l===S.ConnectionState.CONNECTED&&s.ongoingTask!==void 0&&s.ongoingTask.manager.ee.emit("reconnected")}),s}la(e,r);var i=ma(e);return Ha(e,[{key:"setAuthInfo",value:function(o){this.authInfo=o}},{key:"waitMediaTask",value:function(o){var s=this;return new Promise(function(l,f){s.taskFinishers[o]={resolve:l,reject:f},s.isProcessing||s.processMediaTask()}).finally(function(){s.ongoingTask!==void 0&&s.ongoingTask.manager.timer!==void 0&&clearTimeout(s.ongoingTask.manager.timer),delete s.taskFinishers[o],s.mediaTasks.size!==0?s.processMediaTask():s.isProcessing=!1})}},{key:"addUploadTask",value:function(o,s,l,f){var h=o.file;if(o=o.hash,this.authInfo===void 0)throw new Ia("session not found");if(this.mediaTasks.size>=e.MAX_PENDING_TASK_COUNT-1)throw new ib("Upload media failed, exceed max pending jobs",xA);return f=new es({hashStr:as(o),file:h,ticket:this.authInfo.ticket,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),useNewDomain:this.authInfo.useNewDomain},f,this.logger),h=Ud(),this.mediaTasks.set(h,{type:"UPLOAD",manager:f,hash:o,setter:l,fetcher:s,taskId:h}),h}},{key:"addDownloadTask",value:function(o,s,l){var f=o.hashHexStr,h=o.size,d=o.unit;if(o=o.zone,this.authInfo===void 0)throw new Ia("session not found");if(this.mediaTasks.size>=e.MAX_PENDING_TASK_COUNT-1)throw new ib("Download media failed, exceed max pending jobs",BA);return l=new ds({hashHexStr:f,ticket:this.authInfo.ticket,useNewDomain:this.authInfo.useNewDomain,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),size:h,zone:o,unit:d},l,this.logger),f=Ud(),this.mediaTasks.set(f,{type:"DOWNLOAD",manager:l,fetcher:s,taskId:f}),f}},{key:"doDownloadTaskImpl",value:function(){var o=J(w.mark(function s(l,f){var h,d,p,g,_,b,x,A,k=this,C=arguments;return w.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return h=2<C.length&&C[2]!==void 0&&C[2],p=d=l.manager,h&&(d=new ds(p.metaInfo,p.transHandler,this.logger,p.ee)),g=l.fetcher,j.next=7,g();case 7:if(_=j.sent,b=_.serverList,x=_.backupList,A=_.unit,!h||A===p.retUnit){j.next=13;break}throw new da("download unit is different, reject to continue",mg);case 13:h&&(l.manager=d,d.downloadedSize=p.downloadedSize,d.successCount=p.successCount,d.timer=p.timer,d.chunks=p.chunks,d.initialized=p.initialized,d.singleThread=p.singleThread,d.updateProgress(0)),d.ee.once("reconnected",function(){d.ee.removeAllListeners(),k.doDownloadTaskImpl(l,f,!0).catch(function(P){f.reject(P)})}),d.ee.once("multiTimeOut",function(){d.ee.removeAllListeners(),k.doDownloadTaskImpl(l,f,!0).catch(function(P){f.reject(P)})}),d.ee.once("error",function(P){d.ee.removeAllListeners(),f.reject(new da(["download file file, index %d",P.index],{code:mg,originalError:P}))}),d.ee.once("notExist",function(){d.abortController.abort(),d.ee.removeAllListeners(),f.reject(new da("download file not found",AA))}),d.ee.once("timedOut",function(){d.ee.removeAllListeners(),d.abortController.abort(),f.reject(new db("download timed out",zA))}),d.transHandler.cancelSignal!==void 0&&d.transHandler.cancelSignal.addEventListener("abort",function(){f.reject(new hl("Downloading canceled",ir))},{once:!0}),d.ee.once("finished",function(){f.resolve({type:"DOWNLOAD",payload:d.getPayload()})}),d.setInfoByResponse({serverList:b,backupList:x,unit:A}),d.downloadChunks();case 23:case"end":return j.stop()}},s,this)}));return function(s,l){return o.apply(this,arguments)}}()},{key:"doDownloadTask",value:function(o,s){var l=this,f=2<arguments.length&&arguments[2]!==void 0&&arguments[2],h=o.taskId;return f||(this.mediaTasks.delete(h),this.ongoingTask=o),new Promise(function(d,p){l.doDownloadTaskImpl(o,s,f).then(d).catch(p)})}},{key:"doUploadTaskImpl",value:function(){var o=J(w.mark(function s(l,f){var h,d,p,g,_,b,x,A,k,C=this,j=arguments;return w.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return h=2<j.length&&j[2]!==void 0&&j[2],p=d=l.manager,h&&(d=new es(p.metaInfo,p.transHandler,this.logger,p.ee)),g=l.fetcher,_=new Pa,x=new Promise(function(z,_e){var Di=g(),_i=Di.ret,Ei=Di.err,ga=Di.timeout;Di.fin.pipe(ob(_)).subscribe({next:function(_c){f.resolve({type:"UPLOAD",retUnit:_c.unit,zone:_c.zone})},complete:function(){z({hasExist:!0}),_.next(),_.complete()}}),_i.pipe(ob(_),cb(function(){var _c=J(w.mark(function $(Wt){var _t,Vt;return w.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(_t=Wt.servers,Vt=Wt.unit,h&&p.unit!==Vt?f.reject(new da("upload unit is different, reject to continue",lg)):h&&(l.manager=d,d.chunkCount=p.chunkCount,d.chunks=p.chunks,d.totalFailures=p.totalFailures,d.uploadedChunks=p.uploadedChunks,d.timer=p.timer,d.initState=p.initState,d.unit=p.unit,d.uploadedSize=p.uploadedSize,d.singleThread=p.singleThread,d.updateProgress(0)),d.addServers(_t),d.initState!=="uninitialized"){B.next=7;break}return b=d.initChunks(Vt),B.next=7,b;case 7:case"end":return B.stop()}},$)}));return function($){return _c.apply(this,arguments)}}())).subscribe({complete:function(){return z({hasExist:!1})},error:_e}),Di=function(_c){d.initState!=="uninitialized"&&b?z(b.then(function(){return{hasExist:!1}})):_e(_c)},Ei.pipe(ob(_)).subscribe({error:Di}),ga.pipe(ob(_)).subscribe({error:Di})}),P.next=9,x;case 9:if(A=P.sent,!A.hasExist){P.next=15;break}return d.updateProgress(),this.log("file already exists, skipping upload"),P.abrupt("return");case 15:_.next(),_.complete(),this.log("chunks initialization promise resolved"),k=gb(d.ee,"serverUsedUp").pipe(Gt(function(){return d.chunkCount!==d.uploadedChunks.length}),Jt(5e3,void 0,{leading:!1}),pm(function(){return g().ret})).subscribe(function(z){d.addServers(z.servers)}),d.ee.once("reconnected",function(){d.ee.removeAllListeners(),C.doUploadTask(l,f,!0).catch(function(z){f.reject(z)})}),d.ee.once("multiTimeOut",function(){d.ee.removeAllListeners(),C.doUploadTask(l,f,!0).catch(function(z){f.reject(z)})}),d.ee.once("timedOut",function(){k.unsubscribe(),d.ee.removeAllListeners(),d.abortController.abort(),f.reject(new db("upload timed out",Lh))}),d.ee.once("error",function(z){k.unsubscribe(),d.ee.removeAllListeners(),d.abortController.abort(),f.reject(z||new da("upload error",lg))}),d.transHandler.cancelSignal!==void 0&&d.transHandler.cancelSignal.addEventListener("abort",function(){f.reject(new hl("Uploading canceled",hr))},{once:!0}),d.ee.once("finished",J(w.mark(function z(){var _e,Di,_i;return w.wrap(function(Ei){for(;;)switch(Ei.prev=Ei.next){case 0:return k.unsubscribe(),Ei.next=3,l.setter(d.unit,d.getUploadServerIPs());case 3:_e=Ei.sent,Di=_e.zone,_i=_e.unit,d.ee.removeAllListeners(),f.resolve({type:"UPLOAD",retUnit:_i,zone:Di});case 8:case"end":return Ei.stop()}},z)}))),d.uploadToServers();case 26:case"end":return P.stop()}},s,this)}));return function(s,l){return o.apply(this,arguments)}}()},{key:"doUploadTask",value:function(o,s){var l=this,f=2<arguments.length&&arguments[2]!==void 0&&arguments[2],h=o.taskId;return f||(this.mediaTasks.delete(h),this.ongoingTask=o),new Promise(function(d,p){l.doUploadTaskImpl(o,s,f).then(d).catch(p)})}},{key:"processMediaTask",value:function(){var o=J(w.mark(function s(){var l,f,h;return w.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.mediaTasks.size!==0){d.next=2;break}throw Error("no upload tasks");case 2:if(this.isProcessing=!0,l=this.mediaTasks.keys().next().value,(f=this.taskFinishers[l])!==void 0){d.next=7;break}throw Error("top task not found");case 7:if((h=this.mediaTasks.get(l))!==void 0){d.next=10;break}throw new Ia("task invalid");case 10:if(h.type!=="UPLOAD"){d.next=15;break}return d.next=13,this.doUploadTask(h,f).catch(function(p){h.manager.ee.removeAllListeners(),f.reject(p)});case 13:d.next=18;break;case 15:if(h.type!=="DOWNLOAD"){d.next=18;break}return d.next=18,this.doDownloadTask(h,f).catch(function(p){h.manager.ee.removeAllListeners(),f.reject(p)});case 18:case"end":return d.stop()}},s,this)}));return function(){return o.apply(this,arguments)}}()},{key:"cancelTask",value:function(o){var s=o.type==="DOWNLOAD"?ir:hr;o.manager.ee.removeAllListeners(),o.manager.abortController.abort(),this.taskFinishers[o.taskId]!==void 0&&this.taskFinishers[o.taskId].reject(new hl("User logged out or kicked off, media task canceled",s))}}]),e}(tb());m(fs,"MAX_PENDING_TASK_COUNT",9),Oo("of",function(){for(var r=0,e=arguments.length,i=new(Ne(this))(e);e>r;)i[r]=arguments[r++];return i},Dj);var gs=1/0,dD=Math.max,ju=function(r,e,i){var o=Object(r);if(!Ed(r)){var s=Te(e);r=Ad(r),e=function(l){return s(o[l],l,o)}}return-1<(e=function(l,f,h){var d=l==null?0:l.length;if(!d)return-1;if(h==null)h=0;else{var p=(h=h?(h=gl(h))===gs||h===-1/0?17976931348623157e292*(0>h?-1:1):h==h?h:0:h===0?h:0)%1;h=h==h?p?h-p:h:0}return 0>h&&(h=dD(d+h,0)),Xp(l,Te(f),h)}(r,e,i))?o[s?r[e]:e]:void 0},iu=function(r,e){return r&&r.length?vk(r,void 0,typeof e=="function"?e:void 0):[]},hs=function(){function r(){W(this,r),m(this,"size",0),m(this,"fields",new Map)}return Ha(r,[{key:"define",value:function(e,i,o){if(this.size+=o,64<this.size)throw new RangeError("the struct over 64 bits is not supported");Mg(i={val:0,isNumber:i==="number",isBoolean:i==="boolean",oneof:i==="number"||i==="boolean"?void 0:i,len:o}),this.fields.set(e,i)}},{key:"set",value:function(e,i){if(!(e=this.fields.get(e)))throw Error("field not found");var o=e.oneof;if(!U.isLong(i)&&typeof i!="number")if(typeof i=="boolean")i=i?1:0;else{if(o===void 0)throw Error("invalid field type");if((i=o[i])===void 0)throw Error("field type not found")}Mg(e,i),e.val=i}},{key:"toNumber",value:function(){for(var e=0,i=0,o=0,s=Array.from(this.fields);o<s.length;o++){var l=ra(s[o],2)[1],f=l.len;(l=l.val)!==void 0&&(e+=U.fromValue(l).shiftLeft(i).toNumber(),i+=f)}return e}},{key:"toLong",value:function(){for(var e=U.fromNumber(0,!0),i=0,o=0,s=Array.from(this.fields);o<s.length;o++){var l=ra(s[o],2)[1],f=l.len;(l=l.val)!==void 0&&(e=U.fromValue(l).shiftLeft(i).add(e),i+=f)}return e}},{key:"assert",value:function(e,i){function o(f){if(!U.isLong(f)&&typeof f!="number")if(typeof f=="boolean")f=f?1:0;else{if(l===void 0)throw Error("invalid field type");if((f=l[f])===void 0)throw Error("field type not found")}return Mg(s,f),Lg(f,s.val)}var s=this.fields.get(e);if(!s)throw Error("field not found");var l=s.oneof;if(!Array.isArray(i))return o(i);if(i.length===1)return o(i[0]);if(i.every(function(f){return typeof f=="string"})&&l!==void 0)return i.some(function(f){return o(f)});throw Error("invalid valueTypes")}},{key:"from",value:function(e){e=U.fromValue(e);for(var i=0,o=0,s=Array.from(this.fields);o<s.length;o++){var l=ra(s[o],2)[1],f=l.len,h=U.fromNumber(Math.pow(2,f)-1,!0).shiftLeft(i);Mg(l,h=e.and(h).shiftRightUnsigned(i)),l.val=h,i+=f}}},{key:"typeOf",value:function(e){if((e=this.fields.get(e))!==void 0){var i=e.oneof;if(e=e.val,i!==void 0){var o=0;for(i=Object.entries(i);o<i.length;o++){var s=ra(i[o],2),l=s[0];if(Lg(e,s[1]))return l}}}throw new TypeError("can only get type of oneof type")}}]),r}(),is=function(r){function e(o){W(this,e);var s=i.call(this);return s.define("Rejoin","boolean",1),s.define("Unused","number",31),s.define("Platform","number",8),s.define("Version","number",12),s.define("Subversion","number",12),s.set("Platform",7),s.set("Version",4),s.set("Subversion",203),s.set("Rejoin",o),s}la(e,r);var i=ma(e);return e}(hs),eD=ua(ua(ua(ua({},{PeerTextMessage:0,ChannelTextMessage:1,VendorTextMessage:2}),{PeerRawMessage:3,ChannelRawMessage:4,VendorRawMessage:5}),{PeerImageMessage:6,ChannelImageMessage:7,VendorImageMessage:8}),{PeerFileMessage:15,ChannelFileMessage:16,VendorFileMessage:17}),js={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},fD=ua(ua({},eD),js),gD={Uncompressed:0,Zlib:1},ae=function(r){function e(o){W(this,e);var s=i.call(this);if(s.define("MessageType",fD,8),s.define("BroadcastJumps","number",2),s.define("ToCache","boolean",1),s.define("FromCache","boolean",1),s.define("CompressionMethod",gD,2),s.define("IterationNumber","number",4),s.define("BufferedMessage","boolean",1),s.define("ToArchive","boolean",1),s.define("FromArchive","boolean",1),typeof o=="number"||U.isLong(o))s.from(o);else if(o!==void 0){var l=0;for(o=Hg(o);l<o.length;l++){var f=ra(o[l],2);s.set(f[0],f[1])}}return s}la(e,r);var i=ma(e);return Ha(e,[{key:"isTextMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","ChannelTextMessage","VendorTextMessage"])}},{key:"isRawMessage",value:function(){return this.assert("MessageType",["ChannelRawMessage","PeerRawMessage","VendorRawMessage"])}},{key:"isRawPeerMessage",value:function(){return this.assert("MessageType","PeerRawMessage")}},{key:"isRawChannelMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")}},{key:"isPeerTextMessage",value:function(){return this.assert("MessageType","PeerTextMessage")}},{key:"isChannelTextMessage",value:function(){return this.assert("MessageType","ChannelTextMessage")}},{key:"isInvitation",value:function(o){var s=this;return o!==void 0?this.assert("MessageType",o):xf(js).some(function(l){return s.assert("MessageType",l)})}},{key:"isFileMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","ChannelFileMessage","VendorFileMessage"])}},{key:"isImageMessage",value:function(){return this.assert("MessageType",["PeerImageMessage","ChannelImageMessage","VendorImageMessage"])}},{key:"isPeerMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","PeerTextMessage","PeerImageMessage","PeerRawMessage"])}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),e}(hs),hD=function(r){function e(o){return W(this,e),m(n(o=i.call(this,o,"ChatManager")),"dialogueLru",new Sx(void 0,{maxlen:1e4,ttl:1e4})),o}la(e,r);var i=ma(e);return Ha(e,[{key:"getChatInfo",value:function(o){var s=this.dialogueLru.get(o);if(this.dialogueLru.prune(),s){var l=s.dialogue,f={dialogue:l,sequence:s=s.sequence.add(1)};return this.dialogueLru.set(o,{dialogue:l,sequence:s}),f}return l={dialogue:Bg(),sequence:U.fromNumber(1,!0)},this.dialogueLru.set(o,l),l}}]),e}(tb()),v={};X(module)=="object"&&(module.exports=v),v.parse=function(r,e){var i,o=v.bin.readUshort,s=v.bin.readUint,l={};for(i=(r=new Uint8Array(r)).length-4;s(r,i)!=101010256;)i--;var f=o(r,i=i+4+4);o(r,i+=2),s(r,i+=2),i=s(r,i+=4);for(var h=0;h<f;h++){s(r,i),i+=4,i+=4,i+=4,s(r,i+=4);var d=s(r,i+=4),p=s(r,i+=4),g=o(r,i+=4),_=o(r,i+2),b=o(r,i+4);i+=6;var x=s(r,i+=8);i+=4,i+=g+_+b,v._readLocal(r,x,l,d,p,e)}return l},v._readLocal=function(r,e,i,o,s,l){var f=v.bin.readUshort,h=v.bin.readUint;h(r,e),f(r,e+=4),f(r,e+=2);var d=f(r,e+=2);h(r,e+=2),h(r,e+=4),h=f(r,e=e+4+8);var p=f(r,e+=2);if(e+=2,f=v.bin.readUTF8(r,e,h),e=e+h+p,l)i[f]={size:s,csize:o};else if(r=new Uint8Array(r.buffer,e),d==0)i[f]=new Uint8Array(r.buffer.slice(e,e+o));else{if(d!=8)throw"unknown compression method: "+d;e=new Uint8Array(s),v.inflateRaw(r,e),i[f]=e}},v.inflateRaw=function(r,e){return v.F.inflate(r,e)},v.inflate=function(r,e){return r[0],r[1],v.inflateRaw(new Uint8Array(r.buffer,r.byteOffset+2,r.length-2),e)},v.deflate=function(r,e){e==null&&(e={level:6});var i=0,o=new Uint8Array(50+Math.floor(1.1*r.length));return o[i]=120,o[i+1]=156,i=v.F.deflateRaw(r,o,i+2,e.level),r=v.adler(r,0,r.length),o[i+0]=r>>>24&255,o[i+1]=r>>>16&255,o[i+2]=r>>>8&255,o[i+3]=r>>>0&255,new Uint8Array(o.buffer,0,i+4)},v.deflateRaw=function(r,e){e==null&&(e={level:6});var i=new Uint8Array(50+Math.floor(1.1*r.length)),o=v.F.deflateRaw(r,i,o,e.level);return new Uint8Array(i.buffer,0,o)},v.encode=function(r,e){e==null&&(e=!1);var i,o=0,s=v.bin.writeUint,l=v.bin.writeUshort,f={};for(i in r){var h=!v._noNeed(i)&&!e,d=r[i],p=v.crc.crc(d,0,d.length);f[i]={cpr:h,usize:d.length,crc:p,file:h?v.deflateRaw(d):d}}for(i in f)o+=f[i].file.length+30+46+2*v.bin.sizeUTF8(i);for(i in r=new Uint8Array(o+22),e=0,d=[],f)p=f[i],d.push(e),e=v._writeHeader(r,e,i,p,0);for(i in o=0,h=e,f)p=f[i],d.push(e),e=v._writeHeader(r,e,i,p,1,d[o++]);return f=e-h,s(r,e,101010256),l(r,e=e+4+4,o),l(r,e+=2,o),s(r,e+=2,f),s(r,e+4,h),r.buffer},v._noNeed=function(r){return r=r.split(".").pop().toLowerCase(),"png,jpg,jpeg,zip".indexOf(r)!=-1},v._writeHeader=function(r,e,i,o,s,l){var f=v.bin.writeUint,h=v.bin.writeUshort,d=o.file;return f(r,e,s==0?67324752:33639248),e+=4,s==1&&(e+=2),h(r,e,20),h(r,e+=2,0),h(r,e+=2,o.cpr?8:0),f(r,e+=2,0),f(r,e+=4,o.crc),f(r,e+=4,d.length),f(r,e+=4,o.usize),h(r,e+=4,v.bin.sizeUTF8(i)),h(r,e+=2,0),e+=2,s==1&&(f(r,e=e+2+2+6,l),e+=4),e+=i=v.bin.writeUTF8(r,e,i),s==0&&(r.set(d,e),e+=d.length),e},v.crc={table:function(){for(var r=new Uint32Array(256),e=0;256>e;e++){for(var i=e,o=0;8>o;o++)i=1&i?3988292384^i>>>1:i>>>1;r[e]=i}return r}(),update:function(r,e,i,o){for(var s=0;s<o;s++)r=v.crc.table[255&(r^e[i+s])]^r>>>8;return r},crc:function(r,e,i){return 4294967295^v.crc.update(4294967295,r,e,i)}},v.adler=function(r,e,i){var o=1,s=0,l=e;for(e+=i;l<e;){for(i=Math.min(l+5552,e);l<i;)s+=o+=r[l++];o%=65521,s%=65521}return s<<16|o},v.bin={readUshort:function(r,e){return r[e]|r[e+1]<<8},writeUshort:function(r,e,i){r[e]=255&i,r[e+1]=i>>8&255},readUint:function(r,e){return 16777216*r[e+3]+(r[e+2]<<16|r[e+1]<<8|r[e])},writeUint:function(r,e,i){r[e]=255&i,r[e+1]=i>>8&255,r[e+2]=i>>16&255,r[e+3]=i>>24&255},readASCII:function(r,e,i){for(var o="",s=0;s<i;s++)o+=String.fromCharCode(r[e+s]);return o},writeASCII:function(r,e,i){for(var o=0;o<i.length;o++)r[e+o]=i.charCodeAt(o)},pad:function(r){return 2>r.length?"0"+r:r},readUTF8:function(r,e,i){for(var o,s="",l=0;l<i;l++)s+="%"+v.bin.pad(r[e+l].toString(16));try{o=decodeURIComponent(s)}catch{return v.bin.readASCII(r,e,i)}return o},writeUTF8:function(r,e,i){for(var o=i.length,s=0,l=0;l<o;l++){var f=i.charCodeAt(l);if((4294967168&f)==0)r[e+s]=f,s++;else if((4294965248&f)==0)r[e+s]=192|f>>6,r[e+s+1]=128|f>>0&63,s+=2;else if((4294901760&f)==0)r[e+s]=224|f>>12,r[e+s+1]=128|f>>6&63,r[e+s+2]=128|f>>0&63,s+=3;else{if((4292870144&f)!=0)throw"e";r[e+s]=240|f>>18,r[e+s+1]=128|f>>12&63,r[e+s+2]=128|f>>6&63,r[e+s+3]=128|f>>0&63,s+=4}}return s},sizeUTF8:function(r){for(var e=r.length,i=0,o=0;o<e;o++){var s=r.charCodeAt(o);if((4294967168&s)==0)i++;else if((4294965248&s)==0)i+=2;else if((4294901760&s)==0)i+=3;else{if((4292870144&s)!=0)throw"e";i+=4}}return i}},v.F={},v.F.deflateRaw=function(r,e,i,o){var s=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],l=v.F.U,f=v.F._goodIndex;v.F._hash;var h=v.F._putsE,d=0;i<<=3;var p=0,g=r.length;if(o==0){for(;d<g;){var _=Math.min(65535,g-d);h(e,i,d+_==g?1:0),i=v.F._copyExact(r,d,_,e,i+8),d+=_}return i>>>3}h=l.lits,o=l.strt;var b=l.prev,x=0,A=0,k=0,C=0,j=0;for(2<g&&(o[j=v.F._hash(r,0)]=0),d=0;d<g;d++){if(_=j,d+1<g-2){j=v.F._hash(r,d+1);var P=d+1&32767;b[P]=o[j],o[j]=P}if(p<=d){if((14e3<x||26697<A)&&100<g-d&&(p<d&&(h[x]=d-p,x+=2,p=d),i=v.F._writeBlock(d==g-1||p==g?1:0,h,x,C,r,k,d-k,e,i),x=A=C=0,k=d),P=0,d<g-2&&(P=v.F._bestMatch(r,d,b,_,Math.min(s[2],g-d),s[3])),P!=0){_=P>>>16,P&=65535;var z=f(_,l.of0);l.lhst[257+z]++;var _e=f(P,l.df0);l.dhst[_e]++,C+=l.exb[z]+l.dxb[_e],h[x]=_<<23|d-p,h[x+1]=P<<16|z<<8|_e,x+=2,p=d+_}else l.lhst[r[d]]++;A++}}for(k==d&&r.length!=0||(p<d&&(h[x]=d-p,x+=2),i=v.F._writeBlock(1,h,x,C,r,k,d-k,e,i));(7&i)!=0;)i++;return i>>>3},v.F._bestMatch=function(r,e,i,o,s,l){var f=32767&e,h=i[f],d=f-h+32768&32767;if(h==f||o!=v.F._hash(r,e-d))return 0;for(var p=o=0,g=Math.min(32767,e);d<=g&&--l!=0&&h!=f;){if((o==0||r[e+o]==r[e+o-d])&&(f=v.F._howLong(r,e,d))>o){if(p=d,(o=f)>=s)break;d+2<f&&(f=d+2);for(var _=0,b=0;b<f-2;b++){var x=e-d+b+32768&32767,A=x-i[x]+32768&32767;A>_&&(_=A,h=x)}}d+=(f=h)-(h=i[f])+32768&32767}return o<<16|p},v.F._howLong=function(r,e,i){if(r[e]!=r[e-i]||r[e+1]!=r[e+1-i]||r[e+2]!=r[e+2-i])return 0;var o=e,s=Math.min(r.length,e+258);for(e+=3;e<s&&r[e]==r[e-i];)e++;return e-o},v.F._hash=function(r,e){return(r[e]<<8|r[e+1])+(r[e+2]<<4)&65535},v.saved=0,v.F._writeBlock=function(r,e,i,o,s,l,f,h,d){var p=v.F.U,g=v.F._putsF,_=v.F._putsE;p.lhst[256]++;var b=v.F.getTrees(),x=b[0],A=b[1],k=b[2],C=b[3],j=b[4],P=b[5],z=b[6];b=b[7];var _e=32+((d+3&7)==0?0:8-(d+3&7))+(f<<3),Di=o+v.F.contSize(p.fltree,p.lhst)+v.F.contSize(p.fdtree,p.dhst);o=o+v.F.contSize(p.ltree,p.lhst)+v.F.contSize(p.dtree,p.dhst),o+=14+3*P+v.F.contSize(p.itree,p.ihst)+(2*p.ihst[16]+3*p.ihst[17]+7*p.ihst[18]);for(var _i=0;286>_i;_i++)p.lhst[_i]=0;for(_i=0;30>_i;_i++)p.dhst[_i]=0;for(_i=0;19>_i;_i++)p.ihst[_i]=0;if(_e=_e<Di&&_e<o?0:Di<o?1:2,g(h,d,r),g(h,d+1,_e),d+=3,_e==0){for(;(7&d)!=0;)d++;d=v.F._copyExact(s,l,f,h,d)}else{if(_e==1)var Ei=p.fltree,ga=p.fdtree;if(_e==2){for(v.F.makeCodes(p.ltree,x),v.F.revCodes(p.ltree,x),v.F.makeCodes(p.dtree,A),v.F.revCodes(p.dtree,A),v.F.makeCodes(p.itree,k),v.F.revCodes(p.itree,k),Ei=p.ltree,ga=p.dtree,_(h,d,C-257),_(h,d+=5,j-1),_(h,d+=5,P-4),d+=4,r=0;r<P;r++)_(h,d+3*r,p.itree[1+(p.ordr[r]<<1)]);d=v.F._codeTiny(z,p.itree,h,d+3*P),d=v.F._codeTiny(b,p.itree,h,d)}for(P=0;P<i;P+=2){for(z=(r=e[P])>>>23,r=l+(8388607&r);l<r;)d=v.F._writeLit(s[l++],Ei,h,d);z!=0&&(r=(x=e[P+1])>>16,f=x>>8&255,x&=255,_(h,d=v.F._writeLit(257+f,Ei,h,d),z-p.of0[f]),d+=p.exb[f],g(h,d=v.F._writeLit(x,ga,h,d),r-p.df0[x]),d+=p.dxb[x],l+=z)}d=v.F._writeLit(256,Ei,h,d)}return d},v.F._copyExact=function(r,e,i,o,s){var l=s>>>3;return o[l]=i,o[l+1]=i>>>8,o[l+2]=255-o[l],o[l+3]=255-o[l+1],l+=4,o.set(new Uint8Array(r.buffer,e,i),l),s+(i+4<<3)},v.F.getTrees=function(){for(var r=v.F.U,e=v.F._hufTree(r.lhst,r.ltree,15),i=v.F._hufTree(r.dhst,r.dtree,15),o=[],s=v.F._lenCodes(r.ltree,o),l=[],f=v.F._lenCodes(r.dtree,l),h=0;h<o.length;h+=2)r.ihst[o[h]]++;for(h=0;h<l.length;h+=2)r.ihst[l[h]]++;h=v.F._hufTree(r.ihst,r.itree,7);for(var d=19;4<d&&r.itree[1+(r.ordr[d-1]<<1)]==0;)d--;return[e,i,h,s,f,d,o,l]},v.F.getSecond=function(r){for(var e=[],i=0;i<r.length;i+=2)e.push(r[i+1]);return e},v.F.nonZero=function(r){for(var e="",i=0;i<r.length;i+=2)r[i+1]!=0&&(e+=(i>>1)+",");return e},v.F.contSize=function(r,e){for(var i=0,o=0;o<e.length;o++)i+=e[o]*r[1+(o<<1)];return i},v.F._codeTiny=function(r,e,i,o){for(var s=0;s<r.length;s+=2){var l=r[s],f=r[s+1];o=v.F._writeLit(l,e,i,o);var h=l==16?2:l==17?3:7;15<l&&(v.F._putsE(i,o,f,h),o+=h)}return o},v.F._lenCodes=function(r,e){for(var i=r.length;i!=2&&r[i-1]==0;)i-=2;for(var o=0;o<i;o+=2){var s=r[o+1],l=o+3<i?r[o+3]:-1,f=o+5<i?r[o+5]:-1,h=o==0?-1:r[o-1];if(s==0&&l==s&&f==s){for(l=o+5;l+2<i&&r[l+2]==s;)l+=2;11>(s=Math.min(l+1-o>>>1,138))?e.push(17,s-3):e.push(18,s-11),o+=2*s-2}else if(s==h&&l==s&&f==s){for(l=o+5;l+2<i&&r[l+2]==s;)l+=2;s=Math.min(l+1-o>>>1,6),e.push(16,s-3),o+=2*s-2}else e.push(s,0)}return i>>>1},v.F._hufTree=function(r,e,i){var o=[],s=r.length,l=e.length,f=0;for(f=0;f<l;f+=2)e[f]=0,e[f+1]=0;for(f=0;f<s;f++)r[f]!=0&&o.push({lit:f,f:r[f]});if(r=o.length,s=o.slice(0),r==0)return 0;if(r==1)return e[1+((i=o[0].lit)<<1)]=1,e[1+((i==0?1:0)<<1)]=1;o.sort(function(g,_){return g.f-_.f}),f=o[0],l=o[1];var h=0,d=1,p=2;for(o[0]={lit:-1,f:f.f+l.f,l:f,r:l,d:0};d!=r-1;)f=h!=d&&(p==r||o[h].f<o[p].f)?o[h++]:o[p++],l=h!=d&&(p==r||o[h].f<o[p].f)?o[h++]:o[p++],o[d++]={lit:-1,f:f.f+l.f,l:f,r:l};for((o=v.F.setDepth(o[d-1],0))>i&&(v.F.restrictDepth(s,i,o),o=i),f=0;f<r;f++)e[1+(s[f].lit<<1)]=s[f].d;return o},v.F.setDepth=function(r,e){return r.lit!=-1?r.d=e:Math.max(v.F.setDepth(r.l,e+1),v.F.setDepth(r.r,e+1))},v.F.restrictDepth=function(r,e,i){var o=0,s=1<<i-e,l=0;for(r.sort(function(h,d){return d.d==h.d?h.f-d.f:d.d-h.d}),o=0;o<r.length&&r[o].d>e;o++){var f=r[o].d;r[o].d=e,l+=s-(1<<i-f)}for(l>>>=i-e;0<l;)(f=r[o].d)<e?(r[o].d++,l-=1<<e-f-1):o++;for(;0<=o;o--)r[o].d==e&&0>l&&(r[o].d--,l++);l!=0&&console.log("debt left")},v.F._goodIndex=function(r,e){var i=0;return e[16|i]<=r&&(i|=16),e[8|i]<=r&&(i|=8),e[4|i]<=r&&(i|=4),e[2|i]<=r&&(i|=2),e[1|i]<=r&&(i|=1),i},v.F._writeLit=function(r,e,i,o){return v.F._putsF(i,o,e[r<<1]),o+e[1+(r<<1)]},v.F.inflate=function(r,e){var i=Uint8Array;if(r[0]==3&&r[1]==0)return e||new i(0);var o=v.F,s=o._bitsF,l=o._bitsE,f=o._decodeTiny,h=o.makeCodes,d=o.codes2map,p=o._get17,g=o.U,_=e==null;_&&(e=new i(r.length>>>2<<3));for(var b,x,A,k,C=0,j=0,P=x=0,z=0;C==0;)if(C=s(r,z,1),b=s(r,z+1,2),z+=3,b==0)(7&z)!=0&&(z+=8-(7&z)),b=r[(z=4+(z>>>3))-4]|r[z-3]<<8,_&&(e=v.F._check(e,P+b)),e.set(new i(r.buffer,r.byteOffset+z,b),P),z=z+b<<3,P+=b;else{if(_&&(e=v.F._check(e,P+131072)),b==1&&(A=g.flmap,k=g.fdmap,j=511,x=31),b==2){for(x=l(r,z,5)+257,b=l(r,z+5,5)+1,A=l(r,z+10,4)+4,z+=14,k=0;38>k;k+=2)g.itree[k]=0,g.itree[k+1]=0;for(j=1,k=0;k<A;k++){var _e=l(r,z+3*k,3);g.itree[1+(g.ordr[k]<<1)]=_e,_e>j&&(j=_e)}z+=3*A,h(g.itree,j),d(g.itree,j,g.imap),A=g.lmap,k=g.dmap,z=f(g.imap,(1<<j)-1,x+b,r,z,g.ttree),j=(1<<(_e=o._copyOut(g.ttree,0,x,g.ltree)))-1,x=(1<<(b=o._copyOut(g.ttree,x,b,g.dtree)))-1,h(g.ltree,_e),d(g.ltree,_e,A),h(g.dtree,b),d(g.dtree,b,k)}for(;;)if(z+=15&(b=A[p(r,z)&j]),(_e=b>>>4)>>>8==0)e[P++]=_e;else{if(_e==256)break;b=P+_e-254,264<_e&&(b=P+((_e=g.ldef[_e-257])>>>3)+l(r,z,7&_e),z+=7&_e),z+=15&(_e=k[p(r,z)&x]);var Di=((_e=g.ddef[_e>>>4])>>>4)+s(r,z,15&_e);for(z+=15&_e,_&&(e=v.F._check(e,P+131072));P<b;)e[P]=e[P++-Di],e[P]=e[P++-Di],e[P]=e[P++-Di],e[P]=e[P++-Di];P=b}}return e.length==P?e:e.slice(0,P)},v.F._check=function(r,e){var i=r.length;return e<=i?r:((e=new Uint8Array(Math.max(i<<1,e))).set(r,0),e)},v.F._decodeTiny=function(r,e,i,o,s,l){for(var f=v.F._bitsE,h=v.F._get17,d=0;d<i;){var p=r[h(o,s)&e];s+=15&p;var g=p>>>4;if(15>=g)l[d]=g,d++;else{var _=p=0;for(g==16?(_=3+f(o,s,2),s+=2,p=l[d-1]):g==17?(_=3+f(o,s,3),s+=3):g==18&&(_=11+f(o,s,7),s+=7),g=d+_;d<g;)l[d]=p,d++}}return s},v.F._copyOut=function(r,e,i,o){for(var s=0,l=0,f=o.length>>>1;l<i;){var h=r[l+e];o[l<<1]=0,o[1+(l<<1)]=h,h>s&&(s=h),l++}for(;l<f;)o[l<<1]=0,o[1+(l<<1)]=0,l++;return s},v.F.makeCodes=function(r,e){var i,o,s=v.F.U,l=r.length,f=s.bl_count;for(i=0;i<=e;i++)f[i]=0;for(i=1;i<l;i+=2)f[r[i]]++;for(s=s.next_code,i=0,f[0]=0,o=1;o<=e;o++)i=i+f[o-1]<<1,s[o]=i;for(e=0;e<l;e+=2)(f=r[e+1])!=0&&(r[e]=s[f],s[f]++)},v.F.codes2map=function(r,e,i){for(var o=r.length,s=v.F.U.rev15,l=0;l<o;l+=2)if(r[l+1]!=0){var f=r[l+1],h=l>>1<<4|f,d=e-f;for(d=(f=r[l]<<d)+(1<<d);f!=d;)i[s[f]>>>15-e]=h,f++}},v.F.revCodes=function(r,e){for(var i=v.F.U.rev15,o=15-e,s=0;s<r.length;s+=2)r[s]=i[r[s]<<e-r[s+1]]>>>o},v.F._putsE=function(r,e,i){i<<=7&e,r[e>>>=3]|=i,r[e+1]|=i>>>8},v.F._putsF=function(r,e,i){i<<=7&e,r[e>>>=3]|=i,r[e+1]|=i>>>8,r[e+2]|=i>>>16},v.F._bitsE=function(r,e,i){return(r[e>>>3]|r[1+(e>>>3)]<<8)>>>(7&e)&(1<<i)-1},v.F._bitsF=function(r,e,i){return(r[e>>>3]|r[1+(e>>>3)]<<8|r[2+(e>>>3)]<<16)>>>(7&e)&(1<<i)-1},v.F._get17=function(r,e){return(r[e>>>3]|r[1+(e>>>3)]<<8|r[2+(e>>>3)]<<16)>>>(7&e)},v.F._get25=function(r,e){return(r[e>>>3]|r[1+(e>>>3)]<<8|r[2+(e>>>3)]<<16|r[3+(e>>>3)]<<24)>>>(7&e)},v.F.U=function(){var r=Uint16Array,e=Uint32Array;return{next_code:new r(16),bl_count:new r(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new r(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new e(32),flmap:new r(512),fltree:[],fdmap:new r(32),fdtree:[],lmap:new r(32768),ltree:[],ttree:[],dmap:new r(32768),dtree:[],imap:new r(512),itree:[],rev15:new r(32768),lhst:new e(286),dhst:new e(30),ihst:new e(19),lits:new e(15e3),strt:new r(65536),prev:new r(32768)}}(),function(){function r(s,l,f){for(;l--!=0;)s.push(0,f)}for(var e=v.F.U,i=0;32768>i;i++){var o=i;o=(4278255360&(o=(4042322160&(o=(3435973836&(o=(2863311530&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,e.rev15[i]=(o>>>16|o<<16)>>>17}for(i=0;32>i;i++)e.ldef[i]=e.of0[i]<<3|e.exb[i],e.ddef[i]=e.df0[i]<<4|e.dxb[i];r(e.fltree,144,8),r(e.fltree,112,9),r(e.fltree,24,7),r(e.fltree,8,8),v.F.makeCodes(e.fltree,9),v.F.codes2map(e.fltree,9,e.flmap),v.F.revCodes(e.fltree,9),r(e.fdtree,32,5),v.F.makeCodes(e.fdtree,5),v.F.codes2map(e.fdtree,5,e.fdmap),v.F.revCodes(e.fdtree,5),r(e.itree,19,0),r(e.ltree,286,0),r(e.dtree,30,0),r(e.ttree,320,0)}();var iD=["backups","servers"],jD=["backups","servers"],kD=["group"],nl=v.inflate,ks=v.deflate,ls=function(r){function e(o,s,l,f){W(this,e);var h=i.call(this,f,"Session");return m(n(h),"chatManager",void 0),m(n(h),"joinedChannels",new Set),m(n(h),"msgDedupLru",new tc(void 0,{maxlen:200})),m(n(h),"startTime",Date.now()),m(n(h),"seq",U.fromNumber(1,!0)),m(n(h),"userJoinOptions",new is(!1)),m(n(h),"seqSentStatuses",[!1,!1]),m(n(h),"dialogueSequenceLru",new tc(void 0,{maxlen:1e4})),m(n(h),"loggedOut",!1),m(n(h),"messageSentTimes",[]),m(n(h),"curLoginSockets",[void 0,void 0]),m(n(h),"loginSocketSubs",[{channels:new Map,receivers:[]},{channels:new Map,receivers:[]}]),m(n(h),"lastLoginSockets",[new qe(1),new qe(1)]),m(n(h),"dialPendingMsgSubjectMap",new Map),m(n(h),"context",void 0),m(n(h),"connection",void 0),m(n(h),"instanceId",void 0),m(n(h),"registerSocketsFailureListener",function(){h.connection.once("socketsFailure",function(){h.log("socketsFailure, creating a new connection"),ad(function(){return h.connection.removeAllListeners(),h.connection=new Yr(h.context,h.logger,!0),h.loginHandler(15e3,!0)}).pipe(oe(function(d){return d.pipe(cd(Zd.getParameter("RECONNECTING_AP_INTERVAL")))}),ob(h.connection.apClient.apFinish$)).subscribe(function(){h.log("new connection connected")})}),h.connection.listenerCount("tokenExpired")===0&&h.connection.on("tokenExpired",function(){h.emit("tokenExpired")})}),h.context=o,h.connection=s,h.instanceId=l,h.chatManager=new hD(f),h.log("The instanceId is %s",h.instanceId.toString()),h}la(e,r);var i=ma(e);return Ha(e,[{key:"fetchFileUploadIndexGet",value:function(o){var s=o.hash,l=o.size;if((o=this.getLoginSockets()).length===0)throw new K("Client is not logged in");var f=this.incGetSeq();return o.forEach(function(h){h.sendPacket("FileUploadIndexGet",{seq:f,hash:s,size:l})}),{ret:Ca.apply(void 0,G(o.map(function(h){return h.fromReceived("FileUploadIndexRet").pipe(aa(function(d){return f.eq(d.seq)}))}))),fin:Ca.apply(void 0,G(o.map(function(h){return h.fromReceived("FileUploadIndexFin").pipe(aa(function(d){return f.eq(d.seq)}))}))),err:Xb.apply(void 0,G(o.map(function(h){return h.fromReceived("FileUploadIndexErr").pipe(aa(function(d){return f.eq(d.seq)}),ba(function(d){throw new da(["The media message upload failure, code %d",d.code],lg)}))}))),timeout:e.genTimeoutError(Lh)}}},{key:"requestFileUploadIndexSet",value:function(o){var s=o.hash,l=o.unit,f=o.servers;if((o=this.getLoginSockets()).length===0)throw new K("Client is not logged in");var h=this.incGetSeq();return o.forEach(function(d){d.sendPacket("FileUploadIndexSet",{seq:h,servers:f,hash:s,unit:l})}),Ca.apply(void 0,[e.genTimeoutError(Lh)].concat(G(o.map(function(d){return d.fromReceived("FileUploadIndexErr").pipe(aa(function(p){return h.eq(p.seq)}),ba(function(p){throw new da(["FileUploadIndexSet failure, code %d",p.code],lg)}))})),G(o.map(function(d){return d.fromReceived("FileUploadIndexFin").pipe(aa(function(p){return h.eq(p.seq)}))}))))}},{key:"requestFileDownloadIndexGet",value:function(o){var s=o.size,l=o.zone,f=o.unit,h=o.hash,d=this.getLoginSockets();if(d.length===0)throw new K("Client is not logged in");var p=this.incGetSeq();return d.forEach(function(g){g.sendPacket("FileDownloadIndexGet",{seq:p,size:s,zone:l,unit:f,hash:h})}),o=Ca.apply(void 0,G(d.map(function(g){return g.fromReceived("FileDownloadIndexRet").pipe(aa(function(_){return p.eq(_.seq)}))}))).pipe(ba(function(g){var _=g.backups,b=g.servers;return g=ff(g,iD),ua({backupList:_.map(function(x){return[x]}),serverList:b.map(function(x){return[x]})},g)}),cd(500)),d=jm(d.map(function(g){return g.fromReceived("FileDownloadIndexRet").pipe(aa(function(_){return p.eq(_.seq)}))})),Ca(o,d.pipe(ba(function(g){return g.reduce(function(_,b){var x=_.backupList,A=_.serverList;_=b.backups;var k=b.servers;return b=ff(b,jD),ua({backupList:_.map(function(C,j){return[C].concat(G(x!==void 0&&Array.isArray(x[j])?x[j]:[]))}),serverList:k.map(function(C,j){return[C].concat(G(x!==void 0&&Array.isArray(A[j])?A[j]:[]))})},b)},{})})),e.genTimeoutError(Lh))}},{key:"loginHandler",value:function(){var o=this,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:2e4,l=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(this.loggedOut&&l)throw new K("Already logged out, request ignored");l&&this.registerSocketsFailureListener(),this.connection.initConnection();var f=this.getSocketLoginObservables(this.connection.lastOpenSockets,this.seq),h=Date.now();return f.forEach(function(d,p){var g=o.loginSocketSubs[p].login;g!==void 0&&g.unsubscribe(),o.loginSocketSubs[p].login=d.pipe(ca(function(_){var b;o.curLoginSockets[p]=_;var x=Date.now();eb("Link",{ackedServerIp:_.address,destServerIp:_.ip,ec:0,sc:0,elapse:fb(o.startTime),lts:U.fromNumber(x),responseTime:h-x,sid:Xa(o.instanceId),userId:o.context.uid},(b=o.context.config.enableCloudProxy)!==null&&b!==void 0&&b),o.emit("userJoined",_.env),l&&o.connection.apClient.apFinish$.next(void 0)})).subscribe(o.lastLoginSockets[p])}),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),Xb.apply(void 0,G(f).concat([gb(this.connection,"connectionInitFailure").pipe(ca(function(d){throw sa(d)||Sa(d)?d:new da("Login failure",{code:Zq,originalError:d})}))])).pipe(Ka(1),hb(s),Ga(function(d){return d instanceof pb&&o.warn("Client login timeout"),d&&d.code===Kh&&(o.connection.emit("tokenExpired"),o.connection.apClient.apFinish$.next(void 0)),o.clearSockets(0,l),Z(d)}),ca(function(){l||o.registerSocketsFailureListener()}),wg(function(){l||o.connection.apClient.apFinish$.next(void 0)}))}},{key:"logoutHandler",value:function(){var o=J(w.mark(function s(){var l,f,h,d=this;return w.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.loggedOut=!0,this.connection.apClient.apFinish$.next(void 0),l=this.getLoginSockets(),f=l.map(function(g){return g.sendPacket("UserQuit",{}),d.connection.waitClosing(g)}),this.clearSockets(5e3),h=l.map(function(g){return g.env}),[0,1].filter(function(g){return!h.includes(g)}).forEach(function(g){d.connection.closeSocket(g,0)}),p.abrupt("return",Xb.apply(void 0,G(f)).toPromise());case 9:case"end":return p.stop()}},s,this)}));return function(){return o.apply(this,arguments)}}()},{key:"requestChannelJoin",value:function(){var o=J(w.mark(function s(l,f){var h,d,p,g=this;return w.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(this.getLoginSockets().length!==0){_.next=2;break}throw new K("Client is not logged in. Cannot join the channel",Vq);case 2:return h=gb(this,"channelLeft").pipe(wb(function(b){return b===l}),Ka(1)),d=this.incGetSeq(),(p=this.lastLoginSockets.map(function(b){return b.pipe(Cc(function(x,A){A!==0&&g.incSeqIfNeeded(x.env);var k=A===0?d:g.seq;return x.sendPacket("GroupEnter",{account:f,seq:k}),x.fromReceived("GroupReply").pipe(aa(function(C){return k.eq(C.seq)}),ca(function(C){if((C=C.code)!==0)throw new da(["Channel join failure. The response code is %d",C],Rq)}))}),ob(h),pe())})).forEach(function(b,x){var A=function(){return g.loginSocketSubs[x].channels.delete(l.channelId)};g.loginSocketSubs[x].channels.set(l.channelId,b.subscribe({error:A,complete:A}))}),_.next=8,Xb.apply(void 0,G(p)).pipe(Ka(1),hb(1e4),Ga(function(b){return b instanceof pb&&g.warn("Channel join timeout"),Z(b)})).toPromise();case 8:this.joinedChannels.add(l);case 9:case"end":return _.stop()}},s,this)}));return function(s,l){return o.apply(this,arguments)}}()},{key:"requestChannelLeave",value:function(o,s){this.emit("channelLeft",o),this.joinedChannels.delete(o),this.getLoginSockets().forEach(function(l){l.sendPacket("GroupLeave",{account:s})})}},{key:"requestChannelMemberList",value:function(o){var s=this.getLoginSockets();if(s.length===0)throw new K("Client is not logged in. Cannot get the channel members",cA);var l=this.incGetSeq();return s.forEach(function(f){f.sendPacket("GroupAllUsersList",{group:o,pageNumber:0,pageSize:200,seq:l})}),Ca.apply(void 0,[e.genTimeoutError(Pq)].concat(G(s.map(function(f){return f.fromReceived("GroupAllUsersResult").pipe(aa(function(h){var d=h.seq;return h.group===o&&l.eq(d)}))}))))}},{key:"requestPeersOnlineStatus",value:function(o){var s=this.getLoginSockets();if(s.length===0)throw new K("Client is not logged in");var l=this.incGetSeq();return s.forEach(function(f){f.sendPacket("UserStatusList",{users:o,seq:l})}),Ca.apply(void 0,[e.genTimeoutError(oA)].concat(G(s.map(function(f){return f.fromReceived("UserStatusResult").pipe(aa(function(h){return l.eq(h.seq)}))}))))}},{key:"requestSetLocalUserAttributes",value:function(o,s){var l=this,f=this.getLoginSockets();if(f.length===0)throw new K("Client is not logged in");var h=this.incGetSeq();return f.forEach(function(d,p){s!==void 0&&p!==s||d.sendPacket("UserAttributeSet",{account:l.context.uid,attributeInfos:Object.entries(o).map(function(g){return{key:(g=ra(g,2))[0],value:g[1]}}),seq:h})}),Ca.apply(void 0,G(f.map(function(d){return d.fromReceived("UserAttributeErr").pipe(aa(function(p){return h.eq(p.seq)}),ba(function(p){throw new da(["The user attributes set failure, code %d",p.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(f.map(function(d){return d.fromReceived("UserAttributeRsp").pipe(aa(function(p){return h.eq(p.seq)}))}))))}},{key:"requestSetChannelAttributes",value:function(o,s,l){var f=this.getLoginSockets();if(f.length===0)throw new K("Client is not logged in");var h=this.incGetSeq();return f.forEach(function(d){d.sendPacket("GroupAttributeSet",{broadcast:l,group:o,attributeInfos:Object.entries(s).map(function(p){return{key:(p=ra(p,2))[0],value:p[1]}}),seq:h})}),Ca.apply(void 0,G(f.map(function(d){return d.fromReceived("GroupAttributeErr").pipe(aa(function(p){return h.eq(p.seq)}),ba(function(p){throw new da(["The group attributes set failure, code %d",p.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(f.map(function(d){return d.fromReceived("GroupAttributeRsp").pipe(aa(function(p){return h.eq(p.seq)}))}))))}},{key:"requestAddOrUpdateLocalUserAttributes",value:function(o){var s=this,l=this.getLoginSockets();if(l.length===0)throw new K("Client is not logged in");var f=this.incGetSeq();return l.forEach(function(h){h.sendPacket("UserAttributeMod",{account:s.context.uid,attributeInfos:Object.entries(o).map(function(d){return{key:(d=ra(d,2))[0],value:d[1]}}),seq:f})}),Ca.apply(void 0,G(l.map(function(h){return h.fromReceived("UserAttributeErr").pipe(aa(function(d){return f.eq(d.seq)}),ba(function(d){throw new da(["The user attributes add or update failure, code %d",d.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(l.map(function(h){return h.fromReceived("UserAttributeRsp").pipe(aa(function(d){return f.eq(d.seq)}))}))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(o,s,l){var f=this.getLoginSockets();if(f.length===0)throw new K("Client is not logged in");var h=this.incGetSeq();return f.forEach(function(d){d.sendPacket("GroupAttributeMod",{broadcast:l,group:o,attributeInfos:Object.entries(s).map(function(p){return{key:(p=ra(p,2))[0],value:p[1]}}),seq:h})}),Ca.apply(void 0,G(f.map(function(d){return d.fromReceived("GroupAttributeErr").pipe(aa(function(p){return h.eq(p.seq)}),ba(function(p){throw new da(["The group attributes add or update failure, code %d",p.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(f.map(function(d){return d.fromReceived("GroupAttributeRsp").pipe(aa(function(p){return h.eq(p.seq)}))}))))}},{key:"requestDeleteLocalUserAttributesByKeys",value:function(o){var s=this,l=this.getLoginSockets();if(l.length===0)throw new K("Client is not logged in");var f=this.incGetSeq();return l.forEach(function(h){h.sendPacket("UserAttributeDel",{account:s.context.uid,attributes:o,seq:f})}),Ca.apply(void 0,G(l.map(function(h){return h.fromReceived("UserAttributeErr").pipe(aa(function(d){return f.eq(d.seq)}),ba(function(d){throw new da(["The user attributes delete failure, code %d",d.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(l.map(function(h){return h.fromReceived("UserAttributeRsp").pipe(aa(function(d){return f.eq(d.seq)}))}))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(o,s,l){var f=this.getLoginSockets();if(f.length===0)throw new K("Client is not logged in");var h=this.incGetSeq();return f.forEach(function(d){d.sendPacket("GroupAttributeDel",{group:o,broadcast:l,attributes:s,seq:h})}),Ca.apply(void 0,G(f.map(function(d){return d.fromReceived("GroupAttributeErr").pipe(aa(function(p){return h.eq(p.seq)}),ba(function(p){throw new da(["The channel attributes delete failure, code %d",p.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(f.map(function(d){return d.fromReceived("GroupAttributeRsp").pipe(aa(function(p){return h.eq(p.seq)}))}))))}},{key:"requestClearLocalUserAttributes",value:function(){var o=this,s=this.getLoginSockets();if(s.length===0)throw new K("Client is not logged in");var l=this.incGetSeq();return s.forEach(function(f){f.sendPacket("UserAttributeSet",{account:o.context.uid,seq:l,attributeInfos:[]})}),Ca.apply(void 0,G(s.map(function(f){return f.fromReceived("UserAttributeErr").pipe(aa(function(h){return l.eq(h.seq)}),ba(function(h){throw new da(["The user attributes clear failure, code %d",h.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(s.map(function(f){return f.fromReceived("UserAttributeRsp").pipe(aa(function(h){return l.eq(h.seq)}))}))))}},{key:"requestClearChannelAttributes",value:function(o,s){var l=this.getLoginSockets();if(l.length===0)throw new K("Client is not logged in");var f=this.incGetSeq();return l.forEach(function(h){h.sendPacket("GroupAttributeSet",{group:o,seq:f,attributeInfos:[],broadcast:s})}),Ca.apply(void 0,G(l.map(function(h){return h.fromReceived("GroupAttributeErr").pipe(aa(function(d){return f.eq(d.seq)}),ba(function(d){throw new da(["The channel attributes clear failure, code %d",d.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(l.map(function(h){return h.fromReceived("GroupAttributeRsp").pipe(aa(function(d){return f.eq(d.seq)}))}))))}},{key:"requestGetUserAttributesByKeys",value:function(o,s){var l=this.getLoginSockets();if(l.length===0)throw new K("Client is not logged in");var f=this.incGetSeq();return l.forEach(function(h){h.sendPacket("UserAttributeGet",{account:o,seq:f,attributes:s})}),Ca.apply(void 0,[e.genTimeoutError(Tb)].concat(G(l.map(function(h){return h.fromReceived("UserAttributeErr").pipe(aa(function(d){return f.eq(d.seq)}),ba(function(d){throw(d=d.code)===10008?new da("The user requested is not online",Lq):new Wc(["User attribute operation unknown error code: %d",d],Sb)}))})),G(l.map(function(h){return h.fromReceived("UserAttributeRet").pipe(aa(function(d){return f.eq(d.seq)}))}))))}},{key:"requestGetChannelAttributesByKeys",value:function(o,s){var l=this.getLoginSockets();if(l.length===0)throw new K("Client is not logged in");var f=this.incGetSeq();return l.forEach(function(h){h.sendPacket("GroupAttributeGet",{group:o,seq:f,attributes:s})}),Ca.apply(void 0,[e.genTimeoutError(Tb)].concat(G(l.map(function(h){return h.fromReceived("GroupAttributeErr").pipe(aa(function(d){return f.eq(d.seq)}),ba(function(d){throw new da(["The channel attributes get failure, code %d",d.code],Sb)}))})),G(l.map(function(h){return h.fromReceived("GroupAttributeRet").pipe(aa(function(d){return f.eq(d.seq)}))}))))}},{key:"requestGetUserAttributeKeys",value:function(o){var s=this.getLoginSockets();if(s.length===0)throw new K("Client is not logged in");var l=this.incGetSeq();return s.forEach(function(f){f.sendPacket("UserAttributeKeysGet",{account:o,seq:l})}),Ca.apply(void 0,[e.genTimeoutError(Tb)].concat(G(s.map(function(f){return f.fromReceived("UserAttributeErr").pipe(aa(function(h){return l.eq(h.seq)}),ba(function(h){throw(h=h.code)===10008?new da("The user requested is not online",Lq):new Wc(["User attribute operation unknown error code: %d",h],Sb)}))})),G(s.map(function(f){return f.fromReceived("UserAttributeKeysRet").pipe(aa(function(h){return l.eq(h.seq)}))}))))}},{key:"requestGetChannelAttributesKeys",value:function(o){var s=this.getLoginSockets();if(s.length===0)throw new K("Client is not logged in");var l=this.incGetSeq();return s.forEach(function(f){f.sendPacket("GroupAttributeKeysGet",{group:o,seq:l})}),Ca.apply(void 0,[e.genTimeoutError(Tb)].concat(G(s.map(function(f){return f.fromReceived("GroupAttributeErr").pipe(aa(function(h){return l.eq(h.seq)}),ba(function(h){throw new Wc(["Channel attribute operation unknown error code: %d",h.code],Sb)}))})),G(s.map(function(f){return f.fromReceived("GroupAttributeKeysRet").pipe(aa(function(h){return l.eq(h.seq)}))}))))}},{key:"requestGetChannelMemberCount",value:function(o){var s=this.getLoginSockets();if(s.length===0)throw new K("Client is not logged in");var l=this.incGetSeq();return s.forEach(function(f){f.sendPacket("GroupStatusList",{groups:o,seq:l})}),Ca.apply(void 0,[e.genTimeoutError(Pq)].concat(G(s.map(function(f){return f.fromReceived("GroupStatusResult").pipe(aa(function(h){return l.eq(h.seq)}))}))))}},{key:"requestSubscribePeersOnlineStatus",value:function(o){var s=this.getLoginSockets();if(s.length===0)throw new K("Client is not logged in");var l=this.incGetSeq();return s.forEach(function(f){f.sendPacket("SubscribeUserStatus",{seq:l,users:o})}),Ca.apply(void 0,[e.genTimeoutError(vA)].concat(G(s.map(function(f){return f.fromReceived("SubscribeResponse").pipe(aa(function(h){return l.eq(h.seq)}))}))))}},{key:"requestUnsubscribePeersOnlineStatus",value:function(o){var s=this.getLoginSockets();if(s.length===0)throw new K("Client is not logged in");var l=this.incGetSeq();s.forEach(function(f){f.sendPacket("UnsubscribeUserStatus",{seq:l,users:o})})}},{key:"sendInvitationMessage",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g,_,b,x,A,k,C,j,P=this;return w.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(f=l.peerId,h=l.callId,d=l.extra,p=l.isAcceptAck,g=l.channelId,_=l.type,b={callId:h},p===void 0){z.next=6;break}if(_==="CallAccept"){z.next=5;break}throw Error("invalid invitation type");case 5:b.type=p?"ack":"request";case 6:return b.channel=g,(_==="CallInvite"||_==="CallCancel"||_==="CallReject"||_==="CallAccept"&&p===!1)&&d!==void 0&&(b.extra=d),x=Bg(),this.log("The sent invitation body is %o",b),A=function(_e){return{MiscMap:{},sequence:U.fromNumber(1),dialogue:x,instance:P.instanceId,dst:f,ms:U.fromNumber(Date.now(),!0),options:new ae({IterationNumber:_e,MessageType:_}).toLong(),payload:new TextEncoder().encode(JSON.stringify(b)),src:P.context.uid}},z.next=14,Kb(this.sendMessageToRetry(A,!0)).pipe(hb(1e4),Ga(function(_e){return _e instanceof pb&&P.warn("Send invitation timeout"),Z(_e)})).toPromise();case 14:return k=z.sent,C=k.code,j=k.retryTimes,z.abrupt("return",{hasPeerReceived:C===0,hasReSent:j!==0});case 18:case"end":return z.stop()}},s,this)}));return function(s){return o.apply(this,arguments)}}()},{key:"sendMediaMessage",value:function(){var o=J(w.mark(function s(l,f,h,d,p,g){var _,b,x,A,k,C,j,P,z,_e,Di,_i,Ei,ga,_c,$,Wt,_t,Vt,B,H,ue,_r,zt,Fi,_n,Js,Gi,_u,vf=this;return w.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(b=f.width,x=b===void 0?0:b,A=f.height,k=A===void 0?0:A,C=f.fileName,j=C===void 0?"":C,P=f.description,z=P===void 0?"":P,_e=f.thumbnail,Di=_e===void 0?new Blob:_e,_i=f.thumbnailHeight,Ei=_i===void 0?0:_i,ga=f.thumbnailWidth,_c=ga===void 0?0:ga,$=f.size,Wt=$===void 0?0:$,_t=f.mediaId,Vt=p.enableOfflineMessaging,B=p.enableHistoricalMessaging,za(h)){_l.next=4;break}throw new I("The send message arguments are not valid",d?$k:hg);case 4:if(!(32768<new Blob([j,Di,z]).size)){_l.next=6;break}throw new I("The size of message overflowed ",d?ve:Hh);case 6:return H=this.chatManager.getChatInfo(h),ue=H.dialogue,_r=H.sequence,zt=this.instanceId,this.log('A%s media message is sending to %s: "'.concat(zt,"-").concat(ue,"#").concat(_r,'"'),d?" peer":" channel",oa(h)),m(_={},"media_description",z),m(_,"media_width",x),m(_,"media_height",k),m(_,"media_thumbnailwidth",_c),m(_,"media_thumbnailheight",Ei),m(_,"media_size",Wt),m(_,"media_id",_t),m(_,"media_filename",j),Fi=uc(_,function(_d){return new TextEncoder().encode(_d.toString())}),_l.t0=Uint8Array,_l.next=14,Ji(Di);case 14:return _l.t1=_l.sent,Fi.media_thumbnail=new _l.t0(_l.t1),_n=d&&l==="IMAGE"?"PeerImageMessage":d&&l==="FILE"?"PeerFileMessage":d||l!=="IMAGE"?"ChannelFileMessage":"ChannelImageMessage",Js=function(_d){return{MiscMap:Fi,sequence:_r,dialogue:ue,instance:zt,dst:h,ms:U.fromNumber(Date.now(),!0),options:new ae({IterationNumber:_d,CompressionMethod:"Uncompressed",MessageType:_n,ToCache:Vt,ToArchive:B}).toLong(),payload:new Uint8Array,src:vf.context.uid}},_l.next=20,Kb(this.sendMessageToRetry(Js,!0)).pipe(hb(g===void 0?1e4:g),Ga(function(_d){return _d instanceof pb&&vf.warn("Send message timeout"),Z(_d)})).toPromise();case 20:if(Gi=_l.sent,(_u=Gi.code)!==2){_l.next=24;break}throw new da("The peer does not support this type of message",nA);case 24:return _l.abrupt("return",{hasPeerReceived:_u===0});case 25:case"end":return _l.stop()}},s,this)}));return function(s,l,f,h,d,p){return o.apply(this,arguments)}}()},{key:"sendRawMessage",value:function(){var o=J(w.mark(function s(l,f,h,d,p,g){var _,b,x,A,k,C,j,P,z,_e,Di=this;return w.wrap(function(_i){for(;;)switch(_i.prev=_i.next){case 0:if(_=p.enableOfflineMessaging,b=p.enableHistoricalMessaging,za(h)&&l instanceof Uint8Array&&typeof f=="string"){_i.next=3;break}throw new I("The send message arguments are not valid",d?$k:hg);case 3:if(!(32768<l.byteLength+new Blob([f]).size)){_i.next=5;break}throw new ib("The message size is over the 32KB limit",d?ve:Hh);case 5:return x=!Zd.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=l.byteLength,A=this.chatManager.getChatInfo(h),k=A.dialogue,C=A.sequence,j=this.instanceId,this.log('A%s %s raw message is sending to %s: "'.concat(j,"-").concat(k,"#").concat(C,'"'),x?" compressed":"",d?"peer":"channel",oa(h)),P=function(Ei){return{MiscMap:{description:new TextEncoder().encode(f)},sequence:C,dialogue:k,instance:j,dst:h,ms:U.fromNumber(Date.now(),!0),options:new ae({IterationNumber:Ei,CompressionMethod:x?"Zlib":"Uncompressed",MessageType:d?"PeerRawMessage":"ChannelRawMessage",ToCache:_,ToArchive:b}).toLong(),payload:x?ks(l):l,src:Di.context.uid}},_i.next=12,Kb(this.sendMessageToRetry(P,!0)).pipe(hb(g===void 0?1e4:g),Ga(function(Ei){return Ei instanceof pb&&Di.warn("Send message timeout"),Z(Ei)})).toPromise();case 12:return z=_i.sent,_e=z.code,_i.abrupt("return",{hasPeerReceived:_e===0});case 15:case"end":return _i.stop()}},s,this)}));return function(s,l,f,h,d,p){return o.apply(this,arguments)}}()},{key:"sendTextMessage",value:function(){var o=J(w.mark(function s(l,f,h,d,p){var g,_,b,x,A,k,C,j,P,z,_e,Di=this;return w.wrap(function(_i){for(;;)switch(_i.prev=_i.next){case 0:if(g=d.enableOfflineMessaging,_=d.enableHistoricalMessaging,za(f)){_i.next=3;break}throw new I("The send message arguments are not valid",h?$k:hg);case 3:if(!(32768<new Blob([l]).size)){_i.next=5;break}throw new ib("The message size is over the 32KB limit",h?ve:Hh);case 5:return b=!Zd.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=new Blob([l]).size,x=this.chatManager.getChatInfo(f),A=x.dialogue,k=x.sequence,C=this.instanceId,this.log('A%s %s message is sending to %s: "'.concat(C,"-").concat(A,"#").concat(k,'"'),b?" compressed":"",h?"peer":"channel",oa(f)),j=new TextEncoder().encode(l),P=function(Ei){return{MiscMap:{},sequence:k,dialogue:A,instance:C,dst:f,ms:U.fromNumber(Date.now(),!0),options:new ae({IterationNumber:Ei,CompressionMethod:b?"Zlib":"Uncompressed",MessageType:h?"PeerTextMessage":"ChannelTextMessage",ToCache:g,ToArchive:_}).toLong(),payload:b?ks(j):j,src:Di.context.uid}},_i.next=13,Kb(this.sendMessageToRetry(P,!0)).pipe(hb(p===void 0?1e4:p),Ga(function(Ei){return Ei instanceof pb&&Di.warn("Send message timeout"),Z(Ei)})).toPromise();case 13:return z=_i.sent,_e=z.code,_i.abrupt("return",{hasPeerReceived:_e===0});case 16:case"end":return _i.stop()}},s,this)}));return function(s,l,f,h,d){return o.apply(this,arguments)}}()},{key:"cleanLoginSubs",value:function(o,s){Object.entries(this.loginSocketSubs[o]).forEach(function(l){var f=(l=ra(l,2))[1];l[0]==="channels"&&s||(Array.isArray(f)||f instanceof Map?f.forEach(function(h){return h.unsubscribe()}):f&&f.unsubscribe())}),this.loginSocketSubs[o]={channels:s?this.loginSocketSubs[o].channels:new Map,receivers:[]}}},{key:"sendMessageToRetry",value:function(){var o=J(w.mark(function s(l,f){var h,d,p,g,_,b,x,A,k,C=this,j=arguments;return w.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(h=2<j.length&&j[2]!==void 0?j[2]:0,this.log("Attempt to send the message ".concat(f?" with retrying, %o":"without retrying"),{retryTimes:h}),(d=this.getLoginSockets()).length!==0){P.next=5;break}throw Error("no logged-in sockets");case 5:return p=l(h),d.forEach(function(z){z.sendPacket("Message",p)}),g=p.dialogue,_=p.sequence,b=p.instance,x=d.map(function(z){return z.fromReceived("Ack").pipe(wb(function(_e){return g.eq(_e.dialogue)&&_.eq(_e.sequence)&&b.eq(_e.instance)}))}),P.prev=9,P.next=12,Xb.apply(void 0,G(x)).pipe(hb(6e3),Ga(function(z){return Sa(z)&&C.warn("Message send timeout, retry times %d",h),Z(z)}),Ka(1)).toPromise();case 12:return A=P.sent,k=A.code,this.log("The message has been acked, %o",{code:k}),P.abrupt("return",{code:k,retryTimes:h});case 18:if(P.prev=18,P.t0=P.catch(9),!(P.t0 instanceof pb&&f)){P.next=22;break}return P.abrupt("return",this.sendMessageToRetry(l,!1,h+1));case 22:throw P.t0;case 23:case"end":return P.stop()}},s,this,[[9,18]])}));return function(s,l){return o.apply(this,arguments)}}()},{key:"initKeepAliveSender",value:function(){var o=this;this.lastLoginSockets.map(function(s){return s.pipe(Cc(function(l){return Bc(0,2750).pipe(ca(function(){o.incSeqIfNeeded(l.env),l.sendPacket("Ping",{ms:U.fromNumber(Date.now(),!0),seq:o.seq})}))}))}).forEach(function(s,l){var f=o.loginSocketSubs[l].keepAlive;f!==void 0&&f.unsubscribe(),o.loginSocketSubs[l].keepAlive=s.subscribe({error:function(){}})})}},{key:"initKeepAliveReconnector",value:function(){var o=this;this.lastLoginSockets.map(function(s){return s.pipe(Cc(function(l){var f,h=!1,d=l.userJoin$.pipe(ca(function(){h=!0})),p=l.input$.pipe(ca(function(g){Li[g.uri].slice(0,-3)!=="Ping"&&(h=!1)}));return Xb(Bc(15e3,1e4).pipe(Pt(l.receivedPacket),ca(function(g){g=ra(g,2),g=ra(g[1],2)[1],f!==g||h||l.forceReconnect(),f=g})),d,p)}))}).forEach(function(s,l){var f=o.loginSocketSubs[l].keepAliveReconnector;f!==void 0&&f.unsubscribe(),o.loginSocketSubs[l].keepAliveReconnector=s.subscribe({error:function(){}})})}},{key:"initLoginReceiver",value:function(){var o=this;this.lastLoginSockets.map(function(s){return s.pipe(Cc(function(l){return Xb(gb(l,"reconnect").pipe(ca(o.onSocketReconnect(l))),l.fromReceived("Message").pipe(ca(o.onMessage(l))),l.fromReceived("GroupEnterNotice").pipe(ca(o.onGroupEnterNotice())),l.fromReceived("GroupLeaveNotice").pipe(ca(o.onGroupLeaveNotice())),l.fromReceived("GroupCountNotice").pipe(ca(o.onGroupCountNotice())),l.fromReceived("GroupAttributeAlt").pipe(ca(o.onGroupAttributeAlt())),l.fromReceived("UserJoinNotice").pipe(ca(o.onUserNotice(S.PeerOnlineState.ONLINE))),l.fromReceived("UserQuitNotice").pipe(ca(o.onUserNotice(S.PeerOnlineState.OFFLINE))),l.fromReceived("UserWaitNotice").pipe(ca(o.onUserNotice(S.PeerOnlineState.UNREACHABLE)))).pipe(qf(void 0))}))}).forEach(function(s,l){o.loginSocketSubs[l].receivers.push(s.subscribe({error:function(){}}))})}},{key:"requestSocketLogin",value:function(o,s,l){var f=this;return im(ad(function(){f.userJoinOptions=new is(s),o.sendPacket("UserJoin",{account:f.context.uid,instance:f.instanceId,opt:f.userJoinOptions.toLong(),seq:l,ticket:o.ticket})}),o.fromReceived("UserResp").pipe(aa(function(h){return l.eq(h.seq)}),ca(function(h){if((h=h.code)!==0)throw f.clearSockets(),f.logError("Connected to gateway success but the Rtm server rejected login"),new da(["Login failure. The response code from the RTM service is %d",h],jg);f.log("ENV_%d logged in",o.env)}),qf(o),hb(15e3))).pipe(wb(function(h){return h!==void 0}),Ga(function(h){return h instanceof pb&&f.warn("Login response timeout, rejoin: %s",s),Z(h)}))}},{key:"getSocketLoginObservables",value:function(o,s){var l=this;return o.map(function(f){return f.pipe(ca(function(h){h.listenerCount("socketUserDrop")===0&&h.on("socketUserDrop",function(d){return l.onUserDrop(d,h)})}),Cc(function(h,d){return l.incSeqIfNeeded(h.env),l.requestSocketLogin(h,d!==0,d===0?s:l.seq)}),pe())})}},{key:"incSeqIfNeeded",value:function(o){if(![0,1].includes(o))throw new Fa({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[o]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[o]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){for(var o=this.curLoginSockets,s=-1,l=o==null?0:o.length,f=0,h=[];++s<l;){var d=o[s];d&&(h[f++]=d)}return h}},{key:"emitMessage",value:function(o,s){var l=o.options,f=o.payload,h=o.src,d=o.dst,p=o.instance,g=o.dialogue,_=o.sequence,b=o.ms,x=o.MiscMap;this.dialogueSequenceLru.set(g.toString(),_),p="".concat(p,"-").concat(g,"#").concat(_),this.msgDedupLru.has(p)?this.warn("Env_%d: Messages out-of-order or not start with 1: %s",s,p):(this.msgDedupLru.set(p,void 0),s=new ae(l),this.lastLoginSockets.forEach(function(){var A=J(w.mark(function k(C){var j;return w.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,C.pipe(Ka(1)).toPromise();case 2:j=P.sent,e.sendMessageAck(o,j);case 4:case"end":return P.stop()}},k)}));return function(k){return A.apply(this,arguments)}}()),l=s.isZlibCompressed(),s.isInvitation()?(d=pa(l?nl(Xm(f,Uint8Array.of(0,0,0,0))):f),d=JSON.parse(d),this.log("The received invitation body is %o",d),this.emit("invitationMessage",{body:d,type:s.getInvitationType(),peerId:h,serverReceivedTs:b.toNumber()})):s.isTextMessage()?(x=s.isPeerTextMessage(),f=pa(l?nl(Xm(f,Uint8Array.of(0,0,0,0))):f),this.info("Received a %s %s text message from %s to %s, %s",l?" compressed":"",x?"peer":"channel",oa(h),oa(d),p),x?(h={text:f,peerId:h,properties:{serverReceivedTs:b.toNumber(),isOfflineMessage:s.isFromCache()}},this.emit("peerTextMessage",h)):this.emit("channelTextMessage",{channelId:d,memberId:h,text:f,properties:{serverReceivedTs:b.toNumber(),isOfflineMessage:!1}})):s.isRawMessage()?(g=s.isRawPeerMessage(),x=(x=x.description)===void 0?"":pa(x),f=l?nl(f):f,this.info("Received a %s %s raw message from %s to %s, %s",l?" compressed":"",g?"peer":"channel",oa(h),oa(d),p),g?(h={desc:x,raw:f,peerId:h,properties:{serverReceivedTs:b.toNumber(),isOfflineMessage:s.isFromCache()}},this.emit("peerRawMessage",h)):this.emit("channelRawMessage",{desc:x,raw:f,channelId:d,memberId:h,properties:{serverReceivedTs:b.toNumber(),isOfflineMessage:!1}})):(s.isImageMessage()||s.isFileMessage())&&(f=s.isPeerMessage(),this.info("Received a %s media message from %s to %s, %s",f?"peer":"channel",oa(h),oa(d),p),f?this.emit("peerMediaMessage",{messageType:s.isImageMessage()?"IMAGE":"FILE",details:x,peerId:h,properties:{serverReceivedTs:b.toNumber(),isOfflineMessage:s.isFromCache()}}):this.emit("channelMediaMessage",{messageType:s.isImageMessage()?"IMAGE":"FILE",details:x,memberId:h,channelId:d,properties:{serverReceivedTs:b.toNumber(),isOfflineMessage:s.isFromCache()}})))}},{key:"onSocketReconnect",value:function(o){var s=this;return function(){var l=[0,1].filter(function(f){return f!==o.env})[0];(l=s.connection.curOpenSockets[l])&&!l.loggedIn&&s.emit("connectionLost")}}},{key:"onUserDrop",value:function(o,s){var l;o=o.code,eb("KickedOff",{code:0,elapse:fb(this.startTime),linkId:parseInt(s.name.split("-")[1],10),lts:U.fromNumber(Date.now()),server:s.address,serverCode:o,sid:Xa(this.instanceId),userId:this.context.uid},(l=this.context.config.enableCloudProxy)!==null&&l!==void 0&&l),o===10006||o===10001?this.warn("Login too often and kicked off, reconnect and login"):o===10009?(this.warn("The instance ID conflicts, reconnecting"),this.instanceId=Bg(),this.context.sid=Xa(this.instanceId),this.emit("instanceChanged",this.instanceId)):[11,14,15,16].includes(o)&&(this.emit("userDrop",o),this.clearSockets())}},{key:"clearSockets",value:function(){var o=this,s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,l=1<arguments.length&&arguments[1]!==void 0&&arguments[1];[0,1].forEach(function(f){o.cleanLoginSubs(f,l),o.connection.closeSocket(f,s)})}},{key:"onMessage",value:function(o){var s=this;return function(l){var f=l.dialogue,h=l.instance,d=l.sequence,p=l.options;if(l.src===s.context.uid)s.log("The message is from the local account, ignored");else{var g=f.toString(),_=s.dialPendingMsgSubjectMap.get(g);if(f="".concat(h,"-").concat(f,"#").concat(d),_)_.next(l),s.log("Env_%d: The dialogue has pending messages, next: %s",o.env,f);else{var b=s.dialogueSequenceLru.get(g);if(_=!b&&d.eq(1),h=b!==void 0&&d.sub(b).eq(1),_||h)s.emitMessage(l,o.env);else{if(b){if(d.lte(b))return;s.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",o.env,f)}else s.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",o.env,f);d=new Pa,s.dialPendingMsgSubjectMap.set(g,d);var x=d.pipe(Qs(Pk),xg(function(A,k){return[].concat(G(A),[k])},[]),ba(function(A){return G(A).sort(function(k,C){return k=k.sequence,C=C.sequence,k.eq(C)?0:k.gt(C)?1:-1})}),sm(1));p=!(p=new ae(p)).isFromCache()&&!p.isBufferedMessage(),x.pipe(ob(Bc(p?750:1500)),aa(function(A){if(2>A.length)return!1;for(var k=b===void 0?U.fromNumber(1,!0):b.add(1),C=0;C<A.length;k=k.add(1),C++)if(!A[C].sequence.eq(k))return!1;return!0}),wg(function(){s.dialPendingMsgSubjectMap.delete(g)})).subscribe(function(A){A.forEach(function(k){s.emitMessage(k,o.env),s.log("Env_%d: The message queue has fully ordered, emitting: %s",o.env,"".concat(k.instance,"-").concat(k.dialogue,"#").concat(k.sequence))})},function(A){A instanceof vg&&x.pipe(Ka(1)).subscribe(function(k){return k.forEach(function(C){s.log("Env_%d: The message pending queue expired, emitting: %s",o.env,"".concat(C.instance,"-").concat(C.dialogue,"#").concat(C.sequence)),s.emitMessage(C,o.env)})})}),d.next(l)}}}}}},{key:"onGroupEnterNotice",value:function(){var o=this;return function(s){o.emit("memberNotice",{channelId:s.group,seq:s.seq,instance:s.instance,memberId:s.user,type:"MemberJoined",size:s.size})}}},{key:"onGroupLeaveNotice",value:function(){var o=this;return function(s){o.emit("memberNotice",{channelId:s.group,seq:s.seq,instance:s.instance,memberId:s.user,type:"MemberLeft",size:s.size})}}},{key:"onGroupCountNotice",value:function(){var o=this;return function(s){o.emit("memberNotice",{channelId:s.group,seq:s.seq,instance:s.instance,type:"MemberCountUpdated",size:s.size})}}},{key:"onGroupAttributeAlt",value:function(){var o=this;return function(s){var l=s.group;s=ff(s,kD),o.emit("channelAttributesUpdated",ua({channelId:l},s))}}},{key:"onUserNotice",value:function(o){var s=this;return function(l){s.emit("peerOnlineStatusChanged",{peerId:l.user,instance:l.instance,seq:l.seq,state:o})}}}],[{key:"sendMessageAck",value:function(o,s){var l=new ae(o.options);(l.isInvitation()||l.isPeerMessage())&&s.sendPacket("Ack",{code:0,dialogue:o.dialogue,instance:o.instance,sequence:o.sequence})}}]),e}(tb());m(ls,"genTimeoutError",function(r,e){return bb(void 0).pipe(cd(e===void 0?1e4:e),ba(function(){throw new db(["Request timed out after %ds",e===void 0?1e4:e],r)}))});var ms,ol,pl=0,ql=0;Ud.v1=function(r,e,i){i=e&&i||0;var o=e||[],s=(r=r||{}).node||ms,l=r.clockseq!==void 0?r.clockseq:ol;if(s==null||l==null){var f=Jq();s==null&&(s=ms=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),l==null&&(l=ol=16383&(f[6]<<8|f[7]))}f=r.msecs!==void 0?r.msecs:new Date().getTime();var h=r.nsecs!==void 0?r.nsecs:ql+1,d=f-pl+(h-ql)/1e4;if(0>d&&r.clockseq===void 0&&(l=l+1&16383),(0>d||f>pl)&&r.nsecs===void 0&&(h=0),1e4<=h)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");for(pl=f,ql=h,ol=l,r=(1e4*(268435455&(f+=122192928e5))+h)%4294967296,o[i++]=r>>>24&255,o[i++]=r>>>16&255,o[i++]=r>>>8&255,o[i++]=255&r,r=f/4294967296*1e4&268435455,o[i++]=r>>>8&255,o[i++]=255&r,o[i++]=r>>>24&15|16,o[i++]=r>>>16&255,o[i++]=l>>>8|128,o[i++]=255&l,l=0;6>l;++l)o[i+l]=s[l];return e||Kq(o)},Ud.v4=Ud;var rl=Ph(),vd,bf=S.LocalInvitationFailureReason,Ba=S.LocalInvitationState,lD=(vd=function(r){function e(o,s,l){W(this,e);var f=i.call(this,l,"RtmLocalInvitation",!0);return m(n(f),"state",Ba.IDLE),m(n(f),"localInvitationEnd$",Ca(gb(n(f),"LocalInvitationAccepted"),gb(n(f),"LocalInvitationRefused"),gb(n(f),"LocalInvitationFailure"),gb(n(f),"LocalInvitationCanceled")).pipe(Ka(1))),m(n(f),"callId",Ud.v4()),m(n(f),"_content",""),m(n(f),"_channelId",""),m(n(f),"_response",""),m(n(f),"calleeId",void 0),m(n(f),"logger",void 0),m(n(f),"getSession",void 0),f.calleeId=o,f.getSession=s,f.logger=l,f}la(e,r);var i=ma(e);return Ha(e,[{key:"channelId",get:function(){return this._channelId},set:function(o){this.state!==Ba.IDLE?this.info("set channelId only allow before invitation sent to remote"):(this.log("set channelId for %s",this.callId),this._channelId=o)}},{key:"content",get:function(){return this._content},set:function(o){this.log("set content for %s",this.callId),this._content=o}},{key:"response",get:function(){return this._response},set:function(o){throw new I('Cannot set the "response" of the LocalInvitation instance.',xc)}},{key:"send",value:function(){var o,s=this;if(this.state===Ba.SENT_TO_REMOTE||this.state===Ba.RECEIVED_BY_REMOTE)throw new K("The local invitation send failure. The call invitation has already been sent.",gA);if(this.isLocalInvitationEnd())throw new K("The local invitation send failure. The call invitation has ended.",Ih);if(0<this._channelId.length&&!za(this._channelId))throw new I("Illegal invitation channel ID",xc);if(!za(this.calleeId))throw new I("Illegal invitation callee user ID",xc);if(8192<Ig(this._content))throw new I('The length of the "content" overflows. The number of bytes representing content must not exceed 8 Ã 1024 if encoded in UTF-8.',xc);this.state=Ba.SENT_TO_REMOTE,ad(J(w.mark(function l(){var f,h,d;return w.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,s.getSession().sendInvitationMessage({peerId:s.calleeId,callId:s.callId,extra:s._content,type:"CallInvite",channelId:s._channelId});case 2:if(f=p.sent,h=f.hasPeerReceived,d=f.hasReSent,!s.isLocalInvitationEnd()){p.next=7;break}throw new db("send invitation timeout");case 7:if(s.log("The local invitation has sent to the callee"),h||d){p.next=11;break}throw o=new rl({PEER_NOT_ONLINE:"The peer of the invitation is not online"});case 11:if(h){p.next=14;break}throw o=new rl({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"});case 14:case"end":return p.stop()}},l)}))).pipe(oe(function(l){return l.pipe(ca(function(f){if(!(f instanceof rl))throw f}),cd(2e3))}),hb(3e4),Ga(function(l){return Sa(l)&&s.warn("local invitation ack timed out"),Z(l)}),ob(this.localInvitationEnd$)).subscribe({next:function(){s.state===Ba.RECEIVED_BY_REMOTE?s.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"'):s.state!==Ba.SENT_TO_REMOTE?s.log("The invitation has ended, skipped emitting the %s event","LocalInvitationReceivedByPeer"):(s.info("The peer received the local invitation %s.",s.callId),s.state=Ba.RECEIVED_BY_REMOTE,s.emit("LocalInvitationReceivedByPeer"),s.localInvitationEnd$.pipe(hb(6e4),Ga(function(l){return Sa(l)&&s.warn("local invitation expired"),Z(l)})).subscribe({error:function(){s.state=Ba.FAILURE,s.emit("LocalInvitationFailure",bf.INVITATION_EXPIRE)}}))},error:function(l){s.isLocalInvitationEnd()?s.log("The invitation has ended, skipped emitting the %s event","LocalInvitationFailure"):(s.state=Ba.FAILURE,Sa(l)&&o?o.code==="PEER_NOT_ONLINE"?s.emit("LocalInvitationFailure",bf.PEER_OFFLINE):o.code==="RESENT_AND_OFFLINE"&&s.emit("LocalInvitationFailure",bf.PEER_NO_RESPONSE):Sa(l)?s.emit("LocalInvitationFailure",bf.PEER_NO_RESPONSE):l.name==="RtmInvalidStatusError"?s.emit("LocalInvitationFailure",bf.NOT_LOGGEDIN):s.emit("LocalInvitationFailure",bf.UNKNOWN))}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new K("The local invitation cancel failure",Ih);if(this.state===Ba.IDLE)throw new K("The local invitation has not been sent",fA);if(8192<Ig(this._content))throw new I('The length of the "content" overflows. The number of bytes representing content must not exceed 8 Ã 1024 if encoded in UTF-8.',xc);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this._channelId,extra:this._content}),this.state=Ba.CANCELED,this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(o){if(this.isLocalInvitationEnd()&&this.state!==Ba.ACCEPTED_BY_REMOTE)this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationAccepted");else{if(this.state===Ba.IDLE)throw new K("the local have not sent the invitation, how can remote accept it?");this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}),this.state===Ba.ACCEPTED_BY_REMOTE?this.log("already in ACCEPTED_BY_REMOTE state, ignore emit ACCEPTED_BY_REMOTE"):(this.state===Ba.SENT_TO_REMOTE&&(this.log("receive LocalInvitationAccepted before remote response to the invitation"),this.state=Ba.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this.state=Ba.ACCEPTED_BY_REMOTE,this._response=o,this.emit("LocalInvitationAccepted",o))}}},{key:"onRefuseReceived",value:function(o){if(this.isLocalInvitationEnd())this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationRefused");else{if(this.state===Ba.IDLE)throw new K("the local have not sent the invitation, how can remote refuse it?");this.state===Ba.SENT_TO_REMOTE&&(this.log("receive LocalInvitationRefused before remote response to the invitation"),this.state=Ba.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this._response=o,this.state=Ba.REFUSED_BY_REMOTE,this.emit("LocalInvitationRefused",o)}}},{key:"isLocalInvitationEnd",value:function(){return[Ba.CANCELED,Ba.FAILURE,Ba.ACCEPTED_BY_REMOTE,Ba.REFUSED_BY_REMOTE].includes(this.state)}}]),e}(tb()),fa(vd.prototype,"send",[Nb],Object.getOwnPropertyDescriptor(vd.prototype,"send"),vd.prototype),fa(vd.prototype,"cancel",[Nb],Object.getOwnPropertyDescriptor(vd.prototype,"cancel"),vd.prototype),vd),Rh=S.RemoteInvitationFailureReason,kb=S.RemoteInvitationState,mD=function(r){function e(o){var s=o.invitationChannel,l=o.extraContent,f=o.callId,h=o.callerId,d=o.logger;o=o.getSession,W(this,e);var p=i.call(this,d,"RtmRemoteInvitation",!0);return m(n(p),"state",kb.INVITATION_RECEIVED),m(n(p),"remoteInvitationEnd$",Ca(gb(n(p),"RemoteInvitationCanceled"),gb(n(p),"RemoteInvitationRefused"),gb(n(p),"RemoteInvitationAccepted"),gb(n(p),"RemoteInvitationFailure")).pipe(Ka(1))),m(n(p),"callerId",void 0),m(n(p),"callId",void 0),m(n(p),"_getSession",void 0),m(n(p),"logger",void 0),m(n(p),"_content",void 0),m(n(p),"_channelId",void 0),m(n(p),"_response",""),p._channelId=s,p._content=l,p.callId=f,p.callerId=h,p._getSession=o,p.logger=d,p.remoteInvitationEnd$.pipe(hb(6e4),Ga(function(g){return Sa(g)&&p.warn("Remote invitation expired"),Z(g)})).subscribe({error:function(){p.state=kb.FAILURE,p.emit("RemoteInvitationFailure",Rh.INVITATION_EXPIRE)}}),p}la(e,r);var i=ma(e);return Ha(e,[{key:"channelId",get:function(){return this._channelId},set:function(o){throw new I('Cannot set the "response" of the RemoteInvitation instance.',xc)}},{key:"content",get:function(){return this._content},set:function(o){throw new I('Cannot set the "content" of the RemoteInvitation instance.',xc)}},{key:"response",get:function(){return this._response},set:function(o){this._response=o}},{key:"accept",value:function(){var o,s=this;if(this.isRemoteInvitationEnd())throw new K("The local invitation has ended. Cannot accept.",Ih);if(this.state===kb.ACCEPT_SENT_TO_LOCAL)throw new K("The remote invitation is accepting. Cannot do the operation.",Qq);if(8192<Ig(this._response))throw new I('The length of the "response" overflows. The number of bytes representing content must not exceed 8 Ã 1024 if encoded in UTF-8.',xc);this.state=kb.ACCEPT_SENT_TO_LOCAL,Xb(mm(1e3).pipe(cb(function(){return ad(J(w.mark(function l(){return w.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",s._getSession().sendInvitationMessage({peerId:s.callerId,callId:s.callId,extra:s.response,type:"CallAccept",isAcceptAck:!1,channelId:s.channelId}));case 1:case"end":return f.stop()}},l)})))}),wb(function(l){return o=l.hasPeerReceived}),Ka(1)),gb(this,"RemoteInvitationAccepted")).pipe(hb(5e3),ob(this.remoteInvitationEnd$)).subscribe({error:function(l){if(s.logError(l),s.state=kb.FAILURE,Sa(l))switch(o){case void 0:case!0:return void s.emit("RemoteInvitationFailure",Rh.ACCEPT_FAILURE);case!1:return void s.emit("RemoteInvitationFailure",Rh.PEER_OFFLINE)}s.emit("RemoteInvitationFailure",Rh.UNKNOWN)}})}},{key:"refuse",value:function(){if(this.state===kb.ACCEPT_SENT_TO_LOCAL)throw new K("The remote invitation is accepting. Cannot do the operation.",Qq);if(this.isRemoteInvitationEnd())throw new K("The invitation is end. Cannot refuse",Ih);if(8192<Ig(this._response))throw new I('The length of the "response" overflows. The number of bytes representing content must not exceed 8 Ã 1024 if encoded in UTF-8.',xc);this._getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.state=kb.REFUSED,this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(o){this.isRemoteInvitationEnd()?this.log("The invitation has ended, skipped emitting the %s event","RemoteInvitationCanceled"):(this.state===kb.ACCEPT_SENT_TO_LOCAL&&this.log("caller canceled before receive accept"),this._content=o,this.state=kb.CANCELED,this.emit("RemoteInvitationCanceled",o))}},{key:"onAcceptAckReceived",value:function(){this.state!==kb.ACCEPT_SENT_TO_LOCAL?this.log("The invitation has ended, skipped emitting the %s event","ori:".concat(this.state,", to: RemoteInvitationAccepted")):(this.state=kb.ACCEPTED,this.emit("RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[kb.ACCEPTED,kb.REFUSED,kb.CANCELED,kb.FAILURE].includes(this.state)}}]),e}(tb()),nD=function(r){function e(o,s){W(this,e);var l=i.call(this,s,"InvitationManager");return m(n(l),"getSession",void 0),m(n(l),"invitationDispatcher",new ea.EventEmitter),m(n(l),"outgoingLocalInvitations",new Map),m(n(l),"receivedRemoteInvitations",new tc(void 0,{maxlen:1e4})),m(n(l),"logger",void 0),l.getSession=cn(o),l.logger=s,l.invitationDispatcher.on("remoteInvitationToManager",function(f){var h=f.callId,d=f.extra,p=f.callerId;f=f.channelId,l.receivedRemoteInvitations.has(h)||((d=new mD({callerId:p,callId:h,getSession:l.getSession,logger:s,extraContent:d,invitationChannel:f})).remoteInvitationEnd$.subscribe(function(){l.receivedRemoteInvitations.delete(h)}),l.receivedRemoteInvitations.set(h,d),l.emit("remoteInvitationInstance",d))}),l.invitationDispatcher.on("acceptAckToRemoteInvitation",function(f){(f=l.receivedRemoteInvitations.get(f.callId))&&f.onAcceptAckReceived()}),l.invitationDispatcher.on("cancelToRemoteInvitation",function(f){var h=f.extra;(f=l.receivedRemoteInvitations.get(f.callId))&&f.onCancelReceived(h)}),l.invitationDispatcher.on("acceptToLocalInvitation",function(f){var h=f.extra;(f=l.outgoingLocalInvitations.get(f.callId))&&f.onAcceptReceived(h)}),l.invitationDispatcher.on("refuseToLocalInvitation",function(f){var h=f.extra;(f=l.outgoingLocalInvitations.get(f.callId))&&f.onRefuseReceived(h)}),l}la(e,r);var i=ma(e);return Ha(e,[{key:"invitationMessageHandler",value:function(o){var s=o.body,l=s.callId,f=s.extra;f=f===void 0?"":f;var h=s.type,d=(s=s.channel)===void 0?"":s,p=o.type;switch(s=o.peerId,o=o.serverReceivedTs,p){case"CallAccept":h==="ack"?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:l}):h==="request"&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:l,extra:f});break;case"CallInvite":this.invitationDispatcher.emit("remoteInvitationToManager",{callId:l,callerId:s,extra:f,channelId:d});break;case"CallCancel":if(l==="0"){l="".concat("AgoraRTMLegacyEndcallCompatibleMessagePrefix","_").concat(d,"_").concat(f),this.getSession().emit("peerTextMessage",{peerId:s,properties:{serverReceivedTs:o,isOfflineMessage:!1},text:l});break}this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:l,extra:f});break;case"CallReject":this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:l,extra:f});break;default:throw Im("invitationType",p)}}},{key:"genLocalInvitation",value:function(o){var s=this,l=new lD(o,this.getSession,this.logger);return l.localInvitationEnd$.subscribe(function(){s.outgoingLocalInvitations.delete(l.callId)}),this.outgoingLocalInvitations.set(l.callId,l),l}}]),e}(tb()),oD=function(r,e,i){var o=!0,s=!0;if(typeof r!="function")throw new TypeError("Expected a function");return lb(i)&&(o="leading"in i?!!i.leading:o,s="trailing"in i?!!i.trailing:s),qC(r,e,{leading:o,maxWait:e,trailing:s})},ub,cf;(function(r){r[r.JOINED=0]="JOINED",r[r.LEFT=1]="LEFT"})(cf||(cf={}));var ns=S.ConnectionState,pD=(ub=function(r){function e(o,s,l,f){W(this,e);var h=i.call(this,f,"RtmChannel",!0);return m(n(h),"onMemberCountUpdated",oD(function(d){d!==h.memberCount&&(h.memberCount=d,h.emit("MemberCountUpdated",d))},1e3)),m(n(h),"getSession",void 0),m(n(h),"memberCount",0),m(n(h),"memberJoinedLru",new tc(void 0,{maxlen:1e4})),m(n(h),"memberLeftLru",new tc(void 0,{maxlen:1e4})),m(n(h),"memberJoinStateLru",new tc(void 0,{maxlen:1e4})),m(n(h),"attributesSeqLru",new tc(void 0,{maxlen:1e4})),m(n(h),"channelId",void 0),m(n(h),"client",void 0),m(n(h),"onAttributesUpdated",function(d){var p=d.channelId,g=d.attributeMaps,_=d.seq;d=d.instance.toString();var b=h.attributesSeqLru.get(d);if((!b||_.greaterThan(b))&&(h.attributesSeqLru.set(d,_),p===h.channelId)){for(p={},_=0;_<g.length;_++){var x=g[_];d=x.key,b=x.ms;var A=x.value;if(x=x.origin,typeof d!="string"||!U.isLong(b)||typeof A!="string"||!za(x))break;p[d]={value:A,lastUpdateUserId:x,lastUpdateTs:b.toNumber()}}h.emit("AttributesUpdated",p)}}),m(n(h),"onChannelTextMessage",function(d){var p=d.memberId,g=d.text,_=d.properties;d.channelId===h.channelId&&h.emit("ChannelMessage",{text:g,messageType:S.MessageType.TEXT},p,_)}),m(n(h),"onChannelMediaMessage",function(d){var p=d.memberId,g=d.properties,_=d.details,b=d.messageType;d.channelId===h.channelId&&(b==="FILE"?h.emit("ChannelMessage",{messageType:S.MessageType.FILE,size:parseInt(pa(_.media_size),10),description:pa(_.media_description),fileName:pa(_.media_filename),mediaId:pa(_.media_id),thumbnail:new Blob([_.media_thumbnail])},p,g):b==="IMAGE"&&h.emit("ChannelMessage",{messageType:S.MessageType.IMAGE,size:parseInt(pa(_.media_size),10),description:pa(_.media_description),fileName:pa(_.media_filename),mediaId:pa(_.media_id),thumbnail:new Blob([_.media_thumbnail]),height:parseInt(pa(_.media_height),10),width:parseInt(pa(_.media_width),10),thumbnailHeight:parseInt(pa(_.media_thumbnailheight),10),thumbnailWidth:parseInt(pa(_.media_thumbnailwidth),10)},p,g))}),m(n(h),"onChannelRawMessage",function(d){var p=d.desc,g=d.raw,_=d.memberId,b=d.properties;d.channelId===h.channelId&&h.emit("ChannelMessage",{messageType:S.MessageType.RAW,rawMessage:g,description:p},_,b)}),m(n(h),"onMemberNotice",function(d){var p=d.memberId,g=d.type,_=d.size;if(d.channelId===h.channelId){var b=d.instance.toString();d=d.seq.toString();var x={MemberLeft:h.memberLeftLru,MemberJoined:h.memberJoinedLru,MemberCountUpdated:void 0}[g];if(x){if(x.has(b+d))return void h.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",g,d,oa(h.channelId),oa(p||""));if(x.set(b+d,void 0),typeof p!="string")return;if(p!==h.getSession().context.uid&&((b=h.memberJoinStateLru.get(p))===cf.JOINED&&g==="MemberJoined"||b===cf.LEFT&&g==="MemberLeft"))return void h.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",g,d,oa(h.channelId),oa(p||""));h.memberJoinStateLru.set(p,g==="MemberJoined"?cf.JOINED:cf.LEFT)}h.info("Channel %s - %s, memberId: %s",g,oa(h.channelId),g==="MemberCountUpdated"?"[unknown]":oa(p||"")),b=p===h.getSession().context.uid,g==="MemberLeft"&&za(p)||g==="MemberJoined"&&za(p)?(b||h.emit(g,p),h.onMemberCountUpdated(_)):g==="MemberCountUpdated"&&typeof _=="number"&&h.onMemberCountUpdated(_)}}),h.getSession=cn(s),h.channelId=o,h.client=l,h.info("A channel created, id %s",oa(o)),h}la(e,r);var i=ma(e);return Ha(e,[{key:"join",value:function(){var o=J(w.mark(function s(){var l,f,h,d,p,g,_;return w.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(za(this.channelId)){b.next=2;break}throw new I(["The %s in the arguments is invalid","channelId"],hA);case 2:b.prev=2,l=this.getSession(),b.next=9;break;case 6:throw b.prev=6,b.t0=b.catch(2),new K("The client is not logged in. Cannot do the operation",Vq);case 9:if(!l.joinedChannels.has(this)){b.next=12;break}throw eb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:l.context.uid,elapse:fb(l.startTime),errCode:Uq,sid:Xa(l.instanceId)},(f=this.client.context.config.enableCloudProxy)!==null&&f!==void 0&&f),new K("The channel has joined. Cannot rejoin",Uq);case 12:if(b.prev=12,this.log("Joining the channel %s",oa(this.channelId)),!this.hasOtherChannelJoined()){b.next=17;break}throw eb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:l.context.uid,elapse:fb(l.startTime),errCode:Wq,sid:Xa(l.instanceId)},(p=this.client.context.config.enableCloudProxy)!==null&&p!==void 0&&p),new K("A channel of the same channel ID has already joined. Cannot rejoin",Wq);case 17:if(l.joinedChannels.size!==20){b.next=20;break}throw eb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:l.context.uid,elapse:fb(l.startTime),errCode:Tq,sid:Xa(l.instanceId)},(g=this.client.context.config.enableCloudProxy)!==null&&g!==void 0&&g),new ib("The joined channels has exceeded the limit of 20",Tq);case 20:return eb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:l.context.uid,elapse:fb(l.startTime),errCode:0,sid:Xa(l.instanceId)},(h=this.client.context.config.enableCloudProxy)!==null&&h!==void 0&&h),b.next=23,l.requestChannelJoin(this,this.channelId);case 23:eb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(l.startTime),errCode:0,sid:Xa(l.instanceId),serverErrCode:0,userId:l.context.uid},(d=this.client.context.config.enableCloudProxy)!==null&&d!==void 0&&d),this.info("The channel %s joined successfully",oa(this.channelId)),l.on("channelTextMessage",this.onChannelTextMessage),l.on("channelRawMessage",this.onChannelRawMessage),l.on("channelMediaMessage",this.onChannelMediaMessage),l.on("memberNotice",this.onMemberNotice),l.on("channelAttributesUpdated",this.onAttributesUpdated),b.next=41;break;case 32:if(b.prev=32,b.t1=b.catch(12),this.logError(b.t1),!sa(b.t1)){b.next=37;break}throw b.t1;case 37:if(!Sa(b.t1)){b.next=40;break}throw eb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(l.startTime),errCode:Sq,sid:Xa(l.instanceId),serverErrCode:0,userId:l.context.uid},(_=this.client.context.config.enableCloudProxy)!==null&&_!==void 0&&_),new db(["Join channel %s timed out",oa(this.channelId)],Sq);case 40:throw new Wc(["The channel %s join failure",oa(this.channelId)],{code:Rq,originalError:b.t1});case 41:case"end":return b.stop()}},s,this,[[2,6],[12,32]])}));return function(){return o.apply(this,arguments)}}()},{key:"leave",value:function(){var o=J(w.mark(function s(){var l,f,h,d;return w.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:p.prev=0,f=this.getSession(),p.next=7;break;case 4:throw p.prev=4,p.t0=p.catch(0),new K("The client is not logged in. Cannot do the operation",jA);case 7:if(f.joinedChannels.has(this)){p.next=9;break}throw new K("The channel does not join. Cannot do the operation",iA);case 9:p.prev=9,f.requestChannelLeave(this,this.channelId),this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.attributesSeqLru.empty(),this.memberJoinStateLru.empty(),this.memberCount=0,f.removeListener("channelTextMessage",this.onChannelTextMessage),f.removeListener("channelRawMessage",this.onChannelRawMessage),f.removeListener("channelMediaMessage",this.onChannelMediaMessage),f.removeListener("memberNotice",this.onMemberNotice),f.removeListener("channelAttributesUpdated",this.onAttributesUpdated),p.next=32;break;case 23:if(p.prev=23,p.t1=p.catch(9),this.logError(p.t1),!sa(p.t1)){p.next=30;break}throw p.t1.code===void 0&&(p.t1.code=Yq),eb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(f.startTime),errCode:Yq,sid:Xa(f.instanceId),userId:f.context.uid},(d=this.client.context.config.enableCloudProxy)!==null&&d!==void 0&&d),p.t1;case 30:throw eb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(f.startTime),errCode:Xq,sid:Xa(f.instanceId),userId:f.context.uid},(h=this.client.context.config.enableCloudProxy)!==null&&h!==void 0&&h),new Wc("The channel leave failure",{code:Xq,originalError:p.t1});case 32:eb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(f.startTime),errCode:0,sid:Xa(f.instanceId),userId:f.context.uid},(l=this.client.context.config.enableCloudProxy)!==null&&l!==void 0&&l);case 33:case"end":return p.stop()}},s,this,[[0,4],[9,23]])}));return function(){return o.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g,_=this,b=arguments;return w.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:f=1<b.length&&b[1]!==void 0?b[1]:{},h=f.enableHistoricalMessaging,d=h!==void 0&&h,Tm(l,Hh),x.prev=2,p=this.getSession(),x.next=9;break;case 6:throw x.prev=6,x.t0=x.catch(2),new K("The client is not logged in. Cannot do the operation",ig);case 9:if(p.joinedChannels.has(this)){x.next=11;break}throw new K("The channel does not join. Cannot do the operation",ig);case 11:if(this.client.connectionState!==ns.RECONNECTING){x.next=16;break}return g=Date.now(),x.next=15,new Promise(function(A,k){var C=function(){var P=J(w.mark(function z(){var _e;return w.wrap(function(Di){for(;;)switch(Di.prev=Di.next){case 0:return _e=Date.now()-g,Di.prev=1,Di.next=4,Gg({message:l,peerId:_.channelId,toPeer:!1,session:_.getSession(),errorCodes:{NOT_LOGGED_IN:ig,TOO_OFTEN:Mq},diff:_e,logger:_.logger,options:{enableHistoricalMessaging:d,enableOfflineMessaging:!1}});case 4:A(),Di.next=12;break;case 7:Di.prev=7,Di.t0=Di.catch(1),Sa(Di.t0)&&k(new db(Yd(_.name,"sendMessageToPeer",1e4),Yk)),sa(Di.t0)&&k(Di.t0),k(new da("Channel message send failure",{code:hg,originalError:Di.t0}));case 12:return Di.prev=12,clearTimeout(j),Di.finish(12);case 15:case"end":return Di.stop()}},z,null,[[1,7,12,15]])}));return function(){return P.apply(this,arguments)}}();_.client.internalEmitter.once("RECONNECTED",C);var j=setTimeout(function(){_.client.internalEmitter.off("RECONNECTED",C),k(new db(Yd(_.name,"sendMessageToPeer",1e4),Yk))},9e3)});case 15:return x.abrupt("return");case 16:if(this.client.connectionState===ns.CONNECTED){x.next=18;break}throw new K("The client is not logged in. Cannot do the operation",ig);case 18:return x.prev=18,x.next=21,Gg({message:l,peerId:this.channelId,toPeer:!1,session:this.getSession(),errorCodes:{NOT_LOGGED_IN:ig,TOO_OFTEN:Mq},diff:0,logger:this.logger,options:{enableHistoricalMessaging:d,enableOfflineMessaging:!1}});case 21:x.next=31;break;case 23:if(x.prev=23,x.t1=x.catch(18),!Sa(x.t1)){x.next=27;break}throw new db(Yd(this.name,"sendMessage",1e4),Yk);case 27:if(!sa(x.t1)){x.next=30;break}throw this.logError(x.t1),x.t1;case 30:throw new Wc("The channel message send failure",hg);case 31:case"end":return x.stop()}},s,this,[[2,6],[18,23]])}));return function(s){return o.apply(this,arguments)}}()},{key:"getMembers",value:function(){var o=J(w.mark(function s(){var l,f,h;return w.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:d.prev=0,d.prev=1,l=this.getSession(),d.next=8;break;case 5:throw d.prev=5,d.t0=d.catch(1),new K("The client is not logged in. Cannot do the operation",eA);case 8:if(l.joinedChannels.has(this)){d.next=10;break}throw new K("The channel does not join. Cannot do the operation",dA);case 10:return f=this.getSession().requestChannelMemberList(this.channelId),d.next=13,f.pipe(ba(function(p){return p.memberInfos.map(function(g){return g.account})})).toPromise();case 13:return h=d.sent,this.info("Channel %s - get members success, %o",oa(this.channelId),h.map(oa)),d.abrupt("return",h);case 18:if(d.prev=18,d.t1=d.catch(0),!sa(d.t1)){d.next=23;break}throw this.logError(d.t1),d.t1;case 23:throw new Wc("The channel members get failure",bA);case 24:case"end":return d.stop()}},s,this,[[0,18],[1,5]])}));return function(){return o.apply(this,arguments)}}()},{key:"hasOtherChannelJoined",value:function(){var o=this;return!this.getSession().joinedChannels.has(this)&&Array.from(this.getSession().joinedChannels).some(function(s){return s.channelId===o.channelId})}}]),e}(tb()),fa(ub.prototype,"join",[Nb],Object.getOwnPropertyDescriptor(ub.prototype,"join"),ub.prototype),fa(ub.prototype,"leave",[Nb],Object.getOwnPropertyDescriptor(ub.prototype,"leave"),ub.prototype),fa(ub.prototype,"sendMessage",[Nb],Object.getOwnPropertyDescriptor(ub.prototype,"sendMessage"),ub.prototype),fa(ub.prototype,"getMembers",[Ma],Object.getOwnPropertyDescriptor(ub.prototype,"getMembers"),ub.prototype),ub),E,Eb=S.ConnectionChangeReason,T=S.ConnectionState,os={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},qD={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8},rD=(E=function(r){function e(o,s,l,f){W(this,e);var h=i.call(this,s,"RtmClient",!0);return m(n(h),"connectionState",T.DISCONNECTED),m(n(h),"internalEmitter",new ea),m(n(h),"context",void 0),m(n(h),"attributes",{}),m(n(h),"loginPromise",void 0),m(n(h),"attributeDrafts",new Set),m(n(h),"session",void 0),m(n(h),"lastLoginTime",void 0),m(n(h),"reconnId",0),m(n(h),"channelAttributesCacheLru",new tc(void 0,{maxlen:1e4})),m(n(h),"invitationManager",void 0),m(n(h),"subscribedPeerStatusCache",{}),m(n(h),"peerStatusSeqLru",new tc(void 0,{maxlen:1e4})),m(n(h),"peerUnreachableTimers",{}),m(n(h),"mediaTaskManager",void 0),m(n(h),"setParameters",void 0),m(n(h),"updateConfig",void 0),m(n(h),"userDropHandler",function(d){if(h.connectionState!==T.ABORTED)switch(d){case 11:h.logError("Kicked off by remote session"),h.onConnectionStateChanged(T.ABORTED,Eb.REMOTE_LOGIN);break;case 14:case 15:case 16:h.logError("Server banned because of illegal ".concat({14:"User ID",15:"IP",16:"Channel Name"}[d])),h.onConnectionStateChanged(T.ABORTED,Eb.BANNED_BY_SERVER);break;default:h.logError("User kicked off for unknown code: ".concat(d)),h.onConnectionStateChanged(T.ABORTED,Eb.INTERRUPTED)}}),h.context=new ZC(o,l,s),h.mediaTaskManager=new fs(s),h.context.config=l,h.internalEmitter.setMaxListeners(512),h.setParameters=f.bind(n(h)),h.updateConfig=f.bind(n(h)),h.invitationManager=new nD(function(){return h.session},s),h.invitationManager.on("remoteInvitationInstance",function(d){h.emit("RemoteInvitationReceived",d)}),h}la(e,r);var i=ma(e);return Ha(e,[{key:"renewToken",value:function(){var o=J(w.mark(function s(l){var f,h,d,p=this;return w.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(typeof l=="string"&&l.length!==0){g.next=2;break}throw new I("Invalid argument",rA);case 2:if(this.connectionState!==T.ABORTED){g.next=5;break}return g.next=5,new Promise(function(){});case 5:if(this.connectionState===T.CONNECTED||this.connectionState===T.RECONNECTING){g.next=7;break}throw new K("The client is not logged in",uA);case 7:if(this.session!==void 0){g.next=9;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return g.prev=9,f=this.context.token,this.context.token=l,g.next=14,this.session.connection.apClient.getApEdgeInfo$(!1).pipe(Dd(function(){return Error("No available edge address to connect")}),oe(function(_){return _.pipe(ca(function(b){if(sa(b))throw b}),cd(2500),Ka(4))}),Ka(1),hb(2e4),Ga(function(_){return Sa(_)&&p.warn("renewToken timed out"),Z(_)})).toPromise();case 14:h=g.sent,d=h.ticket,g.next=27;break;case 18:if(g.prev=18,g.t0=g.catch(9),this.context.token=f,g.t0.code!==$q&&g.t0.code!==ar){g.next=23;break}throw new Ye("Invalid token",tA);case 23:if(g.t0.code!==Kh){g.next=25;break}throw new Ye("The token expired",sA);case 25:if(!Sa(g.t0)){g.next=27;break}throw new db("Renew token timed out",qA);case 27:this.session.curLoginSockets.filter(function(_){return _!==void 0}).forEach(function(_){return _.ticket=d});case 28:case"end":return g.stop()}},s,this,[[9,18]])}));return function(s){return o.apply(this,arguments)}}()},{key:"queryPeersOnlineStatus",value:function(){var o=J(w.mark(function s(l){var f,h,d=this;return w.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.connectionState===T.CONNECTED){p.next=2;break}throw new K("The client is not logged in",pA);case 2:if(this.session!==void 0){p.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(!Array.isArray(l)||l.length===0||l.some(function(g){return!za(g)})||256<l.length)){p.next=6;break}throw new I("invalid arguments",er);case 6:return p.next=8,this.session.requestPeersOnlineStatus(l).toPromise();case 8:return f=p.sent,h=uc(Jk(f.userInfos,"account"),function(g){return!!g.ts}),Object.keys(h).forEach(function(g){if(g in d.subscribedPeerStatusCache&&d.subscribedPeerStatusCache[g]!==S.PeerOnlineState.UNREACHABLE){var _=h[g]?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE;d.emit("PeersOnlineStatusChanged",m({},g,_)),d.subscribedPeerStatusCache[g]=_}}),p.abrupt("return",h);case 12:case"end":return p.stop()}},s,this)}));return function(s){return o.apply(this,arguments)}}()},{key:"getChannelMemberCount",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g,_,b,x=this;return w.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(this.connectionState===T.CONNECTED){A.next=2;break}throw new K("The client is not logged in",aA);case 2:if(this.session!==void 0){A.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(l)&&l.every(function(k){return typeof k=="string"})&&l.length!==0){A.next=6;break}throw new I("Invalid arguments: channelIds",Oq);case 6:if(!(32<l.length)){A.next=8;break}throw new I("getChannelMemberCount exceed limit of 32 channelIds",$z);case 8:f=0;case 9:if(!(f<l.length)){A.next=16;break}if(za(h=l[f])){A.next=13;break}throw new I(["getChannelMemberCount channel id %s is invalid",h],Oq);case 13:f++,A.next=9;break;case 16:return A.next=18,this.session.requestGetChannelMemberCount(l).toPromise();case 18:for(d=A.sent,p=d.groupInfos,g={},_=function(k){var C=(k=p[k]).group,j=k.memberCount;za(C)&&typeof j=="number"&&(x.session.joinedChannels.forEach(function(P){P.channelId===C&&P.onMemberCountUpdated(j)}),g[C]=j)},b=0;b<p.length;b++)_(b);return A.abrupt("return",g);case 24:case"end":return A.stop()}},s,this)}));return function(s){return o.apply(this,arguments)}}()},{key:"setLocalUserAttributes",value:function(){var o=J(w.mark(function s(l){var f,h;return w.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(uf({attributes:l,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){d.next=3;break}throw new K("The client is not logged in",Ub);case 3:if(this.session!==void 0){d.next=5;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return f=this.session.requestSetLocalUserAttributes(l).toPromise(),h={attribute:l,promise:f},this.attributeDrafts.add(h),d.prev=8,d.next=11,f;case 11:this.attributes=l,d.next=19;break;case 14:if(d.prev=14,d.t0=d.catch(8),!sa(d.t0)){d.next=18;break}throw d.t0;case 18:throw new I("arguments is not valid",Ja);case 19:return d.prev=19,this.attributeDrafts.delete(h),d.finish(19);case 22:case"end":return d.stop()}},s,this,[[8,14,19,22]])}));return function(s){return o.apply(this,arguments)}}()},{key:"setChannelAttributes",value:function(){var o=J(w.mark(function s(l,f){var h,d,p,g,_,b=arguments;return w.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(h=2<b.length&&b[2]!==void 0?b[2]:{},d=h.enableNotificationToChannelMembers,p=d!==void 0&&d,uf({attributes:f,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){x.next=4;break}throw new K("The client is not logged in",Ub);case 4:if(this.session!==void 0){x.next=6;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return g=this.session.requestSetChannelAttributes(l,f,p).toPromise(),x.prev=7,x.next=10,g;case 10:_=uc(f,function(A){return new Blob([A]).size}),this.channelAttributesCacheLru.set(l,_),x.next=19;break;case 14:if(x.prev=14,x.t0=x.catch(7),!sa(x.t0)){x.next=18;break}throw x.t0;case 18:throw new I("arguments is not valid",Ja);case 19:case"end":return x.stop()}},s,this,[[7,14]])}));return function(s,l){return o.apply(this,arguments)}}()},{key:"addOrUpdateLocalUserAttributes",value:function(){var o=J(w.mark(function s(l){var f,h,d;return w.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(f=ua(ua({},this.attributes),l),uf({attributes:l,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),uf({attributes:f,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){p.next=5;break}throw new K("The client is not logged in",Ub);case 5:if(this.session!==void 0){p.next=7;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return h=this.session.requestAddOrUpdateLocalUserAttributes(l).toPromise(),d={attribute:f,promise:h},this.attributeDrafts.add(d),p.prev=10,p.next=13,h;case 13:this.attributes=f,p.next=21;break;case 16:if(p.prev=16,p.t0=p.catch(10),!sa(p.t0)){p.next=20;break}throw p.t0;case 20:throw new I("arguments is not valid",er);case 21:return p.prev=21,this.attributeDrafts.delete(d),p.finish(21);case 24:case"end":return p.stop()}},s,this,[[10,16,21,24]])}));return function(s){return o.apply(this,arguments)}}()},{key:"addOrUpdateChannelAttributes",value:function(){var o=J(w.mark(function s(l,f){var h,d,p,g,_,b,x,A=arguments;return w.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(h=2<A.length&&A[2]!==void 0?A[2]:{},d=h.enableNotificationToChannelMembers,p=d!==void 0&&d,g=this.channelAttributesCacheLru.get(l,{}),_=uc(f,function(C){return new Blob([C]).size}),b=ua(ua({},g),_),uf({attributes:f,attrSizeMap:b,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){k.next=7;break}throw new K("The client is not logged in",Ub);case 7:if(this.session!==void 0){k.next=9;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return x=this.session.requestAddOrUpdateChannelAttributes(l,f,p).toPromise(),k.prev=10,k.next=13,x;case 13:this.channelAttributesCacheLru.set(l,b),k.next=21;break;case 16:if(k.prev=16,k.t0=k.catch(10),!sa(k.t0)){k.next=20;break}throw k.t0;case 20:throw new I("arguments is not valid",Ja);case 21:case"end":return k.stop()}},s,this,[[10,16]])}));return function(s,l){return o.apply(this,arguments)}}()},{key:"deleteLocalUserAttributesByKeys",value:function(){var o=J(w.mark(function s(l){var f,h,d,p;return w.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(Array.isArray(l)&&l.length!==0&&!l.some(function(_){return _.length===0})){g.next=2;break}throw new K("arguments is not valid",Ja);case 2:if(this.connectionState===T.CONNECTED){g.next=4;break}throw new K("The client is not logged in",Ub);case 4:if(this.session!==void 0){g.next=6;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return f=this.session.requestDeleteLocalUserAttributesByKeys(l).toPromise(),h={attribute:Gk(this.attributes,l),promise:f},this.attributeDrafts.add(h),g.prev=9,g.next=12,f;case 12:for(d=0;d<l.length;d++)p=l[d],delete this.attributes[p];g.next=20;break;case 15:if(g.prev=15,g.t0=g.catch(9),!sa(g.t0)){g.next=19;break}throw g.t0;case 19:throw new I("arguments is not valid",Ja);case 20:return g.prev=20,this.attributeDrafts.delete(h),g.finish(20);case 23:case"end":return g.stop()}},s,this,[[9,15,20,23]])}));return function(s){return o.apply(this,arguments)}}()},{key:"deleteChannelAttributesByKeys",value:function(){var o=J(w.mark(function s(l,f){var h,d,p,g,_,b,x,A=arguments;return w.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(h=2<A.length&&A[2]!==void 0?A[2]:{},d=h.enableNotificationToChannelMembers,p=d!==void 0&&d,Array.isArray(f)&&f.length!==0&&za(l)&&!f.some(function(C){return C.length===0||512<C.length})){k.next=3;break}throw new K("arguments is not valid",Ja);case 3:if(this.connectionState===T.CONNECTED){k.next=5;break}throw new K("The client is not logged in",Ub);case 5:if(this.session!==void 0){k.next=7;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return g=this.session.requestDeleteChannelAttributesByKeys(l,f,p).toPromise(),k.prev=8,k.next=11,g;case 11:if(_=this.channelAttributesCacheLru.get(l))for(b=0;b<f.length;b++)x=f[b],delete _[x];k.next=20;break;case 15:if(k.prev=15,k.t0=k.catch(8),!sa(k.t0)){k.next=19;break}throw k.t0;case 19:throw new I("arguments is not valid",Ja);case 20:case"end":return k.stop()}},s,this,[[8,15]])}));return function(s,l){return o.apply(this,arguments)}}()},{key:"clearLocalUserAttributes",value:function(){var o=J(w.mark(function s(){var l,f;return w.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.connectionState===T.CONNECTED){h.next=2;break}throw new K("The client is not logged in",Ub);case 2:if(this.session!==void 0){h.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return l=this.session.requestClearLocalUserAttributes().toPromise(),f={attribute:{},promise:l},this.attributeDrafts.add(f),h.prev=7,h.next=10,l;case 10:this.attributes={},h.next=18;break;case 13:if(h.prev=13,h.t0=h.catch(7),!sa(h.t0)){h.next=17;break}throw h.t0;case 17:throw new I("arguments is not valid",Ja);case 18:return h.prev=18,this.attributeDrafts.delete(f),h.finish(18);case 21:case"end":return h.stop()}},s,this,[[7,13,18,21]])}));return function(){return o.apply(this,arguments)}}()},{key:"clearChannelAttributes",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g=arguments;return w.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(f=1<g.length&&g[1]!==void 0?g[1]:{},h=f.enableNotificationToChannelMembers,d=h!==void 0&&h,this.connectionState===T.CONNECTED){_.next=3;break}throw new K("The client is not logged in",Ub);case 3:if(this.session!==void 0){_.next=5;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return p=this.session.requestClearChannelAttributes(l,d).toPromise(),_.prev=6,_.next=9,p;case 9:this.channelAttributesCacheLru.delete(l),_.next=17;break;case 12:if(_.prev=12,_.t0=_.catch(6),!sa(_.t0)){_.next=16;break}throw _.t0;case 16:throw new I("arguments is not valid",Ja);case 17:case"end":return _.stop()}},s,this,[[6,12]])}));return function(s){return o.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var o=J(w.mark(function s(l){var f,h,d;return w.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(za(l)){p.next=2;break}throw new I("Not a valid user ID",Ja);case 2:if(this.connectionState===T.CONNECTED){p.next=4;break}throw new K("The client is not logged in",Ub);case 4:if(this.session!==void 0){p.next=6;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return p.prev=6,p.next=9,this.session.requestGetUserAttributeKeys(l).toPromise();case 9:return f=p.sent,h=f.keys,p.next=13,this.session.requestGetUserAttributesByKeys(l,h.slice(0,512)).toPromise();case 13:d=p.sent,p.next=21;break;case 16:if(p.prev=16,p.t0=p.catch(6),!sa(p.t0)){p.next=20;break}throw p.t0;case 20:throw new I("arguments is not valid",Ja);case 21:return p.abrupt("return",Yp(d.attributeInfos.map(function(g){return[g.key,g.value]})));case 22:case"end":return p.stop()}},s,this,[[6,16]])}));return function(s){return o.apply(this,arguments)}}()},{key:"getChannelAttributes",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g,_,b,x,A,k,C;return w.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(za(l)){j.next=2;break}throw new I("Not a valid channel ID",Ja);case 2:if(this.connectionState===T.CONNECTED){j.next=4;break}throw new K("The client is not logged in",Ub);case 4:if(this.session!==void 0){j.next=6;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return j.prev=6,j.next=9,this.session.requestGetChannelAttributesKeys(l).toPromise();case 9:return f=j.sent,h=f.keys,j.next=13,this.session.requestGetChannelAttributesByKeys(l,h).toPromise();case 13:d=j.sent,p=d.attributeMaps,j.next=22;break;case 17:if(j.prev=17,j.t0=j.catch(6),!sa(j.t0)){j.next=21;break}throw j.t0;case 21:throw new I("arguments is not valid",Ja);case 22:g={},_=0;case 24:if(!(_<p.length)){j.next=32;break}if(b=p[_],x=b.key,A=b.ms,k=b.value,C=b.origin,typeof x=="string"&&U.isLong(A)&&typeof k=="string"&&za(C)){j.next=28;break}return j.abrupt("break",32);case 28:g[x]={value:k,lastUpdateUserId:C,lastUpdateTs:A.toNumber()};case 29:_++,j.next=24;break;case 32:return this.channelAttributesCacheLru.set(l,uc(g,function(P){return new Blob([P.value]).size})),j.abrupt("return",g);case 34:case"end":return j.stop()}},s,this,[[6,17]])}));return function(s){return o.apply(this,arguments)}}()},{key:"getChannelAttributesByKeys",value:function(){var o=J(w.mark(function s(l,f){var h,d,p,g,_,b,x,A,k,C;return w.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(this.connectionState===T.CONNECTED){j.next=2;break}throw new K("The client is not logged in",Ub);case 2:if(this.session!==void 0){j.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Hm(l,f),j.prev=5,j.next=8,this.session.requestGetChannelAttributesByKeys(l,f).toPromise();case 8:h=j.sent,d=h.attributeMaps,j.next=17;break;case 12:if(j.prev=12,j.t0=j.catch(5),!sa(j.t0)){j.next=16;break}throw j.t0;case 16:throw new I("arguments is not valid",Ja);case 17:p={},g=this.channelAttributesCacheLru.get(l,{}),_=0;case 20:if(!(_<d.length)){j.next=29;break}if(b=d[_],x=b.key,A=b.ms,k=b.value,C=b.origin,typeof x=="string"&&U.isLong(A)&&typeof k=="string"&&za(C)){j.next=24;break}return j.abrupt("break",29);case 24:g[x]=new Blob([k]).size,p[x]={value:k,lastUpdateUserId:C,lastUpdateTs:A.toNumber()};case 26:_++,j.next=20;break;case 29:return this.channelAttributesCacheLru.set(l,g),j.abrupt("return",p);case 31:case"end":return j.stop()}},s,this,[[5,12]])}));return function(s,l){return o.apply(this,arguments)}}()},{key:"getUserAttributesByKeys",value:function(){var o=J(w.mark(function s(l,f){var h;return w.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.connectionState===T.CONNECTED){d.next=2;break}throw new K("The client is not logged in",Ub);case 2:if(this.session!==void 0){d.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Hm(l,f),d.prev=5,d.next=8,this.session.requestGetUserAttributesByKeys(l,f).toPromise();case 8:h=d.sent,d.next=16;break;case 11:if(d.prev=11,d.t0=d.catch(5),!sa(d.t0)){d.next=15;break}throw d.t0;case 15:throw new I("arguments is not valid",Ja);case 16:return d.abrupt("return",Yp(h.attributeInfos.map(function(p){return[p.key,p.value]})));case 17:case"end":return d.stop()}},s,this,[[5,11]])}));return function(s,l){return o.apply(this,arguments)}}()},{key:"login",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g=this;return w.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(Uk=!0,f=Bg(),h=l.token,l.token===this.context.appId&&(h=void 0),setTimeout(function(){var b;eb("Session",{appId:g.context.appId,did:navigator.userAgent,elapse:fb(g.session&&g.session.startTime),index:{index1:l.uid,index2:g.context.appId,index3:"enableLogUpload=".concat(g.context.config.enableLogUpload)},installId:gg,lts:U.fromNumber(Date.now()),os:7,sid:Xa(f),token:h||"",userId:l.uid,ver:"1.4.3-203",buildno:603,subVersion:203,version:4},(b=g.context.config.enableCloudProxy)!==null&&b!==void 0&&b)},1e4),yd(l)&&za(l.uid)){_.next=7;break}throw new I("not a valid user id",Jh);case 7:if(typeof h!="string"||!h){_.next=11;break}this.context.token=h,_.next=13;break;case 11:if(typeof h=="string"||h==null){_.next=13;break}throw new I('The "token" is not a valid string.',Jh);case 13:return d=Date.now(),this.context.sid=Xa(f),this.loginPromise=this.loginImpl({uid:l.uid,instanceId:f}),this.info("RTM Client logging in as ".concat(oa(l.uid))),_.prev=17,_.next=20,this.loginPromise;case 20:_.next=27;break;case 22:throw _.prev=22,_.t0=_.catch(17),sa(_.t0)&&eb("Link",{ackedServerIp:"",destServerIp:"",ec:_.t0.code||1,sc:_.t0.serverCode,elapse:fb(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),responseTime:Date.now()-d,sid:Xa(f),userId:l.uid},(p=this.context.config.enableCloudProxy)!==null&&p!==void 0&&p),this.context.token=void 0,_.t0;case 27:return _.prev=27,this.loginPromise=void 0,_.finish(27);case 30:Uk=!1;case 31:case"end":return _.stop()}},s,this,[[17,22,27,30]])}));return function(s){return o.apply(this,arguments)}}()},{key:"logout",value:function(){var o=J(w.mark(function s(){var l;return w.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this.loginPromise){f.next=3;break}return f.next=3,this.loginPromise;case 3:if(this.connectionState!==T.DISCONNECTED){f.next=6;break}throw this.logError("Already in logout state"),new K("Logout failure. The client has already been logged out",br);case 6:if(this.connectionState!==T.ABORTED){f.next=10;break}return this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGOUT),f.abrupt("return");case 10:if(this.session!==void 0){f.next=13;break}return this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGOUT),f.abrupt("return");case 13:return eb("Logout",{elapse:fb(this.session.startTime),lts:U.fromNumber(Date.now()),sid:Xa(this.session.instanceId),userId:this.context.uid},(l=this.context.config.enableCloudProxy)!==null&&l!==void 0&&l),f.next=16,this.session.logoutHandler();case 16:this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGOUT),this.log("Log out success");case 18:case"end":return f.stop()}},s,this)}));return function(){return o.apply(this,arguments)}}()},{key:"logoutSync",value:function(){var o,s=this;if(this.connectionState===T.DISCONNECTED)throw this.logError("Already in logout state"),new K("Logout failure. The client has already been logged out",br);this.connectionState===T.ABORTED?this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'):this.session!==void 0&&(eb("Logout",{elapse:fb(this.session.startTime),lts:U.fromNumber(Date.now()),sid:Xa(this.session.instanceId),userId:this.context.uid},(o=this.context.config.enableCloudProxy)!==null&&o!==void 0&&o),this.session.logoutHandler().then(function(){s.log("Log out success")})),this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGOUT)}},{key:"sendMessageToPeer",value:function(){var o=J(w.mark(function s(l,f){var h,d,p,g,_,b,x=this,A=arguments;return w.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(h=2<A.length&&A[2]!==void 0?A[2]:{},d=h.enableOfflineMessaging,p=d!==void 0&&d,g=h.enableHistoricalMessaging,_=g!==void 0&&g,Tm(l,ve),this.connectionState!==T.RECONNECTING){k.next=5;break}return b=Date.now(),k.abrupt("return",new Promise(function(C,j){var P=function(){var _e=J(w.mark(function Di(){var _i;return w.wrap(function(Ei){for(;;)switch(Ei.prev=Ei.next){case 0:if(x.session!==void 0){Ei.next=2;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:return _i=Date.now()-b,Ei.prev=3,Ei.t0=C,Ei.next=7,Gg({message:l,peerId:f,toPeer:!0,session:x.session,errorCodes:{NOT_LOGGED_IN:al,TOO_OFTEN:dr},diff:_i,logger:x.logger,options:{enableHistoricalMessaging:_,enableOfflineMessaging:p}});case 7:Ei.t1=Ei.sent,(0,Ei.t0)(Ei.t1),Ei.next=16;break;case 11:Ei.prev=11,Ei.t2=Ei.catch(3),Sa(Ei.t2)&&j(new db(Yd(x.name,"sendMessageToPeer",1e4),Zk)),sa(Ei.t2)&&j(Ei.t2),j(new da("Peer-to-peer message send failure",{code:cr,originalError:Ei.t2}));case 16:return Ei.prev=16,clearTimeout(z),Ei.finish(16);case 19:case"end":return Ei.stop()}},Di,null,[[3,11,16,19]])}));return function(){return _e.apply(this,arguments)}}();x.internalEmitter.once("RECONNECTED",P);var z=setTimeout(function(){x.internalEmitter.off("RECONNECTED",P),j(new db(Yd(x.name,"sendMessageToPeer",1e4),Zk))},9e3)}));case 5:if(this.connectionState===T.CONNECTED){k.next=7;break}throw new K("Failed to send the peer-to-peer message. The client is not logged in",al);case 7:if(this.session!==void 0){k.next=9;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return k.prev=9,k.next=12,Gg({message:l,peerId:f,toPeer:!0,session:this.session,errorCodes:{NOT_LOGGED_IN:al,TOO_OFTEN:dr},diff:0,logger:this.logger,options:{enableHistoricalMessaging:_,enableOfflineMessaging:p}});case 12:return k.abrupt("return",k.sent);case 15:if(k.prev=15,k.t0=k.catch(9),!Sa(k.t0)){k.next=19;break}throw new db(Yd(this.name,"sendMessageToPeer",1e4),Zk);case 19:if(!sa(k.t0)){k.next=21;break}throw k.t0;case 21:throw new da("Peer-to-peer message send failure",{code:cr,originalError:k.t0});case 22:case"end":return k.stop()}},s,this,[[9,15]])}));return function(s,l){return o.apply(this,arguments)}}()},{key:"createChannel",value:function(o){var s=this;if(!za(o))throw new I(["The %s in the arguments is invalid",Object.keys({channelId:o})[0]],Zz);return new pD(o,function(){return s.session},this,this.logger)}},{key:"createLocalInvitation",value:function(o){if(!za(o))throw new I(["The %s in the arguments is invalid",Object.keys({calleeId:o})[0]],xc);return this.invitationManager.genLocalInvitation(o)}},{key:"subscribePeersOnlineStatus",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g,_,b,x,A,k,C,j,P,z=this;return w.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(this.connectionState===T.CONNECTED){_e.next=2;break}throw new K("The client is not logged in",bl);case 2:if(this.session!==void 0){_e.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(l)&&l.length!==0){_e.next=6;break}throw new I("Invalid arguments: peerIds",kg);case 6:f=0;case 7:if(!(f<l.length)){_e.next=14;break}if(za(h=l[f])){_e.next=11;break}throw new I(["subscribePeersOnlineStatus peer id %s is invalid",h],kg);case 11:f++,_e.next=7;break;case 14:if(!(512<(d=l&&l.length?vk(l):[]).length+Object.keys(this.subscribedPeerStatusCache).length)){_e.next=17;break}throw new ib("Subscribed peers overflows",gr);case 17:return _e.next=19,this.session.requestSubscribePeersOnlineStatus(d).toPromise();case 19:p=_e.sent,g=p.errors,_=[],b=[],x=0;case 24:if(!(x<g.length)){_e.next=32;break}if(A=g[x],k=A.code,typeof(C=A.account)=="string"){_e.next=28;break}throw new da("Returned account is invalid",fr);case 28:k!==0&&_.push(C);case 29:x++,_e.next=24;break;case 32:for(j=0;j<d.length;j++)P=d[j],_.includes(P)||(b.push(P),this.subscribedPeerStatusCache[P]=void 0);if(this.session.requestPeersOnlineStatus(b).pipe(ba(function(Di){return uc(Jk(Di.userInfos,"account"),function(_i){return!!_i.ts})})).subscribe(function(Di){Di=uc(Di,function(_i,Ei){return _i=_i?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,z.subscribedPeerStatusCache[Ei]=_i}),z.emit("PeersOnlineStatusChanged",Di)}),_.length===0){_e.next=36;break}throw new da("Subscription failed",fr);case 36:case"end":return _e.stop()}},s,this)}));return function(s){return o.apply(this,arguments)}}()},{key:"unsubscribePeersOnlineStatus",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g;return w.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(this.connectionState===T.CONNECTED){_.next=2;break}throw new K("The client is not logged in",bl);case 2:if(this.session!==void 0){_.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(l)&&l.length!==0){_.next=6;break}throw new I("Invalid arguments: peerIds",kg);case 6:f=0;case 7:if(!(f<l.length)){_.next=14;break}if(za(h=l[f])){_.next=11;break}throw new I(["subscribePeersOnlineStatus peer id %s is invalid",h],kg);case 11:f++,_.next=7;break;case 14:if(!(512<l.length)){_.next=16;break}throw new ib("Unsubscribed peers overflows",gr);case 16:for(d=l&&l.length?vk(l):[],this.session.requestUnsubscribePeersOnlineStatus(d),p=0;p<d.length;p++)g=d[p],delete this.subscribedPeerStatusCache[g];case 19:case"end":return _.stop()}},s,this)}));return function(s){return o.apply(this,arguments)}}()},{key:"queryPeersBySubscriptionOption",value:function(){var o=J(w.mark(function s(l){return w.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.connectionState===T.CONNECTED){f.next=2;break}throw new K("The client is not logged in",bl);case 2:if(l!==S.PeerSubscriptionOption.ONLINE_STATUS){f.next=4;break}return f.abrupt("return",Object.keys(this.subscribedPeerStatusCache));case 4:throw new I("Subscription option not supported",kg);case 5:case"end":return f.stop()}},s,this)}));return function(s){return o.apply(this,arguments)}}()},{key:"createMessage",value:function(o){return o.messageType==="IMAGE"?ua({width:0,height:0,fileName:"",description:"",thumbnail:new Blob,thumbnailWidth:0,thumbnailHeight:0,size:0},o):o.messageType==="FILE"?ua({fileName:"",description:"",thumbnail:new Blob,size:0},o):o}},{key:"downloadMedia",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g,_,b,x,A,k,C,j,P,z,_e=this,Di=arguments;return w.wrap(function(_i){for(;;)switch(_i.prev=_i.next){case 0:if(f=1<Di.length&&Di[1]!==void 0?Di[1]:{},typeof l=="string"){_i.next=3;break}throw new I("invalid mediaId format",cl);case 3:if(_i.prev=3,h=l.split("z"),d=ra(h,3),p=d[0],g=d[1],_=d[2],b=p.slice(1,65),x=bD(b),A=parseInt(p.slice(65),10),k=parseInt(g,10),C=parseInt(_,10),!(Number.isNaN(A)||Number.isNaN(k)||Number.isNaN(C))){_i.next=12;break}throw new I("Invalid mediaId content",cl);case 12:_i.next=19;break;case 14:if(_i.prev=14,_i.t0=_i.catch(3),!sa(_i.t0)){_i.next=18;break}throw _i.t0;case 18:throw new I("parse mediaId failure",{code:cl,originalError:_i.t0});case 19:if(this.connectionState===T.CONNECTED){_i.next=21;break}throw new K("The client is not logged in, cannot download",CA);case 21:if(this.session!==void 0){_i.next=23;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 23:return j=this.mediaTaskManager.addDownloadTask({unit:k,zone:A,hashHexStr:b,size:C},function(){if(_e.session===void 0)throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});return _e.session.requestFileDownloadIndexGet({hash:x,zone:A,unit:k,size:C}).toPromise()},f),_i.next=26,this.mediaTaskManager.waitMediaTask(j);case 26:return P=_i.sent,z=P.payload,_i.abrupt("return",z);case 29:case"end":return _i.stop()}},s,this,[[3,14]])}));return function(s){return o.apply(this,arguments)}}()},{key:"createMediaMessageByUploading",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g,_,b,x,A,k,C,j,P,z,_e,Di,_i,Ei,ga,_c,$,Wt,_t,Vt,B=this,H=arguments;return w.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(f=1<H.length&&H[1]!==void 0?H[1]:{},h=2<H.length&&H[2]!==void 0?H[2]:{},yd(f)){ue.next=4;break}throw new I("Invalid params",wf);case 4:if(d="thumbnailWidth"in f||"thumbnailHeight"in f||"width"in f||"height"in f,p=f.messageType,g=p===void 0?d?"IMAGE":"FILE":p,_=f.description,b=_===void 0?"":_,x=f.fileName,A=x===void 0?"":x,k=f.thumbnail,typeof f.messageType=="string"&&typeof b=="string"&&typeof A=="string"&&(Pm(k)||k===void 0)&&Pm(l)){ue.next=8;break}throw new I("Invalid message params type",wf);case 8:if(!d||g!=="FILE"){ue.next=10;break}throw new I("Invalid message params, unexpected field in RtmFileMessage",wf);case 10:if(!(33554432<(C=l.size))){ue.next=13;break}throw new ib("The payload size overflow 32 MB",wA);case 13:return ue.next=15,Ji(l);case 15:return j=ue.sent,ue.next=18,aD(j);case 18:if(P=ue.sent,this.connectionState===T.CONNECTED){ue.next=21;break}throw new K("The client is not logged in",yA);case 21:if(g!=="IMAGE"){ue.next=29;break}return ue.next=24,Xt(f,j);case 24:z=ue.sent,_e=z.height,Di=z.width,_i=z.thumbnailWidth,Ei=z.thumbnailHeight;case 29:return ga=this.mediaTaskManager.addUploadTask({file:new Uint8Array(j),hash:P},function(){if(B.session===void 0)throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});return B.session.fetchFileUploadIndexGet({hash:P,size:C})},function(_r,zt){if(B.session===void 0)throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});return B.session.requestFileUploadIndexSet({hash:P,unit:_r,servers:zt}).toPromise()},h),ue.next=32,this.mediaTaskManager.waitMediaTask(ga);case 32:if(_c=ue.sent,$=_c.zone,Wt=_c.retUnit,g!=="IMAGE"){ue.next=38;break}return _t={height:_e,width:Di,fileName:A,size:C,description:b,thumbnail:k,messageType:g,thumbnailWidth:_i,thumbnailHeight:Ei,mediaId:"0".concat($r(P)).concat($,"z").concat(Wt,"z").concat(C,"z").concat(_e,"z").concat(Di)},ue.abrupt("return",_t);case 38:return Vt={fileName:A,size:C,description:b,mediaId:"0".concat($r(P)).concat($,"z").concat(Wt,"z").concat(C),thumbnail:k,messageType:g},ue.abrupt("return",Vt);case 40:case"end":return ue.stop()}},s,this)}));return function(s){return o.apply(this,arguments)}}()},{key:"loginImpl",value:function(){var o=J(w.mark(function s(l){var f,h,d,p,g=this;return w.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(f=l.uid,h=l.instanceId,!(this.lastLoginTime!==void 0&&500>Date.now()-this.lastLoginTime)){_.next=4;break}throw new rC(["The frequency of login exceeded the limit of %d queries per second",2],mA);case 4:if(this.connectionState===T.DISCONNECTED){_.next=6;break}throw new K("The SDK is either logging in or has logged in the Agora RTM system",kA);case 6:_.prev=6,this.context.uid=f,_.next=13;break;case 10:throw _.prev=10,_.t0=_.catch(6),new I(["The %s in the arguments is invalid",Object.keys({uid:f})[0]],Jh);case 13:return this.onConnectionStateChanged(T.CONNECTING,Eb.LOGIN),this.session=d=new ls(this.context,new Yr(this.context,this.logger,!1),h,this.logger),p=function(){g.connectionState===T.CONNECTED&&(g.onConnectionStateChanged(T.RECONNECTING,Eb.INTERRUPTED),g.session)&&g.session.once("userJoined",function(){g.onConnectionStateChanged(T.CONNECTED,Eb.LOGIN_SUCCESS)})},d.on("connectionLost",p),d.on("tokenExpired",function(){g.emit("TokenExpired")}),d.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",function(b){g.emit("MessageFromPeer",{text:b.text,messageType:S.MessageType.TEXT},b.peerId,b.properties)}),this.session.on("peerMediaMessage",function(b){var x=b.peerId,A=b.properties,k=b.messageType;b=b.details,k==="FILE"?g.emit("MessageFromPeer",{messageType:S.MessageType.FILE,size:parseInt(pa(b.media_size),10),description:pa(b.media_description),fileName:pa(b.media_filename),mediaId:pa(b.media_id),thumbnail:new Blob([b.media_thumbnail])},x,A):k==="IMAGE"&&g.emit("MessageFromPeer",{messageType:S.MessageType.IMAGE,size:parseInt(pa(b.media_size),10),description:pa(b.media_description),fileName:pa(b.media_filename),mediaId:pa(b.media_id),thumbnail:new Blob([b.media_thumbnail]),height:parseInt(pa(b.media_height),10),width:parseInt(pa(b.media_width),10),thumbnailHeight:parseInt(pa(b.media_thumbnailheight),10),thumbnailWidth:parseInt(pa(b.media_thumbnailwidth),10)},x,A)}),this.session.on("peerRawMessage",function(b){g.emit("MessageFromPeer",{rawMessage:b.raw,description:b.desc,messageType:S.MessageType.RAW},b.peerId,b.properties)}),d.on("instanceChanged",function(b){return h=b}),d.on("peerOnlineStatusChanged",function(b){var x=b.instance.toString()+b.state,A=g.peerStatusSeqLru.get(x);!A||b.seq.greaterThan(A)?(g.peerStatusSeqLru.set(x,b.seq),b.state!==g.subscribedPeerStatusCache[b.peerId]&&g.emit("PeersOnlineStatusChanged",m({},b.peerId,b.state)),g.subscribedPeerStatusCache[b.peerId]=b.state,clearTimeout(g.peerUnreachableTimers[x]),b.state===S.PeerOnlineState.UNREACHABLE&&(g.peerUnreachableTimers[x]=setTimeout(function(){g.subscribedPeerStatusCache[b.peerId]===S.PeerOnlineState.UNREACHABLE&&(g.subscribedPeerStatusCache[b.peerId]=S.PeerOnlineState.ONLINE,g.emit("PeersOnlineStatusChanged",m({},b.peerId,S.PeerOnlineState.ONLINE)))},3e4))):g.log("peerOnlineStatusChanged dedup for %s, %d",x,b.seq.toNumber())}),d.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),d.on("channelAttributesUpdated",function(b){var x=b.channelId;b=b.attributeMaps;for(var A={},k=0;k<b.length;k++){var C=b[k],j=C.key,P=C.ms,z=C.value;if(C=C.origin,typeof j!="string"||!U.isLong(P)||typeof z!="string"||!za(C))break;A[j]=new Blob([z]).size}g.channelAttributesCacheLru.set(x,A)}),d.on("userJoined",function(b){if(Object.keys(g.attributes).length!==0){if(g.session===void 0)return;g.session.requestSetLocalUserAttributes(g.attributes,b).toPromise()}if(g.attributeDrafts.size!==0)for(var x=function(C,j){var P=(C=j[C]).attribute;C.promise.then(function(){g.session!==void 0&&g.session.requestSetLocalUserAttributes(P,b).toPromise()})},A=0,k=Array.from(g.attributeDrafts);A<k.length;A++)x(A,k);Object.keys(g.subscribedPeerStatusCache).length!==0&&d.requestSubscribePeersOnlineStatus(Object.keys(g.subscribedPeerStatusCache))}),this.lastLoginTime=Date.now(),_.prev=29,_.next=32,d.loginHandler().toPromise();case 32:this.mediaTaskManager.setAuthInfo({ticket:d.connection.curOpenSockets.filter(function(b){return b!==void 0})[0].ticket,instance:d.instanceId,useNewDomain:.5<=Math.random(),loginOpt:d.userJoinOptions.toLong()}),_.next=44;break;case 35:if(_.prev=35,_.t1=_.catch(29),!Sa(_.t1)){_.next=40;break}throw this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGIN_TIMEOUT),new db(Yd(this.name,"login",2e4),lA);case 40:if(this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGIN_FAILURE),!sa(_.t1)){_.next=43;break}throw _.t1;case 43:throw new da("Login failure",{code:Zq,originalError:_.t1});case 44:this.onConnectionStateChanged(T.CONNECTED,Eb.LOGIN_SUCCESS);case 45:case"end":return _.stop()}},s,this,[[6,10],[29,35]])}));return function(s){return o.apply(this,arguments)}}()},{key:"onConnectionStateChanged",value:function(o,s){var l,f=this;o===T.RECONNECTING&&(this.reconnId+=1),eb("ConnectionStateChange",{elapse:fb(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),newState:os[o],oldState:os[this.connectionState],reason:qD[s],sid:Xa(this.session&&this.session.instanceId||U.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId},(l=this.context.config.enableCloudProxy)!==null&&l!==void 0&&l),this.connectionState===T.RECONNECTING&&o===T.CONNECTED&&(Object.keys(this.subscribedPeerStatusCache).length!==0&&this.session!==void 0&&this.session.requestPeersOnlineStatus(Object.keys(this.subscribedPeerStatusCache)).pipe(ba(function(h){return uc(Jk(h.userInfos,"account"),function(d){return!!d.ts})})).subscribe(function(h){h=uc(h,function(d,p){return d=d?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,f.subscribedPeerStatusCache[p]=d}),f.emit("PeersOnlineStatusChanged",h)}),this.internalEmitter.emit("RECONNECTED")),this.connectionState=o,o!==T.ABORTED&&o!==T.DISCONNECTED||(this.reconnId=0,this.attributes={},this.session&&(this.session.removeAllListeners(),this.session.joinedChannels.clear(),this.session.msgDedupLru.empty(),this.session.dialogueSequenceLru.empty(),this.session.dialPendingMsgSubjectMap.clear()),this.session=void 0,this.channelAttributesCacheLru.empty(),this.peerStatusSeqLru.empty(),this.peerUnreachableTimers={},this.subscribedPeerStatusCache={},this.attributeDrafts.clear(),this.context.token=void 0),this.mediaTaskManager.emit("connectionStateChanged",o),this.emit("ConnectionStateChanged",o,s)}}]),e}(tb()),fa(E.prototype,"renewToken",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"renewToken"),E.prototype),fa(E.prototype,"queryPeersOnlineStatus",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersOnlineStatus"),E.prototype),fa(E.prototype,"getChannelMemberCount",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getChannelMemberCount"),E.prototype),fa(E.prototype,"setLocalUserAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"setLocalUserAttributes"),E.prototype),fa(E.prototype,"setChannelAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"setChannelAttributes"),E.prototype),fa(E.prototype,"addOrUpdateLocalUserAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateLocalUserAttributes"),E.prototype),fa(E.prototype,"addOrUpdateChannelAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateChannelAttributes"),E.prototype),fa(E.prototype,"deleteLocalUserAttributesByKeys",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"deleteLocalUserAttributesByKeys"),E.prototype),fa(E.prototype,"deleteChannelAttributesByKeys",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"deleteChannelAttributesByKeys"),E.prototype),fa(E.prototype,"clearLocalUserAttributes",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"clearLocalUserAttributes"),E.prototype),fa(E.prototype,"clearChannelAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"clearChannelAttributes"),E.prototype),fa(E.prototype,"getUserAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributes"),E.prototype),fa(E.prototype,"getChannelAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributes"),E.prototype),fa(E.prototype,"getChannelAttributesByKeys",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributesByKeys"),E.prototype),fa(E.prototype,"getUserAttributesByKeys",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributesByKeys"),E.prototype),fa(E.prototype,"login",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"login"),E.prototype),fa(E.prototype,"logout",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"logout"),E.prototype),fa(E.prototype,"logoutSync",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"logoutSync"),E.prototype),fa(E.prototype,"sendMessageToPeer",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"sendMessageToPeer"),E.prototype),fa(E.prototype,"createChannel",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"createChannel"),E.prototype),fa(E.prototype,"createLocalInvitation",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"createLocalInvitation"),E.prototype),fa(E.prototype,"subscribePeersOnlineStatus",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"subscribePeersOnlineStatus"),E.prototype),fa(E.prototype,"unsubscribePeersOnlineStatus",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"unsubscribePeersOnlineStatus"),E.prototype),fa(E.prototype,"queryPeersBySubscriptionOption",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersBySubscriptionOption"),E.prototype),fa(E.prototype,"createMessage",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"createMessage"),E.prototype),fa(E.prototype,"downloadMedia",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"downloadMedia"),E.prototype),fa(E.prototype,"createMediaMessageByUploading",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"createMediaMessageByUploading"),E.prototype),E),ps={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}},qs={enableLogUpload:!1,logFilter:ps.LOG_FILTER_INFO,enableCloudProxy:!1},Zd=ua(ua({createInstance:function(r){var e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},i=2<arguments.length?arguments[2]:void 0;if(!/^[\dA-Za-z]{32}$/.test(r))throw new I(["The %s in the arguments is invalid",Object.keys({appId:r})[0]],Nq);var o=Object.keys(e).filter(function(g){return!(g in qs)});if(o.length!==0)throw new I("Invalid RTM config: ".concat(o.join(", ")),Nq);var s=ua(ua({},qs),e);if(i!==void 0&&(!Array.isArray(i)||i.length===0))throw new I("Invalid area config");if(i!=null){if(!i.every(function(g){return g in S.LegacyAreaCode}))throw new I("Invalid area codes: ".concat(i.filter(function(g){return!(g in S)}).join(", ")));M=xe(i.map(function(g){return zC[g]}))}i=jl=Ya.__global_unique_id__=(Ya.__global_unique_id__||0)+1;var l=DC(s);o=EC(s);var f=FC(s),h=GC(i,s),d=Tr(i,s),p=d("RTM:DEBUG","<Entry> ");return Mr.rtmConfig=s,l("The Agora RTM Web SDK version is %s","1.4.3-203"),e.enableCloudProxy&&l("RTM cloud proxy enabled"),e.enableLogUpload&&l("Log upload enabled"),M&&p("Area is set to %s",Array.from(M.CODES).map(function(g){return xf(F).find(function(_){return F[_]===g})}).join(", ")),p("Creating an RtmClient instance"),p('The Git commit ID is "'.concat("v1.4.3-17-g1e27aa38",'"')),p("The App ID is %s",Um(r,4,10,"*".repeat(6))),l("The process ID is %s",gg),p("The build is %s","v1.4.3-17-g1e27aa38"),p("NODE_ENV is %s","production"),new rD(r,{genLogger:d,genTracker:h,info:l,warn:o,logError:f,loggerId:i},s,function(g){for(var _=0,b=xf(g);_<b.length;_++){var x=b[_];try{var A=g[x];A!=null&&(g.enableCloudProxy&&l("RTM cloud proxy enabled"),g.enableLogUpload&&l("Log upload enabled"),s[x]=A)}catch{throw new I(["The %s in the arguments is invalid",x],void 0)}}})},BUILD:"v1.4.3-17-g1e27aa38",VERSION:"1.4.3-203",END_CALL_PREFIX:"AgoraRTMLegacyEndcallCompatibleMessagePrefix",processId:gg,ConnectionChangeReason:S.ConnectionChangeReason,ConnectionState:S.ConnectionState,LocalInvitationFailureReason:S.LocalInvitationFailureReason,LocalInvitationState:S.LocalInvitationState,RemoteInvitationFailureReason:S.RemoteInvitationFailureReason,RemoteInvitationState:S.RemoteInvitationState,MessageType:S.MessageType,PeerOnlineState:S.PeerOnlineState,PeerSubscriptionOption:S.PeerSubscriptionOption},ps),{},{setParameter:function(r,e){Object.keys(Nc).includes(r)&&(Nc[r]=e)},getParameter:function(r){return Nc[r]},setArea:function(r){var e=r.areaCodes;if(r=r.excludedArea,!Array.isArray(e)||e.length===0||!e.every(function(i){return i in S.AreaCode}))throw new I("Invalid area config");if(r!==void 0&&r===S.AreaCode.GLOBAL)throw new I("Excluded area cannot be global");if(r===void 0)M=xe(e.map(function(i){return F[i]}));else{if(e.includes(r))throw new I("Excluded area cannot be in areaCodes");if(!(r in F))throw new I("Invalid excludedArea:",r);M=bu({areas:e.map(function(i){return F[i]}),excludedArea:F[r]})}}});return Zd})}(agoraRtmSdk$1,agoraRtmSdk$1.exports)),agoraRtmSdk$1.exports}var agoraRtmSdkExports=requireAgoraRtmSdk();const AgoraRTM__default=getDefaultExportFromCjs(agoraRtmSdkExports);var createLazyClient=function r(){var e;function i(o,s,l){return e||(e=AgoraRTM__default.createInstance(o,s,l)),e}return function(o,s,l){return i(o,s,l)}},createLazyChannel=function r(){var e;function i(o,s){return e||(e=o.createChannel(s)),e}return function(o,s){return i(o,s)}},AreaCode;(function(r){r.GLOBAL="GLOBAL",r.INDIA="INDIA",r.JAPAN="JAPAN",r.ASIA="ASIA",r.EUROPE="EUROPE",r.CHINA="CHINA",r.NORTH_AMERICA="NORTH_AMERICA"})(AreaCode||(AreaCode={}));function _extends(){return _extends=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r},_extends.apply(this,arguments)}typeof Symbol<"u"&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")));typeof Symbol<"u"&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function _catch(r,e){try{var i=r()}catch(o){return e(o)}return i&&i.then?i.then(void 0,e):i}var RtcContext=React.createContext({}),RtcProvider=RtcContext.Provider;RtcContext.Consumer;var remoteTrackState;(function(r){r[r.yes=0]="yes",r[r.subbed=1]="subbed",r[r.no=2]="no"})(remoteTrackState||(remoteTrackState={}));var layout;(function(r){r[r.grid=0]="grid",r[r.pin=1]="pin"})(layout||(layout={}));var ToggleState;(function(r){r[r.disabled=0]="disabled",r[r.enabled=1]="enabled",r[r.disabling=2]="disabling",r[r.enabling=3]="enabling"})(ToggleState||(ToggleState={}));var initialValue={rtcProps:{appId:"",channel:"",role:"host"},rtmProps:{}},PropsContext$1=React.createContext(initialValue),PropsProvider=PropsContext$1.Provider,MaxUidContext=React.createContext([]),MaxUidProvider=MaxUidContext.Provider,MaxUidConsumer=MaxUidContext.Consumer,MinUidContext=React.createContext([]),MinUidProvider=MinUidContext.Provider,MinUidConsumer=MinUidContext.Consumer,TracksContext=React.createContext({}),TracksProvider=TracksContext.Provider,initState={max:[{uid:0,hasAudio:remoteTrackState.no,hasVideo:remoteTrackState.no}],min:[],isScreensharing:!1},reducer=function r(e,i){var o=initState,s=[].concat(e.max,e.min).map(function(p){return p.uid});switch(i.type){case"Screensharing":o=_extends({},e,{isScreensharing:i.value[0]}),console.log("!Screensharingstate",e,o);break;case"update-user-video":o={min:e.min.map(function(p){return p.uid===0?{uid:0,hasAudio:remoteTrackState.subbed,hasVideo:remoteTrackState.subbed}:p}),max:e.max.map(function(p){return p.uid===0?{uid:0,hasAudio:remoteTrackState.subbed,hasVideo:remoteTrackState.subbed}:p}),isScreensharing:e.isScreensharing};break;case"user-joined":if(s.indexOf(i.value[0].uid)===-1){var l=[].concat(e.min,[{uid:i.value[0].uid,hasAudio:remoteTrackState.no,hasVideo:remoteTrackState.no}]);l.length===1&&e.max[0].uid===0?o={max:l,min:e.max,isScreensharing:e.isScreensharing}:o={min:l,max:e.max,isScreensharing:e.isScreensharing}}break;case"user-unpublished":if(e.max[0].uid===i.value[0].uid)o={max:[{uid:i.value[0].uid,hasAudio:i.value[1]==="audio"?remoteTrackState.no:e.max[0].hasAudio,hasVideo:i.value[1]==="video"?remoteTrackState.no:e.max[0].hasVideo}],min:e.min,isScreensharing:e.isScreensharing};else{var f=e.min.find(function(p){return p.uid===i.value[0].uid});if(f){var h=[].concat(e.min.filter(function(p){return p.uid!==i.value[0].uid}),[{uid:i.value[0].uid,hasAudio:i.value[1]==="audio"?remoteTrackState.no:f.hasAudio,hasVideo:i.value[1]==="video"?remoteTrackState.no:f.hasVideo}]);o={min:h,max:e.max,isScreensharing:e.isScreensharing}}}break;case"user-published":e.max[0].uid===i.value[0].uid?o={max:[{uid:i.value[0].uid,hasAudio:i.value[1]==="audio"?remoteTrackState.subbed:e.max[0].hasAudio,hasVideo:i.value[1]==="video"?remoteTrackState.subbed:e.max[0].hasVideo}],min:e.min,isScreensharing:e.isScreensharing}:o={min:e.min.map(function(p){return p.uid!==i.value[0].uid?p:{uid:p.uid,hasAudio:i.value[1]==="audio"?remoteTrackState.subbed:p.hasAudio,hasVideo:i.value[1]==="video"?remoteTrackState.subbed:p.hasVideo}}),max:e.max,isScreensharing:e.isScreensharing};break;case"user-left":if(e.max[0].uid===i.value[0].uid){var d=[].concat(e.min);o={max:[d.pop()],min:d,isScreensharing:e.isScreensharing}}else o={min:e.min.filter(function(p){return p.uid!==i.value[0].uid}),max:e.max,isScreensharing:e.isScreensharing};break;case"user-swap":e.max[0].uid===i.value[0].uid||(o={max:[i.value[0]],min:[].concat(e.min.filter(function(p){return p.uid!==i.value[0].uid}),[e.max[0]]),isScreensharing:e.isScreensharing});break;case"local-user-mute-video":o={min:e.min.map(function(p){return p.uid===0?{uid:0,hasAudio:p.hasAudio,hasVideo:i.value[0]}:p}),max:e.max.map(function(p){return p.uid===0?{uid:0,hasAudio:p.hasAudio,hasVideo:i.value[0]}:p}),isScreensharing:e.isScreensharing};break;case"local-user-mute-audio":o={min:e.min.map(function(p){return p.uid===0?{uid:0,hasAudio:i.value[0],hasVideo:p.hasVideo}:p}),max:e.max.map(function(p){return p.uid===0?{uid:0,hasAudio:i.value[0],hasVideo:p.hasVideo}:p}),isScreensharing:e.isScreensharing};break;case"remote-user-mute-video":o={min:e.min.map(function(p){return p.uid===i.value[0].uid?{uid:p.uid,hasVideo:i.value[1],hasAudio:p.hasAudio}:p}),max:e.max.map(function(p){return p.uid===i.value[0].uid?{uid:p.uid,hasVideo:i.value[1],hasAudio:p.hasAudio}:p}),isScreensharing:e.isScreensharing};break;case"remote-user-mute-audio":o={min:e.min.map(function(p){return p.uid===i.value[0].uid?{uid:p.uid,hasAudio:i.value[1],hasVideo:p.hasVideo}:p}),max:e.max.map(function(p){return p.uid===i.value[0].uid?{uid:p.uid,hasAudio:i.value[1],hasVideo:p.hasVideo}:p}),isScreensharing:e.isScreensharing};break;case"leave-channel":o=initState;break;case"ActiveSpeaker":e.max[0].uid===i.value[0]?o=_extends({},e):o={max:[e.min.find(function(p){return p.uid===i.value[0]})],min:[].concat(e.min.filter(function(p){return p.uid!==i.value[0]}),[e.max[0]]),isScreensharing:e.isScreensharing};break}return console.log("!state-update",_extends({},e,o),o),_extends({},e,o)},startScreenshare=function r(e,i,o,s,l,f,h){try{var d=function(){try{try{console.log(_),f&&(_.on("token-privilege-will-expire",function(){try{return console.log("token will expire"),Promise.resolve(fetch(f+"/rtc/"+i+"/publisher/uid/"+x+"/")).then(function(j){return Promise.resolve(j.json()).then(function(P){var z=P.rtcToken;_.renewToken(z)})})}catch(j){return Promise.reject(j)}}),_.on("token-privilege-did-expire",function(){try{return Promise.resolve(fetch(f+"/rtc/"+i+"/publisher/uid/"+x+"/")).then(function(j){return Promise.resolve(j.json()).then(function(P){var z=P.rtcToken;_.renewToken(z)})})}catch(j){return Promise.reject(j)}})),o.on("track-ended",function(){_.leave(),_.removeAllListeners()})}catch(j){console.log(j)}return Promise.resolve()}catch(j){return Promise.reject(j)}},p=function(){try{_.setClientRole("host");var j=function(){if(f){var P=_catch(function(){return Promise.resolve(fetch(f+"/rtc/"+i+"/publisher/uid/"+x+"/")).then(function(z){return Promise.resolve(z.json()).then(function(_e){var Di=_e.rtcToken;return Promise.resolve(_.join(e,i,Di,x)).then(function(_i){b=_i})})})},function(z){console.log(z)});if(P&&P.then)return P.then(function(){})}else return Promise.resolve(_.join(e,i,s||null,x||0)).then(function(z){b=z})}();return Promise.resolve(j&&j.then?j.then(function(){}):void 0)}catch(P){return Promise.reject(P)}},g=function(){try{var j=function(){var _e=function(){if(o.enabled){var Di=function(){if(!A)return Promise.resolve(_.publish([o]).then(function(){A=!0})).then(function(){})}();if(Di&&Di.then)return Di.then(function(){})}}();if(_e&&_e.then)return _e.then(function(){})},P=function(){if(h)return Promise.resolve(_.enableDualStream()).then(function(){})}();return Promise.resolve(P&&P.then?P.then(j):j(P))}catch(z){return Promise.reject(z)}},_=AgoraRTC__default.createClient({mode:"live",role:"host",codec:"vp8"}),b=0,x=l||1,A=!1,k=function(){try{var j=_catch(function(){return o.close(),Promise.resolve(_.leave()).then(function(){_.removeAllListeners()})},function(P){console.log(P)});return Promise.resolve(j&&j.then?j.then(function(){}):void 0)}catch(P){return Promise.reject(P)}};return stopScreenshare=k,Promise.resolve(d()).then(function(){return Promise.resolve(p()).then(function(){return Promise.resolve(g()).then(function(){b&&console.log(b)})})})}catch(C){return Promise.reject(C)}},stopScreenshare=function r(){},useClient=createClient({codec:"vp8",mode:"live"}),RtcConfigure=function r(e){var i=reactExports.useRef(),o=reactExports.useRef(),s=reactExports.useRef(!1),l=reactExports.useContext(TracksContext),f=l.localVideoTrack,h=l.localAudioTrack,d=reactExports.useContext(PropsContext$1),p=d.callbacks,g=d.rtcProps,_=reactExports.useState(!1),b=_[0],x=_[1],A=reactExports.useState(!1),k=A[0],C=A[1],j=null,P=reactExports.useRef(new Promise(function(_t,Vt){j=_t,console.log(Vt)})),z=useClient();g.customRtcClient&&(z.removeAllListeners(),z=g.customRtcClient);var _e=!1,Di=!1,_i=reactExports.useRef({}),Ei=e.callActive;Ei===void 0&&(Ei=!0);var ga=reactExports.useReducer(reducer,initState),_c=ga[0],$=ga[1];reactExports.useEffect(function(){var _t=function(){try{try{if(console.log(z),z.on("user-joined",function(){try{for(var zt=arguments.length,Fi=new Array(zt),_n=0;_n<zt;_n++)Fi[_n]=arguments[_n];var Js=Fi[0];return Js.uid===e.screenshareUid&&s.current||Js.uid===1&&s.current||(_i.current[Js.uid]={}),$({type:"user-joined",value:Fi}),Promise.resolve()}catch(Gi){return Promise.reject(Gi)}}),z.on("user-published",function(){for(var zt=arguments.length,Fi=new Array(zt),_n=0;_n<zt;_n++)Fi[_n]=arguments[_n];try{var Js=Fi[0],Gi=Fi[1];return console.log("user-published",Js.uid),Js.uid===e.screenshareUid&&s.current||Js.uid===1&&s.current?$({type:"user-published",value:Fi}):z.subscribe(Js,Gi).then(function(_u){if(_i.current[Js.uid][Gi+"Track"]=Js[Gi+"Track"],Gi==="audio"){var vf;(vf=Js.audioTrack)===null||vf===void 0||vf.play()}else g.enableDualStream&&g.dualStreamMode&&z.setStreamFallbackOption(Js.uid,g.dualStreamMode);$({type:"user-published",value:Fi})}).catch(function(_u){return console.log(_u)}),Promise.resolve()}catch(_u){return Promise.reject(_u)}}),z.on("user-unpublished",function(){try{for(var zt=arguments.length,Fi=new Array(zt),_n=0;_n<zt;_n++)Fi[_n]=arguments[_n];var Js=Fi[0],Gi=Fi[1];if(console.log("user-unpublished",Js.uid),Gi==="audio"){var _u;(_u=Js.audioTrack)===null||_u===void 0||_u.stop()}return $({type:"user-unpublished",value:Fi}),Promise.resolve()}catch(vf){return Promise.reject(vf)}}),z.on("connection-state-change",function(){try{for(var zt=arguments.length,Fi=new Array(zt),_n=0;_n<zt;_n++)Fi[_n]=arguments[_n];var Js=Fi[0],Gi=Fi[1],_u=Fi[2];if(console.log("connection",Gi,Js,_u),Js==="CONNECTED")C(!0);else if(Js==="DISCONNECTED"){try{stopScreenshare(),s.current=!1}catch(vf){console.log("stopscreenshare",vf)}$({type:"leave-channel",value:null})}else C(!1);return Promise.resolve()}catch(vf){return Promise.reject(vf)}}),z.on("user-left",function(){for(var zt=arguments.length,Fi=new Array(zt),_n=0;_n<zt;_n++)Fi[_n]=arguments[_n];$({type:"user-left",value:Fi})}),g.tokenUrl){var B=g.tokenUrl,H=g.channel,ue=g.uid;z.on("token-privilege-will-expire",function(){try{return console.log("token will expire"),Promise.resolve(fetch(B+"/rtc/"+H+"/publisher/uid/"+(ue||0)+"/")).then(function(zt){return Promise.resolve(zt.json()).then(function(Fi){var _n=Fi.rtcToken;z.renewToken(_n)})})}catch(zt){return Promise.reject(zt)}}),z.on("token-privilege-did-expire",function(){try{return Promise.resolve(fetch(B+"/rtc/"+H+"/publisher/uid/"+(ue||0)+"/")).then(function(zt){return Promise.resolve(zt.json()).then(function(Fi){var _n=Fi.rtcToken;z.renewToken(_n)})})}catch(zt){return Promise.reject(zt)}})}if(p){var _r=Object.keys(p);_r.map(function(zt){try{z.on(zt,function(){for(var Fi=arguments.length,_n=new Array(Fi),Js=0;Js<Fi;Js++)_n[Js]=arguments[Js];p[zt].apply(null,_n)})}catch(Fi){console.log(Fi)}})}j(!0),x(!0)}catch(zt){console.log("!!!",zt)}return Promise.resolve()}catch(zt){return Promise.reject(zt)}};return j?(_t(),function(){try{z.removeAllListeners()}catch(Vt){console.log(Vt)}}):function(){}},[g.appId]),reactExports.useEffect(function(){var _t=function(){try{return Promise.resolve(P.current).then(function(){var H=g.tokenUrl,ue=g.channel,_r=g.uid,zt=g.appId,Fi=g.token,_n=function(){if(z&&!Vt){g.role==="audience"?z.setClientRole(g.role):z.setClientRole("host");var Js=function(){if(H){var Gi=_catch(function(){return Promise.resolve(fetch(H+"/rtc/"+ue+"/publisher/uid/"+(_r||0)+"/")).then(function(_u){return Promise.resolve(_u.json()).then(function(vf){var _l=vf.rtcToken;return Promise.resolve(z.join(zt,ue,_l,_r||0)).then(function(_d){i.current=_d})})})},function(_u){console.log(_u)});if(Gi&&Gi.then)return Gi.then(function(){})}else return Promise.resolve(z.join(zt,ue,Fi||null,_r||0)).then(function(_u){i.current=_u})}();if(Js&&Js.then)return Js.then(function(){})}else console.error("trying to join before RTC Engine was initialized")}();if(_n&&_n.then)return _n.then(function(){})})}catch(H){return Promise.reject(H)}},Vt=!1;return Ei?(_t(),console.log("Attempted join: ",g.channel)):console.log("In precall - waiting to join"),function(){if(Vt=!0,Ei){console.log("Leaving channel");try{stopScreenshare(),s.current=!1}catch(B){console.log(B)}P.current=z.leave().catch(function(B){return console.log(B)})}}},[g.channel,g.uid,Ei,g.tokenUrl]),reactExports.useEffect(function(){var _t=function(){try{var B=function(){function _r(){var Fi=function(){if(f!=null&&f.enabled&&k){var _n=function(){if(!_e)return Promise.resolve(z.publish([f]).then(function(){_e=!0})).then(function(){})}();if(_n&&_n.then)return _n.then(function(){})}}();if(Fi&&Fi.then)return Fi.then(function(){})}var zt=function(){if(h!=null&&h.enabled&&k){var Fi=function(){if(!Di)return Promise.resolve(z.publish([h]).then(function(){Di=!0})).then(function(){})}();if(Fi&&Fi.then)return Fi.then(function(){})}}();return zt&&zt.then?zt.then(_r):_r(zt)},H=function(){if(g.enableDualStream)return Promise.resolve(z.enableDualStream()).then(function(){})}();return Promise.resolve(H&&H.then?H.then(B):B(H))}catch(ue){return Promise.reject(ue)}};console.log("Publish",f,h,Ei),Ei&&_t()},[Ei,f==null?void 0:f.enabled,h==null?void 0:h.enabled,k]),reactExports.useEffect(function(){f&&h!==null&&(_i.current[0]={audioTrack:h,videoTrack:f},$({type:"update-user-video",value:[h,f]}))},[g.channel,k]),reactExports.useEffect(function(){k&&g.token&&z.renewToken(g.token).then(function(_t){return console.log("renewed token",_t)})},[g.token,k]),reactExports.useEffect(function(){g.role&&z.setClientRole(g.role).then(function(_t){return console.log("changed role",_t)})},[g.role,k]),reactExports.useEffect(function(){var _t=function(){try{var B=function(){if(g.activeSpeaker&&g.layout!==layout.grid)return z.on("volume-indicator",function(H){var ue=H.reduce(function(Fi,_n){return Fi===null||_n.level>Fi.level?_n:Fi},null),_r=ue?ue.uid:void 0,zt=_r===i.current?0:_r;_r!==void 0&&$({type:"ActiveSpeaker",value:[zt]})}),Promise.resolve(z.enableAudioVolumeIndicator()).then(function(){})}();return Promise.resolve(B&&B.then?B.then(function(){}):void 0)}catch(H){return Promise.reject(H)}};return Ei&&_t(),function(){z.removeAllListeners("volume-indicator")}},[g.activeSpeaker,g.layout]);var Wt=function(){try{var Vt=function(){try{return $({type:"Screensharing",value:[!0]}),Promise.resolve(AgoraRTC__default.createScreenVideoTrack({},"disable")).then(function(ue){o.current=ue;var _r=g.screenshareUid||1;return _i.current[_r]={videoTrack:o.current},o.current.on("track-ended",function(){s.current=!1,$({type:"Screensharing",value:[!1]})}),s.current=!0,Promise.resolve(startScreenshare(g.appId,g.channel,o.current,g.screenshareToken,g.screenshareUid,g.tokenUrl,g.enableDualStream)).then(function(){})})}catch(ue){return Promise.reject(ue)}},B=function(){stopScreenshare(),s.current=!1};return s.current?B():Vt(),Promise.resolve()}catch(H){return Promise.reject(H)}};return React.createElement(RtcProvider,{value:{client:z,mediaStore:_i.current,localVideoTrack:f,localAudioTrack:h,dispatch:$,localUid:i,channelJoined:k,toggleScreensharing:Wt,isScreensharing:s.current}},React.createElement(MaxUidProvider,{value:_c.max},React.createElement(MinUidProvider,{value:_c.min},b?e.children:null)))},icons={videocam:React.createElement(React.Fragment,null,React.createElement("polygon",{points:"23 7 16 12 23 17 23 7"}),React.createElement("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})),videocamOff:React.createElement(React.Fragment,null,React.createElement("path",{d:"M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10"}),React.createElement("line",{x1:"1",y1:"1",x2:"23",y2:"23"})),remoteSwap:React.createElement(React.Fragment,null,React.createElement("polyline",{points:"15 3 21 3 21 9"}),React.createElement("polyline",{points:"9 21 3 21 3 15"}),React.createElement("line",{x1:"21",y1:"3",x2:"14",y2:"10"}),React.createElement("line",{x1:"3",y1:"21",x2:"10",y2:"14"})),callEnd:React.createElement(React.Fragment,null,React.createElement("path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"}),React.createElement("line",{x1:"23",y1:"1",x2:"1",y2:"23"})),mic:React.createElement(React.Fragment,null,React.createElement("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),React.createElement("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),React.createElement("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),React.createElement("line",{x1:"8",y1:"23",x2:"16",y2:"23"})),micOff:React.createElement(React.Fragment,null,React.createElement("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),React.createElement("path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"}),React.createElement("path",{d:"M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"}),React.createElement("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),React.createElement("line",{x1:"8",y1:"23",x2:"16",y2:"23"})),screen:React.createElement(React.Fragment,null,React.createElement("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),React.createElement("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),React.createElement("line",{x1:"12",y1:"17",x2:"12",y2:"21"})),stop:React.createElement(React.Fragment,null,React.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),React.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))},BtnTemplate=function r(e){var i=e.onClick,o=e.name,s=e.disabled,l=e.style,f=reactExports.useContext(PropsContext$1),h=f.styleProps,d=h||{},p=d.theme,g=d.BtnTemplateStyles,_=d.iconSize,b=d.customIcon;return React.createElement("div",{style:_extends({},{width:35,height:35,borderRadius:"100%",borderWidth:2,borderStyle:"solid",borderColor:"#fff",backgroundColor:"rgba(0,80,180,0.2)",alignItems:"center",justifyContent:"center",display:"flex",cursor:s?"auto":"pointer",margin:4},g,l),onClick:i},b?React.createElement("img",{src:b[o],alt:o}):React.createElement("svg",{style:{width:_||24,height:_||24},xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",opacity:s?"0.5":"1",stroke:p||"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},icons[o]))};function EndCall(){var r=reactExports.useContext(PropsContext$1),e=r.styleProps,i=r.callbacks,o=e||{},s=o.localBtnStyles,l=s||{},f=l.endCall;return React.createElement(BtnTemplate,{style:f||{backgroundColor:"#ef5588",borderColor:"#f00"},name:"callEnd",onClick:function(){return(i==null?void 0:i.EndCall)&&i.EndCall()}})}var LocalContext=reactExports.createContext({}),LocalUserContext=function r(e){var i=reactExports.useContext(MaxUidContext),o=reactExports.useContext(MinUidContext),s;return i[0].uid===0?s=i[0]:s=o.find(function(l){return l.uid===0}),React.createElement(LocalContext.Provider,{value:s},e.children)},muteAudio=function(r,e,i,o){try{var s=function(){if(r.uid===0){var l=r.hasAudio,f=function(){if(l===ToggleState.enabled||l===ToggleState.disabled){var h=l===ToggleState.enabled?ToggleState.disabling:ToggleState.enabling;e({type:"local-user-mute-audio",value:[h]}),o&&o["local-user-mute-audio"]&&o["local-user-mute-audio"](h);var d=_catch(function(){return Promise.resolve(i==null?void 0:i.setEnabled(l!==ToggleState.enabled)).then(function(){h=l===ToggleState.enabled?ToggleState.disabled:ToggleState.enabled,o&&o["local-user-mute-audio"]&&o["local-user-mute-audio"](h),e({type:"local-user-mute-audio",value:[l===ToggleState.enabled?ToggleState.disabled:ToggleState.enabled]})})},function(){e({type:"local-user-mute-audio",value:[l]})});if(d&&d.then)return d.then(function(){})}}();if(f&&f.then)return f.then(function(){})}}();return Promise.resolve(s&&s.then?s.then(function(){}):void 0)}catch(l){return Promise.reject(l)}};function LocalAudioMute(){var r=reactExports.useContext(PropsContext$1),e=r.styleProps,i=r.callbacks,o=e||{},s=o.localBtnStyles,l=s||{},f=l.muteLocalAudio,h=reactExports.useContext(RtcContext),d=h.dispatch,p=h.localAudioTrack,g=reactExports.useContext(LocalContext);return React.createElement("div",null,React.createElement(BtnTemplate,{style:f,name:g.hasAudio===ToggleState.enabled?"mic":"micOff",onClick:function(){return p&&muteAudio(g,d,p,i)}}))}function Screenshare(){var r=reactExports.useContext(PropsContext$1),e=r.styleProps,i=e||{},o=i.localBtnStyles,s=o||{},l=s.screenshare,f=reactExports.useContext(RtcContext),h=f.toggleScreensharing,d=f.isScreensharing;return React.createElement("div",null,React.createElement(BtnTemplate,{style:l,name:d?"stop":"screen",onClick:function(){return h()}}))}var muteVideo=function(r,e,i,o){try{var s=function(){if(r.uid===0){var l=r.hasVideo,f=function(){if(l===ToggleState.enabled||l===ToggleState.disabled){var h=l===ToggleState.enabled?ToggleState.disabling:ToggleState.enabling;e({type:"local-user-mute-video",value:[h]}),o&&o["local-user-mute-video"]&&o["local-user-mute-video"](h);var d=_catch(function(){return Promise.resolve(i==null?void 0:i.setEnabled(l!==ToggleState.enabled)).then(function(){h=l===ToggleState.enabled?ToggleState.disabled:ToggleState.enabled,o&&o["local-user-mute-video"]&&o["local-user-mute-video"](h),e({type:"local-user-mute-video",value:[h]})})},function(){e({type:"local-user-mute-video",value:[l]})});if(d&&d.then)return d.then(function(){})}}();if(f&&f.then)return f.then(function(){})}}();return Promise.resolve(s&&s.then?s.then(function(){}):void 0)}catch(l){return Promise.reject(l)}};function LocalVideoMute(){var r=reactExports.useContext(PropsContext$1),e=r.styleProps,i=r.callbacks,o=e||{},s=o.localBtnStyles,l=s||{},f=l.muteLocalVideo,h=reactExports.useContext(RtcContext),d=h.dispatch,p=h.localVideoTrack,g=reactExports.useContext(LocalContext);return React.createElement("div",null,React.createElement(BtnTemplate,{style:f,name:g.hasVideo===ToggleState.enabled?"videocam":"videocamOff",onClick:function(){return p&&muteVideo(g,d,p,i)}}))}function LocalControls(){var r=reactExports.useContext(PropsContext$1),e=r.styleProps,i=r.rtcProps,o=e||{},s=o.localBtnContainer;return React.createElement("div",{style:_extends({},{backgroundColor:"#007bff",width:"100%",height:70,zIndex:10,display:"flex",flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"},s)},i.role!=="audience"&&React.createElement(LocalVideoMute,null),i.role!=="audience"&&React.createElement(LocalAudioMute,null),i.role!=="audience"&&i.enableScreensharing&&React.createElement(Screenshare,null),React.createElement(EndCall,null))}var rtmStatusEnum;(function(r){r[r.initFailed=0]="initFailed",r[r.offline=1]="offline",r[r.initialising=2]="initialising",r[r.loggingIn=3]="loggingIn",r[r.loggedIn=4]="loggedIn",r[r.connected=5]="connected",r[r.loginFailed=6]="loginFailed"})(rtmStatusEnum||(rtmStatusEnum={}));var clientRoleRaw;(function(r){r[r.broadcaster=0]="broadcaster",r[r.audience=1]="audience"})(clientRoleRaw||(clientRoleRaw={}));var mutingDevice;(function(r){r[r.camera=0]="camera",r[r.microphone=1]="microphone"})(mutingDevice||(mutingDevice={}));var popUpStateEnum;(function(r){r[r.closed=0]="closed",r[r.muteMic=1]="muteMic",r[r.muteCamera=2]="muteCamera",r[r.unmuteMic=3]="unmuteMic",r[r.unmuteCamera=4]="unmuteCamera"})(popUpStateEnum||(popUpStateEnum={}));var RtmContext=reactExports.createContext(null),RtmProvider=RtmContext.Provider;RtmContext.Consumer;function RemoteVideoMute(r){var e=reactExports.useContext(PropsContext$1),i=e.styleProps,o=reactExports.useContext(RtmContext),s=o.sendMuteRequest,l=o.uidMap,f=i||{},h=f.remoteBtnStyles,d=h||{},p=d.muteRemoteVideo,g=r.UIKitUser,_=g.hasVideo===remoteTrackState.no;return g.uid!==0&&l[g.uid]?React.createElement("div",null,React.createElement(BtnTemplate,{name:g.hasVideo===remoteTrackState.subbed?"videocam":"videocamOff",style:p,onClick:function(){return s(mutingDevice.camera,g.uid,!_)}})):null}function RemoteAudioMute(r){var e=reactExports.useContext(PropsContext$1),i=e.styleProps,o=i||{},s=o.remoteBtnStyles,l=reactExports.useContext(RtmContext),f=l.sendMuteRequest,h=l.uidMap,d=s||{},p=d.muteRemoteAudio,g=r.UIKitUser,_=g.hasAudio===remoteTrackState.no;return g.uid!==0&&h[g.uid]?React.createElement("div",null,React.createElement(BtnTemplate,{style:p,name:g.hasAudio===remoteTrackState.subbed?"mic":"micOff",onClick:function(){return f(mutingDevice.microphone,g.uid,!_)}})):null}function SwapUser(r){var e=reactExports.useContext(RtcContext),i=e.dispatch,o=r.UIKitUser;return React.createElement("div",null,React.createElement(BtnTemplate,{name:"remoteSwap",onClick:function(){return i({type:"user-swap",value:[o]})}}))}var VideoPlaceholder=function r(e){var i=reactExports.useContext(PropsContext$1),o=i.styleProps,s=i.rtcProps,l=o||{},f=l.maxViewStyles,h=l.maxViewOverlayContainer,d=e.user,p=s.CustomVideoPlaceholder;return p?p&&p(_extends({},e),null):React.createElement("div",{key:d.uid,style:_extends({},style.max,f)},React.createElement("div",{style:style.imgContainer},React.createElement("img",{style:style.img,src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJmZWF0aGVyIGZlYXRoZXItdXNlciI+PHBhdGggZD0iTTIwIDIxdi0yYTQgNCAwIDAgMC00LTRIOGE0IDQgMCAwIDAtNCA0djIiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiPjwvY2lyY2xlPjwvc3ZnPg=="})),e.isShown&&React.createElement("div",{style:_extends({},style.btnContainer,h)},e.showButtons&&React.createElement(React.Fragment,null,!s.disableRtm&&React.createElement(RemoteVideoMute,{UIKitUser:d}),!s.disableRtm&&React.createElement(RemoteAudioMute,{UIKitUser:d}),e.showSwap&&React.createElement(SwapUser,{UIKitUser:d}))))},style={max:{flex:1,display:"flex",backgroundColor:"#007bff33",flexDirection:"row",position:"relative"},imgContainer:{flex:10,display:"flex",justifyContent:"center"},img:{width:100,height:100,position:"absolute",alignSelf:"center",justifySelf:"center",margin:"auto",display:"flex"},btnContainer:{position:"absolute",margin:5,flexDirection:"column",display:"flex"}},Username=function r(e){var i=reactExports.useContext(RtmContext),o=i.usernames,s=reactExports.useContext(PropsContext$1),l=s.rtmProps,f=s.styleProps,h=e.user;return l!=null&&l.displayUsername?React.createElement("p",{style:_extends({},styles.username,f==null?void 0:f.usernameText)},h.uid===1?"Screenshare":o[h.uid]):React.createElement(React.Fragment,null)},styles={username:{position:"absolute",background:"#007bffaa",padding:"2px 8px",color:"#fff",margin:0,bottom:0,right:0,zIndex:90}},MaxVideoView=function r(e){var i=reactExports.useContext(RtcContext),o=i.mediaStore,s=reactExports.useContext(PropsContext$1),l=s.styleProps,f=s.rtcProps,h=l||{},d=h.maxViewStyles,p=h.videoMode,g=h.maxViewOverlayContainer,_=p==null?void 0:p.max,b=reactExports.useState(!1),x=b[0],A=b[1],k=e.user;return React.createElement("div",{style:_extends({},styles$1.container,e.style,d),onMouseEnter:function(){return A(!0)},onMouseLeave:function(){return A(!1)}},k.hasVideo===1?React.createElement("div",{style:styles$1.videoContainer},!f.disableRtm&&React.createElement(Username,{user:k}),React.createElement(AgoraVideoPlayer,{style:styles$1.videoplayer,config:{fit:_||"cover"},videoTrack:o[k.uid].videoTrack}),x&&React.createElement("div",{style:_extends({},styles$1.overlay,g)},!f.disableRtm&&React.createElement(RemoteVideoMute,{UIKitUser:k}),!f.disableRtm&&React.createElement(RemoteAudioMute,{UIKitUser:k}))):React.createElement("div",{style:styles$1.videoContainer},!f.disableRtm&&React.createElement(Username,{user:k}),React.createElement(VideoPlaceholder,{user:k,isShown:x,showButtons:!0})))},styles$1={container:{display:"flex",flex:1},videoContainer:{display:"flex",flex:1,position:"relative"},videoplayer:{width:"100%",display:"flex",flex:1},overlay:{position:"absolute",margin:5,flexDirection:"column",display:"flex"}},MinVideoView=function r(e){var i=reactExports.useContext(RtcContext),o=i.mediaStore,s=reactExports.useContext(PropsContext$1),l=s.styleProps,f=s.rtcProps,h=l||{},d=h.minViewStyles,p=h.videoMode,g=h.minViewOverlayContainer,_=p==null?void 0:p.min,b=reactExports.useState(!1),x=b[0],A=b[1],k=e.user;return React.createElement("div",{style:_extends({},{display:"flex",flex:1},d),onMouseEnter:function(){return A(!0)},onMouseLeave:function(){return A(!1)}},k.hasVideo===1?React.createElement("div",{style:_extends({},{display:"flex",flex:1,position:"relative"})},React.createElement(AgoraVideoPlayer,{style:{flex:10,display:"flex"},config:{fit:_!==void 0?_:"cover"},videoTrack:o[k.uid].videoTrack}),x&&React.createElement("div",{style:_extends({},{margin:4,position:"absolute",flex:1,display:"flex",flexDirection:"column"},g)},!f.disableRtm&&React.createElement(RemoteVideoMute,{UIKitUser:k}),!f.disableRtm&&React.createElement(RemoteAudioMute,{UIKitUser:k}),React.createElement(SwapUser,{UIKitUser:k}))):React.createElement(VideoPlaceholder,{user:k,isShown:x,showButtons:!0,showSwap:!0}))},styles$2={scrollbar:"_3Sxu7"},PinnedVideo=function r(){var e=reactExports.useContext(PropsContext$1),i=e.styleProps,o=e.rtcProps,s=i||{},l=s.minViewContainer,f=s.pinnedVideoContainer,h=s.maxViewContainer,d=s.scrollViewContainer,p=reactExports.useRef(null),g=reactExports.useState(0),_=g[0],b=g[1],x=reactExports.useState(0),A=x[0],k=x[1],C=_>A;return reactExports.useEffect(function(){var j=function(){p.current&&(b(p.current.offsetWidth),k(p.current.offsetHeight))};return window.addEventListener("resize",j),p.current&&(b(p.current.offsetWidth),k(p.current.offsetHeight)),function(){window.removeEventListener("resize",j)}},[]),React.createElement("div",{ref:p,style:_extends({},{display:"flex",flex:1,flexDirection:C?"row":"column-reverse",overflow:"hidden"},f)},React.createElement("div",{style:_extends({},{display:"flex",flex:C?5:4},h)},React.createElement(MaxUidConsumer,null,function(j){return o.role==="audience"&&j[0].uid===0?null:React.createElement(MaxVideoView,{user:j[0]})})),React.createElement("div",{className:styles$2.scrollbar,style:_extends({},{overflowY:C?"scroll":"hidden",overflowX:C?"hidden":"scroll",display:"flex",flex:1,flexDirection:C?"column":"row"},d)},React.createElement(MinUidConsumer,null,function(j){return j.map(function(P){return o.role==="audience"&&P.uid===0?null:React.createElement("div",{style:_extends({},{minHeight:C?"35vh":"99%",minWidth:C?"99%":"40vw",margin:2,display:"flex"},l),key:P.uid},React.createElement(MinVideoView,{user:P}))})})))},GridVideo=function r(){var e=reactExports.useContext(PropsContext$1),i=e.styleProps,o=e.rtcProps,s=i||{},l=s.gridVideoCells,f=s.gridVideoContainer,h=reactExports.useContext(MaxUidContext),d=reactExports.useContext(MinUidContext),p=o.role==="audience"?[].concat(h,d).filter(function(z){return z.uid!==0}):[].concat(h,d),g=reactExports.useRef(null),_=reactExports.useState(window.innerWidth),b=_[0],x=_[1],A=reactExports.useState(window.innerHeight),k=A[0],C=A[1],j=b>k,P="minmax(0, 1fr) ";return reactExports.useEffect(function(){var z=function(){g.current&&(x(g.current.offsetWidth),C(g.current.offsetHeight))};return window.addEventListener("resize",z),g.current&&(x(g.current.offsetWidth),C(g.current.offsetHeight)),function(){window.removeEventListener("resize",z)}},[]),React.createElement("div",{ref:g,style:_extends({},{width:"100%",height:"100%",display:"grid",gridTemplateColumns:j?p.length>9?P.repeat(4):p.length>4?P.repeat(3):p.length>1?P.repeat(2):P:p.length>8?P.repeat(3):p.length>2?P.repeat(2):P},f)},p.map(function(z){return React.createElement(MaxVideoView,{user:z,style:_extends({},{height:"100%",width:"100%"},l),key:z.uid})}))},useTracks=createMicrophoneAndCameraTracks({encoderConfig:{}},{encoderConfig:{}}),TracksConfigure=function r(e){var i=reactExports.useState(!1),o=i[0],s=i[1],l=reactExports.useState(null),f=l[0],h=l[1],d=reactExports.useState(null),p=d[0],g=d[1],_=useTracks(),b=_.ready,x=_.tracks,A=_.error,k=reactExports.useRef({});return reactExports.useEffect(function(){return x!==null?(g(x[0]),h(x[1]),k.current[0]={audioTrack:x[0],videoTrack:x[1]},s(!0)):A&&(console.error(A),s(!1)),function(){if(x){var C,j;(C=x[0])===null||C===void 0||C.close(),(j=x[1])===null||j===void 0||j.close()}}},[b,A]),React.createElement(TracksProvider,{value:{localVideoTrack:f,localAudioTrack:p}},o?e.children:null)},timeNow=function r(){return new Date().getTime()},useChannel=createLazyChannel(),useClient$1=createLazyClient(),RtmConfigure=function r(e){var i=reactExports.useContext(PropsContext$1),o=i.rtcProps,s=i.rtmProps,l=reactExports.useState(!1),f=l[0],h=l[1],d=useClient$1(o.appId),p=useChannel(d,o.channel),g=reactExports.useRef(""),_=reactExports.useRef(5),b=reactExports.useContext(LocalContext),x=reactExports.useContext(PropsContext$1),A=x.rtmCallbacks,k=reactExports.useState({}),C=k[0],j=k[1],P=reactExports.useState({}),z=P[0],_e=P[1],Di=reactExports.useState({}),_i=Di[0],Ei=Di[1],ga=reactExports.useState(popUpStateEnum.closed),_c=ga[0],$=ga[1],Wt=reactExports.useState(rtmStatusEnum.offline),_t=Wt[0],Vt=Wt[1],B=reactExports.useContext(RtcContext),H=B.localUid,ue=B.localAudioTrack,_r=B.localVideoTrack,zt=B.dispatch,Fi=B.channelJoined,_n=function _h(){try{var _o=o.tokenUrl,_a=function(){if(_o){var _s=_catch(function(){return Promise.resolve(fetch(_o+"/rtm/"+((s==null?void 0:s.uid)||g.current))).then(function(_f){return Promise.resolve(_f.json()).then(function(_p){var _b=_p.rtmToken;return Promise.resolve(d.login({uid:(s==null?void 0:s.uid)||g.current,token:_b})).then(function(){_.current=5})})})},function(){setTimeout(function(){try{return _.current=_.current+_.current,_h(),Promise.resolve()}catch(_f){return Promise.reject(_f)}},_.current*1e3)});if(_s&&_s.then)return _s.then(function(){})}else{var kc=_catch(function(){return Promise.resolve(d.login({uid:(s==null?void 0:s.uid)||g.current,token:(s==null?void 0:s.token)||void 0})).then(function(){_.current=5})},function(){setTimeout(function(){try{return _.current=_.current+_.current,_h(),Promise.resolve()}catch(_f){return Promise.reject(_f)}},_.current*1e3)});if(kc&&kc.then)return kc.then(function(){})}}();return Promise.resolve(_a&&_a.then?_a.then(function(){}):void 0)}catch(_s){return Promise.reject(_s)}},Js=function _h(){try{var _o=_catch(function(){return Promise.resolve(p.join()).then(function(){_.current=5})},function(){setTimeout(function(){try{return _.current=_.current+_.current,_h(),Promise.resolve()}catch(_a){return Promise.reject(_a)}},_.current*1e3)});return Promise.resolve(_o&&_o.then?_o.then(function(){}):void 0)}catch(_a){return Promise.reject(_a)}},Gi=function(){try{if(Vt(rtmStatusEnum.initialising),o.uid?g.current=String(o.uid):g.current=String(timeNow()),d.on("ConnectionStateChanged",function(_s,kc){console.log(_s,kc)}),d.on("TokenExpired",function(){try{var _s=o.tokenUrl;console.log("token expired - renewing");var kc=function(){if(_s){var _f=_catch(function(){return Promise.resolve(fetch(_s+"/rtm/"+((s==null?void 0:s.uid)||g.current))).then(function(_p){return Promise.resolve(_p.json()).then(function(_b){var Lb=_b.rtmToken;return Promise.resolve(d.renewToken(Lb)).then(function(){_.current=5})})})},function(_p){console.error("TokenExpiredError",_p)});if(_f&&_f.then)return _f.then(function(){})}}();return Promise.resolve(kc&&kc.then?kc.then(function(){}):void 0)}catch(_f){return Promise.reject(_f)}}),d.on("MessageFromPeer",function(_s,kc){_l(_s,kc)}),p.on("ChannelMessage",function(_s,kc){_l(_s,kc)}),p.on("MemberJoined",function(_s){try{return Promise.resolve(_v(_u(),_s)).then(function(){})}catch(kc){return Promise.reject(kc)}}),p.on("MemberCountUpdated",function(_s){try{return console.log("RTM-MemberCountUpdated: ",_s),Promise.resolve()}catch(kc){return Promise.reject(kc)}}),A!=null&&A.channel?Object.keys(A.channel).map(function(_s){A.channel&&p.on(_s,A.channel[_s])}):A!=null&&A.client&&Object.keys(A.client).map(function(_s){A.client&&d.on(_s,A.client[_s])}),o.tokenUrl){var _o=o.tokenUrl,_a=o.uid;d.on("TokenExpired",function(){try{return console.log("token expired"),Promise.resolve(fetch(_o+"/rtm/"+(_a||0)+"/")).then(function(_s){return Promise.resolve(_s.json()).then(function(kc){var _f=kc.rtmToken;d.renewToken(_f)})})}catch(_s){return Promise.reject(_s)}})}return Vt(rtmStatusEnum.loggingIn),Promise.resolve(_n()).then(function(){return Vt(rtmStatusEnum.loggedIn),Promise.resolve(Js()).then(function(){Vt(rtmStatusEnum.connected),_e(function(_s){return _extends({},_s,{0:s==null?void 0:s.username})}),_g(_u())})})}catch(_s){return Promise.reject(_s)}},_u=function(){return{messageType:"UserData",rtmId:(s==null?void 0:s.uid)||g.current,rtcId:H.current,username:s==null?void 0:s.username,role:o.role==="audience"?1:0,uikit:{platform:"web",framework:"react",version:"1.2.0"},agora:{rtm:AgoraRTM__default.VERSION,rtc:AgoraRTC__default.VERSION}}},vf=function(_o,_a,_s){var kc=(s==null?void 0:s.showPopUpBeforeRemoteMute)===!1,_f={messageType:"MuteRequest",device:_o,rtcId:_a,mute:_s,isForceful:kc},_p=C[_a];kc&&!_s?console.log("cannot send force unmute request"):_p?_v(_f,_p):console.log("peer not found")},_l=function(_o,_a){var _s;if(_o.messageType==="RAW"?_s=parsePayload(_o.rawMessage):_o.messageType==="TEXT"&&(_s=JSON.parse(_o.text)),console.log(_s,_a),_s)switch(_s.messageType){case"UserData":_d(_s);break;case"MuteRequest":_m(_s);break;case"RtmDataRequest":switch(_s.type){case"ping":Eg(_a);break;case"userData":Qm(_a);break;default:console.log(_a)}break;default:console.log("unknown message content")}else console.log("unknown rtm message type")},_d=function(_o){j(function(_a){var _s;return _extends({},_a,(_s={},_s[_o.rtcId]=_o.rtmId,_s))}),_e(function(_a){var _s;return _extends({},_a,(_s={},_s[_o.rtcId]=_o.username,_s))}),Ei(function(_a){var _s;return _extends({},_a,(_s={},_s[_o.rtmId]=_o,_s))})},_m=function(_o){H.current===_o.rtcId&&(_o.isForceful?_o.mute?_o.device===mutingDevice.microphone?ue&&muteAudio(b,zt,ue):_o.device===mutingDevice.camera&&_r&&muteVideo(b,zt,_r):console.error("cannot force unmute"):_o.device===mutingDevice.microphone?_o.mute?$(popUpStateEnum.muteMic):$(popUpStateEnum.unmuteMic):_o.device===mutingDevice.camera&&(_o.mute?$(popUpStateEnum.muteCamera):$(popUpStateEnum.unmuteCamera)))},Eg=function(_o){_v({messageType:"RtmDataRequest",type:"pong"},_o)},Qm=function(_o){_v(_u(),_o)},_g=function(_o){try{var _a=d.createMessage({text:JSON.stringify(_o),messageType:AgoraRTM__default.MessageType.TEXT}),_s=_catch(function(){return Promise.resolve(p.sendMessage(_a)).then(function(){})},function(kc){console.error(kc)});return Promise.resolve(_s&&_s.then?_s.then(function(){}):void 0)}catch(kc){return Promise.reject(kc)}},_v=function(_o,_a){try{var _s=d.createMessage({text:JSON.stringify(_o),messageType:AgoraRTM__default.MessageType.TEXT}),kc=_catch(function(){return Promise.resolve(d.sendMessageToPeer(_s,String(_a))).then(function(){})},function(_f){console.error(_f)});return Promise.resolve(kc&&kc.then?kc.then(function(){}):void 0)}catch(_f){return Promise.reject(_f)}},Fg=function(){try{return Promise.resolve(d.logout()).then(function(){return Promise.resolve(d.removeAllListeners()).then(function(){})})}catch(_o){return Promise.reject(_o)}};return reactExports.useEffect(function(){return Fi&&(Gi(),h(!0)),function(){Fi&&Fg()}},[o.channel,o.appId,Fi]),React.createElement(RtmProvider,{value:{rtmStatus:_t,sendPeerMessage:_v,sendChannelMessage:_g,sendMuteRequest:vf,rtmClient:d,uidMap:C,usernames:z,userDataMap:_i,popUpState:_c,setPopUpState:$}},f?e.children:React.createElement(React.Fragment,null))};new TextEncoder;var dec=new TextDecoder,parsePayload=function r(e){return JSON.parse(dec.decode(e))};function PopUp(){var r=reactExports.useContext(PropsContext$1),e=r.styleProps,i=reactExports.useContext(RtmContext),o=i.popUpState,s=i.setPopUpState,l=e||{},f=l.popUpContainer,h=reactExports.useContext(RtcContext),d=h.dispatch,p=h.localVideoTrack,g=h.localAudioTrack,_=reactExports.useContext(LocalContext);return o!==popUpStateEnum.closed?React.createElement("div",{style:_extends({},styles$3.container,f)},React.createElement("div",{style:{color:"#fff",fontSize:18,fontWeight:700}},o===popUpStateEnum.muteCamera||o===popUpStateEnum.muteMic?"Mute ":"Unmute ",o===popUpStateEnum.muteCamera||o===popUpStateEnum.unmuteCamera?"Camera":"Mic","?"),React.createElement("div",{style:{flexDirection:"row",display:"flex",width:"100%",justifyContent:"space-around"}},React.createElement("div",{onClick:function(){switch(o){case popUpStateEnum.muteCamera:_.hasVideo&&p&&muteVideo(_,d,p);break;case popUpStateEnum.muteMic:_.hasAudio&&g&&muteAudio(_,d,g);break;case popUpStateEnum.unmuteCamera:!_.hasVideo&&p&&muteVideo(_,d,p);break;case popUpStateEnum.unmuteMic:!_.hasAudio&&g&&muteAudio(_,d,g);break}s(popUpStateEnum.closed)},style:styles$3.button},"Confirm"),React.createElement("div",{style:styles$3.buttonClose,onClick:function(){return s(popUpStateEnum.closed)}},"Close"))):null}var styles$3={button:{color:"#fff",cursor:"pointer",borderWidth:2,borderStyle:"solid",borderColor:"#fff",padding:"2px 4px",borderRadius:4},buttonClose:{color:"#fff",cursor:"pointer",borderWidth:2,borderStyle:"solid",borderColor:"#fff",padding:"2px 4px",borderRadius:4},container:{backgroundColor:"#007bffaa",position:"absolute",width:240,height:80,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:100,display:"flex",flexDirection:"column",justifyContent:"space-evenly",alignItems:"center"}},AgoraUIKit=function r(e){var i=e.styleProps,o=e.rtcProps,s=i||{},l=s.UIKitContainer;return React.createElement(PropsProvider,{value:e},React.createElement("div",{style:_extends({},style$1,l)},o.role==="audience"?React.createElement(VideocallUI,null):React.createElement(TracksConfigure,null,React.createElement(VideocallUI,null))))},VideocallUI=function r(){var e=reactExports.useContext(PropsContext$1),i=e.rtcProps;return React.createElement(RtcConfigure,{callActive:i.callActive},React.createElement(LocalUserContext,null,i.disableRtm?React.createElement(React.Fragment,null,(i==null?void 0:i.layout)===layout.grid?React.createElement(GridVideo,null):React.createElement(PinnedVideo,null),React.createElement(LocalControls,null)):React.createElement(RtmConfigure,null,React.createElement(PopUp,null),(i==null?void 0:i.layout)===layout.grid?React.createElement(GridVideo,null):React.createElement(PinnedVideo,null),React.createElement(LocalControls,null))))},style$1={display:"flex",flex:1,minHeight:0,flexDirection:"column"};const RealIdentityVerification=({onVerified:r,userType:e})=>{const[i,o]=reactExports.useState("camera_check"),[s,l]=reactExports.useState(null),[f,h]=reactExports.useState(null),[d,p]=reactExports.useState(null),[g,_]=reactExports.useState(!1),[b,x]=reactExports.useState(null),[A,k]=reactExports.useState(null),C=reactExports.useRef(null),j=reactExports.useRef(null),{toast:P}=useToast();reactExports.useEffect(()=>(z(),()=>{A&&A.getTracks().forEach(Vt=>Vt.stop())}),[]);const z=async()=>{try{const Vt=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});l(!0),k(Vt),o("instructions"),Vt.getTracks().forEach(B=>B.stop())}catch(Vt){console.error("Error al acceder a la cÃ¡mara:",Vt),l(!1),x("No se pudo acceder a la cÃ¡mara. Por favor, verifica los permisos."),o("error")}},_e=async(Vt="environment")=>{try{A&&A.getTracks().forEach(H=>H.stop());const B=await navigator.mediaDevices.getUserMedia({video:{facingMode:Vt,width:{ideal:1280},height:{ideal:720}}});return k(B),C.current&&(C.current.srcObject=B,await C.current.play()),!0}catch(B){return console.error("Error al iniciar la cÃ¡mara:",B),x("No se pudo iniciar la cÃ¡mara. Por favor, verifica los permisos."),o("error"),!1}},Di=()=>{A&&(A.getTracks().forEach(Vt=>Vt.stop()),k(null)),C.current&&(C.current.srcObject=null)},_i=async()=>{o("document"),_(!0),await _e("environment")||(P({title:"Error de cÃ¡mara",description:"No se pudo iniciar la cÃ¡mara trasera. Intentando con cÃ¡mara frontal...",variant:"destructive"}),await _e("user")),_(!1)},Ei=()=>{if(C.current&&j.current){const Vt=C.current,B=j.current;B.width=Vt.videoWidth,B.height=Vt.videoHeight;const H=B.getContext("2d");if(H){H.drawImage(Vt,0,0,B.width,B.height);const ue=B.toDataURL("image/jpeg");h(ue),Di(),o("face"),P({title:"Documento capturado",description:"Imagen del documento capturada correctamente"})}}},ga=async()=>{_(!0),await _e("user"),_(!1)},_c=()=>{if(C.current&&j.current){const Vt=C.current,B=j.current;B.width=Vt.videoWidth,B.height=Vt.videoHeight;const H=B.getContext("2d");if(H){H.drawImage(Vt,0,0,B.width,B.height);const ue=B.toDataURL("image/jpeg");p(ue),Di(),o("processing"),P({title:"Rostro capturado",description:"Imagen del rostro capturada correctamente"}),$()}}},$=()=>{setTimeout(()=>{const Vt={documentType:"CÃ©dula de Identidad",documentNumber:"12.345.678-9",fullName:e==="client"?"Cliente Demo":"Certificador Demo",expiryDate:"31/12/2026",documentImage:f,faceImage:d,verificationTime:new Date().toISOString(),verificationResult:"VERIFICADO",score:.95};r(Vt)},2e3)},Wt=()=>{Di(),h(null),p(null),x(null),o("instructions")},_t=()=>{switch(i){case"camera_check":return jsxRuntimeExports.jsxs("div",{className:"text-center p-6 space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"animate-pulse flex justify-center",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"h-12 w-12 text-primary animate-spin"})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:"Verificando cÃ¡mara..."}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Por favor, espere mientras verificamos el acceso a su cÃ¡mara"})]});case"instructions":return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"bg-primary/10 p-6 rounded-full inline-block mb-4",children:jsxRuntimeExports.jsx(Camera,{className:"h-12 w-12 text-primary"})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-2",children:"VerificaciÃ³n de identidad"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Para completar la verificaciÃ³n de identidad necesitaremos:"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3 mt-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("div",{className:"bg-primary/10 p-2 rounded-full",children:jsxRuntimeExports.jsx("span",{className:"text-primary font-bold",children:"1"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium",children:"Foto de su documento de identidad"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Capturaremos el frente de su cÃ©dula o pasaporte"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("div",{className:"bg-primary/10 p-2 rounded-full",children:jsxRuntimeExports.jsx("span",{className:"text-primary font-bold",children:"2"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium",children:"Foto de su rostro"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Tomaremos una foto para verificar su identidad"})]})]})]}),jsxRuntimeExports.jsx(Button,{onClick:_i,className:"w-full",disabled:g,children:g?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"mr-2 h-4 w-4 animate-spin"}),"Iniciando cÃ¡mara..."]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:"Comenzar verificaciÃ³n"})})]});case"document":return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:"Captura de documento"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Coloque su documento de identidad frente a la cÃ¡mara"})]}),jsxRuntimeExports.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden",children:[jsxRuntimeExports.jsx("video",{ref:C,className:"w-full h-[280px] object-cover",autoPlay:!0,playsInline:!0}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 border-2 border-dashed border-white/50 pointer-events-none rounded-lg"})]}),jsxRuntimeExports.jsx(Button,{onClick:Ei,className:"w-full",disabled:g||!A,children:g?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"mr-2 h-4 w-4 animate-spin"}),"Preparando..."]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:"Capturar documento"})})]});case"face":return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:"Captura de rostro"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Mire directamente a la cÃ¡mara y mantenga su rostro dentro del marco"})]}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium mb-1",children:"Documento capturado:"}),f&&jsxRuntimeExports.jsx("img",{src:f,alt:"Documento capturado",className:"w-full h-[100px] object-cover rounded-lg"})]}),A?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden",children:[jsxRuntimeExports.jsx("video",{ref:C,className:"w-full h-[280px] object-cover",autoPlay:!0,playsInline:!0}),jsxRuntimeExports.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[180px] h-[180px] border-2 border-primary rounded-full pointer-events-none"})]}),jsxRuntimeExports.jsx(Button,{onClick:_c,className:"w-full",disabled:g,children:"Capturar rostro"})]}):jsxRuntimeExports.jsx(Button,{onClick:ga,className:"w-full mb-4",disabled:g,children:g?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"mr-2 h-4 w-4 animate-spin"}),"Iniciando cÃ¡mara..."]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:"Iniciar cÃ¡mara"})})]});case"processing":return jsxRuntimeExports.jsxs("div",{className:"text-center p-6 space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"animate-pulse flex justify-center",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"h-12 w-12 text-primary animate-spin"})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:"Procesando verificaciÃ³n"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Estamos analizando las imÃ¡genes capturadas para verificar su identidad..."}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium mb-1",children:"Documento:"}),f&&jsxRuntimeExports.jsx("img",{src:f,alt:"Documento",className:"w-full h-[100px] object-cover rounded-lg"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium mb-1",children:"Rostro:"}),d&&jsxRuntimeExports.jsx("img",{src:d,alt:"Rostro",className:"w-full h-[100px] object-cover rounded-lg"})]})]})]});case"error":return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs(Alert,{variant:"destructive",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"h-4 w-4"}),jsxRuntimeExports.jsx(AlertTitle,{children:"Error"}),jsxRuntimeExports.jsx(AlertDescription,{children:b||"Ha ocurrido un error durante el proceso de verificaciÃ³n."})]}),jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsxs(Button,{variant:"outline",onClick:Wt,className:"mt-4",children:[jsxRuntimeExports.jsx(RefreshCw,{className:"h-4 w-4 mr-2"}),"Reintentar"]})})]})}};return jsxRuntimeExports.jsxs(Card,{className:"w-full",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{children:"VerificaciÃ³n de identidad"}),jsxRuntimeExports.jsx(CardDescription,{children:e==="client"?"Complete el proceso de verificaciÃ³n de identidad":"Solicite al cliente que complete la verificaciÃ³n"})]}),jsxRuntimeExports.jsxs(CardContent,{children:[_t(),jsxRuntimeExports.jsx("canvas",{ref:j,className:"hidden"})]}),i!=="camera_check"&&i!=="processing"&&i!=="error"&&jsxRuntimeExports.jsxs(CardFooter,{className:"border-t pt-4 flex justify-between",children:[i!=="instructions"?jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:Wt,children:"Reiniciar"}):jsxRuntimeExports.jsx("div",{}),e==="certifier"&&i==="instructions"&&jsxRuntimeExports.jsx(Button,{variant:"secondary",onClick:()=>{const Vt={documentType:"CÃ©dula de Identidad",documentNumber:"98.765.432-1",fullName:"Cliente Verificado",expiryDate:"31/12/2026",documentImage:null,faceImage:null,verificationTime:new Date().toISOString(),verificationResult:"VERIFICADO",score:.98};r(Vt),P({title:"VerificaciÃ³n completada",description:"La verificaciÃ³n de identidad ha sido completada exitosamente"})},children:"Marcar como verificado"})]})]})},PropsContext=reactExports.createContext({rtcProps:{appId:"",channel:""},callbacks:{}}),SignatureDialog=({isOpen:r,onClose:e,onSign:i})=>{const[o,s]=reactExports.useState(""),l=()=>{i(o),s(""),e()};return r?jsxRuntimeExports.jsx(Dialog,{open:r,onOpenChange:e,children:jsxRuntimeExports.jsxs(DialogContent,{className:"sm:max-w-md",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Firmar documento"}),jsxRuntimeExports.jsx(DialogDescription,{children:"Ingrese su firma para el documento"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 py-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"signature",children:"Firma (nombre completo)"}),jsxRuntimeExports.jsx(Input,{id:"signature",value:o,onChange:f=>s(f.target.value),placeholder:"Juan Pedro PÃ©rez"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500",children:"Esta es una firma simple para fines de demostraciÃ³n. Una implementaciÃ³n real utilizarÃ­a firmas digitales avanzadas o calificadas."})]}),jsxRuntimeExports.jsxs(DialogFooter,{children:[jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:e,children:"Cancelar"}),jsxRuntimeExports.jsxs(Button,{onClick:l,disabled:!o.trim(),className:"ml-2",children:[jsxRuntimeExports.jsx(PenLine,{className:"h-4 w-4 mr-2"}),"Firmar"]})]})]})}):null},AgoraUIKitTest=()=>{const[r,e]=reactExports.useState(!1),[i,o]=reactExports.useState(!1),[s,l]=reactExports.useState(null),[f,h]=reactExports.useState(!1),[d,p]=reactExports.useState(null),[g,_]=reactExports.useState(null),[b,x]=reactExports.useState("RON-2025-001"),[A,k]=reactExports.useState("client"),[C,j]=reactExports.useState(!1),[P,z]=reactExports.useState([{id:"doc-001",title:"Contrato de ejemplo",status:"pendiente"}]),[_e,Di]=reactExports.useState(!1),[_i,Ei]=reactExports.useState(null),[ga,_c]=reactExports.useState(!1),[$,Wt]=reactExports.useState(!1),[_t,Vt]=reactExports.useState(!1),[B,H]=reactExports.useState("video"),[ue,_r]=reactExports.useState(!1),[zt,Fi]=reactExports.useState(0),_n=reactExports.useRef(null),Js=reactExports.useRef("forced"),{toast:Gi}=useToast(),[_u,vf]=useLocation(),[_l,_d]=useRoute("/ron-test/:role?/:session?");reactExports.useEffect(()=>{if(_l&&_d){const _a=_d.role,_s=_d.session;_a&&(_a==="certifier"||_a==="client")&&k(_a),_s&&x(_s)}async function _o(){if(b){h(!0),p(null);try{const _s=await(await fetch(`/api/ron/public/session/${b}`)).json();_s.success?_(_s):(p(_s.error||"No se pudo obtener informaciÃ³n de la sesiÃ³n"),Gi({title:"Error",description:_s.error||"No se pudo obtener informaciÃ³n de la sesiÃ³n",variant:"destructive"}))}catch{p("Error de conexiÃ³n al servidor"),Gi({title:"Error de conexiÃ³n",description:"No se pudo conectar con el servidor",variant:"destructive"})}finally{h(!1)}}}_o()},[b,_l,_d]);const _m=async()=>{if(!b){p("Ingrese un cÃ³digo de sesiÃ³n vÃ¡lido");return}h(!0),p(null);try{const _a=await(await fetch(`/api/ron/public/session/${b}/tokens`)).json();_a.success?(console.log("Tokens obtenidos correctamente:",_a),l({appId:_a.appId,channelName:_a.channelName,token:A==="certifier"?_a.certifierToken:_a.token,certifierToken:_a.certifierToken,isNotarial:_a.isNotarial}),e(!0),Fi(A==="certifier"?1:2),Gi({title:"Conectado",description:"Conectado exitosamente a la sesiÃ³n RON"})):(p(_a.error||"No se pudieron obtener los tokens"),Gi({title:"Error",description:_a.error||"No se pudieron obtener los tokens",variant:"destructive"}))}catch{p("Error de conexiÃ³n al servidor"),Gi({title:"Error de conexiÃ³n",description:"No se pudo conectar con el servidor",variant:"destructive"})}finally{h(!1)}},Eg=()=>{e(!1),o(!1),Di(!1),Ei(null),_c(!1),H("video"),_r(!1),Gi({title:"Desconectado",description:"Se ha desconectado de la videollamada"})},Qm=async()=>{_r(!0),e(!1),setTimeout(async()=>{try{const _a=await(await fetch(`/api/ron/public/session/${b}/tokens`)).json();_a.success?(l({appId:_a.appId,channelName:_a.channelName,token:A==="certifier"?_a.certifierToken:_a.token,certifierToken:_a.certifierToken,isNotarial:_a.isNotarial}),e(!0),Gi({title:"Reconectado",description:"Se ha reconectado a la videollamada"})):(p(_a.error||"No se pudieron obtener los tokens para reconexiÃ³n"),Gi({title:"Error",description:_a.error||"No se pudieron obtener los tokens para reconexiÃ³n",variant:"destructive"}))}catch{p("Error de conexiÃ³n al reconectar"),Gi({title:"Error de reconexiÃ³n",description:"No se pudo reconectar con el servidor",variant:"destructive"})}finally{_r(!1)}},1e3)},_g=_o=>{Ei(_o),Di(!0),_c(!1),console.log("VerificaciÃ³n completada:",_o),Gi({title:"VerificaciÃ³n completada",description:"Su identidad ha sido verificada correctamente",variant:"default"}),A==="certifier"&&Gi({title:"Cliente verificado",description:`El cliente ${_o.fullName} ha sido verificado correctamente`})},_v=_o=>{z(_a=>_a.map(_s=>({..._s,status:"firmado",signature:_o,signedAt:new Date().toISOString()}))),Gi({title:"Documento firmado",description:`El documento ha sido firmado como "${_o}"`})},Fg={appId:(s==null?void 0:s.appId)||"",channel:(s==null?void 0:s.channelName)||"",token:(s==null?void 0:s.token)||null,layout:i?layout.pin:layout.grid,uid:zt,enableScreensharing:A==="certifier",disableRtm:!1},_h={EndCall:()=>Eg(),"user-joined":_o=>{console.log("Usuario unido:",_o),Gi({title:`${A==="certifier"?"Cliente":"Certificador"} conectado`,description:"Se ha conectado a la videollamada"})},"user-left":_o=>{console.log("Usuario desconectado:",_o),Gi({title:`${A==="certifier"?"Cliente":"Certificador"} desconectado`,description:"Se ha desconectado de la videollamada"})}};return _n.current=Fg,jsxRuntimeExports.jsxs("div",{className:"container mt-4 mb-8 px-2 sm:px-4",children:[jsxRuntimeExports.jsx(ForcedModeNotification,{mode:Js.current,sessionId:b}),jsxRuntimeExports.jsxs("div",{className:"mb-4 flex flex-col lg:flex-row items-start gap-4",children:[jsxRuntimeExports.jsxs(Card,{className:"w-full lg:w-1/3 mb-4 lg:mb-0",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg font-bold",children:g?"InformaciÃ³n de la sesiÃ³n":"Ingresar a sesiÃ³n RON"}),jsxRuntimeExports.jsx(CardDescription,{children:g?`SesiÃ³n ${g.id} - ${g.documentType}`:"Ingrese el cÃ³digo de la sesiÃ³n RON para conectarse"})]}),jsxRuntimeExports.jsx(CardContent,{children:g?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Tipo de documento:"}),jsxRuntimeExports.jsx("div",{children:g.documentType}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Cliente:"}),jsxRuntimeExports.jsx("div",{children:g.client}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Certificador:"}),jsxRuntimeExports.jsx("div",{children:g.certifierName}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"RegiÃ³n:"}),jsxRuntimeExports.jsx("div",{children:g.region}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"PropÃ³sito:"}),jsxRuntimeExports.jsx("div",{children:g.purpose}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Programada para:"}),jsxRuntimeExports.jsx("div",{children:new Date(g.scheduledFor).toLocaleString()}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Estado:"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Badge,{variant:g.status==="programada"?"default":g.status==="en_espera"?"secondary":g.status==="en_proceso"?"outline":g.status==="completada"?"success":"outline",children:g.status==="programada"?"Programada":g.status==="en_espera"?"En espera":g.status==="en_proceso"?"En proceso":g.status==="completada"?"Completada":g.status})}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Conectado como:"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Badge,{variant:"outline",children:A==="certifier"?"Certificador":"Cliente"})})]}),jsxRuntimeExports.jsx("div",{className:"pt-2",children:r?jsxRuntimeExports.jsxs(Button,{onClick:Eg,variant:"destructive",className:"w-full",children:[jsxRuntimeExports.jsx(Phone,{className:"mr-2 h-4 w-4 rotate-135"}),"Finalizar videollamada"]}):jsxRuntimeExports.jsx(Button,{onClick:_m,disabled:f,className:"w-full",children:f?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"mr-2 h-4 w-4 animate-spin"}),"Conectando..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Video,{className:"mr-2 h-4 w-4"}),"Iniciar videollamada"]})})}),d&&jsxRuntimeExports.jsxs(Alert,{variant:"destructive",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"h-4 w-4"}),jsxRuntimeExports.jsx(AlertTitle,{children:"Error"}),jsxRuntimeExports.jsx(AlertDescription,{children:d})]})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"sessionCode",children:"CÃ³digo de sesiÃ³n"}),jsxRuntimeExports.jsx(Input,{id:"sessionCode",placeholder:"Ej: RON-2025-001",value:b,onChange:_o=>x(_o.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"userType",children:"Conectarse como"}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsx(Button,{variant:A==="client"?"default":"outline",onClick:()=>k("client"),className:"flex-1",children:"Cliente"}),jsxRuntimeExports.jsx(Button,{variant:A==="certifier"?"default":"outline",onClick:()=>k("certifier"),className:"flex-1",children:"Certificador"})]})]}),jsxRuntimeExports.jsx(Button,{onClick:()=>vf(`/ron-test/${A}/${b}`),disabled:!b,className:"w-full",children:"Actualizar URL"}),d&&jsxRuntimeExports.jsxs(Alert,{variant:"destructive",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"h-4 w-4"}),jsxRuntimeExports.jsx(AlertTitle,{children:"Error"}),jsxRuntimeExports.jsx(AlertDescription,{children:d})]})]})})]}),jsxRuntimeExports.jsx("div",{className:"w-full lg:w-2/3",children:r?jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-0",children:jsxRuntimeExports.jsx(Tabs,{value:B,onValueChange:H,children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs(TabsList,{children:[jsxRuntimeExports.jsxs(TabsTrigger,{value:"video",className:"flex items-center",children:[jsxRuntimeExports.jsx(Video,{className:"h-4 w-4 mr-2"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Videollamada"})]}),jsxRuntimeExports.jsxs(TabsTrigger,{value:"documents",className:"flex items-center",children:[jsxRuntimeExports.jsx(FileText,{className:"h-4 w-4 mr-2"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Documentos"})]}),jsxRuntimeExports.jsxs(TabsTrigger,{value:"verification",className:"flex items-center",children:[jsxRuntimeExports.jsx(Shield,{className:"h-4 w-4 mr-2"}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"VerificaciÃ³n"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-1",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:Qm,disabled:ue,children:ue?jsxRuntimeExports.jsx(LoaderCircle,{className:"h-4 w-4 animate-spin"}):jsxRuntimeExports.jsx(RotateCcw,{className:"h-4 w-4"})}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>o(!i),children:jsxRuntimeExports.jsx(AlignJustify,{className:"h-4 w-4"})})]})]})})}),jsxRuntimeExports.jsxs(CardContent,{className:"p-0 pt-2",children:[jsxRuntimeExports.jsx(TabsContent,{value:"video",className:"m-0",children:jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"agoraApp",style:{height:"500px",position:"relative"},children:jsxRuntimeExports.jsx(PropsContext.Provider,{value:{rtcProps:Fg,callbacks:_h},children:jsxRuntimeExports.jsx(AgoraUIKit,{})})}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center space-x-2 z-10",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>Wt(!$),className:"bg-slate-800 hover:bg-slate-700",children:$?jsxRuntimeExports.jsx(MicOff,{className:"h-4 w-4 text-red-500"}):jsxRuntimeExports.jsx(Mic,{className:"h-4 w-4 text-green-500"})}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>Vt(!_t),className:"bg-slate-800 hover:bg-slate-700",children:_t?jsxRuntimeExports.jsx(CameraOff,{className:"h-4 w-4 text-red-500"}):jsxRuntimeExports.jsx(Camera,{className:"h-4 w-4 text-green-500"})}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:Eg,className:"bg-red-700 hover:bg-red-800",children:jsxRuntimeExports.jsx(Phone,{className:"h-4 w-4 rotate-135 text-white"})})]})]})}),jsxRuntimeExports.jsx(TabsContent,{value:"documents",className:"m-0",children:jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-4 min-h-[500px]",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold",children:"Documentos para esta sesiÃ³n"}),P.length===0?jsxRuntimeExports.jsxs(Alert,{children:[jsxRuntimeExports.jsx(CircleAlert,{className:"h-4 w-4"}),jsxRuntimeExports.jsx(AlertTitle,{children:"Sin documentos"}),jsxRuntimeExports.jsx(AlertDescription,{children:"No hay documentos disponibles para esta sesiÃ³n."})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[P.map(_o=>jsxRuntimeExports.jsxs(Card,{className:"overflow-hidden",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-base",children:_o.title}),jsxRuntimeExports.jsxs(CardDescription,{children:["ID: ",_o.id]})]}),jsxRuntimeExports.jsx(CardContent,{className:"pb-2",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Estado:"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Badge,{variant:_o.status==="pendiente"?"outline":_o.status==="firmado"?"success":"secondary",children:_o.status==="pendiente"?"Pendiente":_o.status==="firmado"?"Firmado":_o.status})}),_o.signature&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Firmado por:"}),jsxRuntimeExports.jsx("div",{children:_o.signature}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Fecha de firma:"}),jsxRuntimeExports.jsx("div",{children:new Date(_o.signedAt).toLocaleString()})]})]})}),jsxRuntimeExports.jsx(CardFooter,{className:"pb-4",children:_o.status==="pendiente"?jsxRuntimeExports.jsxs(Button,{onClick:()=>j(!0),className:"w-full sm:w-auto",children:[jsxRuntimeExports.jsx(PenLine,{className:"h-4 w-4 mr-2"}),"Firmar documento"]}):jsxRuntimeExports.jsxs(Button,{variant:"outline",disabled:!0,className:"w-full sm:w-auto",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"h-4 w-4 mr-2 text-green-500"}),"Documento firmado"]})})]},_o.id)),jsxRuntimeExports.jsx(SignatureDialog,{isOpen:C,onClose:()=>j(!1),onSign:_v})]})]})}),jsxRuntimeExports.jsx(TabsContent,{value:"verification",className:"m-0",children:jsxRuntimeExports.jsx("div",{className:"p-4 min-h-[500px]",children:ga?jsxRuntimeExports.jsx(RealIdentityVerification,{onVerified:_g,userType:A}):_e?jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx("div",{className:"bg-green-50 dark:bg-green-900 p-5 rounded-full",children:jsxRuntimeExports.jsx(CircleCheckBig,{className:"h-12 w-12 text-green-600 dark:text-green-400"})})}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-2",children:"VerificaciÃ³n completada"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:A==="client"?"Su identidad ha sido verificada correctamente":"La identidad del cliente ha sido verificada correctamente"})]}),_i&&jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{children:"Detalles de verificaciÃ³n"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-y-2 text-sm",children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Tipo de documento:"}),jsxRuntimeExports.jsx("div",{children:_i.documentType}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"NÃºmero de documento:"}),jsxRuntimeExports.jsx("div",{children:_i.documentNumber}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Nombre completo:"}),jsxRuntimeExports.jsx("div",{children:_i.fullName}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Fecha de expiraciÃ³n:"}),jsxRuntimeExports.jsx("div",{children:_i.expiryDate}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Fecha de verificaciÃ³n:"}),jsxRuntimeExports.jsx("div",{children:new Date(_i.verificationTime).toLocaleString()}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Resultado:"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Badge,{variant:"success",children:"Verificado exitosamente"})}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:"PuntuaciÃ³n:"}),jsxRuntimeExports.jsxs("div",{children:[Math.round(_i.score*100),"% de coincidencia"]})]})})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsxs(Button,{variant:"outline",onClick:()=>{Di(!1),Ei(null),_c(!0)},children:[jsxRuntimeExports.jsx(RefreshCw,{className:"h-4 w-4 mr-2"}),"Realizar nueva verificaciÃ³n"]})})]}):jsxRuntimeExports.jsxs("div",{className:"text-center space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:"VerificaciÃ³n de identidad"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:A==="client"?"Verifique su identidad para continuar con la sesiÃ³n":"Solicite al cliente que verifique su identidad"})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-900 p-8 rounded-full",children:jsxRuntimeExports.jsx(Shield,{className:"h-16 w-16 text-indigo-600 dark:text-indigo-400"})})}),jsxRuntimeExports.jsxs(Button,{onClick:()=>_c(!0),className:"px-8",children:[jsxRuntimeExports.jsx(UserCheck,{className:"h-4 w-4 mr-2"}),A==="client"?"Verificar mi identidad":"Iniciar verificaciÃ³n del cliente"]})]})})})]})]}):jsxRuntimeExports.jsx(Card,{className:"min-h-[500px] flex flex-col justify-center items-center p-4",children:jsxRuntimeExports.jsxs("div",{className:"text-center space-y-6 max-w-md",children:[jsxRuntimeExports.jsx("div",{className:"bg-slate-100 dark:bg-slate-800 p-8 rounded-full inline-block mx-auto",children:jsxRuntimeExports.jsx(Video,{className:"h-16 w-16 text-slate-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold mb-2",children:"Videollamada RON"}),jsxRuntimeExports.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:g?'Presione el botÃ³n "Iniciar videollamada" para comenzar':"Ingrese el cÃ³digo de la sesiÃ³n para conectarse"})]})]})})})]})]})};export{AgoraUIKitTest as default};
