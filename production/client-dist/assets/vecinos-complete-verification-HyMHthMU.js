import{u as W,r,bG as X,j as e,d as w,v as y,x as C,aS as ce,z as A,e as E,ax as z,W as le,az as Q,aA as I,a as c,s as Y,V as L,bE as ae,U as Z,bh as ee,bH as oe,bI as de,bJ as me,X as xe,aB as J,ag as ie,ay as ue,bB as he,af as se,ab as B,p as pe,bK as fe,bL as je,F as ge}from"./index-BPC64rrb.js";function ve({documentId:x,documentName:S,onSuccess:j,onCancel:$}){const{toast:u}=W(),[l,h]=r.useState(!1),[v,k]=r.useState(null),[o,H]=r.useState(!1),[d,m]=r.useState("disconnected"),[N,q]=r.useState(!0),[a,R]=r.useState(!0),[p,M]=r.useState([]),P=r.useRef(null),G=r.useRef(null),O=r.useRef(null),t=r.useRef(null),s=r.useRef(null);r.useEffect(()=>(t.current=X.createClient({mode:"rtc",codec:"vp8"}),()=>{f()}),[]);const V=async()=>{try{if(h(!0),k(null),m("connecting"),!t.current)throw new Error("El cliente Agora no se ha inicializado correctamente");const i=`document_verification_${x}_${Date.now()}`,n=void 0;if(!n)throw new Error("AGORA_APP_ID no está configurado");await t.current.join(n,i,null,null),s.current=await X.createMicrophoneAndCameraTracks();const[b,D]=s.current;await t.current.publish(s.current),P.current&&D.play(P.current),t.current.on("user-published",async(g,T)=>{var _,U;await t.current.subscribe(g,T),T==="video"&&G.current&&((_=g.videoTrack)==null||_.play(G.current)),T==="audio"&&((U=g.audioTrack)==null||U.play())}),t.current.on("user-unpublished",(g,T)=>{var _,U;T==="video"&&((_=g.videoTrack)==null||_.stop()),T==="audio"&&((U=g.audioTrack)==null||U.stop())}),m("connected"),u({title:"Videollamada iniciada",description:"Conexión establecida correctamente"})}catch(i){console.error("Error al iniciar video:",i),k(i.message||"Error al iniciar la videollamada"),m("disconnected"),u({variant:"destructive",title:"Error de conexión",description:i.message||"No se pudo iniciar la videollamada"})}finally{h(!1)}},f=async()=>{s.current&&(s.current.forEach(i=>i.close()),s.current=null),t.current&&await t.current.leave(),m("disconnected")},F=async()=>{if(!s.current)return;const i=s.current[1];N?await i.setEnabled(!1):await i.setEnabled(!0),q(!N)},te=async()=>{if(!s.current)return;const i=s.current[0];a?await i.setEnabled(!1):await i.setEnabled(!0),R(!a)},re=()=>{if(!s.current||!O.current||d!=="connected"){u({variant:"destructive",title:"Error",description:"No se puede capturar evidencia sin una conexión de video activa"});return}try{const i=s.current[1],n=O.current,b=n.getContext("2d");if(!b)throw new Error("No se pudo obtener el contexto del canvas");const D=document.querySelector(`[data-video="video-${i.getTrackId()}"]`);if(!D)throw new Error("No se pudo encontrar el elemento de video");n.width=D.videoWidth,n.height=D.videoHeight,b.drawImage(D,0,0,n.width,n.height);const g=n.toDataURL("image/jpeg");M(T=>[...T,g]),u({title:"Evidencia capturada",description:"Se ha capturado una imagen como evidencia"})}catch(i){console.error("Error al capturar evidencia:",i),u({variant:"destructive",title:"Error",description:i.message||"No se pudo capturar la evidencia"})}},K=(i,n)=>{const b=document.createElement("a");b.href=i,b.download=`evidencia-documento-${x}-${n}.jpg`,b.click()},ne=async()=>{if(p.length===0){u({variant:"destructive",title:"Error",description:"Se requiere al menos una captura de evidencia para completar la verificación"});return}try{h(!0),await new Promise(i=>setTimeout(i,1500)),await f(),H(!0),u({title:"Verificación completada",description:"El proceso de verificación por video ha finalizado correctamente"}),j&&j({documentId:x,evidenceCount:p.length,verificationTime:new Date().toISOString()})}catch(i){k(i.message||"Error al completar la verificación"),u({variant:"destructive",title:"Error",description:i.message||"Ha ocurrido un error al completar la verificación"})}finally{h(!1)}};return o?e.jsxs(w,{className:"w-full max-w-3xl mx-auto",children:[e.jsxs(y,{className:"bg-green-50 border-b",children:[e.jsxs(C,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(ce,{className:"h-5 w-5"}),"Verificación completada"]}),e.jsx(A,{children:"El proceso de verificación ha finalizado exitosamente"})]}),e.jsxs(E,{className:"pt-6 pb-2",children:[e.jsxs(z,{className:"bg-green-50 border-green-200 mb-4",children:[e.jsx(le,{className:"h-4 w-4 text-green-700"}),e.jsx(Q,{className:"text-green-700",children:"Verificación exitosa"}),e.jsxs(I,{children:["Se ha completado la verificación por video para el documento ",e.jsx("strong",{children:S}),"."]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Evidencia capturada:"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:p.map((i,n)=>e.jsxs("div",{className:"border rounded-md overflow-hidden",children:[e.jsx("img",{src:i,alt:`Evidencia ${n+1}`,className:"w-full h-auto"}),e.jsx("div",{className:"p-2 flex justify-end",children:e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>K(i,n+1),children:[e.jsx(Y,{className:"h-4 w-4 mr-1"}),"Descargar"]})})]},n))})]})]}),e.jsx(L,{className:"flex justify-end gap-2",children:e.jsx(c,{variant:"default",onClick:()=>{j&&j({})},children:"Continuar"})})]}):e.jsxs(w,{className:"w-full max-w-3xl mx-auto",children:[e.jsxs(y,{className:"border-b",children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"Verificación por videollamada"]}),e.jsxs(A,{children:["Verificación de identidad para el documento: ",S]})]}),e.jsxs(E,{className:"pt-6",children:[v&&e.jsxs(z,{variant:"destructive",className:"mb-4",children:[e.jsx(Q,{children:"Error"}),e.jsx(I,{children:v})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-gray-100 aspect-video flex items-center justify-center",children:[d==="disconnected"?e.jsxs("div",{className:"text-center p-4",children:[e.jsx(Z,{className:"h-10 w-10 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"Videollamada no iniciada"}),e.jsx(c,{variant:"default",onClick:V,className:"mt-2",disabled:l,children:l?e.jsx(e.Fragment,{children:"Conectando..."}):e.jsx(e.Fragment,{children:"Iniciar video"})})]}):e.jsx("div",{ref:P,className:"w-full h-full bg-black",id:"local-video"}),d==="connected"&&e.jsxs("div",{className:"absolute bottom-2 left-2 right-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded-full",children:"Yo"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:F,className:`p-2 rounded-full ${N?"bg-gray-700":"bg-red-600"} text-white`,children:N?e.jsx(ee,{className:"h-4 w-4"}):e.jsx(oe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:te,className:`p-2 rounded-full ${a?"bg-gray-700":"bg-red-600"} text-white`,children:a?e.jsx(de,{className:"h-4 w-4"}):e.jsx(me,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-gray-100 aspect-video flex items-center justify-center",children:[d!=="connected"?e.jsxs("div",{className:"text-center p-4",children:[e.jsx(Z,{className:"h-10 w-10 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"Esperando al certificador"})]}):e.jsx("div",{ref:G,className:"w-full h-full bg-black",id:"remote-video"}),d==="connected"&&e.jsx("div",{className:"absolute bottom-2 left-2",children:e.jsx("span",{className:"text-xs bg-purple-600 text-white px-2 py-1 rounded-full",children:"Certificador"})})]})]}),d==="connected"&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2 border-t border-b py-3 mb-3",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Captura de evidencia:"}),e.jsxs(c,{onClick:re,variant:"outline",className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-4 w-4"}),"Capturar evidencia"]})]}),p.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 mt-2",children:p.map((i,n)=>e.jsxs("div",{className:"relative border rounded-md overflow-hidden group",children:[e.jsx("img",{src:i,alt:`Evidencia ${n+1}`,className:"w-full h-auto"}),e.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all flex items-center justify-center opacity-0 group-hover:opacity-100",children:[e.jsx(c,{size:"icon",variant:"ghost",className:"text-white",onClick:()=>K(i,n+1),children:e.jsx(Y,{className:"h-5 w-5"})}),e.jsx(c,{size:"icon",variant:"ghost",className:"text-white",onClick:()=>{M(b=>b.filter((D,g)=>g!==n))},children:e.jsx(xe,{className:"h-5 w-5"})})]})]},n))}),e.jsx("canvas",{ref:O,style:{display:"none"},id:"snapshot-canvas"})]})]}),e.jsxs(L,{className:"flex justify-between gap-2 border-t pt-4",children:[e.jsx(c,{variant:"outline",onClick:async()=>{await f(),$&&$()},disabled:l,children:"Cancelar"}),e.jsx(c,{onClick:ne,disabled:l||d!=="connected"||p.length===0,className:"flex-1 sm:flex-none",children:l?e.jsx(e.Fragment,{children:"Procesando..."}):e.jsx(e.Fragment,{children:"Completar verificación"})})]})]})}function Ne({documentId:x,documentName:S,onSuccess:j,onCancel:$}){const{toast:u}=W(),[l,h]=r.useState(!1),[v,k]=r.useState(!1),[o,H]=r.useState(null),[d,m]=r.useState(null),[N,q]=r.useState(!1),[a,R]=r.useState("waiting"),[p,M]=r.useState(300);r.useEffect(()=>{P()},[]),r.useEffect(()=>{let t;return v&&a!=="signed"&&p>0?t=setTimeout(()=>{M(s=>s-1)},1e3):p===0&&a!=="signed"&&(R("expired"),m("El código QR ha expirado. Por favor, genere uno nuevo para continuar.")),()=>{t&&clearTimeout(t)}},[v,p,a]);const P=async()=>{try{h(!0),m(null),R("waiting"),M(300);const t=await fetch("/api/qr-signature/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentId:x})});if(!t.ok){const f=await t.json();throw new Error(f.error||"Error al generar el código QR")}const s=await t.json();if(!s.success)throw new Error("Error al generar el código QR: respuesta inválida del servidor");const V=s.signatureUrl;H(V),k(!0),G(s.verificationCode)}catch(t){console.error("Error al generar QR:",t),m(t.message||"Error al generar el código QR"),k(!1)}finally{h(!1)}},G=t=>{let s;const V=async()=>{try{if(a!=="signed"&&a!=="expired"&&t){const f=await fetch(`/api/qr-signature/status/${x}/${t}`);if(!f.ok){console.error("Error al verificar estado de firma:",f.status);return}const F=await f.json();F.success&&F.status!==a&&(F.status==="scanned"&&a==="waiting"?(R("scanned"),u({title:"QR escaneado",description:"El usuario ha escaneado el código QR desde su dispositivo móvil"})):F.status==="signed"&&(R("signed"),q(!0),window.clearInterval(s),u({title:"Documento firmado",description:"El documento ha sido firmado exitosamente desde el dispositivo móvil"})))}else window.clearInterval(s)}catch(f){console.error("Error al comprobar estado de firma:",f)}};V(),s=window.setInterval(V,3e3),setTimeout(()=>{a==="waiting"&&(R("scanned"),u({title:"QR escaneado (simulado)",description:"El usuario ha escaneado el código QR desde su dispositivo móvil"}))},8e3),setTimeout(()=>{a==="scanned"&&(R("signed"),q(!0),window.clearInterval(s),u({title:"Documento firmado (simulado)",description:"El documento ha sido firmado exitosamente desde el dispositivo móvil"}))},15e3)},O=t=>{const s=Math.floor(t/60),V=t%60;return`${s.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`};return N?e.jsxs(w,{className:"w-full max-w-3xl mx-auto",children:[e.jsxs(y,{className:"bg-green-50 border-b",children:[e.jsxs(C,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(J,{className:"h-5 w-5"}),"Firma completada"]}),e.jsx(A,{children:"El documento ha sido firmado correctamente"})]}),e.jsx(E,{className:"pt-6 pb-2",children:e.jsxs("div",{className:"text-center max-w-md mx-auto py-8",children:[e.jsx(J,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"¡Firma exitosa!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"El documento ha sido firmado electrónicamente de manera exitosa desde un dispositivo móvil."}),e.jsxs(z,{className:"mb-4 text-left",children:[e.jsx(Q,{children:"Información de la firma"}),e.jsxs(I,{children:[e.jsx("p",{children:"Se ha utilizado firma electrónica avanzada según Ley 19.799."}),e.jsxs("p",{className:"mt-2",children:["Documento firmado: ",e.jsx("strong",{children:S})]}),e.jsxs("p",{className:"mt-2",children:["ID de documento: ",e.jsx("strong",{children:x})]}),e.jsxs("p",{className:"mt-2",children:["Hora de firma: ",e.jsx("strong",{children:new Date().toLocaleString()})]})]})]})]})}),e.jsx(L,{className:"flex justify-end gap-2",children:e.jsx(c,{onClick:()=>{j&&j({documentId:x,signatureType:"qr_mobile",signatureTime:new Date().toISOString()})},children:"Continuar"})})]}):e.jsxs(w,{className:"w-full max-w-3xl mx-auto",children:[e.jsxs(y,{className:"border-b",children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Firma con Código QR"]}),e.jsxs(A,{children:["Firma electrónica avanzada para el documento: ",S]})]}),e.jsxs(E,{className:"pt-6",children:[d&&e.jsxs(z,{variant:"destructive",className:"mb-4",children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsx(Q,{children:"Error"}),e.jsx(I,{children:d})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border p-4 bg-gray-50",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Información del documento:"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Nombre:"})," ",e.jsx("span",{className:"font-medium",children:S})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"ID del documento:"})," ",e.jsx("span",{className:"font-medium",children:x})]})]})})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Código QR para firma móvil:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`text-sm font-medium ${p<60?"text-red-500":"text-gray-500"}`,children:["Expira en: ",O(p)]}),e.jsx(c,{variant:"outline",size:"sm",onClick:P,disabled:l||a==="scanned",children:l?"Generando...":"Generar nuevo QR"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6 justify-between",children:[e.jsx("div",{className:"flex-1 flex flex-col items-center",children:l?e.jsx("div",{className:"flex items-center justify-center w-64 h-64 border rounded-lg bg-gray-50",children:e.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-primary border-t-transparent rounded-full"})}):v?e.jsxs("div",{className:"relative border rounded-lg p-4 bg-white",children:[a==="expired"&&e.jsx("div",{className:"absolute inset-0 bg-gray-200 bg-opacity-70 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-md",children:[e.jsx(he,{className:"h-8 w-8 text-amber-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-medium text-center",children:"QR Expirado"})]})}),a==="scanned"&&e.jsx("div",{className:"absolute inset-0 bg-blue-100 bg-opacity-70 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-md",children:[e.jsx(se,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-medium text-center",children:"QR Escaneado"}),e.jsx("p",{className:"text-xs text-center mt-1",children:"Esperando firma..."})]})}),e.jsx("div",{className:"w-64 h-64 bg-white flex items-center justify-center overflow-hidden",children:e.jsxs("div",{className:"qr-code-placeholder",children:[e.jsx("div",{className:"w-56 h-56 grid grid-cols-9 grid-rows-9 gap-1",children:Array.from({length:81}).map((t,s)=>e.jsx("div",{className:`${Math.random()>.7?"bg-black":"bg-transparent"} ${s<9&&(s<3||s>5)||s>71&&(s<75||s>77)||s%9<3&&(s%9<1||s%9>1)&&s<27||s%9>5&&(s%9<7||s%9>7)&&s<27?"bg-black":""}`},s))}),e.jsx("div",{className:"mt-2 text-xs text-center font-mono overflow-hidden text-ellipsis px-2",children:o||"https://vecinos-xpress.site/firma/..."})]})})]}):e.jsx("div",{className:"w-64 h-64 border rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500 text-center p-4",children:'No se ha generado ningún código QR. Haga clic en "Generar nuevo QR" para comenzar.'})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(z,{children:[e.jsx(Q,{children:"Instrucciones"}),e.jsxs(I,{children:[e.jsxs("ol",{className:"list-decimal pl-5 space-y-2 text-sm",children:[e.jsx("li",{children:"Escanee el código QR con la cámara de su teléfono móvil."}),e.jsx("li",{children:"Será dirigido a una página web segura."}),e.jsx("li",{children:"Verifique su identidad siguiendo las instrucciones."}),e.jsx("li",{children:"Firme el documento directamente desde su teléfono."}),e.jsx("li",{children:"Una vez completado, esta pantalla se actualizará automáticamente."})]}),e.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[e.jsx("p",{className:"font-medium",children:"Notas importantes:"}),e.jsxs("ul",{className:"list-disc pl-5 mt-1 space-y-1",children:[e.jsx("li",{children:"El código QR expira en 5 minutos por seguridad."}),e.jsx("li",{children:"Necesitará tener su cédula de identidad a mano."}),e.jsx("li",{children:"El proceso cumple con los requisitos de la Ley 19.799 de firma electrónica."})]})]})]})]}),a==="scanned"&&e.jsxs(z,{className:"mt-4 bg-blue-50 border-blue-200",children:[e.jsx(se,{className:"h-4 w-4 text-blue-700"}),e.jsx(Q,{className:"text-blue-700",children:"Dispositivo móvil conectado"}),e.jsxs(I,{children:[e.jsx("p",{children:"El usuario está completando el proceso de firma en su dispositivo móvil."}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"Por favor, espere a que termine el proceso."})]})]})]})]})]})]})]}),e.jsx(L,{className:"flex justify-between gap-2 border-t pt-4",children:e.jsxs(c,{variant:"outline",onClick:$,disabled:l,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Cancelar"]})})]})}function we(){const[,x]=pe(),S=fe(),{toast:j}=W(),[$,u]=r.useState(!1),[l,h]=r.useState("select"),[v,k]=r.useState("etoken"),[o,H]=r.useState({id:parseInt(S.documentId||"1"),title:"Contrato de Prestación de Servicios",type:"contract",status:"pending",clientName:"Juan Pérez González",clientRut:"12.345.678-9",clientPhone:"+56 9 1234 5678",clientEmail:"juan.perez@ejemplo.cl",verificationCode:"ABC12345",createdAt:new Date().toISOString(),fileName:"contrato-prestacion-servicios.pdf"}),d=()=>{l==="sign"||l==="verify"||l==="qrsign"?h("select"):x("/vecinos-express")},m=a=>{k(a),a==="etoken"?h("sign"):a==="video"?h("verify"):a==="qr"&&h("qrsign")},N=a=>{j({title:"Firma completada",description:"El documento ha sido firmado exitosamente."}),h("complete")},q=a=>{j({title:"Verificación completa",description:"La verificación por video ha sido completada exitosamente."}),h("complete")};return l==="complete"?e.jsx("div",{className:"container mx-auto mt-8 px-4 max-w-3xl",children:e.jsxs(w,{children:[e.jsxs(y,{className:"bg-green-50 border-b",children:[e.jsxs(C,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(J,{className:"h-5 w-5"}),"Proceso completado exitosamente"]}),e.jsx(A,{children:"El documento ha sido procesado correctamente"})]}),e.jsx(E,{className:"pt-6 pb-2",children:e.jsxs("div",{className:"text-center max-w-md mx-auto py-8",children:[e.jsx(J,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"¡Proceso completado!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:v==="etoken"?"El documento ha sido firmado electrónicamente de manera exitosa con eToken.":v==="qr"?"El documento ha sido firmado electrónicamente desde un dispositivo móvil.":"La verificación por video ha sido registrada correctamente."}),e.jsxs(z,{className:"mb-4 text-left",children:[e.jsx(Q,{children:"Información importante"}),e.jsxs(I,{children:[e.jsx("p",{children:"Se ha enviado una notificación al cliente."}),e.jsxs("p",{className:"mt-2",children:["Código de verificación: ",e.jsx("strong",{children:o.verificationCode})]})]})]})]})}),e.jsx(L,{className:"flex justify-end gap-2",children:e.jsx(c,{onClick:()=>x("/vecinos-express"),children:"Volver al dashboard"})})]})}):l==="sign"?e.jsxs("div",{className:"container mx-auto mt-8 px-4 max-w-3xl",children:[e.jsxs(c,{onClick:d,variant:"outline",className:"mb-6",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Volver"]}),e.jsx(je,{documentId:o.id,documentName:o.title,onSuccess:N,onCancel:d})]}):l==="verify"?e.jsxs("div",{className:"container mx-auto mt-8 px-4 max-w-3xl",children:[e.jsxs(c,{onClick:d,variant:"outline",className:"mb-6",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Volver"]}),e.jsx(ve,{documentId:o.id,documentName:o.title,onSuccess:q,onCancel:d})]}):l==="qrsign"?e.jsxs("div",{className:"container mx-auto mt-8 px-4 max-w-3xl",children:[e.jsxs(c,{onClick:d,variant:"outline",className:"mb-6",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Volver"]}),e.jsx(Ne,{documentId:o.id,documentName:o.title,onSuccess:N,onCancel:d})]}):e.jsxs("div",{className:"container mx-auto mt-8 px-4 max-w-3xl",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsxs(c,{onClick:()=>x("/vecinos-express"),variant:"outline",size:"sm",className:"mr-4",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Volver"]}),e.jsx("h1",{className:"text-2xl font-bold",children:"Verificación de Documento"})]}),e.jsxs(w,{children:[e.jsxs(y,{children:[e.jsx(C,{children:"Información del documento"}),e.jsxs(A,{children:["Seleccione el método de validación para el documento: ",o.title]})]}),e.jsxs(E,{children:[e.jsxs("div",{className:"border rounded-lg p-4 mb-6 bg-gray-50",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Detalles del documento:"}),e.jsxs("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-500",children:"Título:"}),e.jsx("dd",{className:"font-medium",children:o.title})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-500",children:"Tipo:"}),e.jsx("dd",{className:"font-medium capitalize",children:o.type})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-500",children:"Cliente:"}),e.jsx("dd",{className:"font-medium",children:o.clientName})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-500",children:"RUT:"}),e.jsx("dd",{className:"font-medium",children:o.clientRut})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-500",children:"Código de verificación:"}),e.jsx("dd",{className:"font-mono font-medium",children:o.verificationCode})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-500",children:"Fecha de creación:"}),e.jsx("dd",{className:"font-medium",children:new Date(o.createdAt).toLocaleDateString()})]})]})]}),e.jsx("h3",{className:"text-base font-medium mb-3",children:"Seleccione el método de verificación:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-2",children:[e.jsxs(w,{className:"overflow-hidden border-2 hover:border-indigo-500 cursor-pointer transition-all",onClick:()=>m("etoken"),children:[e.jsx(y,{className:"bg-indigo-50 pb-2",children:e.jsxs(C,{className:"flex items-center gap-2 text-indigo-800 text-sm md:text-base",children:[e.jsx(ge,{className:"h-5 w-5"}),"Firma con eToken"]})}),e.jsxs(E,{className:"pt-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Utilice su token criptográfico para firmar electrónicamente el documento con una firma que cumple con la Ley 19.799."}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx(c,{variant:"outline",size:"sm",className:"border-indigo-200 hover:bg-indigo-50",onClick:a=>{a.stopPropagation(),m("etoken")},children:"Seleccionar"})})]})]}),e.jsxs(w,{className:"overflow-hidden border-2 hover:border-cyan-500 cursor-pointer transition-all",onClick:()=>m("qr"),children:[e.jsx(y,{className:"bg-cyan-50 pb-2",children:e.jsxs(C,{className:"flex items-center gap-2 text-cyan-800 text-sm md:text-base",children:[e.jsx(ie,{className:"h-5 w-5"}),"Firma por QR Móvil"]})}),e.jsxs(E,{className:"pt-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Genere un código QR para que el cliente pueda firmar el documento desde su celular. Ideal cuando el firmante está en otra ubicación."}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx(c,{variant:"outline",size:"sm",className:"border-cyan-200 hover:bg-cyan-50",onClick:a=>{a.stopPropagation(),m("qr")},children:"Seleccionar"})})]})]}),e.jsxs(w,{className:"overflow-hidden border-2 hover:border-purple-500 cursor-pointer transition-all",onClick:()=>m("video"),children:[e.jsx(y,{className:"bg-purple-50 pb-2",children:e.jsxs(C,{className:"flex items-center gap-2 text-purple-800 text-sm md:text-base",children:[e.jsx(ae,{className:"h-5 w-5"}),"Verificación por video"]})}),e.jsxs(E,{className:"pt-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Inicie una videollamada de verificación con el sistema de certificación remota RON (Remote Online Notarization)."}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx(c,{variant:"outline",size:"sm",className:"border-purple-200 hover:bg-purple-50",onClick:a=>{a.stopPropagation(),m("video")},children:"Seleccionar"})})]})]})]})]}),e.jsx(L,{className:"flex justify-between border-t pt-4",children:e.jsx(c,{variant:"outline",onClick:()=>x("/vecinos-express"),children:"Cancelar"})})]})]})}export{we as default};
